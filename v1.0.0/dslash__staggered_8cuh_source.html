<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>QUDA: include/kernels/dslash_staggered.cuh Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">QUDA
   &#160;<span id="projectnumber">1.0.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_f2fd8bd6424c93166d6dd5f2b70706e7.html">kernels</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">dslash_staggered.cuh</div>  </div>
</div><!--header-->
<div class="contents">
<a href="dslash__staggered_8cuh.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#pragma once</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="dslash__helper_8cuh.html">dslash_helper.cuh</a>&gt;</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="color__spinor__field__order_8h.html">color_spinor_field_order.h</a>&gt;</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="gauge__field__order_8h.html">gauge_field_order.h</a>&gt;</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="color__spinor_8h.html">color_spinor.h</a>&gt;</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="dslash__helper_8cuh.html">dslash_helper.cuh</a>&gt;</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="index__helper_8cuh.html">index_helper.cuh</a>&gt;</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacequda.html">quda</a></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;{</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Float, <span class="keywordtype">int</span> <a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a>, <a class="code" href="enum__quda_8h.html#a829ee8aa93bd9465811ae1ef9e0eedcc">QudaReconstructType</a> reconstruct_u_, <a class="code" href="enum__quda_8h.html#a829ee8aa93bd9465811ae1ef9e0eedcc">QudaReconstructType</a> reconstruct_l_,</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;      <span class="keywordtype">bool</span> improved_, <a class="code" href="enum__quda_8h.html#a66bcb3446804c792fbe18f0301a3a56e">QudaStaggeredPhase</a> phase_ = <a class="code" href="enum__quda_8h.html#a2f13fac18d6933e9e21bc1cf2737b21aaef16001e82f5d27acc1087288a42c3ac">QUDA_STAGGERED_PHASE_MILC</a>&gt;</div><div class="line"><a name="l00018"></a><span class="lineno"><a class="line" href="structquda_1_1_staggered_arg.html">   18</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structquda_1_1_staggered_arg.html">StaggeredArg</a> : <a class="code" href="structquda_1_1_dslash_arg.html">DslashArg</a>&lt;Float&gt; {</div><div class="line"><a name="l00019"></a><span class="lineno"><a class="line" href="structquda_1_1_staggered_arg.html#a3499b63ae3f17ce03d6df97b58718e05">   19</a></span>&#160;    <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="structquda_1_1mapper.html">mapper&lt;Float&gt;::type</a> <a class="code" href="structquda_1_1_staggered_arg.html#a3499b63ae3f17ce03d6df97b58718e05">real</a>;</div><div class="line"><a name="l00020"></a><span class="lineno"><a class="line" href="structquda_1_1_staggered_arg.html#a82c26b95bc3d210bf15c5a826d9d70a7">   20</a></span>&#160;    <span class="keyword">static</span> constexpr <span class="keywordtype">int</span> <a class="code" href="structquda_1_1_staggered_arg.html#a82c26b95bc3d210bf15c5a826d9d70a7">nSpin</a> = 1;</div><div class="line"><a name="l00021"></a><span class="lineno"><a class="line" href="structquda_1_1_staggered_arg.html#a9eedd5084c2f8aab828302448ed9d70d">   21</a></span>&#160;    <span class="keyword">static</span> constexpr <span class="keywordtype">bool</span> <a class="code" href="structquda_1_1_staggered_arg.html#a9eedd5084c2f8aab828302448ed9d70d">spin_project</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l00022"></a><span class="lineno"><a class="line" href="structquda_1_1_staggered_arg.html#a2a108d6d6c3ba077f0663de0320e728c">   22</a></span>&#160;    <span class="keyword">static</span> constexpr <span class="keywordtype">bool</span> <a class="code" href="structquda_1_1_staggered_arg.html#a2a108d6d6c3ba077f0663de0320e728c">spinor_direct_load</a> = <span class="keyword">false</span>; <span class="comment">// false means texture load</span></div><div class="line"><a name="l00023"></a><span class="lineno"><a class="line" href="structquda_1_1_staggered_arg.html#add05aef554b99bcf5caa7dfc23ad67e4">   23</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="structquda_1_1_staggered_arg.html#add05aef554b99bcf5caa7dfc23ad67e4">F</a> = <span class="keyword">typename</span> <a class="code" href="structquda_1_1colorspinor__mapper.html">colorspinor_mapper&lt;Float, nSpin, nColor, spin_project, spinor_direct_load&gt;::type</a>;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div><div class="line"><a name="l00025"></a><span class="lineno"><a class="line" href="structquda_1_1_staggered_arg.html#a8b840d254adb1008a500d2131ed9d8f4">   25</a></span>&#160;    <span class="keyword">static</span> constexpr <a class="code" href="enum__quda_8h.html#a829ee8aa93bd9465811ae1ef9e0eedcc">QudaReconstructType</a> <a class="code" href="structquda_1_1_staggered_arg.html#a8b840d254adb1008a500d2131ed9d8f4">reconstruct_u</a> = reconstruct_u_;</div><div class="line"><a name="l00026"></a><span class="lineno"><a class="line" href="structquda_1_1_staggered_arg.html#a9c952da005818285d148537b6a5c42b0">   26</a></span>&#160;    <span class="keyword">static</span> constexpr <a class="code" href="enum__quda_8h.html#a829ee8aa93bd9465811ae1ef9e0eedcc">QudaReconstructType</a> <a class="code" href="structquda_1_1_staggered_arg.html#a9c952da005818285d148537b6a5c42b0">reconstruct_l</a> = reconstruct_l_;</div><div class="line"><a name="l00027"></a><span class="lineno"><a class="line" href="structquda_1_1_staggered_arg.html#a8c7e9dcd68fbf9aca0a3764ba665b08f">   27</a></span>&#160;    <span class="keyword">static</span> constexpr <span class="keywordtype">bool</span> <a class="code" href="structquda_1_1_staggered_arg.html#a8c7e9dcd68fbf9aca0a3764ba665b08f">gauge_direct_load</a> = <span class="keyword">false</span>; <span class="comment">// false means texture load</span></div><div class="line"><a name="l00028"></a><span class="lineno"><a class="line" href="structquda_1_1_staggered_arg.html#acb9deb79daedb18f755dfe171b786a6a">   28</a></span>&#160;    <span class="keyword">static</span> constexpr <a class="code" href="enum__quda_8h.html#a744e553dee90a2671fe00aba878c315b">QudaGhostExchange</a> <a class="code" href="structquda_1_1_staggered_arg.html#acb9deb79daedb18f755dfe171b786a6a">ghost</a> = <a class="code" href="enum__quda_8h.html#a93131cceecad27ce4b964cb184e8d47aaab94b36fc680dd39f976636dac350e53">QUDA_GHOST_EXCHANGE_PAD</a>;</div><div class="line"><a name="l00029"></a><span class="lineno"><a class="line" href="structquda_1_1_staggered_arg.html#a2b9d879abbc1181dd5025d5ccaf5efe4">   29</a></span>&#160;    <span class="keyword">static</span> constexpr <span class="keywordtype">bool</span> <a class="code" href="structquda_1_1_staggered_arg.html#a2b9d879abbc1181dd5025d5ccaf5efe4">use_inphase</a> = improved_ ? false : <span class="keyword">true</span>;</div><div class="line"><a name="l00030"></a><span class="lineno"><a class="line" href="structquda_1_1_staggered_arg.html#a2ca9e8fe0dae6d5822991ca73a14a4b5">   30</a></span>&#160;    <span class="keyword">static</span> constexpr <a class="code" href="enum__quda_8h.html#a66bcb3446804c792fbe18f0301a3a56e">QudaStaggeredPhase</a> <a class="code" href="structquda_1_1_staggered_arg.html#a2ca9e8fe0dae6d5822991ca73a14a4b5">phase</a> = phase_;</div><div class="line"><a name="l00031"></a><span class="lineno"><a class="line" href="structquda_1_1_staggered_arg.html#aac4bfbe0c81e4993afb36df5bc42c5a3">   31</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="structquda_1_1_staggered_arg.html#aac4bfbe0c81e4993afb36df5bc42c5a3">GU</a> = <span class="keyword">typename</span> <a class="code" href="structquda_1_1gauge__mapper.html">gauge_mapper&lt;Float, reconstruct_u, 18, phase, gauge_direct_load, ghost, use_inphase&gt;::type</a>;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="keyword">using</span> <a class="code" href="structquda_1_1_staggered_arg.html#a956f3f3018d2cdb339eb187dba24c0de">GL</a> =</div><div class="line"><a name="l00033"></a><span class="lineno"><a class="line" href="structquda_1_1_staggered_arg.html#a956f3f3018d2cdb339eb187dba24c0de">   33</a></span>&#160;        <span class="keyword">typename</span> <a class="code" href="structquda_1_1gauge__mapper.html">gauge_mapper&lt;Float, reconstruct_l, 18, QUDA_STAGGERED_PHASE_NO, gauge_direct_load, ghost, use_inphase&gt;::type</a>;</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div><div class="line"><a name="l00035"></a><span class="lineno"><a class="line" href="structquda_1_1_staggered_arg.html#a0c40caa50baa743b43ded916ed7b341c">   35</a></span>&#160;    <a class="code" href="structquda_1_1_staggered_arg.html#add05aef554b99bcf5caa7dfc23ad67e4">F</a> <a class="code" href="structquda_1_1_staggered_arg.html#a0c40caa50baa743b43ded916ed7b341c">out</a>;      </div><div class="line"><a name="l00036"></a><span class="lineno"><a class="line" href="structquda_1_1_staggered_arg.html#ae772fbc0e4cc88f4b5c3ce0481236dff">   36</a></span>&#160;    <span class="keyword">const</span> <a class="code" href="structquda_1_1_staggered_arg.html#add05aef554b99bcf5caa7dfc23ad67e4">F</a> <a class="code" href="structquda_1_1_staggered_arg.html#ae772fbc0e4cc88f4b5c3ce0481236dff">in</a>; </div><div class="line"><a name="l00037"></a><span class="lineno"><a class="line" href="structquda_1_1_staggered_arg.html#a824f6c7fb6b63b08080b91c5d7b28532">   37</a></span>&#160;    <span class="keyword">const</span> <a class="code" href="structquda_1_1_staggered_arg.html#add05aef554b99bcf5caa7dfc23ad67e4">F</a> <a class="code" href="structquda_1_1_staggered_arg.html#a824f6c7fb6b63b08080b91c5d7b28532">x</a>;  </div><div class="line"><a name="l00038"></a><span class="lineno"><a class="line" href="structquda_1_1_staggered_arg.html#a194cca2d662d730fc7f68c173b09b02b">   38</a></span>&#160;    <span class="keyword">const</span> <a class="code" href="structquda_1_1_staggered_arg.html#aac4bfbe0c81e4993afb36df5bc42c5a3">GU</a> <a class="code" href="structquda_1_1_staggered_arg.html#a194cca2d662d730fc7f68c173b09b02b">U</a>; </div><div class="line"><a name="l00039"></a><span class="lineno"><a class="line" href="structquda_1_1_staggered_arg.html#aeef5198c30e81f2eaa6a29d50c536ac8">   39</a></span>&#160;    <span class="keyword">const</span> <a class="code" href="structquda_1_1_staggered_arg.html#a956f3f3018d2cdb339eb187dba24c0de">GL</a> <a class="code" href="structquda_1_1_staggered_arg.html#aeef5198c30e81f2eaa6a29d50c536ac8">L</a>; </div><div class="line"><a name="l00041"></a><span class="lineno"><a class="line" href="structquda_1_1_staggered_arg.html#a5616ef5d9190515a866bd7549a30ef90">   41</a></span>&#160;    <span class="keyword">const</span> real <a class="code" href="structquda_1_1_staggered_arg.html#a5616ef5d9190515a866bd7549a30ef90">a</a>; </div><div class="line"><a name="l00042"></a><span class="lineno"><a class="line" href="structquda_1_1_staggered_arg.html#ad57165e82075ade2ced1f5988e28592c">   42</a></span>&#160;    <span class="keyword">const</span> real <a class="code" href="structquda_1_1_staggered_arg.html#ad57165e82075ade2ced1f5988e28592c">tboundary</a>; </div><div class="line"><a name="l00043"></a><span class="lineno"><a class="line" href="structquda_1_1_staggered_arg.html#ac60e96d4fa1ae101ec991998354276d0">   43</a></span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="structquda_1_1_staggered_arg.html#ac60e96d4fa1ae101ec991998354276d0">is_first_time_slice</a>; </div><div class="line"><a name="l00044"></a><span class="lineno"><a class="line" href="structquda_1_1_staggered_arg.html#acb6da98de4b1cc0e750490c48323a6b9">   44</a></span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="structquda_1_1_staggered_arg.html#acb6da98de4b1cc0e750490c48323a6b9">is_last_time_slice</a>; </div><div class="line"><a name="l00045"></a><span class="lineno"><a class="line" href="structquda_1_1_staggered_arg.html#a3f247d2d48ef36aa27a0ec612babdb34">   45</a></span>&#160;    <span class="keyword">static</span> constexpr <span class="keywordtype">bool</span> <a class="code" href="structquda_1_1_staggered_arg.html#a3f247d2d48ef36aa27a0ec612babdb34">improved</a> = improved_;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div><div class="line"><a name="l00047"></a><span class="lineno"><a class="line" href="structquda_1_1_staggered_arg.html#a7d0ed79703d8468410c13c7239ed4394">   47</a></span>&#160;    <a class="code" href="structquda_1_1_staggered_arg.html#a7d0ed79703d8468410c13c7239ed4394">StaggeredArg</a>(<a class="code" href="classquda_1_1_color_spinor_field.html">ColorSpinorField</a> &amp;out, <span class="keyword">const</span> <a class="code" href="classquda_1_1_color_spinor_field.html">ColorSpinorField</a> &amp;in, <span class="keyword">const</span> <a class="code" href="classquda_1_1_gauge_field.html">GaugeField</a> &amp;U, <span class="keyword">const</span> <a class="code" href="classquda_1_1_gauge_field.html">GaugeField</a> &amp;L, <span class="keywordtype">double</span> a,</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;                 <span class="keyword">const</span> <a class="code" href="classquda_1_1_color_spinor_field.html">ColorSpinorField</a> &amp;x, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1_dslash_arg.html#a69783b102d092c4ea199fbe62fc2989c">parity</a>, <span class="keywordtype">bool</span> <a class="code" href="structquda_1_1_dslash_arg.html#a9145859a2847ef8b096d99680da0b506">dagger</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> *comm_override) :</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;      <a class="code" href="structquda_1_1_dslash_arg.html">DslashArg</a>&lt;Float&gt;(in, U, parity, dagger, a == 0.0 ? false : true, improved_ ? 3 : 1, spin_project, comm_override),</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;      out(out),</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;      in(in, improved_ ? 3 : 1),</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;      U(U),</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;      L(L),</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;      x(x),</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      a(a),</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      tboundary(U.TBoundary()),</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      is_first_time_slice(<a class="code" href="comm__quda_8h.html#a6c081bfedfe939a19ca8acd025864f14">comm_coord</a>(3) == 0 ? true : false),</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      is_last_time_slice(<a class="code" href="comm__quda_8h.html#a6c081bfedfe939a19ca8acd025864f14">comm_coord</a>(3) == <a class="code" href="comm__quda_8h.html#ab6471b31d5a7f3f80e6561382c09b3b5">comm_dim</a>(3) - 1 ? true : false)</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    {</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;      <span class="keywordflow">if</span> (!out.<a class="code" href="classquda_1_1_color_spinor_field.html#ac324b268700ab27a4455e7d216f2e92c">isNative</a>() || !x.<a class="code" href="classquda_1_1_color_spinor_field.html#ac324b268700ab27a4455e7d216f2e92c">isNative</a>() || !in.<a class="code" href="classquda_1_1_color_spinor_field.html#ac324b268700ab27a4455e7d216f2e92c">isNative</a>() || !U.<a class="code" href="classquda_1_1_gauge_field.html#aca7e53965b88761140d7bf4a78ecd935">isNative</a>())</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        <a class="code" href="util__quda_8h.html#af3bddfd9d113d50e8e0bbf58a35c5aac">errorQuda</a>(<span class="stringliteral">&quot;Unsupported field order colorspinor=%d gauge=%d combination\n&quot;</span>, in.<a class="code" href="classquda_1_1_color_spinor_field.html#ac825bed31e6f651d73c10da2595c7acc">FieldOrder</a>(), U.<a class="code" href="classquda_1_1_gauge_field.html#a757a7c90d4e94d4c44073c9904a1cb5f">FieldOrder</a>());</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    }</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  };</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Float, <span class="keywordtype">int</span> nDim, <span class="keywordtype">int</span> nColor, <span class="keywordtype">int</span> nParity, <span class="keywordtype">bool</span> dagger, KernelType kernel_type, <span class="keyword">typename</span> Arg, <span class="keyword">typename</span> Vector&gt;</div><div class="line"><a name="l00076"></a><span class="lineno"><a class="line" href="namespacequda.html#a934c5fc9441c8e192d6b6e178e0d626f">   76</a></span>&#160;  __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespacequda.html#a934c5fc9441c8e192d6b6e178e0d626f">applyStaggered</a>(</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      <a class="code" href="namespacequda.html#a4e54927fc030027c7892b4bff973aaaa">Vector</a> &amp;<a class="code" href="structquda_1_1_staggered_arg.html#a0c40caa50baa743b43ded916ed7b341c">out</a>, <a class="code" href="structquda_1_1_arg.html">Arg</a> &amp;<a class="code" href="namespacequda.html#a519e30abf575a4084224e899c730e95f">arg</a>, <span class="keywordtype">int</span> coord[nDim], <span class="keywordtype">int</span> x_cb, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1_dslash_arg.html#a69783b102d092c4ea199fbe62fc2989c">parity</a>, <span class="keywordtype">int</span> idx, <span class="keywordtype">int</span> thread_dim, <span class="keywordtype">bool</span> &amp;active)</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  {</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="structquda_1_1mapper.html">mapper&lt;Float&gt;::type</a> <a class="code" href="structquda_1_1_staggered_arg.html#a3499b63ae3f17ce03d6df97b58718e05">real</a>;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="keyword">typedef</span> <a class="code" href="classquda_1_1_matrix.html">Matrix&lt;complex&lt;real&gt;</a>, nColor&gt; Link;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> their_spinor_parity = (arg.<a class="code" href="structquda_1_1_arg.html#a8c893cadf2b678609993f7bcef5d3e14">nParity</a> == 2) ? 1 - parity : 0;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="preprocessor">#pragma unroll 4</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; 4; d++) { <span class="comment">// loop over dimension</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      <span class="comment">// standard - forward direction</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      {</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="structquda_1_1_staggered_arg.html#acb9deb79daedb18f755dfe171b786a6a">ghost</a> = (coord[d] + 1 &gt;= arg.dim[d]) &amp;&amp; isActive&lt;kernel_type&gt;(active, thread_dim, d, coord, arg);</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        <span class="keywordflow">if</span> (doHalo&lt;kernel_type&gt;(d) &amp;&amp; <a class="code" href="structquda_1_1_staggered_arg.html#acb9deb79daedb18f755dfe171b786a6a">ghost</a>) {</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">int</span> ghost_idx = ghostFaceIndexStaggered&lt;1&gt;(coord, arg.dim, d, 1);</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;          <span class="keyword">const</span> Link <a class="code" href="structquda_1_1_staggered_arg.html#a194cca2d662d730fc7f68c173b09b02b">U</a> = arg.improved ? arg.U(d, x_cb, parity) : arg.U(d, x_cb, parity, <a class="code" href="namespacequda.html#a82e883b0c8e9f4e028953ba20e274ca3">StaggeredPhase</a>(coord, d, +1, arg));</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;          <a class="code" href="namespacequda.html#a4e54927fc030027c7892b4bff973aaaa">Vector</a> <a class="code" href="structquda_1_1_staggered_arg.html#ae772fbc0e4cc88f4b5c3ce0481236dff">in</a> = arg.in.Ghost(d, 1, ghost_idx, their_spinor_parity);</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;          out += (U * <a class="code" href="structquda_1_1_staggered_arg.html#ae772fbc0e4cc88f4b5c3ce0481236dff">in</a>);</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;          <span class="keywordflow">if</span> (x_cb == 0 &amp;&amp; parity == 0 &amp;&amp; d == 0) <a class="code" href="namespacequda.html#a05261e247b2fa6bfb7bb1210c77d0636">printLink</a>(U);</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (doBulk&lt;kernel_type&gt;() &amp;&amp; !ghost) {</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">int</span> fwd_idx = <a class="code" href="namespacequda.html#a0b554befac535568a3866593316bfe26">linkIndexP1</a>(coord, arg.dim, d);</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;          <span class="keyword">const</span> Link <a class="code" href="structquda_1_1_staggered_arg.html#a194cca2d662d730fc7f68c173b09b02b">U</a> = arg.improved ? arg.U(d, x_cb, parity) : arg.U(d, x_cb, parity, <a class="code" href="namespacequda.html#a82e883b0c8e9f4e028953ba20e274ca3">StaggeredPhase</a>(coord, d, +1, arg));</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;          <a class="code" href="namespacequda.html#a4e54927fc030027c7892b4bff973aaaa">Vector</a> <a class="code" href="structquda_1_1_staggered_arg.html#ae772fbc0e4cc88f4b5c3ce0481236dff">in</a> = arg.in(fwd_idx, their_spinor_parity);</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;          out += (U * <a class="code" href="structquda_1_1_staggered_arg.html#ae772fbc0e4cc88f4b5c3ce0481236dff">in</a>);</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        }</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;      }</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;      <span class="comment">// improved - forward direction</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      <span class="keywordflow">if</span> (arg.improved) {</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="structquda_1_1_staggered_arg.html#acb9deb79daedb18f755dfe171b786a6a">ghost</a> = (coord[d] + 3 &gt;= arg.dim[d]) &amp;&amp; isActive&lt;kernel_type&gt;(active, thread_dim, d, coord, arg);</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <span class="keywordflow">if</span> (doHalo&lt;kernel_type&gt;(d) &amp;&amp; <a class="code" href="structquda_1_1_staggered_arg.html#acb9deb79daedb18f755dfe171b786a6a">ghost</a>) {</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">int</span> ghost_idx = ghostFaceIndexStaggered&lt;1&gt;(coord, arg.dim, d, arg.nFace);</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;          <span class="keyword">const</span> Link <a class="code" href="structquda_1_1_staggered_arg.html#aeef5198c30e81f2eaa6a29d50c536ac8">L</a> = arg.L(d, x_cb, parity);</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;          <span class="keyword">const</span> <a class="code" href="namespacequda.html#a4e54927fc030027c7892b4bff973aaaa">Vector</a> <a class="code" href="structquda_1_1_staggered_arg.html#ae772fbc0e4cc88f4b5c3ce0481236dff">in</a> = arg.in.Ghost(d, 1, ghost_idx, their_spinor_parity);</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;          out += L * <a class="code" href="structquda_1_1_staggered_arg.html#ae772fbc0e4cc88f4b5c3ce0481236dff">in</a>;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (doBulk&lt;kernel_type&gt;() &amp;&amp; !ghost) {</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">int</span> fwd3_idx = <a class="code" href="namespacequda.html#a28607f6fa1739e109ff41acd0e48b974">linkIndexP3</a>(coord, arg.dim, d);</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;          <span class="keyword">const</span> Link <a class="code" href="structquda_1_1_staggered_arg.html#aeef5198c30e81f2eaa6a29d50c536ac8">L</a> = arg.L(d, x_cb, parity);</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;          <span class="keyword">const</span> <a class="code" href="namespacequda.html#a4e54927fc030027c7892b4bff973aaaa">Vector</a> <a class="code" href="structquda_1_1_staggered_arg.html#ae772fbc0e4cc88f4b5c3ce0481236dff">in</a> = arg.in(fwd3_idx, their_spinor_parity);</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;          out += L * <a class="code" href="structquda_1_1_staggered_arg.html#ae772fbc0e4cc88f4b5c3ce0481236dff">in</a>;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        }</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      }</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      {</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        <span class="comment">// Backward gather - compute back offset for spinor and gauge fetch</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="structquda_1_1_staggered_arg.html#acb9deb79daedb18f755dfe171b786a6a">ghost</a> = (coord[d] - 1 &lt; 0) &amp;&amp; isActive&lt;kernel_type&gt;(active, thread_dim, d, coord, arg);</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        <span class="keywordflow">if</span> (doHalo&lt;kernel_type&gt;(d) &amp;&amp; <a class="code" href="structquda_1_1_staggered_arg.html#acb9deb79daedb18f755dfe171b786a6a">ghost</a>) {</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">int</span> ghost_idx2 = ghostFaceIndexStaggered&lt;0&gt;(coord, arg.dim, d, 1);</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">int</span> ghost_idx = arg.improved ? ghostFaceIndexStaggered&lt;0&gt;(coord, arg.dim, d, 3) : ghost_idx2;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">int</span> back_idx = <a class="code" href="namespacequda.html#ab14419953c0b6e02a7e9ac4a4313e0b9">linkIndexM1</a>(coord, arg.dim, d);</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;          <span class="keyword">const</span> Link <a class="code" href="structquda_1_1_staggered_arg.html#a194cca2d662d730fc7f68c173b09b02b">U</a> = arg.improved ? arg.U.Ghost(d, ghost_idx2, 1 - parity) :</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;            arg.U.Ghost(d, ghost_idx2, 1 - parity, <a class="code" href="namespacequda.html#a82e883b0c8e9f4e028953ba20e274ca3">StaggeredPhase</a>(coord, d, -1, arg));</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;          <a class="code" href="namespacequda.html#a4e54927fc030027c7892b4bff973aaaa">Vector</a> <a class="code" href="structquda_1_1_staggered_arg.html#ae772fbc0e4cc88f4b5c3ce0481236dff">in</a> = arg.in.Ghost(d, 0, ghost_idx, their_spinor_parity);</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;          out -= (<a class="code" href="namespacequda.html#a043738f16cdeb082fa1a5158fbad36b3">conj</a>(U) * <a class="code" href="structquda_1_1_staggered_arg.html#ae772fbc0e4cc88f4b5c3ce0481236dff">in</a>);</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (doBulk&lt;kernel_type&gt;() &amp;&amp; !<a class="code" href="structquda_1_1_staggered_arg.html#acb9deb79daedb18f755dfe171b786a6a">ghost</a>) {</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">int</span> back_idx = <a class="code" href="namespacequda.html#ab14419953c0b6e02a7e9ac4a4313e0b9">linkIndexM1</a>(coord, arg.dim, d);</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">int</span> gauge_idx = back_idx;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;          <span class="keyword">const</span> Link <a class="code" href="structquda_1_1_staggered_arg.html#a194cca2d662d730fc7f68c173b09b02b">U</a> = arg.improved ? arg.U(d, gauge_idx, 1 - parity) :</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;            arg.U(d, gauge_idx, 1 - parity, <a class="code" href="namespacequda.html#a82e883b0c8e9f4e028953ba20e274ca3">StaggeredPhase</a>(coord, d, -1, arg));</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;          <a class="code" href="namespacequda.html#a4e54927fc030027c7892b4bff973aaaa">Vector</a> <a class="code" href="structquda_1_1_staggered_arg.html#ae772fbc0e4cc88f4b5c3ce0481236dff">in</a> = arg.in(back_idx, their_spinor_parity);</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;          out -= (<a class="code" href="namespacequda.html#a043738f16cdeb082fa1a5158fbad36b3">conj</a>(U) * <a class="code" href="structquda_1_1_staggered_arg.html#ae772fbc0e4cc88f4b5c3ce0481236dff">in</a>);</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        }</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      }</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;      <span class="comment">// improved - backward direction</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;      <span class="keywordflow">if</span> (arg.improved) {</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="structquda_1_1_staggered_arg.html#acb9deb79daedb18f755dfe171b786a6a">ghost</a> = (coord[d] - 3 &lt; 0) &amp;&amp; isActive&lt;kernel_type&gt;(active, thread_dim, d, coord, arg);</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        <span class="keywordflow">if</span> (doHalo&lt;kernel_type&gt;(d) &amp;&amp; <a class="code" href="structquda_1_1_staggered_arg.html#acb9deb79daedb18f755dfe171b786a6a">ghost</a>) {</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;          <span class="comment">// when updating replace arg.nFace with 1 here</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">int</span> ghost_idx = ghostFaceIndexStaggered&lt;0&gt;(coord, arg.dim, d, 1);</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;          <span class="keyword">const</span> Link <a class="code" href="structquda_1_1_staggered_arg.html#aeef5198c30e81f2eaa6a29d50c536ac8">L</a> = arg.L.Ghost(d, ghost_idx, 1 - parity);</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;          <span class="keyword">const</span> <a class="code" href="namespacequda.html#a4e54927fc030027c7892b4bff973aaaa">Vector</a> <a class="code" href="structquda_1_1_staggered_arg.html#ae772fbc0e4cc88f4b5c3ce0481236dff">in</a> = arg.in.Ghost(d, 0, ghost_idx, their_spinor_parity);</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;          out -= <a class="code" href="namespacequda.html#a043738f16cdeb082fa1a5158fbad36b3">conj</a>(L) * <a class="code" href="structquda_1_1_staggered_arg.html#ae772fbc0e4cc88f4b5c3ce0481236dff">in</a>;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (doBulk&lt;kernel_type&gt;() &amp;&amp; !ghost) {</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">int</span> back3_idx = <a class="code" href="namespacequda.html#a29a377b8266f65a52210764e05d7a24d">linkIndexM3</a>(coord, arg.dim, d);</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">int</span> gauge_idx = back3_idx;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;          <span class="keyword">const</span> Link <a class="code" href="structquda_1_1_staggered_arg.html#aeef5198c30e81f2eaa6a29d50c536ac8">L</a> = arg.L(d, gauge_idx, 1 - parity);</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;          <span class="keyword">const</span> <a class="code" href="namespacequda.html#a4e54927fc030027c7892b4bff973aaaa">Vector</a> <a class="code" href="structquda_1_1_staggered_arg.html#ae772fbc0e4cc88f4b5c3ce0481236dff">in</a> = arg.in(back3_idx, their_spinor_parity);</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;          out -= <a class="code" href="namespacequda.html#a043738f16cdeb082fa1a5158fbad36b3">conj</a>(L) * <a class="code" href="structquda_1_1_staggered_arg.html#ae772fbc0e4cc88f4b5c3ce0481236dff">in</a>;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        }</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      }</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    } <span class="comment">// nDim</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  }</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <span class="comment">// out(x) = M*in = (-D + m) * in(x-mu)</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Float, <span class="keywordtype">int</span> nDim, <span class="keywordtype">int</span> nColor, <span class="keywordtype">int</span> nParity, <span class="keywordtype">bool</span> dagger, <span class="keywordtype">bool</span> xpay, KernelType kernel_type, <span class="keyword">typename</span> Arg&gt;</div><div class="line"><a name="l00164"></a><span class="lineno"><a class="line" href="namespacequda.html#aefe1fe37ecff5a2f12b7acbaf113a97a">  164</a></span>&#160;  __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespacequda.html#aefe1fe37ecff5a2f12b7acbaf113a97a">staggered</a>(<a class="code" href="structquda_1_1_arg.html">Arg</a> &amp;<a class="code" href="namespacequda.html#a519e30abf575a4084224e899c730e95f">arg</a>, <span class="keywordtype">int</span> idx, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1_dslash_arg.html#a69783b102d092c4ea199fbe62fc2989c">parity</a>)</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  {</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="keyword">using</span> <a class="code" href="structquda_1_1_staggered_arg.html#a3499b63ae3f17ce03d6df97b58718e05">real</a> = <span class="keyword">typename</span> <a class="code" href="structquda_1_1mapper.html">mapper&lt;Float&gt;::type</a>;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="keyword">using</span> <a class="code" href="namespacequda.html#a4e54927fc030027c7892b4bff973aaaa">Vector</a> = <a class="code" href="structquda_1_1_color_spinor.html">ColorSpinor&lt;real, nColor, 1&gt;</a>;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="keywordtype">bool</span> active</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        = <a class="code" href="structquda_1_1_dslash_arg.html#a386ecee3ffc3dfd62ea73ec8a6c75ccb">kernel_type</a> == <a class="code" href="namespacequda.html#a26dab7d836d0d5accdbd1ae9d86a6072ae5c1a8b8dba0493455102e121deb95bd">EXTERIOR_KERNEL_ALL</a> ? false : <span class="keyword">true</span>; <span class="comment">// is thread active (non-trival for fused kernel only)</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="keywordtype">int</span> thread_dim;                                          <span class="comment">// which dimension is thread working on (fused kernel only)</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="keywordtype">int</span> coord[nDim];</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="keywordtype">int</span> x_cb = arg.improved ? getCoords&lt;nDim, QUDA_4D_PC, kernel_type, Arg, 3&gt;(coord, <a class="code" href="namespacequda.html#a519e30abf575a4084224e899c730e95f">arg</a>, idx, <a class="code" href="structquda_1_1_dslash_arg.html#a69783b102d092c4ea199fbe62fc2989c">parity</a>, thread_dim) :</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                              getCoords&lt;nDim, QUDA_4D_PC, kernel_type, Arg, 1&gt;(coord, arg, idx, parity, thread_dim);</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> my_spinor_parity = <a class="code" href="structquda_1_1_dslash_arg.html#a9f9200974d6cc384443168c45e12264c">nParity</a> == 2 ? <a class="code" href="structquda_1_1_dslash_arg.html#a69783b102d092c4ea199fbe62fc2989c">parity</a> : 0;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <a class="code" href="namespacequda.html#a4e54927fc030027c7892b4bff973aaaa">Vector</a> <a class="code" href="structquda_1_1_staggered_arg.html#a0c40caa50baa743b43ded916ed7b341c">out</a>;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    applyStaggered&lt;Float, nDim, nColor, nParity, dagger, kernel_type&gt;(</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        <a class="code" href="structquda_1_1_staggered_arg.html#a0c40caa50baa743b43ded916ed7b341c">out</a>, <a class="code" href="namespacequda.html#a519e30abf575a4084224e899c730e95f">arg</a>, coord, x_cb, <a class="code" href="structquda_1_1_dslash_arg.html#a69783b102d092c4ea199fbe62fc2989c">parity</a>, idx, thread_dim, active);</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structquda_1_1_dslash_arg.html#a9145859a2847ef8b096d99680da0b506">dagger</a>) { out = -<a class="code" href="structquda_1_1_staggered_arg.html#a0c40caa50baa743b43ded916ed7b341c">out</a>; }</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structquda_1_1_dslash_arg.html#a8f950f70c2597dfadf7b6d4eb629661d">xpay</a> &amp;&amp; <a class="code" href="structquda_1_1_dslash_arg.html#a386ecee3ffc3dfd62ea73ec8a6c75ccb">kernel_type</a> == <a class="code" href="namespacequda.html#a26dab7d836d0d5accdbd1ae9d86a6072ade3868e66b609f21c5d62c2197704c40">INTERIOR_KERNEL</a>) {</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      <a class="code" href="namespacequda.html#a4e54927fc030027c7892b4bff973aaaa">Vector</a> <a class="code" href="structquda_1_1_staggered_arg.html#a824f6c7fb6b63b08080b91c5d7b28532">x</a> = arg.x(x_cb, my_spinor_parity);</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      out = arg.a * x - <a class="code" href="structquda_1_1_staggered_arg.html#a0c40caa50baa743b43ded916ed7b341c">out</a>;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="structquda_1_1_dslash_arg.html#a386ecee3ffc3dfd62ea73ec8a6c75ccb">kernel_type</a> != <a class="code" href="namespacequda.html#a26dab7d836d0d5accdbd1ae9d86a6072ade3868e66b609f21c5d62c2197704c40">INTERIOR_KERNEL</a>) {</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      <a class="code" href="namespacequda.html#a4e54927fc030027c7892b4bff973aaaa">Vector</a> <a class="code" href="structquda_1_1_staggered_arg.html#a824f6c7fb6b63b08080b91c5d7b28532">x</a> = arg.out(x_cb, my_spinor_parity);</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      out = x + (<a class="code" href="structquda_1_1_dslash_arg.html#a8f950f70c2597dfadf7b6d4eb629661d">xpay</a> ? -<a class="code" href="structquda_1_1_staggered_arg.html#a0c40caa50baa743b43ded916ed7b341c">out</a> : <a class="code" href="structquda_1_1_staggered_arg.html#a0c40caa50baa743b43ded916ed7b341c">out</a>);</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    }</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structquda_1_1_dslash_arg.html#a386ecee3ffc3dfd62ea73ec8a6c75ccb">kernel_type</a> != <a class="code" href="namespacequda.html#a26dab7d836d0d5accdbd1ae9d86a6072ae5c1a8b8dba0493455102e121deb95bd">EXTERIOR_KERNEL_ALL</a> || active) arg.out(x_cb, my_spinor_parity) = <a class="code" href="structquda_1_1_staggered_arg.html#a0c40caa50baa743b43ded916ed7b341c">out</a>;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  }</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  <span class="comment">// GPU Kernel for applying the staggered operator to a vector</span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Float, <span class="keywordtype">int</span> nDim, <span class="keywordtype">int</span> nColor, <span class="keywordtype">int</span> nParity, <span class="keywordtype">bool</span> dagger, <span class="keywordtype">bool</span> xpay, KernelType kernel_type, <span class="keyword">typename</span> Arg&gt;</div><div class="line"><a name="l00197"></a><span class="lineno"><a class="line" href="namespacequda.html#a5249bcc355db606c8b170525d6e027ef">  197</a></span>&#160;  __global__ <span class="keywordtype">void</span> <a class="code" href="namespacequda.html#a5249bcc355db606c8b170525d6e027ef">staggeredGPU</a>(<a class="code" href="structquda_1_1_arg.html">Arg</a> <a class="code" href="namespacequda.html#a519e30abf575a4084224e899c730e95f">arg</a>)</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  {</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="keywordtype">int</span> x_cb = blockIdx.x * blockDim.x + threadIdx.x;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keywordflow">if</span> (x_cb &gt;= arg.threads) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="comment">// for full fields set parity from z thread index else use arg setting</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structquda_1_1_dslash_arg.html#a69783b102d092c4ea199fbe62fc2989c">parity</a> = <a class="code" href="structquda_1_1_dslash_arg.html#a9f9200974d6cc384443168c45e12264c">nParity</a> == 2 ? blockDim.z * blockIdx.z + threadIdx.z : arg.parity;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="keywordflow">switch</span> (parity) {</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="keywordflow">case</span> 0: staggered&lt;Float, nDim, nColor, nParity, dagger, xpay, kernel_type&gt;(<a class="code" href="namespacequda.html#a519e30abf575a4084224e899c730e95f">arg</a>, x_cb, 0); <span class="keywordflow">break</span>;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="keywordflow">case</span> 1: staggered&lt;Float, nDim, nColor, nParity, dagger, xpay, kernel_type&gt;(<a class="code" href="namespacequda.html#a519e30abf575a4084224e899c730e95f">arg</a>, x_cb, 1); <span class="keywordflow">break</span>;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    }</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  }</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;} <span class="comment">// namespace quda</span></div><div class="ttc" id="structquda_1_1_dslash_arg_html"><div class="ttname"><a href="structquda_1_1_dslash_arg.html">quda::DslashArg</a></div><div class="ttdef"><b>Definition:</b> <a href="dslash__helper_8cuh_source.html#l00229">dslash_helper.cuh:229</a></div></div>
<div class="ttc" id="structquda_1_1_staggered_arg_html_a3499b63ae3f17ce03d6df97b58718e05"><div class="ttname"><a href="structquda_1_1_staggered_arg.html#a3499b63ae3f17ce03d6df97b58718e05">quda::StaggeredArg::real</a></div><div class="ttdeci">mapper&lt; Float &gt;::type real</div><div class="ttdef"><b>Definition:</b> <a href="dslash__staggered_8cuh_source.html#l00019">dslash_staggered.cuh:19</a></div></div>
<div class="ttc" id="structquda_1_1_dslash_arg_html_a386ecee3ffc3dfd62ea73ec8a6c75ccb"><div class="ttname"><a href="structquda_1_1_dslash_arg.html#a386ecee3ffc3dfd62ea73ec8a6c75ccb">quda::DslashArg::kernel_type</a></div><div class="ttdeci">KernelType kernel_type</div><div class="ttdef"><b>Definition:</b> <a href="dslash__helper_8cuh_source.html#l00250">dslash_helper.cuh:250</a></div></div>
<div class="ttc" id="structquda_1_1_staggered_arg_html_a9eedd5084c2f8aab828302448ed9d70d"><div class="ttname"><a href="structquda_1_1_staggered_arg.html#a9eedd5084c2f8aab828302448ed9d70d">quda::StaggeredArg::spin_project</a></div><div class="ttdeci">static constexpr bool spin_project</div><div class="ttdef"><b>Definition:</b> <a href="dslash__staggered_8cuh_source.html#l00021">dslash_staggered.cuh:21</a></div></div>
<div class="ttc" id="structquda_1_1_staggered_arg_html_a824f6c7fb6b63b08080b91c5d7b28532"><div class="ttname"><a href="structquda_1_1_staggered_arg.html#a824f6c7fb6b63b08080b91c5d7b28532">quda::StaggeredArg::x</a></div><div class="ttdeci">const F x</div><div class="ttdef"><b>Definition:</b> <a href="dslash__staggered_8cuh_source.html#l00037">dslash_staggered.cuh:37</a></div></div>
<div class="ttc" id="namespacequda_html_a26dab7d836d0d5accdbd1ae9d86a6072ae5c1a8b8dba0493455102e121deb95bd"><div class="ttname"><a href="namespacequda.html#a26dab7d836d0d5accdbd1ae9d86a6072ae5c1a8b8dba0493455102e121deb95bd">quda::EXTERIOR_KERNEL_ALL</a></div><div class="ttdef"><b>Definition:</b> <a href="index__helper_8cuh_source.html#l00466">index_helper.cuh:466</a></div></div>
<div class="ttc" id="classquda_1_1_color_spinor_field_html"><div class="ttname"><a href="classquda_1_1_color_spinor_field.html">quda::ColorSpinorField</a></div><div class="ttdef"><b>Definition:</b> <a href="color__spinor__field_8h_source.html#l00311">color_spinor_field.h:311</a></div></div>
<div class="ttc" id="classquda_1_1_gauge_field_html_a757a7c90d4e94d4c44073c9904a1cb5f"><div class="ttname"><a href="classquda_1_1_gauge_field.html#a757a7c90d4e94d4c44073c9904a1cb5f">quda::GaugeField::FieldOrder</a></div><div class="ttdeci">QudaGaugeFieldOrder FieldOrder() const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field_8h_source.html#l00257">gauge_field.h:257</a></div></div>
<div class="ttc" id="namespacequda_html_a934c5fc9441c8e192d6b6e178e0d626f"><div class="ttname"><a href="namespacequda.html#a934c5fc9441c8e192d6b6e178e0d626f">quda::applyStaggered</a></div><div class="ttdeci">__device__ __host__ void applyStaggered(Vector &amp;out, Arg &amp;arg, int coord[nDim], int x_cb, int parity, int idx, int thread_dim, bool &amp;active)</div><div class="ttdoc">Applies the off-diagonal part of the Staggered / Asqtad operator. </div><div class="ttdef"><b>Definition:</b> <a href="dslash__staggered_8cuh_source.html#l00076">dslash_staggered.cuh:76</a></div></div>
<div class="ttc" id="util__quda_8h_html_af3bddfd9d113d50e8e0bbf58a35c5aac"><div class="ttname"><a href="util__quda_8h.html#af3bddfd9d113d50e8e0bbf58a35c5aac">errorQuda</a></div><div class="ttdeci">#define errorQuda(...)</div><div class="ttdef"><b>Definition:</b> <a href="util__quda_8h_source.html#l00121">util_quda.h:121</a></div></div>
<div class="ttc" id="structquda_1_1_color_spinor_html"><div class="ttname"><a href="structquda_1_1_color_spinor.html">quda::ColorSpinor</a></div><div class="ttdef"><b>Definition:</b> <a href="color__spinor_8h_source.html#l00024">color_spinor.h:24</a></div></div>
<div class="ttc" id="structquda_1_1_staggered_arg_html_a8b840d254adb1008a500d2131ed9d8f4"><div class="ttname"><a href="structquda_1_1_staggered_arg.html#a8b840d254adb1008a500d2131ed9d8f4">quda::StaggeredArg::reconstruct_u</a></div><div class="ttdeci">static constexpr QudaReconstructType reconstruct_u</div><div class="ttdef"><b>Definition:</b> <a href="dslash__staggered_8cuh_source.html#l00025">dslash_staggered.cuh:25</a></div></div>
<div class="ttc" id="comm__quda_8h_html_ab6471b31d5a7f3f80e6561382c09b3b5"><div class="ttname"><a href="comm__quda_8h.html#ab6471b31d5a7f3f80e6561382c09b3b5">comm_dim</a></div><div class="ttdeci">int comm_dim(int dim)</div><div class="ttdef"><b>Definition:</b> <a href="comm__common_8cpp_source.html#l00424">comm_common.cpp:424</a></div></div>
<div class="ttc" id="namespacequda_html_a5249bcc355db606c8b170525d6e027ef"><div class="ttname"><a href="namespacequda.html#a5249bcc355db606c8b170525d6e027ef">quda::staggeredGPU</a></div><div class="ttdeci">__global__ void staggeredGPU(Arg arg)</div><div class="ttdef"><b>Definition:</b> <a href="dslash__staggered_8cuh_source.html#l00197">dslash_staggered.cuh:197</a></div></div>
<div class="ttc" id="structquda_1_1_staggered_arg_html_ad57165e82075ade2ced1f5988e28592c"><div class="ttname"><a href="structquda_1_1_staggered_arg.html#ad57165e82075ade2ced1f5988e28592c">quda::StaggeredArg::tboundary</a></div><div class="ttdeci">const real tboundary</div><div class="ttdef"><b>Definition:</b> <a href="dslash__staggered_8cuh_source.html#l00042">dslash_staggered.cuh:42</a></div></div>
<div class="ttc" id="comm__quda_8h_html_a6c081bfedfe939a19ca8acd025864f14"><div class="ttname"><a href="comm__quda_8h.html#a6c081bfedfe939a19ca8acd025864f14">comm_coord</a></div><div class="ttdeci">int comm_coord(int dim)</div><div class="ttdef"><b>Definition:</b> <a href="comm__common_8cpp_source.html#l00431">comm_common.cpp:431</a></div></div>
<div class="ttc" id="structquda_1_1_staggered_arg_html_aac4bfbe0c81e4993afb36df5bc42c5a3"><div class="ttname"><a href="structquda_1_1_staggered_arg.html#aac4bfbe0c81e4993afb36df5bc42c5a3">quda::StaggeredArg::GU</a></div><div class="ttdeci">typename gauge_mapper&lt; Float, reconstruct_u, 18, phase, gauge_direct_load, ghost, use_inphase &gt;::type GU</div><div class="ttdef"><b>Definition:</b> <a href="dslash__staggered_8cuh_source.html#l00031">dslash_staggered.cuh:31</a></div></div>
<div class="ttc" id="structquda_1_1_staggered_arg_html_a956f3f3018d2cdb339eb187dba24c0de"><div class="ttname"><a href="structquda_1_1_staggered_arg.html#a956f3f3018d2cdb339eb187dba24c0de">quda::StaggeredArg::GL</a></div><div class="ttdeci">typename gauge_mapper&lt; Float, reconstruct_l, 18, QUDA_STAGGERED_PHASE_NO, gauge_direct_load, ghost, use_inphase &gt;::type GL</div><div class="ttdef"><b>Definition:</b> <a href="dslash__staggered_8cuh_source.html#l00033">dslash_staggered.cuh:33</a></div></div>
<div class="ttc" id="structquda_1_1_staggered_arg_html_a0c40caa50baa743b43ded916ed7b341c"><div class="ttname"><a href="structquda_1_1_staggered_arg.html#a0c40caa50baa743b43ded916ed7b341c">quda::StaggeredArg::out</a></div><div class="ttdeci">F out</div><div class="ttdef"><b>Definition:</b> <a href="dslash__staggered_8cuh_source.html#l00035">dslash_staggered.cuh:35</a></div></div>
<div class="ttc" id="namespacequda_html"><div class="ttname"><a href="namespacequda.html">quda</a></div><div class="ttdef"><b>Definition:</b> <a href="blas__cublas_8h_source.html#l00005">blas_cublas.h:5</a></div></div>
<div class="ttc" id="namespacequda_html_a05261e247b2fa6bfb7bb1210c77d0636"><div class="ttname"><a href="namespacequda.html#a05261e247b2fa6bfb7bb1210c77d0636">quda::printLink</a></div><div class="ttdeci">__host__ __device__ void printLink(const Matrix&lt; Cmplx, 3 &gt; &amp;link)</div><div class="ttdef"><b>Definition:</b> <a href="quda__matrix_8h_source.html#l01149">quda_matrix.h:1149</a></div></div>
<div class="ttc" id="structquda_1_1_staggered_arg_html_a194cca2d662d730fc7f68c173b09b02b"><div class="ttname"><a href="structquda_1_1_staggered_arg.html#a194cca2d662d730fc7f68c173b09b02b">quda::StaggeredArg::U</a></div><div class="ttdeci">const GU U</div><div class="ttdef"><b>Definition:</b> <a href="dslash__staggered_8cuh_source.html#l00038">dslash_staggered.cuh:38</a></div></div>
<div class="ttc" id="structquda_1_1_staggered_arg_html_a2ca9e8fe0dae6d5822991ca73a14a4b5"><div class="ttname"><a href="structquda_1_1_staggered_arg.html#a2ca9e8fe0dae6d5822991ca73a14a4b5">quda::StaggeredArg::phase</a></div><div class="ttdeci">static constexpr QudaStaggeredPhase phase</div><div class="ttdef"><b>Definition:</b> <a href="dslash__staggered_8cuh_source.html#l00030">dslash_staggered.cuh:30</a></div></div>
<div class="ttc" id="structquda_1_1_staggered_arg_html_a8c7e9dcd68fbf9aca0a3764ba665b08f"><div class="ttname"><a href="structquda_1_1_staggered_arg.html#a8c7e9dcd68fbf9aca0a3764ba665b08f">quda::StaggeredArg::gauge_direct_load</a></div><div class="ttdeci">static constexpr bool gauge_direct_load</div><div class="ttdef"><b>Definition:</b> <a href="dslash__staggered_8cuh_source.html#l00027">dslash_staggered.cuh:27</a></div></div>
<div class="ttc" id="structquda_1_1_staggered_arg_html_a2a108d6d6c3ba077f0663de0320e728c"><div class="ttname"><a href="structquda_1_1_staggered_arg.html#a2a108d6d6c3ba077f0663de0320e728c">quda::StaggeredArg::spinor_direct_load</a></div><div class="ttdeci">static constexpr bool spinor_direct_load</div><div class="ttdef"><b>Definition:</b> <a href="dslash__staggered_8cuh_source.html#l00022">dslash_staggered.cuh:22</a></div></div>
<div class="ttc" id="namespacequda_html_aefe1fe37ecff5a2f12b7acbaf113a97a"><div class="ttname"><a href="namespacequda.html#aefe1fe37ecff5a2f12b7acbaf113a97a">quda::staggered</a></div><div class="ttdeci">__device__ __host__ void staggered(Arg &amp;arg, int idx, int parity)</div><div class="ttdef"><b>Definition:</b> <a href="dslash__staggered_8cuh_source.html#l00164">dslash_staggered.cuh:164</a></div></div>
<div class="ttc" id="namespacequda_html_a28607f6fa1739e109ff41acd0e48b974"><div class="ttname"><a href="namespacequda.html#a28607f6fa1739e109ff41acd0e48b974">quda::linkIndexP3</a></div><div class="ttdeci">static __device__ __host__ int linkIndexP3(const int x[], const I X[4], const int mu)</div><div class="ttdef"><b>Definition:</b> <a href="index__helper_8cuh_source.html#l00151">index_helper.cuh:151</a></div></div>
<div class="ttc" id="namespacequda_html_a26dab7d836d0d5accdbd1ae9d86a6072ade3868e66b609f21c5d62c2197704c40"><div class="ttname"><a href="namespacequda.html#a26dab7d836d0d5accdbd1ae9d86a6072ade3868e66b609f21c5d62c2197704c40">quda::INTERIOR_KERNEL</a></div><div class="ttdef"><b>Definition:</b> <a href="index__helper_8cuh_source.html#l00465">index_helper.cuh:465</a></div></div>
<div class="ttc" id="namespacequda_html_ab14419953c0b6e02a7e9ac4a4313e0b9"><div class="ttname"><a href="namespacequda.html#ab14419953c0b6e02a7e9ac4a4313e0b9">quda::linkIndexM1</a></div><div class="ttdeci">static __device__ __host__ int linkIndexM1(const int x[], const I X[4], const int mu)</div><div class="ttdef"><b>Definition:</b> <a href="index__helper_8cuh_source.html#l00094">index_helper.cuh:94</a></div></div>
<div class="ttc" id="namespacequda_html_a29a377b8266f65a52210764e05d7a24d"><div class="ttname"><a href="namespacequda.html#a29a377b8266f65a52210764e05d7a24d">quda::linkIndexM3</a></div><div class="ttdeci">static __device__ __host__ int linkIndexM3(const int x[], const I X[4], const int mu)</div><div class="ttdef"><b>Definition:</b> <a href="index__helper_8cuh_source.html#l00107">index_helper.cuh:107</a></div></div>
<div class="ttc" id="enum__quda_8h_html_a66bcb3446804c792fbe18f0301a3a56e"><div class="ttname"><a href="enum__quda_8h.html#a66bcb3446804c792fbe18f0301a3a56e">QudaStaggeredPhase</a></div><div class="ttdeci">enum QudaStaggeredPhase_s QudaStaggeredPhase</div></div>
<div class="ttc" id="covdev__test_8cpp_html_a8534bf561fd4d68d79107757d9cbac65"><div class="ttname"><a href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a></div><div class="ttdeci">const int nColor</div><div class="ttdef"><b>Definition:</b> <a href="covdev__test_8cpp_source.html#l00075">covdev_test.cpp:75</a></div></div>
<div class="ttc" id="structquda_1_1_staggered_arg_html_a9c952da005818285d148537b6a5c42b0"><div class="ttname"><a href="structquda_1_1_staggered_arg.html#a9c952da005818285d148537b6a5c42b0">quda::StaggeredArg::reconstruct_l</a></div><div class="ttdeci">static constexpr QudaReconstructType reconstruct_l</div><div class="ttdef"><b>Definition:</b> <a href="dslash__staggered_8cuh_source.html#l00026">dslash_staggered.cuh:26</a></div></div>
<div class="ttc" id="enum__quda_8h_html_a744e553dee90a2671fe00aba878c315b"><div class="ttname"><a href="enum__quda_8h.html#a744e553dee90a2671fe00aba878c315b">QudaGhostExchange</a></div><div class="ttdeci">enum QudaGhostExchange_s QudaGhostExchange</div></div>
<div class="ttc" id="gauge__field__order_8h_html"><div class="ttname"><a href="gauge__field__order_8h.html">gauge_field_order.h</a></div><div class="ttdoc">Main header file for host and device accessors to GaugeFields. </div></div>
<div class="ttc" id="dslash__helper_8cuh_html"><div class="ttname"><a href="dslash__helper_8cuh.html">dslash_helper.cuh</a></div></div>
<div class="ttc" id="structquda_1_1_staggered_arg_html_add05aef554b99bcf5caa7dfc23ad67e4"><div class="ttname"><a href="structquda_1_1_staggered_arg.html#add05aef554b99bcf5caa7dfc23ad67e4">quda::StaggeredArg::F</a></div><div class="ttdeci">typename colorspinor_mapper&lt; Float, nSpin, nColor, spin_project, spinor_direct_load &gt;::type F</div><div class="ttdef"><b>Definition:</b> <a href="dslash__staggered_8cuh_source.html#l00023">dslash_staggered.cuh:23</a></div></div>
<div class="ttc" id="structquda_1_1_arg_html"><div class="ttname"><a href="structquda_1_1_arg.html">quda::Arg</a></div><div class="ttdef"><b>Definition:</b> <a href="spinor__noise_8cu_source.html#l00022">spinor_noise.cu:22</a></div></div>
<div class="ttc" id="classquda_1_1_color_spinor_field_html_ac324b268700ab27a4455e7d216f2e92c"><div class="ttname"><a href="classquda_1_1_color_spinor_field.html#ac324b268700ab27a4455e7d216f2e92c">quda::ColorSpinorField::isNative</a></div><div class="ttdeci">bool isNative() const</div><div class="ttdef"><b>Definition:</b> <a href="color__spinor__field_8cpp_source.html#l00568">color_spinor_field.cpp:568</a></div></div>
<div class="ttc" id="structquda_1_1_staggered_arg_html"><div class="ttname"><a href="structquda_1_1_staggered_arg.html">quda::StaggeredArg</a></div><div class="ttdoc">Parameter structure for driving the Staggered Dslash operator. </div><div class="ttdef"><b>Definition:</b> <a href="dslash__staggered_8cuh_source.html#l00018">dslash_staggered.cuh:18</a></div></div>
<div class="ttc" id="structquda_1_1_staggered_arg_html_acb9deb79daedb18f755dfe171b786a6a"><div class="ttname"><a href="structquda_1_1_staggered_arg.html#acb9deb79daedb18f755dfe171b786a6a">quda::StaggeredArg::ghost</a></div><div class="ttdeci">static constexpr QudaGhostExchange ghost</div><div class="ttdef"><b>Definition:</b> <a href="dslash__staggered_8cuh_source.html#l00028">dslash_staggered.cuh:28</a></div></div>
<div class="ttc" id="structquda_1_1_staggered_arg_html_a82c26b95bc3d210bf15c5a826d9d70a7"><div class="ttname"><a href="structquda_1_1_staggered_arg.html#a82c26b95bc3d210bf15c5a826d9d70a7">quda::StaggeredArg::nSpin</a></div><div class="ttdeci">static constexpr int nSpin</div><div class="ttdef"><b>Definition:</b> <a href="dslash__staggered_8cuh_source.html#l00020">dslash_staggered.cuh:20</a></div></div>
<div class="ttc" id="structquda_1_1_dslash_arg_html_a9145859a2847ef8b096d99680da0b506"><div class="ttname"><a href="structquda_1_1_dslash_arg.html#a9145859a2847ef8b096d99680da0b506">quda::DslashArg::dagger</a></div><div class="ttdeci">const bool dagger</div><div class="ttdef"><b>Definition:</b> <a href="dslash__helper_8cuh_source.html#l00244">dslash_helper.cuh:244</a></div></div>
<div class="ttc" id="index__helper_8cuh_html"><div class="ttname"><a href="index__helper_8cuh.html">index_helper.cuh</a></div></div>
<div class="ttc" id="structquda_1_1_arg_html_a8c893cadf2b678609993f7bcef5d3e14"><div class="ttname"><a href="structquda_1_1_arg.html#a8c893cadf2b678609993f7bcef5d3e14">quda::Arg::nParity</a></div><div class="ttdeci">const int nParity</div><div class="ttdef"><b>Definition:</b> <a href="spinor__noise_8cu_source.html#l00025">spinor_noise.cu:25</a></div></div>
<div class="ttc" id="structquda_1_1mapper_html"><div class="ttname"><a href="structquda_1_1mapper.html">quda::mapper</a></div><div class="ttdef"><b>Definition:</b> <a href="register__traits_8h_source.html#l00043">register_traits.h:43</a></div></div>
<div class="ttc" id="enum__quda_8h_html_a829ee8aa93bd9465811ae1ef9e0eedcc"><div class="ttname"><a href="enum__quda_8h.html#a829ee8aa93bd9465811ae1ef9e0eedcc">QudaReconstructType</a></div><div class="ttdeci">enum QudaReconstructType_s QudaReconstructType</div></div>
<div class="ttc" id="color__spinor__field__order_8h_html"><div class="ttname"><a href="color__spinor__field__order_8h.html">color_spinor_field_order.h</a></div></div>
<div class="ttc" id="structquda_1_1colorspinor__mapper_html"><div class="ttname"><a href="structquda_1_1colorspinor__mapper.html">quda::colorspinor_mapper</a></div><div class="ttdef"><b>Definition:</b> <a href="color__spinor__field__order_8h_source.html#l01602">color_spinor_field_order.h:1602</a></div></div>
<div class="ttc" id="structquda_1_1gauge__mapper_html"><div class="ttname"><a href="structquda_1_1gauge__mapper.html">quda::gauge_mapper</a></div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l03012">gauge_field_order.h:3012</a></div></div>
<div class="ttc" id="structquda_1_1_staggered_arg_html_ac60e96d4fa1ae101ec991998354276d0"><div class="ttname"><a href="structquda_1_1_staggered_arg.html#ac60e96d4fa1ae101ec991998354276d0">quda::StaggeredArg::is_first_time_slice</a></div><div class="ttdeci">const bool is_first_time_slice</div><div class="ttdef"><b>Definition:</b> <a href="dslash__staggered_8cuh_source.html#l00043">dslash_staggered.cuh:43</a></div></div>
<div class="ttc" id="enum__quda_8h_html_a2f13fac18d6933e9e21bc1cf2737b21aaef16001e82f5d27acc1087288a42c3ac"><div class="ttname"><a href="enum__quda_8h.html#a2f13fac18d6933e9e21bc1cf2737b21aaef16001e82f5d27acc1087288a42c3ac">QUDA_STAGGERED_PHASE_MILC</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00490">enum_quda.h:490</a></div></div>
<div class="ttc" id="structquda_1_1_staggered_arg_html_acb6da98de4b1cc0e750490c48323a6b9"><div class="ttname"><a href="structquda_1_1_staggered_arg.html#acb6da98de4b1cc0e750490c48323a6b9">quda::StaggeredArg::is_last_time_slice</a></div><div class="ttdeci">const bool is_last_time_slice</div><div class="ttdef"><b>Definition:</b> <a href="dslash__staggered_8cuh_source.html#l00044">dslash_staggered.cuh:44</a></div></div>
<div class="ttc" id="structquda_1_1_staggered_arg_html_a2b9d879abbc1181dd5025d5ccaf5efe4"><div class="ttname"><a href="structquda_1_1_staggered_arg.html#a2b9d879abbc1181dd5025d5ccaf5efe4">quda::StaggeredArg::use_inphase</a></div><div class="ttdeci">static constexpr bool use_inphase</div><div class="ttdef"><b>Definition:</b> <a href="dslash__staggered_8cuh_source.html#l00029">dslash_staggered.cuh:29</a></div></div>
<div class="ttc" id="namespacequda_html_a519e30abf575a4084224e899c730e95f"><div class="ttname"><a href="namespacequda.html#a519e30abf575a4084224e899c730e95f">quda::arg</a></div><div class="ttdeci">__host__ __device__ ValueType arg(const complex&lt; ValueType &gt; &amp;z)</div><div class="ttdoc">Returns the phase angle of z. </div><div class="ttdef"><b>Definition:</b> <a href="complex__quda_8h_source.html#l01076">complex_quda.h:1076</a></div></div>
<div class="ttc" id="namespacequda_html_a4e54927fc030027c7892b4bff973aaaa"><div class="ttname"><a href="namespacequda.html#a4e54927fc030027c7892b4bff973aaaa">quda::Vector</a></div><div class="ttdeci">VectorXcd Vector</div><div class="ttdef"><b>Definition:</b> <a href="inv__eigcg__quda_8cpp_source.html#l00038">inv_eigcg_quda.cpp:38</a></div></div>
<div class="ttc" id="structquda_1_1_staggered_arg_html_a3f247d2d48ef36aa27a0ec612babdb34"><div class="ttname"><a href="structquda_1_1_staggered_arg.html#a3f247d2d48ef36aa27a0ec612babdb34">quda::StaggeredArg::improved</a></div><div class="ttdeci">static constexpr bool improved</div><div class="ttdef"><b>Definition:</b> <a href="dslash__staggered_8cuh_source.html#l00045">dslash_staggered.cuh:45</a></div></div>
<div class="ttc" id="namespacequda_html_a82e883b0c8e9f4e028953ba20e274ca3"><div class="ttname"><a href="namespacequda.html#a82e883b0c8e9f4e028953ba20e274ca3">quda::StaggeredPhase</a></div><div class="ttdeci">__device__ __host__ auto StaggeredPhase(const int coords[], int dim, int dir, const Arg &amp;arg) -&gt; typename Arg::real</div><div class="ttdoc">Compute the staggered phase factor at unit shift from the current lattice coordinates. The routine below optimizes out the shift where possible, hence is only visible where we need to consider the boundary condition. </div><div class="ttdef"><b>Definition:</b> <a href="index__helper_8cuh_source.html#l00868">index_helper.cuh:868</a></div></div>
<div class="ttc" id="namespacequda_html_a043738f16cdeb082fa1a5158fbad36b3"><div class="ttname"><a href="namespacequda.html#a043738f16cdeb082fa1a5158fbad36b3">quda::conj</a></div><div class="ttdeci">__host__ __device__ ValueType conj(ValueType x)</div><div class="ttdef"><b>Definition:</b> <a href="complex__quda_8h_source.html#l00130">complex_quda.h:130</a></div></div>
<div class="ttc" id="enum__quda_8h_html_a93131cceecad27ce4b964cb184e8d47aaab94b36fc680dd39f976636dac350e53"><div class="ttname"><a href="enum__quda_8h.html#a93131cceecad27ce4b964cb184e8d47aaab94b36fc680dd39f976636dac350e53">QUDA_GHOST_EXCHANGE_PAD</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00483">enum_quda.h:483</a></div></div>
<div class="ttc" id="namespacequda_html_a0b554befac535568a3866593316bfe26"><div class="ttname"><a href="namespacequda.html#a0b554befac535568a3866593316bfe26">quda::linkIndexP1</a></div><div class="ttdeci">static __device__ __host__ int linkIndexP1(const int x[], const I X[4], const int mu)</div><div class="ttdef"><b>Definition:</b> <a href="index__helper_8cuh_source.html#l00139">index_helper.cuh:139</a></div></div>
<div class="ttc" id="classquda_1_1_gauge_field_html_aca7e53965b88761140d7bf4a78ecd935"><div class="ttname"><a href="classquda_1_1_gauge_field.html#aca7e53965b88761140d7bf4a78ecd935">quda::GaugeField::isNative</a></div><div class="ttdeci">bool isNative() const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field_8cpp_source.html#l00167">gauge_field.cpp:167</a></div></div>
<div class="ttc" id="structquda_1_1_dslash_arg_html_a8f950f70c2597dfadf7b6d4eb629661d"><div class="ttname"><a href="structquda_1_1_dslash_arg.html#a8f950f70c2597dfadf7b6d4eb629661d">quda::DslashArg::xpay</a></div><div class="ttdeci">const bool xpay</div><div class="ttdef"><b>Definition:</b> <a href="dslash__helper_8cuh_source.html#l00245">dslash_helper.cuh:245</a></div></div>
<div class="ttc" id="structquda_1_1_staggered_arg_html_a7d0ed79703d8468410c13c7239ed4394"><div class="ttname"><a href="structquda_1_1_staggered_arg.html#a7d0ed79703d8468410c13c7239ed4394">quda::StaggeredArg::StaggeredArg</a></div><div class="ttdeci">StaggeredArg(ColorSpinorField &amp;out, const ColorSpinorField &amp;in, const GaugeField &amp;U, const GaugeField &amp;L, double a, const ColorSpinorField &amp;x, int parity, bool dagger, const int *comm_override)</div><div class="ttdef"><b>Definition:</b> <a href="dslash__staggered_8cuh_source.html#l00047">dslash_staggered.cuh:47</a></div></div>
<div class="ttc" id="classquda_1_1_color_spinor_field_html_ac825bed31e6f651d73c10da2595c7acc"><div class="ttname"><a href="classquda_1_1_color_spinor_field.html#ac825bed31e6f651d73c10da2595c7acc">quda::ColorSpinorField::FieldOrder</a></div><div class="ttdeci">QudaFieldOrder FieldOrder() const</div><div class="ttdef"><b>Definition:</b> <a href="color__spinor__field_8h_source.html#l00483">color_spinor_field.h:483</a></div></div>
<div class="ttc" id="structquda_1_1_staggered_arg_html_a5616ef5d9190515a866bd7549a30ef90"><div class="ttname"><a href="structquda_1_1_staggered_arg.html#a5616ef5d9190515a866bd7549a30ef90">quda::StaggeredArg::a</a></div><div class="ttdeci">const real a</div><div class="ttdef"><b>Definition:</b> <a href="dslash__staggered_8cuh_source.html#l00041">dslash_staggered.cuh:41</a></div></div>
<div class="ttc" id="structquda_1_1_staggered_arg_html_ae772fbc0e4cc88f4b5c3ce0481236dff"><div class="ttname"><a href="structquda_1_1_staggered_arg.html#ae772fbc0e4cc88f4b5c3ce0481236dff">quda::StaggeredArg::in</a></div><div class="ttdeci">const F in</div><div class="ttdef"><b>Definition:</b> <a href="dslash__staggered_8cuh_source.html#l00036">dslash_staggered.cuh:36</a></div></div>
<div class="ttc" id="classquda_1_1_matrix_html"><div class="ttname"><a href="classquda_1_1_matrix.html">quda::Matrix</a></div><div class="ttdef"><b>Definition:</b> <a href="quda__matrix_8h_source.html#l00064">quda_matrix.h:64</a></div></div>
<div class="ttc" id="structquda_1_1_dslash_arg_html_a69783b102d092c4ea199fbe62fc2989c"><div class="ttname"><a href="structquda_1_1_dslash_arg.html#a69783b102d092c4ea199fbe62fc2989c">quda::DslashArg::parity</a></div><div class="ttdeci">const int parity</div><div class="ttdef"><b>Definition:</b> <a href="dslash__helper_8cuh_source.html#l00233">dslash_helper.cuh:233</a></div></div>
<div class="ttc" id="structquda_1_1_staggered_arg_html_aeef5198c30e81f2eaa6a29d50c536ac8"><div class="ttname"><a href="structquda_1_1_staggered_arg.html#aeef5198c30e81f2eaa6a29d50c536ac8">quda::StaggeredArg::L</a></div><div class="ttdeci">const GL L</div><div class="ttdef"><b>Definition:</b> <a href="dslash__staggered_8cuh_source.html#l00039">dslash_staggered.cuh:39</a></div></div>
<div class="ttc" id="structquda_1_1_dslash_arg_html_a9f9200974d6cc384443168c45e12264c"><div class="ttname"><a href="structquda_1_1_dslash_arg.html#a9f9200974d6cc384443168c45e12264c">quda::DslashArg::nParity</a></div><div class="ttdeci">const int nParity</div><div class="ttdef"><b>Definition:</b> <a href="dslash__helper_8cuh_source.html#l00234">dslash_helper.cuh:234</a></div></div>
<div class="ttc" id="color__spinor_8h_html"><div class="ttname"><a href="color__spinor_8h.html">color_spinor.h</a></div></div>
<div class="ttc" id="classquda_1_1_gauge_field_html"><div class="ttname"><a href="classquda_1_1_gauge_field.html">quda::GaugeField</a></div><div class="ttdef"><b>Definition:</b> <a href="gauge__field_8h_source.html#l00164">gauge_field.h:164</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
