<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>QUDA: include/gauge_field_order.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">QUDA
   &#160;<span id="projectnumber">1.0.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">gauge_field_order.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="gauge__field__order_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#ifndef _GAUGE_ORDER_H</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#define _GAUGE_ORDER_H</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#ifndef __CUDACC_RTC__</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &lt;assert.h&gt;</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &lt;type_traits&gt;</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="register__traits_8h.html">register_traits.h</a>&gt;</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="complex__quda_8h.html">complex_quda.h</a>&gt;</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="quda__matrix_8h.html">quda_matrix.h</a>&gt;</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="index__helper_8cuh.html">index_helper.cuh</a>&gt;</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="fast__intdiv_8h.html">fast_intdiv.h</a>&gt;</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &lt;type_traits&gt;</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &lt;limits&gt;</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="atomic_8cuh.html">atomic.cuh</a>&gt;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="thrust__helper_8cuh.html">thrust_helper.cuh</a>&gt;</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="gauge__field_8h.html">gauge_field.h</a>&gt;</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="index__helper_8cuh.html">index_helper.cuh</a>&gt;</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="trove__helper_8cuh.html">trove_helper.cuh</a>&gt;</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="texture__helper_8cuh.html">texture_helper.cuh</a>&gt;</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacequda.html">quda</a> {</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Float, <span class="keyword">typename</span> T&gt;</div><div class="line"><a name="l00044"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__wrapper.html">   44</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structquda_1_1gauge__wrapper.html">gauge_wrapper</a> {</div><div class="line"><a name="l00045"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">   45</a></span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>;</div><div class="line"><a name="l00046"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__wrapper.html#a5261c5f7423edd78086a027390e11983">   46</a></span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5261c5f7423edd78086a027390e11983">x_cb</a>;</div><div class="line"><a name="l00047"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">   47</a></span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>;</div><div class="line"><a name="l00048"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__wrapper.html#a953756c13d685eacf355434ee7897a3c">   48</a></span>&#160;      <span class="keyword">const</span> Float <a class="code" href="structquda_1_1gauge__wrapper.html#a953756c13d685eacf355434ee7897a3c">phase</a>;</div><div class="line"><a name="l00049"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__wrapper.html#a74e48d66e79a75aa5b890a214e27028e">   49</a></span>&#160;      T &amp;<a class="code" href="structquda_1_1gauge__wrapper.html#a74e48d66e79a75aa5b890a214e27028e">gauge</a>;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div><div class="line"><a name="l00058"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__wrapper.html#a0cf3553817718f178c8c6d3cfc5eabf5">   58</a></span>&#160;      __device__ __host__ <span class="keyword">inline</span> <a class="code" href="structquda_1_1gauge__wrapper.html">gauge_wrapper&lt;Float, T&gt;</a>(T &amp;<a class="code" href="structquda_1_1gauge__wrapper.html#a74e48d66e79a75aa5b890a214e27028e">gauge</a>, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5261c5f7423edd78086a027390e11983">x_cb</a>, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>, Float phase = 1.0) :</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;          gauge(gauge),</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;          dim(dim),</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;          x_cb(x_cb),</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;          parity(parity),</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;          phase(phase)</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      {</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      }</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> M&gt;</div><div class="line"><a name="l00072"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__wrapper.html#ad2d275ef18602d6c92fadc63a8e5a185">   72</a></span>&#160;      __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structquda_1_1gauge__wrapper.html#ad2d275ef18602d6c92fadc63a8e5a185">operator=</a>(<span class="keyword">const</span> M &amp;a) {</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        <a class="code" href="structquda_1_1gauge__wrapper.html#a74e48d66e79a75aa5b890a214e27028e">gauge</a>.save(a.data, <a class="code" href="structquda_1_1gauge__wrapper.html#a5261c5f7423edd78086a027390e11983">x_cb</a>, <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>, <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>);</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      }</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    };</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keywordtype">int</span> N&gt;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> S&gt;</div><div class="line"><a name="l00083"></a><span class="lineno"><a class="line" href="classquda_1_1_matrix.html#ae841fb0e543e045ec5a6ca75fec5ae28">   83</a></span>&#160;    __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classquda_1_1_matrix.html#a663ab9ae31395811a443268c9bd24654">Matrix&lt;T,N&gt;::operator=</a>(<span class="keyword">const</span> <a class="code" href="structquda_1_1gauge__wrapper.html">gauge_wrapper</a>&lt;<span class="keyword">typename</span> <a class="code" href="structquda_1_1_real_type.html">RealType&lt;T&gt;::type</a>,<a class="code" href="structquda_1_1clover_1_1_s.html">S</a>&gt; &amp;a) {</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    a.gauge.load(data, a.x_cb, a.dim, a.parity, a.phase);</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  }</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keywordtype">int</span> N&gt;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> S&gt;</div><div class="line"><a name="l00093"></a><span class="lineno"><a class="line" href="classquda_1_1_matrix.html#a1297acdb597bad37a61bc778b14af773">   93</a></span>&#160;    __device__ __host__ <span class="keyword">inline</span> <a class="code" href="classquda_1_1_matrix.html#a30da6eaa2554155c19f632b96bc0f11a">Matrix&lt;T,N&gt;::Matrix</a>(<span class="keyword">const</span> <a class="code" href="structquda_1_1gauge__wrapper.html">gauge_wrapper</a>&lt;<span class="keyword">typename</span> <a class="code" href="structquda_1_1_real_type.html">RealType&lt;T&gt;::type</a>,<a class="code" href="structquda_1_1clover_1_1_s.html">S</a>&gt; &amp;a) {</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    a.gauge.load(data, a.x_cb, a.dim, a.parity, a.phase);</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  }</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Float, <span class="keyword">typename</span> T&gt;</div><div class="line"><a name="l00109"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__ghost__wrapper.html">  109</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structquda_1_1gauge__ghost__wrapper.html">gauge_ghost_wrapper</a> {</div><div class="line"><a name="l00110"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__ghost__wrapper.html#a31f15cc207949569d9fb3da630bb479a">  110</a></span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__ghost__wrapper.html#a31f15cc207949569d9fb3da630bb479a">dim</a>;</div><div class="line"><a name="l00111"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__ghost__wrapper.html#a34d1df05b6647252d6c455d6b06ebd32">  111</a></span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__ghost__wrapper.html#a34d1df05b6647252d6c455d6b06ebd32">ghost_idx</a>;</div><div class="line"><a name="l00112"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__ghost__wrapper.html#a8ec61c40527b2a2d94d3cf511e97034f">  112</a></span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__ghost__wrapper.html#a8ec61c40527b2a2d94d3cf511e97034f">parity</a>;</div><div class="line"><a name="l00113"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__ghost__wrapper.html#af95ecc0d2c7cfb0277ddd666c23dfe8f">  113</a></span>&#160;      <span class="keyword">const</span> Float <a class="code" href="structquda_1_1gauge__ghost__wrapper.html#af95ecc0d2c7cfb0277ddd666c23dfe8f">phase</a>;</div><div class="line"><a name="l00114"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__ghost__wrapper.html#a97783cef31f79df168ca1f9a99f4d370">  114</a></span>&#160;      T &amp;<a class="code" href="structquda_1_1gauge__ghost__wrapper.html#a97783cef31f79df168ca1f9a99f4d370">gauge</a>;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div><div class="line"><a name="l00123"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__ghost__wrapper.html#a31c3227713f3e9f64e337a1608e9bdac">  123</a></span>&#160;      __device__ __host__ <span class="keyword">inline</span> <a class="code" href="structquda_1_1gauge__ghost__wrapper.html">gauge_ghost_wrapper&lt;Float, T&gt;</a>(</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;          T &amp;<a class="code" href="structquda_1_1gauge__wrapper.html#a74e48d66e79a75aa5b890a214e27028e">gauge</a>, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>, <span class="keywordtype">int</span> ghost_idx, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>, Float phase = 1.0) :</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;          gauge(gauge),</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;          dim(dim),</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;          ghost_idx(ghost_idx),</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;          parity(parity),</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;          phase(phase)</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      {</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;      }</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> M&gt;</div><div class="line"><a name="l00138"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__ghost__wrapper.html#aeb8ff558d06d95d01d3762e83d2d2fd9">  138</a></span>&#160;      __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structquda_1_1gauge__ghost__wrapper.html#aeb8ff558d06d95d01d3762e83d2d2fd9">operator=</a>(<span class="keyword">const</span> M &amp;a) {</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        <a class="code" href="structquda_1_1gauge__wrapper.html#a74e48d66e79a75aa5b890a214e27028e">gauge</a>.saveGhost(a.data, ghost_idx, <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>, <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>);</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      }</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    };</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keywordtype">int</span> N&gt;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> S&gt;</div><div class="line"><a name="l00149"></a><span class="lineno"><a class="line" href="classquda_1_1_matrix.html#a006a402725db42fb24a124fefcb44d12">  149</a></span>&#160;    __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classquda_1_1_matrix.html#a663ab9ae31395811a443268c9bd24654">Matrix&lt;T,N&gt;::operator=</a>(<span class="keyword">const</span> <a class="code" href="structquda_1_1gauge__ghost__wrapper.html">gauge_ghost_wrapper</a>&lt;<span class="keyword">typename</span> <a class="code" href="structquda_1_1_real_type.html">RealType&lt;T&gt;::type</a>,<a class="code" href="structquda_1_1clover_1_1_s.html">S</a>&gt; &amp;a) {</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    a.gauge.loadGhost(data, a.ghost_idx, a.dim, a.parity, a.phase);</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  }</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keywordtype">int</span> N&gt;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> S&gt;</div><div class="line"><a name="l00159"></a><span class="lineno"><a class="line" href="classquda_1_1_matrix.html#ae0a919780844f27d71b50bad23de8faf">  159</a></span>&#160;    __device__ __host__ <span class="keyword">inline</span> <a class="code" href="classquda_1_1_matrix.html#a30da6eaa2554155c19f632b96bc0f11a">Matrix&lt;T,N&gt;::Matrix</a>(<span class="keyword">const</span> <a class="code" href="structquda_1_1gauge__ghost__wrapper.html">gauge_ghost_wrapper</a>&lt;<span class="keyword">typename</span> <a class="code" href="structquda_1_1_real_type.html">RealType&lt;T&gt;::type</a>,<a class="code" href="structquda_1_1clover_1_1_s.html">S</a>&gt; &amp;a) {</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    a.gauge.loadGhost(data, a.ghost_idx, a.dim, a.parity, a.phase);</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  }</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  <span class="keyword">namespace </span><a class="code" href="structquda_1_1gauge__wrapper.html#a74e48d66e79a75aa5b890a214e27028e">gauge</a> {</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div><div class="line"><a name="l00165"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1square__.html">  165</a></span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> ReduceType, <span class="keyword">typename</span> Float&gt; <span class="keyword">struct </span><a class="code" href="structquda_1_1gauge_1_1square__.html">square_</a> {</div><div class="line"><a name="l00166"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1square__.html#a761453dc4a7f75f0aed655a6be79aa58">  166</a></span>&#160;      <a class="code" href="structquda_1_1gauge_1_1square__.html#a761453dc4a7f75f0aed655a6be79aa58">square_</a>(ReduceType scale) { }</div><div class="line"><a name="l00167"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1square__.html#ac36b98bc253f8cb5ea2f18e8bcf7efa7">  167</a></span>&#160;      __host__ __device__ <span class="keyword">inline</span> ReduceType <a class="code" href="structquda_1_1gauge_1_1square__.html#ac36b98bc253f8cb5ea2f18e8bcf7efa7">operator()</a>(<span class="keyword">const</span> quda::complex&lt;Float&gt; &amp;x)</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      { <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span>ReduceType<span class="keyword">&gt;</span>(<a class="code" href="namespacequda.html#abeed8b3819eb6b18921f208412fe40d1">norm</a>(x)); }</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    };</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div><div class="line"><a name="l00171"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1square___3_01_reduce_type_00_01char_01_4.html">  171</a></span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> ReduceType&gt; <span class="keyword">struct </span><a class="code" href="structquda_1_1gauge_1_1square__.html">square_</a>&lt;ReduceType,char&gt; {</div><div class="line"><a name="l00172"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1square___3_01_reduce_type_00_01char_01_4.html#a87726f90445cfaa6d6d363b85e273db3">  172</a></span>&#160;      <span class="keyword">const</span> ReduceType <a class="code" href="structquda_1_1gauge_1_1square___3_01_reduce_type_00_01char_01_4.html#a87726f90445cfaa6d6d363b85e273db3">scale</a>;</div><div class="line"><a name="l00173"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1square___3_01_reduce_type_00_01char_01_4.html#a12d95fbdf5375799d69ec3e926908ca3">  173</a></span>&#160;      <a class="code" href="structquda_1_1gauge_1_1square___3_01_reduce_type_00_01char_01_4.html#a12d95fbdf5375799d69ec3e926908ca3">square_</a>(<span class="keyword">const</span> ReduceType scale) : scale(scale) { }</div><div class="line"><a name="l00174"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1square___3_01_reduce_type_00_01char_01_4.html#a08f5cd5a402e179961e858f346b73f04">  174</a></span>&#160;      __host__ __device__ <span class="keyword">inline</span> ReduceType <a class="code" href="structquda_1_1gauge_1_1square___3_01_reduce_type_00_01char_01_4.html#a08f5cd5a402e179961e858f346b73f04">operator()</a>(<span class="keyword">const</span> <a class="code" href="structquda_1_1complex_3_01char_01_4.html">quda::complex&lt;char&gt;</a> &amp;x)</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      { <span class="keywordflow">return</span> <a class="code" href="namespacequda.html#abeed8b3819eb6b18921f208412fe40d1">norm</a>(scale * complex&lt;ReduceType&gt;(x.<a class="code" href="structquda_1_1complex_3_01char_01_4.html#a611a70ec9a63a1e1d708737dd4525c0b">real</a>(), x.<a class="code" href="structquda_1_1complex_3_01char_01_4.html#a97ebd156203c91b2f6d127f19b2faf6a">imag</a>())); }</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    };</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div><div class="line"><a name="l00178"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1square___3_01_reduce_type_00_01short_01_4.html">  178</a></span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> ReduceType&gt; <span class="keyword">struct </span><a class="code" href="structquda_1_1gauge_1_1square__.html">square_</a>&lt;ReduceType,short&gt; {</div><div class="line"><a name="l00179"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1square___3_01_reduce_type_00_01short_01_4.html#a4394a7e232118c0e0ee29b65fb53ebe2">  179</a></span>&#160;      <span class="keyword">const</span> ReduceType <a class="code" href="structquda_1_1gauge_1_1square___3_01_reduce_type_00_01short_01_4.html#a4394a7e232118c0e0ee29b65fb53ebe2">scale</a>;</div><div class="line"><a name="l00180"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1square___3_01_reduce_type_00_01short_01_4.html#a241d168bdfc224376fb5bcedf36147d4">  180</a></span>&#160;      <a class="code" href="structquda_1_1gauge_1_1square___3_01_reduce_type_00_01short_01_4.html#a241d168bdfc224376fb5bcedf36147d4">square_</a>(<span class="keyword">const</span> ReduceType scale) : scale(scale) { }</div><div class="line"><a name="l00181"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1square___3_01_reduce_type_00_01short_01_4.html#a2239341e1135930359e23f18a96ba283">  181</a></span>&#160;      __host__ __device__ <span class="keyword">inline</span> ReduceType <a class="code" href="structquda_1_1gauge_1_1square___3_01_reduce_type_00_01short_01_4.html#a2239341e1135930359e23f18a96ba283">operator()</a>(<span class="keyword">const</span> <a class="code" href="structquda_1_1complex_3_01short_01_4.html">quda::complex&lt;short&gt;</a> &amp;x)</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      { <span class="keywordflow">return</span> <a class="code" href="namespacequda.html#abeed8b3819eb6b18921f208412fe40d1">norm</a>(scale * complex&lt;ReduceType&gt;(x.<a class="code" href="structquda_1_1complex_3_01short_01_4.html#a9240d517dba02ea9c9f28d0045468d21">real</a>(), x.<a class="code" href="structquda_1_1complex_3_01short_01_4.html#aa203635a627c53a8978aeee859a49c7c">imag</a>())); }</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    };</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div><div class="line"><a name="l00185"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1square___3_01_reduce_type_00_01int_01_4.html">  185</a></span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> ReduceType&gt; <span class="keyword">struct </span><a class="code" href="structquda_1_1gauge_1_1square__.html">square_</a>&lt;ReduceType,int&gt; {</div><div class="line"><a name="l00186"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1square___3_01_reduce_type_00_01int_01_4.html#a6b10b0f028f7dd86b0f2479baf509ca2">  186</a></span>&#160;      <span class="keyword">const</span> ReduceType <a class="code" href="structquda_1_1gauge_1_1square___3_01_reduce_type_00_01int_01_4.html#a6b10b0f028f7dd86b0f2479baf509ca2">scale</a>;</div><div class="line"><a name="l00187"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1square___3_01_reduce_type_00_01int_01_4.html#a544f02a2294656e2dd69ad64d788896e">  187</a></span>&#160;      <a class="code" href="structquda_1_1gauge_1_1square___3_01_reduce_type_00_01int_01_4.html#a544f02a2294656e2dd69ad64d788896e">square_</a>(<span class="keyword">const</span> ReduceType scale) : scale(scale) { }</div><div class="line"><a name="l00188"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1square___3_01_reduce_type_00_01int_01_4.html#a0673da2a17293bfa08f73f188db78ff8">  188</a></span>&#160;      __host__ __device__ <span class="keyword">inline</span> ReduceType <a class="code" href="structquda_1_1gauge_1_1square___3_01_reduce_type_00_01int_01_4.html#a0673da2a17293bfa08f73f188db78ff8">operator()</a>(<span class="keyword">const</span> <a class="code" href="structquda_1_1complex_3_01int_01_4.html">quda::complex&lt;int&gt;</a> &amp;x)</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      { <span class="keywordflow">return</span> <a class="code" href="namespacequda.html#abeed8b3819eb6b18921f208412fe40d1">norm</a>(scale * complex&lt;ReduceType&gt;(x.<a class="code" href="structquda_1_1complex_3_01int_01_4.html#ae01bd432beeb8df71da19b69555ee7e4">real</a>(), x.<a class="code" href="structquda_1_1complex_3_01int_01_4.html#a962d1decb933422bad3525967e066907">imag</a>())); }</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    };</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div><div class="line"><a name="l00192"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1abs__.html">  192</a></span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> Float, <span class="keyword">typename</span> storeFloat&gt; <span class="keyword">struct </span><a class="code" href="structquda_1_1gauge_1_1abs__.html">abs_</a> {</div><div class="line"><a name="l00193"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1abs__.html#adcb117f80b1bfcc2c0ea249a1a99f008">  193</a></span>&#160;      <a class="code" href="structquda_1_1gauge_1_1abs__.html#adcb117f80b1bfcc2c0ea249a1a99f008">abs_</a>(<span class="keyword">const</span> Float scale) { }</div><div class="line"><a name="l00194"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1abs__.html#a5f21c54d6532202a3cd9695a0b34c7a1">  194</a></span>&#160;      __host__ __device__ Float <a class="code" href="structquda_1_1gauge_1_1abs__.html#a5f21c54d6532202a3cd9695a0b34c7a1">operator()</a>(<span class="keyword">const</span> quda::complex&lt;storeFloat&gt; &amp;x) { <span class="keywordflow">return</span> <a class="code" href="namespacequda.html#afc8f979be274d625e247ce913db49805">abs</a>(x); }</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    };</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div><div class="line"><a name="l00197"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1abs___3_01_float_00_01char_01_4.html">  197</a></span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> Float&gt; <span class="keyword">struct </span><a class="code" href="structquda_1_1gauge_1_1abs__.html">abs_</a>&lt;Float,char&gt; {</div><div class="line"><a name="l00198"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1abs___3_01_float_00_01char_01_4.html#a433a53d51297921073932479fc389526">  198</a></span>&#160;      Float <a class="code" href="structquda_1_1gauge_1_1abs___3_01_float_00_01char_01_4.html#a433a53d51297921073932479fc389526">scale</a>;</div><div class="line"><a name="l00199"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1abs___3_01_float_00_01char_01_4.html#aa2fd82400e0d70ac88a2e6a33384f352">  199</a></span>&#160;      <a class="code" href="structquda_1_1gauge_1_1abs___3_01_float_00_01char_01_4.html#aa2fd82400e0d70ac88a2e6a33384f352">abs_</a>(<span class="keyword">const</span> Float scale) : scale(scale) { }</div><div class="line"><a name="l00200"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1abs___3_01_float_00_01char_01_4.html#a201f282c74ae6ad173a789928b024c39">  200</a></span>&#160;      __host__ __device__ Float <a class="code" href="structquda_1_1gauge_1_1abs___3_01_float_00_01char_01_4.html#a201f282c74ae6ad173a789928b024c39">operator()</a>(<span class="keyword">const</span> <a class="code" href="structquda_1_1complex_3_01char_01_4.html">quda::complex&lt;char&gt;</a> &amp;x)</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      { <span class="keywordflow">return</span> <a class="code" href="namespacequda.html#afc8f979be274d625e247ce913db49805">abs</a>(scale * complex&lt;Float&gt;(x.<a class="code" href="structquda_1_1complex_3_01char_01_4.html#a611a70ec9a63a1e1d708737dd4525c0b">real</a>(), x.<a class="code" href="structquda_1_1complex_3_01char_01_4.html#a97ebd156203c91b2f6d127f19b2faf6a">imag</a>())); }</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    };</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div><div class="line"><a name="l00204"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1abs___3_01_float_00_01short_01_4.html">  204</a></span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> Float&gt; <span class="keyword">struct </span><a class="code" href="structquda_1_1gauge_1_1abs__.html">abs_</a>&lt;Float,short&gt; {</div><div class="line"><a name="l00205"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1abs___3_01_float_00_01short_01_4.html#abb578d85c0d0211837fca40f12b7cc34">  205</a></span>&#160;      Float <a class="code" href="structquda_1_1gauge_1_1abs___3_01_float_00_01short_01_4.html#abb578d85c0d0211837fca40f12b7cc34">scale</a>;</div><div class="line"><a name="l00206"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1abs___3_01_float_00_01short_01_4.html#aa1666115f8b7b7b91005a15c2f4b27a9">  206</a></span>&#160;      <a class="code" href="structquda_1_1gauge_1_1abs___3_01_float_00_01short_01_4.html#aa1666115f8b7b7b91005a15c2f4b27a9">abs_</a>(<span class="keyword">const</span> Float scale) : scale(scale) { }</div><div class="line"><a name="l00207"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1abs___3_01_float_00_01short_01_4.html#a8da4900f3a724a29a1af2543d66208d1">  207</a></span>&#160;      __host__ __device__ Float <a class="code" href="structquda_1_1gauge_1_1abs___3_01_float_00_01short_01_4.html#a8da4900f3a724a29a1af2543d66208d1">operator()</a>(<span class="keyword">const</span> <a class="code" href="structquda_1_1complex_3_01short_01_4.html">quda::complex&lt;short&gt;</a> &amp;x)</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      { <span class="keywordflow">return</span> <a class="code" href="namespacequda.html#afc8f979be274d625e247ce913db49805">abs</a>(scale * complex&lt;Float&gt;(x.<a class="code" href="structquda_1_1complex_3_01short_01_4.html#a9240d517dba02ea9c9f28d0045468d21">real</a>(), x.<a class="code" href="structquda_1_1complex_3_01short_01_4.html#aa203635a627c53a8978aeee859a49c7c">imag</a>())); }</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    };</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div><div class="line"><a name="l00211"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1abs___3_01_float_00_01int_01_4.html">  211</a></span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> Float&gt; <span class="keyword">struct </span><a class="code" href="structquda_1_1gauge_1_1abs__.html">abs_</a>&lt;Float,int&gt; {</div><div class="line"><a name="l00212"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1abs___3_01_float_00_01int_01_4.html#a72aacc1d254044a9811ffafc70d3b701">  212</a></span>&#160;      Float <a class="code" href="structquda_1_1gauge_1_1abs___3_01_float_00_01int_01_4.html#a72aacc1d254044a9811ffafc70d3b701">scale</a>;</div><div class="line"><a name="l00213"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1abs___3_01_float_00_01int_01_4.html#a7d8a83f222b5f1defe3e4fe4136f800d">  213</a></span>&#160;      <a class="code" href="structquda_1_1gauge_1_1abs___3_01_float_00_01int_01_4.html#a7d8a83f222b5f1defe3e4fe4136f800d">abs_</a>(<span class="keyword">const</span> Float scale) : scale(scale) { }</div><div class="line"><a name="l00214"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1abs___3_01_float_00_01int_01_4.html#a00116b96fe619e00716d1695c6f1a055">  214</a></span>&#160;      __host__ __device__ Float <a class="code" href="structquda_1_1gauge_1_1abs___3_01_float_00_01int_01_4.html#a00116b96fe619e00716d1695c6f1a055">operator()</a>(<span class="keyword">const</span> <a class="code" href="structquda_1_1complex_3_01int_01_4.html">quda::complex&lt;int&gt;</a> &amp;x)</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      { <span class="keywordflow">return</span> <a class="code" href="namespacequda.html#afc8f979be274d625e247ce913db49805">abs</a>(scale * complex&lt;Float&gt;(x.<a class="code" href="structquda_1_1complex_3_01int_01_4.html#ae01bd432beeb8df71da19b69555ee7e4">real</a>(), x.<a class="code" href="structquda_1_1complex_3_01int_01_4.html#a962d1decb933422bad3525967e066907">imag</a>())); }</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    };</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;</div><div class="line"><a name="l00218"></a><span class="lineno"><a class="line" href="namespacequda_1_1gauge.html#af89ff4791ae99da9af05ebc95b2ec1b4">  218</a></span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Float, <span class="keyword">typename</span> storeFloat&gt; __host__ __device__ <span class="keyword">inline</span> constexpr <span class="keywordtype">bool</span> <a class="code" href="namespacequda_1_1gauge.html#af89ff4791ae99da9af05ebc95b2ec1b4">fixed_point</a>() { <span class="keywordflow">return</span> <span class="keyword">false</span>; }</div><div class="line"><a name="l00219"></a><span class="lineno"><a class="line" href="namespacequda_1_1gauge.html#a90278ad9b2340af4be893205e339b7e2">  219</a></span>&#160;    <span class="keyword">template</span>&lt;&gt; __host__ __device__ <span class="keyword">inline</span> constexpr <span class="keywordtype">bool</span> <a class="code" href="namespacequda_1_1gauge.html#a90278ad9b2340af4be893205e339b7e2">fixed_point&lt;float,char&gt;</a>() { <span class="keywordflow">return</span> <span class="keyword">true</span>; }</div><div class="line"><a name="l00220"></a><span class="lineno"><a class="line" href="namespacequda_1_1gauge.html#a94ec8809009843f4f40299778f0fb92e">  220</a></span>&#160;    <span class="keyword">template</span>&lt;&gt; __host__ __device__ <span class="keyword">inline</span> constexpr <span class="keywordtype">bool</span> <a class="code" href="namespacequda_1_1gauge.html#a94ec8809009843f4f40299778f0fb92e">fixed_point&lt;float,short&gt;</a>() { <span class="keywordflow">return</span> <span class="keyword">true</span>; }</div><div class="line"><a name="l00221"></a><span class="lineno"><a class="line" href="namespacequda_1_1gauge.html#abb125d7ac186898c774ab769d43ce280">  221</a></span>&#160;    <span class="keyword">template</span>&lt;&gt; __host__ __device__ <span class="keyword">inline</span> constexpr <span class="keywordtype">bool</span> <a class="code" href="namespacequda_1_1gauge.html#abb125d7ac186898c774ab769d43ce280">fixed_point&lt;float,int&gt;</a>() { <span class="keywordflow">return</span> <span class="keyword">true</span>; }</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;</div><div class="line"><a name="l00223"></a><span class="lineno"><a class="line" href="namespacequda_1_1gauge.html#ae5f0419c82921aea2f705d4caf7fde57">  223</a></span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Float, <span class="keyword">typename</span> storeFloat&gt; __host__ __device__ <span class="keyword">inline</span> constexpr <span class="keywordtype">bool</span> <a class="code" href="namespacequda_1_1gauge.html#ae5f0419c82921aea2f705d4caf7fde57">match</a>() { <span class="keywordflow">return</span> <span class="keyword">false</span>; }</div><div class="line"><a name="l00224"></a><span class="lineno"><a class="line" href="namespacequda_1_1gauge.html#a78c4d08410925a7cf57a044ae74ee95b">  224</a></span>&#160;    <span class="keyword">template</span>&lt;&gt; __host__ __device__ <span class="keyword">inline</span> constexpr <span class="keywordtype">bool</span> <a class="code" href="namespacequda_1_1gauge.html#a78c4d08410925a7cf57a044ae74ee95b">match&lt;int,int&gt;</a>() { <span class="keywordflow">return</span> <span class="keyword">true</span>; }</div><div class="line"><a name="l00225"></a><span class="lineno"><a class="line" href="namespacequda_1_1gauge.html#a455f7c20cd5e809a8e782da36affe7e8">  225</a></span>&#160;    <span class="keyword">template</span>&lt;&gt; __host__ __device__ <span class="keyword">inline</span> constexpr <span class="keywordtype">bool</span> <a class="code" href="namespacequda_1_1gauge.html#a455f7c20cd5e809a8e782da36affe7e8">match&lt;short,short&gt;</a>() { <span class="keywordflow">return</span> <span class="keyword">true</span>; }</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Float, <span class="keyword">typename</span> storeFloat&gt;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      <span class="keyword">struct </span><a class="code" href="structquda_1_1gauge_1_1fieldorder__wrapper.html">fieldorder_wrapper</a> {</div><div class="line"><a name="l00236"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1fieldorder__wrapper.html#a80e4b9bd0e7e0ef31ffcc64797bf763d">  236</a></span>&#160;  complex&lt;storeFloat&gt; *<a class="code" href="structquda_1_1gauge_1_1fieldorder__wrapper.html#a80e4b9bd0e7e0ef31ffcc64797bf763d">v</a>;</div><div class="line"><a name="l00237"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1fieldorder__wrapper.html#a11a664c89044348978942364fc030000">  237</a></span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge_1_1fieldorder__wrapper.html#a11a664c89044348978942364fc030000">idx</a>;</div><div class="line"><a name="l00238"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1fieldorder__wrapper.html#af766cd5dca93a9e0d93cb3f98dea3eaa">  238</a></span>&#160;  <span class="keyword">const</span> Float <a class="code" href="structquda_1_1gauge_1_1fieldorder__wrapper.html#af766cd5dca93a9e0d93cb3f98dea3eaa">scale</a>;</div><div class="line"><a name="l00239"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1fieldorder__wrapper.html#a77dfc72683e622e3a257c33156ae4e25">  239</a></span>&#160;  <span class="keyword">const</span> Float <a class="code" href="structquda_1_1gauge_1_1fieldorder__wrapper.html#a77dfc72683e622e3a257c33156ae4e25">scale_inv</a>;</div><div class="line"><a name="l00240"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1fieldorder__wrapper.html#a2f86780afa4701be742c363a78bbb19b">  240</a></span>&#160;  <span class="keyword">static</span> constexpr <span class="keywordtype">bool</span> fixed = fixed_point&lt;Float,storeFloat&gt;();</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div><div class="line"><a name="l00246"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1fieldorder__wrapper.html#ae04cc4f10549a5e4e8269bfd8ba130ae">  246</a></span>&#160;        __device__ __host__ <span class="keyword">inline</span> <a class="code" href="structquda_1_1gauge_1_1fieldorder__wrapper.html#ae04cc4f10549a5e4e8269bfd8ba130ae">fieldorder_wrapper</a>(complex&lt;storeFloat&gt; *v, <span class="keywordtype">int</span> idx, Float scale, Float scale_inv)</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    : v(v), idx(idx), scale(scale), scale_inv(scale_inv) {}</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div><div class="line"><a name="l00249"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1fieldorder__wrapper.html#a8481a3e0b6670a33818206802171d657">  249</a></span>&#160;  __device__ __host__ <span class="keyword">inline</span> Float <a class="code" href="structquda_1_1gauge_1_1fieldorder__wrapper.html#a8481a3e0b6670a33818206802171d657">real</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;          <span class="keywordflow">if</span> (!fixed) {</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;            <span class="keywordflow">return</span> v[idx].real();</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;          } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;            <span class="keywordflow">return</span> scale_inv*<span class="keyword">static_cast&lt;</span>Float<span class="keyword">&gt;</span>(v[idx].real());</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;          }</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        }</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;</div><div class="line"><a name="l00257"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1fieldorder__wrapper.html#aa496f194271d518008d6c88b75d407a2">  257</a></span>&#160;  __device__ __host__ <span class="keyword">inline</span> Float <a class="code" href="structquda_1_1gauge_1_1fieldorder__wrapper.html#aa496f194271d518008d6c88b75d407a2">imag</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;          <span class="keywordflow">if</span> (!fixed) {</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;            <span class="keywordflow">return</span> v[idx].imag();</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;          } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;            <span class="keywordflow">return</span> scale_inv*<span class="keyword">static_cast&lt;</span>Float<span class="keyword">&gt;</span>(v[idx].imag());</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;          }</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        }</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;</div><div class="line"><a name="l00269"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1fieldorder__wrapper.html#af59c2c6b8a0037af11786e1f1c8430e5">  269</a></span>&#160;  __device__ __host__ <span class="keyword">inline</span> complex&lt;Float&gt; <a class="code" href="structquda_1_1gauge_1_1fieldorder__wrapper.html#af59c2c6b8a0037af11786e1f1c8430e5">operator-</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="keywordflow">return</span> fixed ? -scale_inv*<span class="keyword">static_cast&lt;</span>complex&lt;Float&gt; <span class="keyword">&gt;</span>(v[idx]) : -<span class="keyword">static_cast&lt;</span>complex&lt;Float&gt; <span class="keyword">&gt;</span>(v[idx]);</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  }</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;</div><div class="line"><a name="l00277"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1fieldorder__wrapper.html#a1abe5792511bb445f8dcbe5d44be31ca">  277</a></span>&#160;  __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structquda_1_1gauge_1_1fieldorder__wrapper.html#a1abe5792511bb445f8dcbe5d44be31ca">operator=</a>(<span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1fieldorder__wrapper.html">fieldorder_wrapper&lt;Float,storeFloat&gt;</a> &amp;a) {</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    v[idx] = fixed ? complex&lt;storeFloat&gt;(round(scale * a.<a class="code" href="structquda_1_1gauge_1_1fieldorder__wrapper.html#a8481a3e0b6670a33818206802171d657">real</a>()), round(scale * a.<a class="code" href="structquda_1_1gauge_1_1fieldorder__wrapper.html#aa496f194271d518008d6c88b75d407a2">imag</a>())) : a.<a class="code" href="structquda_1_1gauge_1_1fieldorder__wrapper.html#a80e4b9bd0e7e0ef31ffcc64797bf763d">v</a>[a.<a class="code" href="structquda_1_1gauge_1_1fieldorder__wrapper.html#a11a664c89044348978942364fc030000">idx</a>];</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  }</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        <span class="keyword">template</span>&lt;<span class="keyword">typename</span> theirFloat&gt;</div><div class="line"><a name="l00286"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1fieldorder__wrapper.html#a6d65a3629349ab662d11c10caf709ad8">  286</a></span>&#160;  __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structquda_1_1gauge_1_1fieldorder__wrapper.html#a6d65a3629349ab662d11c10caf709ad8">operator=</a>(<span class="keyword">const</span> complex&lt;theirFloat&gt; &amp;a) {</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keywordflow">if</span> (match&lt;storeFloat,theirFloat&gt;()) {</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;      v[idx] = complex&lt;storeFloat&gt;(a.x, a.y);</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;      v[idx] = fixed ? complex&lt;storeFloat&gt;(round(scale * a.x), round(scale * a.y)) : complex&lt;storeFloat&gt;(a.x, a.y);</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    }</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  }</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        <span class="keyword">template</span>&lt;<span class="keyword">typename</span> theirFloat&gt;</div><div class="line"><a name="l00299"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1fieldorder__wrapper.html#a81bd1662dab72a1ce85d34653ff9d391">  299</a></span>&#160;  __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structquda_1_1gauge_1_1fieldorder__wrapper.html#a81bd1662dab72a1ce85d34653ff9d391">operator+=</a>(<span class="keyword">const</span> complex&lt;theirFloat&gt; &amp;a) {</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="keywordflow">if</span> (match&lt;storeFloat,theirFloat&gt;()) {</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;      v[idx] += complex&lt;storeFloat&gt;(a.x, a.y);</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;      v[idx] += fixed ? complex&lt;storeFloat&gt;(round(scale * a.x), round(scale * a.y)) : complex&lt;storeFloat&gt;(a.x, a.y);</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    }</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  }</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  <span class="keyword">template</span>&lt;<span class="keyword">typename</span> theirFloat&gt;</div><div class="line"><a name="l00312"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1fieldorder__wrapper.html#a8b1a346c52f0b0eab22992b0dfda491d">  312</a></span>&#160;  __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structquda_1_1gauge_1_1fieldorder__wrapper.html#a8b1a346c52f0b0eab22992b0dfda491d">operator-=</a>(<span class="keyword">const</span> complex&lt;theirFloat&gt; &amp;a) {</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="keywordflow">if</span> (match&lt;storeFloat,theirFloat&gt;()) {</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;      v[idx] -= complex&lt;storeFloat&gt;(a.x, a.y);</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;      v[idx] -= fixed ? complex&lt;storeFloat&gt;(round(scale * a.x), round(scale * a.y)) : complex&lt;storeFloat&gt;(a.x, a.y);</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    }</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  }</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;      };</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> Float, <span class="keyword">typename</span> storeFloat&gt;</div><div class="line"><a name="l00323"></a><span class="lineno"><a class="line" href="namespacequda_1_1gauge.html#ad054f42108d03b4a84408084cd9e28d4">  323</a></span>&#160;    __device__ __host__ <span class="keyword">inline</span> complex&lt;Float&gt; <a class="code" href="namespacequda.html#a2d204fdcd6f07297d2822a24ce82d224">operator*</a>(<span class="keyword">const</span> Float &amp;a, <span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1fieldorder__wrapper.html">fieldorder_wrapper&lt;Float,storeFloat&gt;</a> &amp;b)</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    {</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;      <span class="keywordflow">if</span> (fixed_point&lt;Float,storeFloat&gt;()) <span class="keywordflow">return</span> a*complex&lt;Float&gt;(b.<a class="code" href="structquda_1_1gauge_1_1fieldorder__wrapper.html#a8481a3e0b6670a33818206802171d657">real</a>(), b.<a class="code" href="structquda_1_1gauge_1_1fieldorder__wrapper.html#aa496f194271d518008d6c88b75d407a2">imag</a>());</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">return</span> a*complex&lt;Float&gt;(b.<a class="code" href="structquda_1_1gauge_1_1fieldorder__wrapper.html#a80e4b9bd0e7e0ef31ffcc64797bf763d">v</a>[b.<a class="code" href="structquda_1_1gauge_1_1fieldorder__wrapper.html#a11a664c89044348978942364fc030000">idx</a>].real(),b.<a class="code" href="structquda_1_1gauge_1_1fieldorder__wrapper.html#a80e4b9bd0e7e0ef31ffcc64797bf763d">v</a>[b.<a class="code" href="structquda_1_1gauge_1_1fieldorder__wrapper.html#a11a664c89044348978942364fc030000">idx</a>].imag());</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    }</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> Float, <span class="keyword">typename</span> storeFloat&gt;</div><div class="line"><a name="l00330"></a><span class="lineno"><a class="line" href="namespacequda_1_1gauge.html#a8500f7a47458e4b2dee5e22f18f01b5a">  330</a></span>&#160;    __device__ __host__ <span class="keyword">inline</span> complex&lt;Float&gt; <a class="code" href="namespacequda.html#a9cc47efb0ccd91ab0c136e82537e8450">operator+</a>(<span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1fieldorder__wrapper.html">fieldorder_wrapper&lt;Float,storeFloat&gt;</a> &amp;a, <span class="keyword">const</span> complex&lt;Float&gt; &amp;b) {</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;      <span class="keywordflow">if</span> (fixed_point&lt;Float,storeFloat&gt;()) <span class="keywordflow">return</span> complex&lt;Float&gt;(a.<a class="code" href="structquda_1_1gauge_1_1fieldorder__wrapper.html#a8481a3e0b6670a33818206802171d657">real</a>(), a.<a class="code" href="structquda_1_1gauge_1_1fieldorder__wrapper.html#aa496f194271d518008d6c88b75d407a2">imag</a>()) + b;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">return</span> complex&lt;Float&gt;(a.<a class="code" href="structquda_1_1gauge_1_1fieldorder__wrapper.html#a80e4b9bd0e7e0ef31ffcc64797bf763d">v</a>[a.<a class="code" href="structquda_1_1gauge_1_1fieldorder__wrapper.html#a11a664c89044348978942364fc030000">idx</a>].real(),a.<a class="code" href="structquda_1_1gauge_1_1fieldorder__wrapper.html#a80e4b9bd0e7e0ef31ffcc64797bf763d">v</a>[a.<a class="code" href="structquda_1_1gauge_1_1fieldorder__wrapper.html#a11a664c89044348978942364fc030000">idx</a>].imag()) + b;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    }</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> Float, <span class="keyword">typename</span> storeFloat&gt;</div><div class="line"><a name="l00336"></a><span class="lineno"><a class="line" href="namespacequda_1_1gauge.html#a2f0d60777af5ed339e6b1ac1b33194f0">  336</a></span>&#160;    __device__ __host__ <span class="keyword">inline</span> complex&lt;Float&gt; <a class="code" href="namespacequda.html#a9cc47efb0ccd91ab0c136e82537e8450">operator+</a>(<span class="keyword">const</span> complex&lt;Float&gt; &amp;a, <span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1fieldorder__wrapper.html">fieldorder_wrapper&lt;Float,storeFloat&gt;</a> &amp;b) {</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;      <span class="keywordflow">if</span> (fixed_point&lt;Float,storeFloat&gt;()) <span class="keywordflow">return</span> a + complex&lt;Float&gt;(b.<a class="code" href="structquda_1_1gauge_1_1fieldorder__wrapper.html#a8481a3e0b6670a33818206802171d657">real</a>(), b.<a class="code" href="structquda_1_1gauge_1_1fieldorder__wrapper.html#aa496f194271d518008d6c88b75d407a2">imag</a>());</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">return</span> a + complex&lt;Float&gt;(b.<a class="code" href="structquda_1_1gauge_1_1fieldorder__wrapper.html#a80e4b9bd0e7e0ef31ffcc64797bf763d">v</a>[b.<a class="code" href="structquda_1_1gauge_1_1fieldorder__wrapper.html#a11a664c89044348978942364fc030000">idx</a>].real(),b.<a class="code" href="structquda_1_1gauge_1_1fieldorder__wrapper.html#a80e4b9bd0e7e0ef31ffcc64797bf763d">v</a>[b.<a class="code" href="structquda_1_1gauge_1_1fieldorder__wrapper.html#a11a664c89044348978942364fc030000">idx</a>].imag());;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    }</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> Float, <span class="keywordtype">int</span> nColor, QudaGaugeFieldOrder order, <span class="keyword">typename</span> storeFloat, <span class="keywordtype">bool</span> use_tex&gt;</div><div class="line"><a name="l00342"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_accessor.html">  342</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structquda_1_1gauge_1_1_accessor.html">Accessor</a> {</div><div class="line"><a name="l00343"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_accessor.html#a4c42d26a22ef886f5a143d73c1ea79d4">  343</a></span>&#160;      <span class="keyword">mutable</span> complex&lt;Float&gt; <a class="code" href="structquda_1_1gauge_1_1_accessor.html#a4c42d26a22ef886f5a143d73c1ea79d4">dummy</a>;</div><div class="line"><a name="l00344"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_accessor.html#a4dc9e7058ca2c7f87a2ac1f2612140e3">  344</a></span>&#160;      <a class="code" href="structquda_1_1gauge_1_1_accessor.html#a4dc9e7058ca2c7f87a2ac1f2612140e3">Accessor</a>(<span class="keyword">const</span> <a class="code" href="classquda_1_1_gauge_field.html">GaugeField</a> &amp;, <span class="keywordtype">void</span> *gauge_=0, <span class="keywordtype">void</span> **ghost_=0) {</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  <a class="code" href="util__quda_8h.html#af3bddfd9d113d50e8e0bbf58a35c5aac">errorQuda</a>(<span class="stringliteral">&quot;Not implemented for order=%d&quot;</span>, order);</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;      }</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;</div><div class="line"><a name="l00348"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_accessor.html#a1851487551035d00f0e9ac0f7eb63aaf">  348</a></span>&#160;      <span class="keywordtype">void</span> <a class="code" href="structquda_1_1gauge_1_1_accessor.html#a1851487551035d00f0e9ac0f7eb63aaf">resetScale</a>(Float dummy) { }</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;</div><div class="line"><a name="l00350"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_accessor.html#a897edbafac524e14ca64c32de0fa10d2">  350</a></span>&#160;      __device__ __host__ complex&lt;Float&gt;&amp; <a class="code" href="structquda_1_1gauge_1_1_accessor.html#a897edbafac524e14ca64c32de0fa10d2">operator()</a>(<span class="keywordtype">int</span> d, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> row, <span class="keywordtype">int</span> col)<span class="keyword"> const </span>{</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  <span class="keywordflow">return</span> dummy;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;      }</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    };</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> Float, <span class="keywordtype">int</span> nColor, QudaGaugeFieldOrder order, <span class="keywordtype">bool</span> native_ghost, <span class="keyword">typename</span> storeFloat, <span class="keywordtype">bool</span> use_tex&gt;</div><div class="line"><a name="l00356"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_ghost_accessor.html">  356</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structquda_1_1gauge_1_1_ghost_accessor.html">GhostAccessor</a> {</div><div class="line"><a name="l00357"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_ghost_accessor.html#a42bf4e43d364bd1399692cf10177b1a5">  357</a></span>&#160;      <span class="keyword">mutable</span> complex&lt;Float&gt; <a class="code" href="structquda_1_1gauge_1_1_ghost_accessor.html#a42bf4e43d364bd1399692cf10177b1a5">dummy</a>;</div><div class="line"><a name="l00358"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_ghost_accessor.html#aaab87f9ce7a526322bf2c147b8301ecb">  358</a></span>&#160;      <a class="code" href="structquda_1_1gauge_1_1_ghost_accessor.html#aaab87f9ce7a526322bf2c147b8301ecb">GhostAccessor</a>(<span class="keyword">const</span> <a class="code" href="classquda_1_1_gauge_field.html">GaugeField</a> &amp;, <span class="keywordtype">void</span> *gauge_=0, <span class="keywordtype">void</span> **ghost_=0) {</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  <a class="code" href="util__quda_8h.html#af3bddfd9d113d50e8e0bbf58a35c5aac">errorQuda</a>(<span class="stringliteral">&quot;Not implemented for order=%d&quot;</span>, order);</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;      }</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;</div><div class="line"><a name="l00362"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_ghost_accessor.html#ac99bddfe8d81b397460c400f9de778a1">  362</a></span>&#160;      <span class="keywordtype">void</span> <a class="code" href="structquda_1_1gauge_1_1_ghost_accessor.html#ac99bddfe8d81b397460c400f9de778a1">resetScale</a>(Float dummy) { }</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;</div><div class="line"><a name="l00364"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_ghost_accessor.html#a2cb286f35cfa4b3774a3c21e1416c65d">  364</a></span>&#160;      __device__ __host__ complex&lt;Float&gt;&amp; <a class="code" href="structquda_1_1gauge_1_1_ghost_accessor.html#a2cb286f35cfa4b3774a3c21e1416c65d">operator()</a>(<span class="keywordtype">int</span> d, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> row, <span class="keywordtype">int</span> col)<span class="keyword"> const </span>{</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  <span class="keywordflow">return</span> dummy;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;      }</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    };</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> Float, <span class="keywordtype">int</span> nColor, <span class="keyword">typename</span> storeFloat, <span class="keywordtype">bool</span> use_tex&gt;</div><div class="line"><a name="l00370"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_e___o_r18e8f8cc0cf320665821408416e0c3d7.html">  370</a></span>&#160;      <span class="keyword">struct </span><a class="code" href="structquda_1_1gauge_1_1_accessor.html">Accessor</a>&lt;Float,<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a>,<a class="code" href="enum__quda_8h.html#acb61fdc14d6b12e8c6177b6d966bd863a85ce3606ffcab0df5df3e6d2b069edc9">QUDA_QDP_GAUGE_ORDER</a>,storeFloat,use_tex&gt; {</div><div class="line"><a name="l00371"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_e___o_r18e8f8cc0cf320665821408416e0c3d7.html#ae423b3bafd85384c19dcfa5680e59da9">  371</a></span>&#160;      complex &lt;storeFloat&gt; *u[<a class="code" href="quda__constants_8h.html#a9d871a1cba105d90eed0f3659e1a1766">QUDA_MAX_GEOMETRY</a>];</div><div class="line"><a name="l00372"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_e___o_r18e8f8cc0cf320665821408416e0c3d7.html#afcd90e23f09cb4b69b9c75bc1d213eb5">  372</a></span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_e___o_r18e8f8cc0cf320665821408416e0c3d7.html#afcd90e23f09cb4b69b9c75bc1d213eb5">volumeCB</a>;</div><div class="line"><a name="l00373"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_e___o_r18e8f8cc0cf320665821408416e0c3d7.html#a1022f349394e12d809344d83c99b3b80">  373</a></span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_e___o_r18e8f8cc0cf320665821408416e0c3d7.html#a1022f349394e12d809344d83c99b3b80">geometry</a>;</div><div class="line"><a name="l00374"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_e___o_r18e8f8cc0cf320665821408416e0c3d7.html#af1265ded29db9df86f67ee7b3ba19b83">  374</a></span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_e___o_r18e8f8cc0cf320665821408416e0c3d7.html#af1265ded29db9df86f67ee7b3ba19b83">cb_offset</a>;</div><div class="line"><a name="l00375"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_e___o_r18e8f8cc0cf320665821408416e0c3d7.html#a1c8e5fb8e0a4d94879899b3dc92aebb1">  375</a></span>&#160;      Float <a class="code" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_e___o_r18e8f8cc0cf320665821408416e0c3d7.html#a1c8e5fb8e0a4d94879899b3dc92aebb1">scale</a>;</div><div class="line"><a name="l00376"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_e___o_r18e8f8cc0cf320665821408416e0c3d7.html#a52825077351d924adbf0fa43ae3d189c">  376</a></span>&#160;      Float <a class="code" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_e___o_r18e8f8cc0cf320665821408416e0c3d7.html#a52825077351d924adbf0fa43ae3d189c">scale_inv</a>;</div><div class="line"><a name="l00377"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_e___o_r18e8f8cc0cf320665821408416e0c3d7.html#a527a49251eb6312788726d223e7995b2">  377</a></span>&#160;      <span class="keyword">static</span> constexpr <span class="keywordtype">bool</span> fixed = fixed_point&lt;Float,storeFloat&gt;();</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;</div><div class="line"><a name="l00379"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_e___o_r18e8f8cc0cf320665821408416e0c3d7.html#a191d03a97ee50649e83ce1719fb0c078">  379</a></span>&#160;      <a class="code" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_e___o_r18e8f8cc0cf320665821408416e0c3d7.html#a191d03a97ee50649e83ce1719fb0c078">Accessor</a>(<span class="keyword">const</span> <a class="code" href="classquda_1_1_gauge_field.html">GaugeField</a> &amp;U, <span class="keywordtype">void</span> *gauge_=0, <span class="keywordtype">void</span> **ghost_=0)</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  : volumeCB(U.VolumeCB()), geometry(U.Geometry()), cb_offset((U.Bytes()&gt;&gt;1) / (sizeof(complex&lt;storeFloat&gt;)*U.Geometry())),</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  scale(static_cast&lt;Float&gt;(1.0)), scale_inv(static_cast&lt;Float&gt;(1.0))</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;      {</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d=0; d&lt;U.<a class="code" href="classquda_1_1_gauge_field.html#a02bc76f698126cbaa08301110983f779">Geometry</a>(); d++)</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    u[d] = gauge_ ? <span class="keyword">static_cast&lt;</span>complex&lt;storeFloat&gt;**<span class="keyword">&gt;</span>(gauge_)[d] :</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;      <span class="keyword">static_cast&lt;</span>complex&lt;storeFloat&gt;**<span class="keyword">&gt;</span>(<span class="keyword">const_cast&lt;</span><span class="keywordtype">void</span>*<span class="keyword">&gt;</span>(U.<a class="code" href="classquda_1_1_gauge_field.html#ab875db966189cb025989e43275f78830">Gauge_p</a>()))[d];</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  resetScale(U.<a class="code" href="classquda_1_1_lattice_field.html#ae8c8678bb923db27c8ea985546101f11">Scale</a>());</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;      }</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;</div><div class="line"><a name="l00389"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_e___o_r18e8f8cc0cf320665821408416e0c3d7.html#a71b0fcb6caca719b2653998e21aab0eb">  389</a></span>&#160;    <a class="code" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_e___o_r18e8f8cc0cf320665821408416e0c3d7.html#a71b0fcb6caca719b2653998e21aab0eb">Accessor</a>(<span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_e___o_r18e8f8cc0cf320665821408416e0c3d7.html">Accessor&lt;Float,nColor,QUDA_QDP_GAUGE_ORDER,storeFloat,use_tex&gt;</a> &amp;a)</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;      : volumeCB(a.volumeCB), geometry(a.geometry), cb_offset(a.cb_offset), scale(a.scale), scale_inv(a.scale_inv) {</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d=0; d&lt;<a class="code" href="quda__constants_8h.html#a9d871a1cba105d90eed0f3659e1a1766">QUDA_MAX_GEOMETRY</a>; d++)</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    u[d] = a.<a class="code" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_e___o_r18e8f8cc0cf320665821408416e0c3d7.html#ae423b3bafd85384c19dcfa5680e59da9">u</a>[d];</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;      }</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;</div><div class="line"><a name="l00395"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_e___o_r18e8f8cc0cf320665821408416e0c3d7.html#a0bed839ec79e5df0dcaeae5186de1d28">  395</a></span>&#160;      <span class="keywordtype">void</span> <a class="code" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_e___o_r18e8f8cc0cf320665821408416e0c3d7.html#a0bed839ec79e5df0dcaeae5186de1d28">resetScale</a>(Float max) {</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  <span class="keywordflow">if</span> (fixed) {</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    scale = <span class="keyword">static_cast&lt;</span>Float<span class="keyword">&gt;</span>(std::numeric_limits&lt;storeFloat&gt;::max()) / max;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    scale_inv = max / <span class="keyword">static_cast&lt;</span>Float<span class="keyword">&gt;</span>(std::numeric_limits&lt;storeFloat&gt;::max());</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  }</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;      }</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;</div><div class="line"><a name="l00402"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_e___o_r18e8f8cc0cf320665821408416e0c3d7.html#af19e27579fd98c18d5f582f9351b6232">  402</a></span>&#160;      __device__ __host__ <span class="keyword">inline</span> complex&lt;Float&gt; <a class="code" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_e___o_r18e8f8cc0cf320665821408416e0c3d7.html#af19e27579fd98c18d5f582f9351b6232">operator()</a>(<span class="keywordtype">int</span> d, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> row, <span class="keywordtype">int</span> col)<span class="keyword"> const</span></div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="keyword">      </span>{</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  complex&lt;storeFloat&gt; <a class="code" href="covdev__test_8cpp.html#a788da19b1cbae7d08eb18da226046dd7">tmp</a> = u[d][ parity*cb_offset + (x*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a> + row)*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a> + col];</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  <span class="keywordflow">if</span> (fixed) {</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <span class="keywordflow">return</span> scale_inv*complex&lt;Float&gt;(<span class="keyword">static_cast&lt;</span>Float<span class="keyword">&gt;</span>(tmp.x), static_cast&lt;Float&gt;(tmp.y));</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <span class="keywordflow">return</span> complex&lt;Float&gt;(tmp.x,tmp.y);</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  }</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;      }</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;</div><div class="line"><a name="l00413"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_e___o_r18e8f8cc0cf320665821408416e0c3d7.html#a839bdd1a61f7e61aea7c23098ce22ce0">  413</a></span>&#160;      __device__ __host__ <span class="keyword">inline</span> <a class="code" href="structquda_1_1gauge_1_1fieldorder__wrapper.html">fieldorder_wrapper&lt;Float,storeFloat&gt;</a> <a class="code" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_e___o_r18e8f8cc0cf320665821408416e0c3d7.html#a839bdd1a61f7e61aea7c23098ce22ce0">operator()</a>(<span class="keywordtype">int</span> d, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> row, <span class="keywordtype">int</span> col)</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  { <span class="keywordflow">return</span> <a class="code" href="structquda_1_1gauge_1_1fieldorder__wrapper.html">fieldorder_wrapper&lt;Float,storeFloat&gt;</a>(u[d], parity*cb_offset + (x*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a> + row)*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a> + col,</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                  scale, scale_inv); }</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> theirFloat&gt;</div><div class="line"><a name="l00418"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_e___o_r18e8f8cc0cf320665821408416e0c3d7.html#a4e1439061ab2dd08a990780fede480a3">  418</a></span>&#160;      __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_e___o_r18e8f8cc0cf320665821408416e0c3d7.html#a4e1439061ab2dd08a990780fede480a3">atomic_add</a>(<span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5261c5f7423edd78086a027390e11983">x_cb</a>, <span class="keywordtype">int</span> row, <span class="keywordtype">int</span> col,</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                                                 <span class="keyword">const</span> complex&lt;theirFloat&gt; &amp;val)<span class="keyword"> const </span>{</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="preprocessor">#ifdef __CUDA_ARCH__</span></div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> vector&lt;storeFloat,2&gt;::type vec2;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  vec2 *u2 = <span class="keyword">reinterpret_cast&lt;</span>vec2*<span class="keyword">&gt;</span>(u[<a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>] + parity*cb_offset + (x_cb*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a> + row)*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a> + col);</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  <span class="keywordflow">if</span> (fixed &amp;&amp; !match&lt;storeFloat,theirFloat&gt;()) {</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    complex&lt;storeFloat&gt; val_(round(scale * val.real()), round(scale * val.imag()));</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <a class="code" href="atomic_8cuh.html#a5723b0bba0d65bedce0e1bb329366d8c">atomicAdd</a>(u2, (vec2&amp;)val_);</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <a class="code" href="atomic_8cuh.html#a5723b0bba0d65bedce0e1bb329366d8c">atomicAdd</a>(u2, (vec2&amp;)val);</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  }</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  <span class="keywordflow">if</span> (fixed &amp;&amp; !match&lt;storeFloat,theirFloat&gt;()) {</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    complex&lt;storeFloat&gt; val_(round(scale * val.real()), round(scale * val.imag()));</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="preprocessor">#pragma omp atomic update</span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    u[<a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>][ parity*cb_offset + (x_cb*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a> + row)*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a> + col].x += val_.x;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;#pragma omp atomic update</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    u[dim][ parity*cb_offset + (x_cb*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a> + row)*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a> + col].y += val_.y;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="preprocessor">#pragma omp atomic update</span></div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    u[<a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>][ parity*cb_offset + (x_cb*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a> + row)*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a> + col].x += static_cast&lt;storeFloat&gt;(val.x);</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="preprocessor">#pragma omp atomic update</span></div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    u[<a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>][ parity*cb_offset + (x_cb*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a> + row)*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a> + col].y += static_cast&lt;storeFloat&gt;(val.y);</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  }</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;      }</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> helper, <span class="keyword">typename</span> reducer&gt;</div><div class="line"><a name="l00446"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_e___o_r18e8f8cc0cf320665821408416e0c3d7.html#a5dd933c7020bcd49fdf36120c76d660c">  446</a></span>&#160;        __host__ <span class="keywordtype">double</span> <a class="code" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_e___o_r18e8f8cc0cf320665821408416e0c3d7.html#a5dd933c7020bcd49fdf36120c76d660c">transform_reduce</a>(<a class="code" href="enum__quda_8h.html#a7e07bc0f2e37ab1df05cd3c87017ff33">QudaFieldLocation</a> location, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>, helper h, reducer r, <span class="keywordtype">double</span> <a class="code" href="namespacequda_1_1cublas.html#ac642c2c4f9dd3abfe528cc1581e5bf76">init</a>)<span class="keyword"> const </span>{</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  <span class="keywordflow">if</span> (dim &gt;= geometry) <a class="code" href="util__quda_8h.html#af3bddfd9d113d50e8e0bbf58a35c5aac">errorQuda</a>(<span class="stringliteral">&quot;Request dimension %d exceeds dimensionality of the field %d&quot;</span>, dim, geometry);</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        <span class="keywordtype">int</span> lower = (dim == -1) ? 0 : dim;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        <span class="keywordtype">int</span> upper = (dim == -1) ? geometry : dim+1;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        <span class="keywordtype">double</span> result = <a class="code" href="namespacequda_1_1cublas.html#ac642c2c4f9dd3abfe528cc1581e5bf76">init</a>;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        <span class="keywordflow">if</span> (location == <a class="code" href="enum__quda_8h.html#a35de1312d8bed4b94234a3092907e0d9a184379764fab0f101cab6f19a8a14690">QUDA_CUDA_FIELD_LOCATION</a>) {</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;          <a class="code" href="classthrust__allocator.html">thrust_allocator</a> <a class="code" href="namespacequda.html#a4fae7f819003f6b7116efc43e7830908">alloc</a>;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d=lower; d&lt;upper; d++) {</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;            thrust::device_ptr&lt;complex&lt;storeFloat&gt; &gt; ptr(u[d]);</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;            result = thrust::transform_reduce(thrust::cuda::par(alloc), ptr, ptr+2*volumeCB*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a>*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a>, h, result, r);</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;          }</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d=lower; d&lt;upper; d++) {</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;            result = thrust::transform_reduce(thrust::seq, u[d], u[d]+2*volumeCB*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a>*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a>, h, result, r);</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;          }</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        }</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        <span class="keywordflow">return</span> result;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;      }</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    };</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> Float, <span class="keywordtype">int</span> nColor, <span class="keywordtype">bool</span> native_ghost, <span class="keyword">typename</span> storeFloat, <span class="keywordtype">bool</span> use_tex&gt;</div><div class="line"><a name="l00468"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_edba98cba7f194488e42e7a830abb1e97.html">  468</a></span>&#160;      <span class="keyword">struct </span><a class="code" href="structquda_1_1gauge_1_1_ghost_accessor.html">GhostAccessor</a>&lt;Float,<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a>,<a class="code" href="enum__quda_8h.html#acb61fdc14d6b12e8c6177b6d966bd863a85ce3606ffcab0df5df3e6d2b069edc9">QUDA_QDP_GAUGE_ORDER</a>,native_ghost,storeFloat,use_tex&gt; {</div><div class="line"><a name="l00469"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_edba98cba7f194488e42e7a830abb1e97.html#aa3372cab2321bb3b804225b6bc3a37be">  469</a></span>&#160;      complex&lt;storeFloat&gt; *ghost[8];</div><div class="line"><a name="l00470"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_edba98cba7f194488e42e7a830abb1e97.html#a36b586e2960b6da3e8b7ec321e7512f3">  470</a></span>&#160;      <span class="keywordtype">int</span> ghostOffset[8];</div><div class="line"><a name="l00471"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_edba98cba7f194488e42e7a830abb1e97.html#a661f0d4b02e6019c16bd9688c891093a">  471</a></span>&#160;      Float <a class="code" href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_edba98cba7f194488e42e7a830abb1e97.html#a661f0d4b02e6019c16bd9688c891093a">scale</a>;</div><div class="line"><a name="l00472"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_edba98cba7f194488e42e7a830abb1e97.html#a02ccda92aacd33a8bca9ce687f53a9c4">  472</a></span>&#160;      Float <a class="code" href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_edba98cba7f194488e42e7a830abb1e97.html#a02ccda92aacd33a8bca9ce687f53a9c4">scale_inv</a>;</div><div class="line"><a name="l00473"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_edba98cba7f194488e42e7a830abb1e97.html#ac6b85bc33169663a73ee6d66661d0498">  473</a></span>&#160;      <span class="keyword">static</span> constexpr <span class="keywordtype">bool</span> fixed = fixed_point&lt;Float,storeFloat&gt;();</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;</div><div class="line"><a name="l00475"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_edba98cba7f194488e42e7a830abb1e97.html#aea102e27316f8c91d3df053976644919">  475</a></span>&#160;      <a class="code" href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_edba98cba7f194488e42e7a830abb1e97.html#aea102e27316f8c91d3df053976644919">GhostAccessor</a>(<span class="keyword">const</span> <a class="code" href="classquda_1_1_gauge_field.html">GaugeField</a> &amp;U, <span class="keywordtype">void</span> *gauge_=0, <span class="keywordtype">void</span> **ghost_=0)</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  : scale(static_cast&lt;Float&gt;(1.0)), scale_inv(static_cast&lt;Float&gt;(1.0)) {</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d=0; d&lt;4; d++) {</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    ghost[d] = ghost_ ? <span class="keyword">static_cast&lt;</span>complex&lt;storeFloat&gt;*<span class="keyword">&gt;</span>(ghost_[d]) :</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;      <span class="keyword">static_cast&lt;</span>complex&lt;storeFloat&gt;*<span class="keyword">&gt;</span>(const_cast&lt;void*&gt;(U.<a class="code" href="classquda_1_1_gauge_field.html#aedfa91e714c61b8e11caec9d2703dcfa">Ghost</a>()[d]));</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    ghostOffset[d] = U.<a class="code" href="classquda_1_1_gauge_field.html#a8e0ae774c1566179db3e3c5a2bc0b226">Nface</a>()*U.<a class="code" href="classquda_1_1_lattice_field.html#a64969b1180e27da1fdbc1959f1cf644c">SurfaceCB</a>(d)*U.<a class="code" href="classquda_1_1_gauge_field.html#ab655802370bde3461711f30a2da68bb7">Ncolor</a>()*U.<a class="code" href="classquda_1_1_gauge_field.html#ab655802370bde3461711f30a2da68bb7">Ncolor</a>();</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    ghost[d+4] = (U.<a class="code" href="classquda_1_1_gauge_field.html#a02bc76f698126cbaa08301110983f779">Geometry</a>() != <a class="code" href="enum__quda_8h.html#a7589b295019a40887f1c10c76555feeaadc1a5ef802228fe4edd42346172c7605">QUDA_COARSE_GEOMETRY</a>) ? <span class="keyword">nullptr</span> :</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;      ghost_ ? <span class="keyword">static_cast&lt;</span>complex&lt;storeFloat&gt;*<span class="keyword">&gt;</span>(ghost_[d+4]) :</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;      <span class="keyword">static_cast&lt;</span>complex&lt;storeFloat&gt;*<span class="keyword">&gt;</span>(<span class="keyword">const_cast&lt;</span><span class="keywordtype">void</span>*<span class="keyword">&gt;</span>(U.<a class="code" href="classquda_1_1_gauge_field.html#aedfa91e714c61b8e11caec9d2703dcfa">Ghost</a>()[d+4]));</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    ghostOffset[d+4] = U.<a class="code" href="classquda_1_1_gauge_field.html#a8e0ae774c1566179db3e3c5a2bc0b226">Nface</a>()*U.<a class="code" href="classquda_1_1_lattice_field.html#a64969b1180e27da1fdbc1959f1cf644c">SurfaceCB</a>(d)*U.<a class="code" href="classquda_1_1_gauge_field.html#ab655802370bde3461711f30a2da68bb7">Ncolor</a>()*U.<a class="code" href="classquda_1_1_gauge_field.html#ab655802370bde3461711f30a2da68bb7">Ncolor</a>();</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  }</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  resetScale(U.<a class="code" href="classquda_1_1_lattice_field.html#ae8c8678bb923db27c8ea985546101f11">Scale</a>());</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;      }</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;</div><div class="line"><a name="l00491"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_edba98cba7f194488e42e7a830abb1e97.html#a07febabba6f47da6d1d9cc70b8cd86a0">  491</a></span>&#160;    <a class="code" href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_edba98cba7f194488e42e7a830abb1e97.html#a07febabba6f47da6d1d9cc70b8cd86a0">GhostAccessor</a>(<span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_edba98cba7f194488e42e7a830abb1e97.html">GhostAccessor&lt;Float,nColor,QUDA_QDP_GAUGE_ORDER,native_ghost,storeFloat,use_tex&gt;</a> &amp;a)</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;  : scale(a.scale), scale_inv(a.scale_inv) {</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d=0; d&lt;8; d++) {</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    ghost[d] = a.<a class="code" href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_edba98cba7f194488e42e7a830abb1e97.html#aa3372cab2321bb3b804225b6bc3a37be">ghost</a>[d];</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    ghostOffset[d] = a.<a class="code" href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_edba98cba7f194488e42e7a830abb1e97.html#a36b586e2960b6da3e8b7ec321e7512f3">ghostOffset</a>[d];</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  }</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;      }</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;</div><div class="line"><a name="l00499"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_edba98cba7f194488e42e7a830abb1e97.html#a596d10a2571358e5ebf2a5f2ddc11b29">  499</a></span>&#160;      <span class="keywordtype">void</span> <a class="code" href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_edba98cba7f194488e42e7a830abb1e97.html#a596d10a2571358e5ebf2a5f2ddc11b29">resetScale</a>(Float max) {</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  <span class="keywordflow">if</span> (fixed) {</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    scale = <span class="keyword">static_cast&lt;</span>Float<span class="keyword">&gt;</span>(std::numeric_limits&lt;storeFloat&gt;::max()) / max;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    scale_inv = max / <span class="keyword">static_cast&lt;</span>Float<span class="keyword">&gt;</span>(std::numeric_limits&lt;storeFloat&gt;::max());</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;  }</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;      }</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;</div><div class="line"><a name="l00506"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_edba98cba7f194488e42e7a830abb1e97.html#a5a358771e83d917f101d8335948e9972">  506</a></span>&#160;      __device__ __host__ <span class="keyword">inline</span> complex&lt;Float&gt; <a class="code" href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_edba98cba7f194488e42e7a830abb1e97.html#a5a358771e83d917f101d8335948e9972">operator()</a>(<span class="keywordtype">int</span> d, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> row, <span class="keywordtype">int</span> col)<span class="keyword"> const</span></div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="keyword">      </span>{</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;  complex&lt;storeFloat&gt; <a class="code" href="covdev__test_8cpp.html#a788da19b1cbae7d08eb18da226046dd7">tmp</a> = ghost[d][ parity*ghostOffset[d] + (x*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a> + row)*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a> + col];</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;  <span class="keywordflow">if</span> (fixed) {</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <span class="keywordflow">return</span> scale_inv*complex&lt;Float&gt;(<span class="keyword">static_cast&lt;</span>Float<span class="keyword">&gt;</span>(tmp.x), static_cast&lt;Float&gt;(tmp.y));</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <span class="keywordflow">return</span> complex&lt;Float&gt;(tmp.x,tmp.y);</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;  }</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;      }</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;</div><div class="line"><a name="l00516"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_edba98cba7f194488e42e7a830abb1e97.html#aea9c6d1e9305972703e7e871a0fded1c">  516</a></span>&#160;      __device__ __host__ <span class="keyword">inline</span> <a class="code" href="structquda_1_1gauge_1_1fieldorder__wrapper.html">fieldorder_wrapper&lt;Float,storeFloat&gt;</a> <a class="code" href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_edba98cba7f194488e42e7a830abb1e97.html#aea9c6d1e9305972703e7e871a0fded1c">operator()</a>(<span class="keywordtype">int</span> d, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> row, <span class="keywordtype">int</span> col)</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;  { <span class="keywordflow">return</span> <a class="code" href="structquda_1_1gauge_1_1fieldorder__wrapper.html">fieldorder_wrapper&lt;Float,storeFloat&gt;</a>(ghost[d], parity*ghostOffset[d] + (x*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a> + row)*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a> + col,</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                  scale, scale_inv); }</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    };</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> Float, <span class="keywordtype">int</span> nColor, <span class="keyword">typename</span> storeFloat, <span class="keywordtype">bool</span> use_tex&gt;</div><div class="line"><a name="l00522"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g_e___ob3f8ab569f1b01e2fe1b1e99b6b90783.html">  522</a></span>&#160;      <span class="keyword">struct </span><a class="code" href="structquda_1_1gauge_1_1_accessor.html">Accessor</a>&lt;Float,<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a>,<a class="code" href="enum__quda_8h.html#acb61fdc14d6b12e8c6177b6d966bd863adb1a4116b2cbd52bd33641d7400f0989">QUDA_MILC_GAUGE_ORDER</a>,storeFloat,use_tex&gt; {</div><div class="line"><a name="l00523"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g_e___ob3f8ab569f1b01e2fe1b1e99b6b90783.html#ab0638d3207a827964ae3cb4d0459e094">  523</a></span>&#160;      complex&lt;storeFloat&gt; *<a class="code" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g_e___ob3f8ab569f1b01e2fe1b1e99b6b90783.html#ab0638d3207a827964ae3cb4d0459e094">u</a>;</div><div class="line"><a name="l00524"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g_e___ob3f8ab569f1b01e2fe1b1e99b6b90783.html#a521b20db37d2f59dac308b4fe75deca3">  524</a></span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g_e___ob3f8ab569f1b01e2fe1b1e99b6b90783.html#a521b20db37d2f59dac308b4fe75deca3">volumeCB</a>;</div><div class="line"><a name="l00525"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g_e___ob3f8ab569f1b01e2fe1b1e99b6b90783.html#a6b966f5c8b3fd4bd18e02965cc72df43">  525</a></span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g_e___ob3f8ab569f1b01e2fe1b1e99b6b90783.html#a6b966f5c8b3fd4bd18e02965cc72df43">geometry</a>;</div><div class="line"><a name="l00526"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g_e___ob3f8ab569f1b01e2fe1b1e99b6b90783.html#a21448ccb9031637f542cb95583247978">  526</a></span>&#160;      Float <a class="code" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g_e___ob3f8ab569f1b01e2fe1b1e99b6b90783.html#a21448ccb9031637f542cb95583247978">scale</a>;</div><div class="line"><a name="l00527"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g_e___ob3f8ab569f1b01e2fe1b1e99b6b90783.html#a8a271c728386ed3761fd5fbcab95f1af">  527</a></span>&#160;      Float <a class="code" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g_e___ob3f8ab569f1b01e2fe1b1e99b6b90783.html#a8a271c728386ed3761fd5fbcab95f1af">scale_inv</a>;</div><div class="line"><a name="l00528"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g_e___ob3f8ab569f1b01e2fe1b1e99b6b90783.html#ab74e7e1c1876b37207173dfa3d701af4">  528</a></span>&#160;      <span class="keyword">static</span> constexpr <span class="keywordtype">bool</span> fixed = fixed_point&lt;Float,storeFloat&gt;();</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;</div><div class="line"><a name="l00530"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g_e___ob3f8ab569f1b01e2fe1b1e99b6b90783.html#a469557fb123e53adce7567f90e916b69">  530</a></span>&#160;      <a class="code" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g_e___ob3f8ab569f1b01e2fe1b1e99b6b90783.html#a469557fb123e53adce7567f90e916b69">Accessor</a>(<span class="keyword">const</span> <a class="code" href="classquda_1_1_gauge_field.html">GaugeField</a> &amp;U, <span class="keywordtype">void</span> *gauge_=0, <span class="keywordtype">void</span> **ghost_=0)</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;      : u(gauge_ ? static_cast&lt;complex&lt;storeFloat&gt;*&gt;(gauge_) :</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    static_cast&lt;complex&lt;storeFloat&gt;*&gt;(const_cast&lt;void *&gt;(U.Gauge_p()))),</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;  volumeCB(U.VolumeCB()), geometry(U.Geometry()),</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;  scale(static_cast&lt;Float&gt;(1.0)), scale_inv(static_cast&lt;Float&gt;(1.0)) {</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;  resetScale(U.<a class="code" href="classquda_1_1_lattice_field.html#ae8c8678bb923db27c8ea985546101f11">Scale</a>());</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;      }</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;</div><div class="line"><a name="l00538"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g_e___ob3f8ab569f1b01e2fe1b1e99b6b90783.html#aa7ec76754773b64c99fbd087d5c304fd">  538</a></span>&#160;    <a class="code" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g_e___ob3f8ab569f1b01e2fe1b1e99b6b90783.html#aa7ec76754773b64c99fbd087d5c304fd">Accessor</a>(<span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g_e___ob3f8ab569f1b01e2fe1b1e99b6b90783.html">Accessor&lt;Float,nColor,QUDA_MILC_GAUGE_ORDER,storeFloat,use_tex&gt;</a> &amp;a)</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;  : u(a.u), volumeCB(a.volumeCB), geometry(a.geometry), scale(a.scale), scale_inv(a.scale_inv)</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;      { }</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;</div><div class="line"><a name="l00542"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g_e___ob3f8ab569f1b01e2fe1b1e99b6b90783.html#a119ab6f6efb84fe00ea783d0865a6d45">  542</a></span>&#160;      <span class="keywordtype">void</span> <a class="code" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g_e___ob3f8ab569f1b01e2fe1b1e99b6b90783.html#a119ab6f6efb84fe00ea783d0865a6d45">resetScale</a>(Float max) {</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;  <span class="keywordflow">if</span> (fixed) {</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    scale = <span class="keyword">static_cast&lt;</span>Float<span class="keyword">&gt;</span>(std::numeric_limits&lt;storeFloat&gt;::max()) / max;</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    scale_inv = max / <span class="keyword">static_cast&lt;</span>Float<span class="keyword">&gt;</span>(std::numeric_limits&lt;storeFloat&gt;::max());</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;  }</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;      }</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;</div><div class="line"><a name="l00549"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g_e___ob3f8ab569f1b01e2fe1b1e99b6b90783.html#a7e01072e90b4eec60c975be1a9d0de3e">  549</a></span>&#160;      __device__ __host__ <span class="keyword">inline</span> complex&lt;Float&gt; <a class="code" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g_e___ob3f8ab569f1b01e2fe1b1e99b6b90783.html#a7e01072e90b4eec60c975be1a9d0de3e">operator()</a>(<span class="keywordtype">int</span> d, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> row, <span class="keywordtype">int</span> col)<span class="keyword"> const</span></div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="keyword">      </span>{</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;  complex&lt;storeFloat&gt; <a class="code" href="covdev__test_8cpp.html#a788da19b1cbae7d08eb18da226046dd7">tmp</a> = u[(((parity*volumeCB+x)*geometry + d)*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a> + row)*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a> + col];</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  <span class="keywordflow">if</span> (fixed) {</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    <span class="keywordflow">return</span> scale_inv*complex&lt;Float&gt;(<span class="keyword">static_cast&lt;</span>Float<span class="keyword">&gt;</span>(tmp.x), static_cast&lt;Float&gt;(tmp.y));</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <span class="keywordflow">return</span> complex&lt;Float&gt;(tmp.x,tmp.y);</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;  }</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;      }</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;</div><div class="line"><a name="l00559"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g_e___ob3f8ab569f1b01e2fe1b1e99b6b90783.html#ad1a50df3a514e8d1a540b12cf361a5ed">  559</a></span>&#160;      __device__ __host__ <span class="keyword">inline</span> <a class="code" href="structquda_1_1gauge_1_1fieldorder__wrapper.html">fieldorder_wrapper&lt;Float,storeFloat&gt;</a> <a class="code" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g_e___ob3f8ab569f1b01e2fe1b1e99b6b90783.html#ad1a50df3a514e8d1a540b12cf361a5ed">operator()</a>(<span class="keywordtype">int</span> d, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> row, <span class="keywordtype">int</span> col)</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;  { <span class="keywordflow">return</span> <a class="code" href="structquda_1_1gauge_1_1fieldorder__wrapper.html">fieldorder_wrapper&lt;Float,storeFloat&gt;</a></div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;      (u, (((parity*volumeCB+x)*geometry + d)*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a> + row)*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a> + col, scale, scale_inv); }</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;      <span class="keyword">template</span> &lt;<span class="keyword">typename</span> theirFloat&gt;</div><div class="line"><a name="l00564"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g_e___ob3f8ab569f1b01e2fe1b1e99b6b90783.html#ad6dff02852e021909caeb934881d37bb">  564</a></span>&#160;      __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g_e___ob3f8ab569f1b01e2fe1b1e99b6b90783.html#ad6dff02852e021909caeb934881d37bb">atomic_add</a>(<span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5261c5f7423edd78086a027390e11983">x_cb</a>, <span class="keywordtype">int</span> row, <span class="keywordtype">int</span> col, <span class="keyword">const</span> complex&lt;theirFloat&gt; &amp;val)<span class="keyword"> const </span>{</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="preprocessor">#ifdef __CUDA_ARCH__</span></div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> vector&lt;storeFloat,2&gt;::type vec2;</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;  vec2 *u2 = <span class="keyword">reinterpret_cast&lt;</span>vec2*<span class="keyword">&gt;</span>(u + (((parity*volumeCB+<a class="code" href="structquda_1_1gauge__wrapper.html#a5261c5f7423edd78086a027390e11983">x_cb</a>)*geometry + dim)*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a> + row)*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a> + col);</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;  <span class="keywordflow">if</span> (fixed &amp;&amp; !match&lt;storeFloat,theirFloat&gt;()) {</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    complex&lt;storeFloat&gt; val_(round(scale * val.real()), round(scale * val.imag()));</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    <a class="code" href="atomic_8cuh.html#a5723b0bba0d65bedce0e1bb329366d8c">atomicAdd</a>(u2, (vec2&amp;)val_);</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    <a class="code" href="atomic_8cuh.html#a5723b0bba0d65bedce0e1bb329366d8c">atomicAdd</a>(u2, (vec2&amp;)val);</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;  }</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;  <span class="keywordflow">if</span> (fixed &amp;&amp; !match&lt;storeFloat,theirFloat&gt;()) {</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    complex&lt;storeFloat&gt; val_(round(scale * val.real()), round(scale * val.imag()));</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="preprocessor">#pragma omp atomic update</span></div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    u[(((parity*volumeCB+<a class="code" href="structquda_1_1gauge__wrapper.html#a5261c5f7423edd78086a027390e11983">x_cb</a>)*geometry + dim)*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a> + row)*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a> + col].x += val_.x;</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;#pragma omp atomic update</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    u[(((parity*volumeCB+x_cb)*geometry + <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>)*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a> + row)*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a> + col].y += val_.y;</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="preprocessor">#pragma omp atomic update</span></div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    u[(((parity*volumeCB+<a class="code" href="structquda_1_1gauge__wrapper.html#a5261c5f7423edd78086a027390e11983">x_cb</a>)*geometry + dim)*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a> + row)*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a> + col].x += static_cast&lt;storeFloat&gt;(val.x);</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="preprocessor">#pragma omp atomic update</span></div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    u[(((parity*volumeCB+<a class="code" href="structquda_1_1gauge__wrapper.html#a5261c5f7423edd78086a027390e11983">x_cb</a>)*geometry + dim)*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a> + row)*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a> + col].y += static_cast&lt;storeFloat&gt;(val.y);</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;  }</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;      }</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> helper, <span class="keyword">typename</span> reducer&gt;</div><div class="line"><a name="l00591"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g_e___ob3f8ab569f1b01e2fe1b1e99b6b90783.html#a999469e15e4586cdf5af7b1f00b3db14">  591</a></span>&#160;      __host__ <span class="keywordtype">double</span> <a class="code" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g_e___ob3f8ab569f1b01e2fe1b1e99b6b90783.html#a999469e15e4586cdf5af7b1f00b3db14">transform_reduce</a>(<a class="code" href="enum__quda_8h.html#a7e07bc0f2e37ab1df05cd3c87017ff33">QudaFieldLocation</a> location, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>, helper h, reducer r, <span class="keywordtype">double</span> <a class="code" href="namespacequda_1_1cublas.html#ac642c2c4f9dd3abfe528cc1581e5bf76">init</a>)<span class="keyword"> const </span>{</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;  <span class="keywordflow">if</span> (dim &gt;= geometry) <a class="code" href="util__quda_8h.html#af3bddfd9d113d50e8e0bbf58a35c5aac">errorQuda</a>(<span class="stringliteral">&quot;Request dimension %d exceeds dimensionality of the field %d&quot;</span>, dim, geometry);</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        <span class="keywordtype">int</span> lower = (dim == -1) ? 0 : dim;</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        <span class="keywordtype">int</span> upper = (dim == -1) ? geometry : dim+1;</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;        <span class="keywordtype">double</span> result = <a class="code" href="namespacequda_1_1cublas.html#ac642c2c4f9dd3abfe528cc1581e5bf76">init</a>;</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        <span class="keywordflow">if</span> (location == <a class="code" href="enum__quda_8h.html#a35de1312d8bed4b94234a3092907e0d9a184379764fab0f101cab6f19a8a14690">QUDA_CUDA_FIELD_LOCATION</a>) {</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;          <a class="code" href="classthrust__allocator.html">thrust_allocator</a> <a class="code" href="namespacequda.html#a4fae7f819003f6b7116efc43e7830908">alloc</a>;</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;          thrust::device_ptr&lt;complex&lt;storeFloat&gt; &gt; ptr(u);</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;          result = thrust::transform_reduce(thrust::cuda::par(alloc),</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                                            ptr+(0*geometry+lower)*volumeCB*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a>*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a>,</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;                                            ptr+(0*geometry+upper)*volumeCB*nColor*nColor, h, result, r);</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;          result = thrust::transform_reduce(thrust::cuda::par(alloc),</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;                                            ptr+(1*geometry+lower)*volumeCB*nColor*nColor,</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;                                            ptr+(1*geometry+upper)*volumeCB*nColor*nColor, h, result, r);</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;          result = thrust::transform_reduce(thrust::seq,</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;                                            u+(0*geometry+lower)*volumeCB*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a>*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a>,</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                                            u+(0*geometry+upper)*volumeCB*nColor*nColor, h, result, r);</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;          result  = thrust::transform_reduce(thrust::seq,</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;                                             u+(1*geometry+lower)*volumeCB*nColor*nColor,</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;                                             u+(1*geometry+upper)*volumeCB*nColor*nColor, h, result, r);</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        }</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        <span class="keywordflow">return</span> result;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;      }</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    };</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> Float, <span class="keywordtype">int</span> nColor, <span class="keywordtype">bool</span> native_ghost, <span class="keyword">typename</span> storeFloat, <span class="keywordtype">bool</span> use_tex&gt;</div><div class="line"><a name="l00619"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g656a684b71192f463c0c771174ee66f3.html">  619</a></span>&#160;      <span class="keyword">struct </span><a class="code" href="structquda_1_1gauge_1_1_ghost_accessor.html">GhostAccessor</a>&lt;Float,<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a>,<a class="code" href="enum__quda_8h.html#acb61fdc14d6b12e8c6177b6d966bd863adb1a4116b2cbd52bd33641d7400f0989">QUDA_MILC_GAUGE_ORDER</a>,native_ghost,storeFloat,use_tex&gt; {</div><div class="line"><a name="l00620"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g656a684b71192f463c0c771174ee66f3.html#a343d8e01c6800c5620def6ce0c5a1551">  620</a></span>&#160;      complex&lt;storeFloat&gt; *ghost[8];</div><div class="line"><a name="l00621"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g656a684b71192f463c0c771174ee66f3.html#a43aaf4defc7b9e2a0689129c84055bff">  621</a></span>&#160;      <span class="keywordtype">int</span> ghostOffset[8];</div><div class="line"><a name="l00622"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g656a684b71192f463c0c771174ee66f3.html#ab463f7622edced2ee2e14a7ad4cf7a23">  622</a></span>&#160;      Float <a class="code" href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g656a684b71192f463c0c771174ee66f3.html#ab463f7622edced2ee2e14a7ad4cf7a23">scale</a>;</div><div class="line"><a name="l00623"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g656a684b71192f463c0c771174ee66f3.html#aaa8f76b78ae50323da4b7022fc3f0a75">  623</a></span>&#160;      Float <a class="code" href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g656a684b71192f463c0c771174ee66f3.html#aaa8f76b78ae50323da4b7022fc3f0a75">scale_inv</a>;</div><div class="line"><a name="l00624"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g656a684b71192f463c0c771174ee66f3.html#a292b558ad29f39cf9540149397e48bf2">  624</a></span>&#160;      <span class="keyword">static</span> constexpr <span class="keywordtype">bool</span> fixed = fixed_point&lt;Float,storeFloat&gt;();</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;</div><div class="line"><a name="l00626"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g656a684b71192f463c0c771174ee66f3.html#aabcf0c8430ff9d5e2cee70834c6ccabf">  626</a></span>&#160;      <a class="code" href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g656a684b71192f463c0c771174ee66f3.html#aabcf0c8430ff9d5e2cee70834c6ccabf">GhostAccessor</a>(<span class="keyword">const</span> <a class="code" href="classquda_1_1_gauge_field.html">GaugeField</a> &amp;U, <span class="keywordtype">void</span> *gauge_=0, <span class="keywordtype">void</span> **ghost_=0)</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;  : scale(static_cast&lt;Float&gt;(1.0)), scale_inv(static_cast&lt;Float&gt;(1.0)) {</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d=0; d&lt;4; d++) {</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    ghost[d] = ghost_ ? <span class="keyword">static_cast&lt;</span>complex&lt;storeFloat&gt;*<span class="keyword">&gt;</span>(ghost_[d]) :</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;      <span class="keyword">static_cast&lt;</span>complex&lt;storeFloat&gt;*<span class="keyword">&gt;</span>(const_cast&lt;void*&gt;(U.<a class="code" href="classquda_1_1_gauge_field.html#aedfa91e714c61b8e11caec9d2703dcfa">Ghost</a>()[d]));</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    ghostOffset[d] = U.<a class="code" href="classquda_1_1_gauge_field.html#a8e0ae774c1566179db3e3c5a2bc0b226">Nface</a>()*U.<a class="code" href="classquda_1_1_lattice_field.html#a64969b1180e27da1fdbc1959f1cf644c">SurfaceCB</a>(d)*U.<a class="code" href="classquda_1_1_gauge_field.html#ab655802370bde3461711f30a2da68bb7">Ncolor</a>()*U.<a class="code" href="classquda_1_1_gauge_field.html#ab655802370bde3461711f30a2da68bb7">Ncolor</a>();</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    ghost[d+4] = (U.<a class="code" href="classquda_1_1_gauge_field.html#a02bc76f698126cbaa08301110983f779">Geometry</a>() != <a class="code" href="enum__quda_8h.html#a7589b295019a40887f1c10c76555feeaadc1a5ef802228fe4edd42346172c7605">QUDA_COARSE_GEOMETRY</a>) ? <span class="keyword">nullptr</span> :</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;      ghost_ ? <span class="keyword">static_cast&lt;</span>complex&lt;storeFloat&gt;*<span class="keyword">&gt;</span>(ghost_[d+4]) :</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;      <span class="keyword">static_cast&lt;</span>complex&lt;storeFloat&gt;*<span class="keyword">&gt;</span>(<span class="keyword">const_cast&lt;</span><span class="keywordtype">void</span>*<span class="keyword">&gt;</span>(U.<a class="code" href="classquda_1_1_gauge_field.html#aedfa91e714c61b8e11caec9d2703dcfa">Ghost</a>()[d+4]));</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    ghostOffset[d+4] = U.<a class="code" href="classquda_1_1_gauge_field.html#a8e0ae774c1566179db3e3c5a2bc0b226">Nface</a>()*U.<a class="code" href="classquda_1_1_lattice_field.html#a64969b1180e27da1fdbc1959f1cf644c">SurfaceCB</a>(d)*U.<a class="code" href="classquda_1_1_gauge_field.html#ab655802370bde3461711f30a2da68bb7">Ncolor</a>()*U.<a class="code" href="classquda_1_1_gauge_field.html#ab655802370bde3461711f30a2da68bb7">Ncolor</a>();</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;  }</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;  resetScale(U.<a class="code" href="classquda_1_1_lattice_field.html#ae8c8678bb923db27c8ea985546101f11">Scale</a>());</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;      }</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;</div><div class="line"><a name="l00642"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g656a684b71192f463c0c771174ee66f3.html#ab687ad590c4ab8683651c664ba21424d">  642</a></span>&#160;    <a class="code" href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g656a684b71192f463c0c771174ee66f3.html#ab687ad590c4ab8683651c664ba21424d">GhostAccessor</a>(<span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g656a684b71192f463c0c771174ee66f3.html">GhostAccessor&lt;Float,nColor,QUDA_MILC_GAUGE_ORDER,native_ghost,storeFloat,use_tex&gt;</a> &amp;a)</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;  : scale(a.scale), scale_inv(a.scale_inv) {</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d=0; d&lt;8; d++) {</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    ghost[d] = a.<a class="code" href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g656a684b71192f463c0c771174ee66f3.html#a343d8e01c6800c5620def6ce0c5a1551">ghost</a>[d];</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    ghostOffset[d] = a.<a class="code" href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g656a684b71192f463c0c771174ee66f3.html#a43aaf4defc7b9e2a0689129c84055bff">ghostOffset</a>[d];</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;  }</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;      }</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;</div><div class="line"><a name="l00650"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g656a684b71192f463c0c771174ee66f3.html#a51f356d75603e8422f943acf3eae5501">  650</a></span>&#160;      <span class="keywordtype">void</span> <a class="code" href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g656a684b71192f463c0c771174ee66f3.html#a51f356d75603e8422f943acf3eae5501">resetScale</a>(Float max) {</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  <span class="keywordflow">if</span> (fixed) {</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    scale = <span class="keyword">static_cast&lt;</span>Float<span class="keyword">&gt;</span>(std::numeric_limits&lt;storeFloat&gt;::max()) / max;</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    scale_inv = max / <span class="keyword">static_cast&lt;</span>Float<span class="keyword">&gt;</span>(std::numeric_limits&lt;storeFloat&gt;::max());</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;  }</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;      }</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;</div><div class="line"><a name="l00657"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g656a684b71192f463c0c771174ee66f3.html#adb76f7afde16a18a6184b7612bc0cde8">  657</a></span>&#160;      __device__ __host__ <span class="keyword">inline</span> complex&lt;Float&gt; <a class="code" href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g656a684b71192f463c0c771174ee66f3.html#adb76f7afde16a18a6184b7612bc0cde8">operator()</a>(<span class="keywordtype">int</span> d, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> row, <span class="keywordtype">int</span> col)<span class="keyword"> const</span></div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;<span class="keyword">      </span>{</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;  complex&lt;storeFloat&gt; <a class="code" href="covdev__test_8cpp.html#a788da19b1cbae7d08eb18da226046dd7">tmp</a> = ghost[d][ parity*ghostOffset[d] + (x*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a> + row)*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a> + col];</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;  <span class="keywordflow">if</span> (fixed) {</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    <span class="keywordflow">return</span> scale_inv*complex&lt;Float&gt;(<span class="keyword">static_cast&lt;</span>Float<span class="keyword">&gt;</span>(tmp.x), static_cast&lt;Float&gt;(tmp.y));</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    <span class="keywordflow">return</span> complex&lt;Float&gt;(tmp.x,tmp.y);</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;  }</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;      }</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;</div><div class="line"><a name="l00667"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g656a684b71192f463c0c771174ee66f3.html#ad3bd419947b7028251150a41df91e3b7">  667</a></span>&#160;      __device__ __host__ <span class="keyword">inline</span> <a class="code" href="structquda_1_1gauge_1_1fieldorder__wrapper.html">fieldorder_wrapper&lt;Float,storeFloat&gt;</a> <a class="code" href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g656a684b71192f463c0c771174ee66f3.html#ad3bd419947b7028251150a41df91e3b7">operator()</a>(<span class="keywordtype">int</span> d, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> row, <span class="keywordtype">int</span> col)</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;  { <span class="keywordflow">return</span> <a class="code" href="structquda_1_1gauge_1_1fieldorder__wrapper.html">fieldorder_wrapper&lt;Float,storeFloat&gt;</a></div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;      (ghost[d], parity*ghostOffset[d] + (x*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a> + row)*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a> + col, scale, scale_inv); }</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    };</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    <span class="keyword">template</span>&lt;<span class="keywordtype">int</span> nColor, <span class="keywordtype">int</span> N&gt;</div><div class="line"><a name="l00673"></a><span class="lineno"><a class="line" href="namespacequda_1_1gauge.html#ac38d7c2bb9ea52de39575dcaf73a3d0f">  673</a></span>&#160;      __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="namespacequda_1_1gauge.html#ac38d7c2bb9ea52de39575dcaf73a3d0f">indexFloatN</a>(<span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5261c5f7423edd78086a027390e11983">x_cb</a>, <span class="keywordtype">int</span> row, <span class="keywordtype">int</span> col, <span class="keywordtype">int</span> stride, <span class="keywordtype">int</span> offset_cb) {</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;      constexpr <span class="keywordtype">int</span> M = (2*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a>*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a>) / N;</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;      <span class="keywordtype">int</span> j = ((row*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a>+col)*2) / N; <span class="comment">// factor of two for complexity</span></div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;      <span class="keywordtype">int</span> i = ((row*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a>+col)*2) % N;</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;      <span class="keywordtype">int</span> <a class="code" href="comm__common_8cpp.html#a9050542b1bb11f6418bae82e3ef4c192">index</a> = ((x_cb + dim*stride*M + j*stride)*2+i) / 2; <span class="comment">// back to a complex offset</span></div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;      index += parity*offset_cb;</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="comm__common_8cpp.html#a9050542b1bb11f6418bae82e3ef4c192">index</a>;</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    };</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> Float, <span class="keywordtype">int</span> nColor, <span class="keyword">typename</span> storeFloat, <span class="keywordtype">bool</span> use_tex&gt;</div><div class="line"><a name="l00683"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e_0851bfc944ce664513b027bdb1e7938b.html">  683</a></span>&#160;      <span class="keyword">struct </span><a class="code" href="structquda_1_1gauge_1_1_accessor.html">Accessor</a>&lt;Float,<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a>,<a class="code" href="enum__quda_8h.html#acb61fdc14d6b12e8c6177b6d966bd863a2237dcd2b3bc4294563478199248107c">QUDA_FLOAT2_GAUGE_ORDER</a>, storeFloat, use_tex&gt; {</div><div class="line"><a name="l00684"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e_0851bfc944ce664513b027bdb1e7938b.html#a91a34bb6d9ae7d7a58cfd8573fcc4bf6">  684</a></span>&#160;      complex&lt;storeFloat&gt; *<a class="code" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e_0851bfc944ce664513b027bdb1e7938b.html#a91a34bb6d9ae7d7a58cfd8573fcc4bf6">u</a>;</div><div class="line"><a name="l00685"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e_0851bfc944ce664513b027bdb1e7938b.html#a022df6630cc60bde40bf21eaabb840eb">  685</a></span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e_0851bfc944ce664513b027bdb1e7938b.html#a022df6630cc60bde40bf21eaabb840eb">offset_cb</a>;</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;<span class="preprocessor">#ifdef USE_TEXTURE_OBJECTS</span></div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;      <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="structquda_1_1_tex_vector_type.html">TexVectorType&lt;Float,2&gt;::type</a> TexVector;</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;      cudaTextureObject_t tex;</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00690"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e_0851bfc944ce664513b027bdb1e7938b.html#a06c4536e37aaedc49201fa6f276c3406">  690</a></span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e_0851bfc944ce664513b027bdb1e7938b.html#a06c4536e37aaedc49201fa6f276c3406">volumeCB</a>;</div><div class="line"><a name="l00691"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e_0851bfc944ce664513b027bdb1e7938b.html#af7baeb52ee488ad2841aa2f1a0c49ad5">  691</a></span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e_0851bfc944ce664513b027bdb1e7938b.html#af7baeb52ee488ad2841aa2f1a0c49ad5">stride</a>;</div><div class="line"><a name="l00692"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e_0851bfc944ce664513b027bdb1e7938b.html#ad33d12657f2f4c8ee7155d1060268531">  692</a></span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e_0851bfc944ce664513b027bdb1e7938b.html#ad33d12657f2f4c8ee7155d1060268531">geometry</a>;</div><div class="line"><a name="l00693"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e_0851bfc944ce664513b027bdb1e7938b.html#acfe2d7943e3074672e6e370240e56a45">  693</a></span>&#160;      Float <a class="code" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e_0851bfc944ce664513b027bdb1e7938b.html#acfe2d7943e3074672e6e370240e56a45">max</a>;</div><div class="line"><a name="l00694"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e_0851bfc944ce664513b027bdb1e7938b.html#a9fd0a0611ee431918f6ac1dffe887d79">  694</a></span>&#160;      Float <a class="code" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e_0851bfc944ce664513b027bdb1e7938b.html#a9fd0a0611ee431918f6ac1dffe887d79">scale</a>;</div><div class="line"><a name="l00695"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e_0851bfc944ce664513b027bdb1e7938b.html#a45bd07b635565ca44633621567c7d0e0">  695</a></span>&#160;      Float <a class="code" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e_0851bfc944ce664513b027bdb1e7938b.html#a45bd07b635565ca44633621567c7d0e0">scale_inv</a>;</div><div class="line"><a name="l00696"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e_0851bfc944ce664513b027bdb1e7938b.html#a3535236cbfb0af21ecb9db30217d4f13">  696</a></span>&#160;      <span class="keyword">static</span> constexpr <span class="keywordtype">bool</span> fixed = fixed_point&lt;Float,storeFloat&gt;();</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;</div><div class="line"><a name="l00698"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e_0851bfc944ce664513b027bdb1e7938b.html#aaac76f7fdae0f7d7d82d1aa2368e5d2d">  698</a></span>&#160;    <a class="code" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e_0851bfc944ce664513b027bdb1e7938b.html#aaac76f7fdae0f7d7d82d1aa2368e5d2d">Accessor</a>(<span class="keyword">const</span> <a class="code" href="classquda_1_1_gauge_field.html">GaugeField</a> &amp;U, <span class="keywordtype">void</span> *gauge_=0, <span class="keywordtype">void</span> **ghost_=0, <span class="keywordtype">bool</span> <span class="keyword">override</span>=<span class="keyword">false</span>)</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;      : u(gauge_ ? static_cast&lt;complex&lt;storeFloat&gt;*&gt;(gauge_) :</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    static_cast&lt;complex&lt;storeFloat&gt;*&gt;(const_cast&lt;void*&gt;(U.Gauge_p()))),</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;  offset_cb( (U.Bytes()&gt;&gt;1) / sizeof(complex&lt;storeFloat&gt;)),</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;#ifdef USE_TEXTURE_OBJECTS</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;        tex(0),</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;#endif</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;        volumeCB(U.VolumeCB()), stride(U.Stride()), geometry(U.Geometry()),</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;        max(static_cast&lt;Float&gt;(1.0)), scale(static_cast&lt;Float&gt;(1.0)), scale_inv(static_cast&lt;Float&gt;(1.0))</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;      {</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;  resetScale(U.<a class="code" href="classquda_1_1_lattice_field.html#ae8c8678bb923db27c8ea985546101f11">Scale</a>());</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;<span class="preprocessor">#ifdef USE_TEXTURE_OBJECTS</span></div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;  <span class="keywordflow">if</span> (U.<a class="code" href="classquda_1_1_lattice_field.html#a644c9306ed8f513cdb2c88c755e305d8">Location</a>() == <a class="code" href="enum__quda_8h.html#a35de1312d8bed4b94234a3092907e0d9a184379764fab0f101cab6f19a8a14690">QUDA_CUDA_FIELD_LOCATION</a>) tex = static_cast&lt;const cudaGaugeField&amp;&gt;(U).Tex();</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;  <span class="keywordflow">if</span> (use_tex &amp;&amp; this-&gt;u != U.<a class="code" href="classquda_1_1_gauge_field.html#ab875db966189cb025989e43275f78830">Gauge_p</a>() &amp;&amp; !<span class="keyword">override</span>) {</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    <a class="code" href="util__quda_8h.html#af3bddfd9d113d50e8e0bbf58a35c5aac">errorQuda</a>(<span class="stringliteral">&quot;Cannot use texture read since data pointer does not equal field pointer - use with use_tex=false instead&quot;</span>);</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;  }</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;      }</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;</div><div class="line"><a name="l00717"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e_0851bfc944ce664513b027bdb1e7938b.html#ae37a53b215b98335fea28dfce9674af3">  717</a></span>&#160;    <a class="code" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e_0851bfc944ce664513b027bdb1e7938b.html#ae37a53b215b98335fea28dfce9674af3">Accessor</a>(<span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e_0851bfc944ce664513b027bdb1e7938b.html">Accessor&lt;Float,nColor,QUDA_FLOAT2_GAUGE_ORDER,storeFloat,use_tex&gt;</a> &amp;a)</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;      : u(a.u), offset_cb(a.offset_cb),</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;#ifdef USE_TEXTURE_OBJECTS</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;        tex(a.tex),</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;#endif</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;        volumeCB(a.volumeCB), stride(a.stride), geometry(a.geometry),</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;  scale(a.scale), scale_inv(a.scale_inv) {  }</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;</div><div class="line"><a name="l00725"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e_0851bfc944ce664513b027bdb1e7938b.html#ae0c33dfb8eeb1db3e84b449237bdd559">  725</a></span>&#160;      <span class="keywordtype">void</span> <a class="code" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e_0851bfc944ce664513b027bdb1e7938b.html#ae0c33dfb8eeb1db3e84b449237bdd559">resetScale</a>(Float max_) {</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;  <span class="keywordflow">if</span> (fixed) {</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    max = max_;</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    scale = <span class="keyword">static_cast&lt;</span>Float<span class="keyword">&gt;</span>(std::numeric_limits&lt;storeFloat&gt;::max()) / max;</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    scale_inv = max / <span class="keyword">static_cast&lt;</span>Float<span class="keyword">&gt;</span>(std::numeric_limits&lt;storeFloat&gt;::max());</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;  }</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;      }</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;</div><div class="line"><a name="l00733"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e_0851bfc944ce664513b027bdb1e7938b.html#a70058aa340a3f815a40b346f01b72cf2">  733</a></span>&#160;      __device__ __host__ <span class="keyword">inline</span> <span class="keyword">const</span> complex&lt;Float&gt; <a class="code" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e_0851bfc944ce664513b027bdb1e7938b.html#a70058aa340a3f815a40b346f01b72cf2">operator()</a>(<span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5261c5f7423edd78086a027390e11983">x_cb</a>, <span class="keywordtype">int</span> row, <span class="keywordtype">int</span> col)<span class="keyword"> const</span></div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;<span class="keyword">      </span>{</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;<span class="preprocessor">#if defined(USE_TEXTURE_OBJECTS) &amp;&amp; defined(__CUDA_ARCH__)</span></div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;  <span class="keywordflow">if</span> (use_tex) {</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    TexVector vecTmp = tex1Dfetch_&lt;TexVector&gt;(tex, parity*offset_cb + dim*stride*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a>*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a> + (row*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a>+col)*stride + x_cb);</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;    <span class="keywordflow">if</span> (fixed) {</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;      <span class="keywordflow">return</span> max*complex&lt;Float&gt;(vecTmp.x, vecTmp.y);</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;      <span class="keywordflow">return</span> complex&lt;Float&gt;(vecTmp.x, vecTmp.y);</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    }</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;  } <span class="keywordflow">else</span></div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;  {</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    complex&lt;storeFloat&gt; <a class="code" href="covdev__test_8cpp.html#a788da19b1cbae7d08eb18da226046dd7">tmp</a> = u[parity*offset_cb + dim*stride*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a>*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a> + (row*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a>+col)*stride + x_cb];</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    <span class="keywordflow">if</span> (fixed) {</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;      <span class="keywordflow">return</span> scale_inv*complex&lt;Float&gt;(<span class="keyword">static_cast&lt;</span>Float<span class="keyword">&gt;</span>(tmp.x), static_cast&lt;Float&gt;(tmp.y));</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;      <span class="keywordflow">return</span> complex&lt;Float&gt;(tmp.x, tmp.y);</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    }</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;  }</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;      }</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;</div><div class="line"><a name="l00755"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e_0851bfc944ce664513b027bdb1e7938b.html#a755409bb96206d814e9b2025961a9cfc">  755</a></span>&#160;      __device__ __host__ <span class="keyword">inline</span> <a class="code" href="structquda_1_1gauge_1_1fieldorder__wrapper.html">fieldorder_wrapper&lt;Float,storeFloat&gt;</a> <a class="code" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e_0851bfc944ce664513b027bdb1e7938b.html#a755409bb96206d814e9b2025961a9cfc">operator()</a>(<span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5261c5f7423edd78086a027390e11983">x_cb</a>, <span class="keywordtype">int</span> row, <span class="keywordtype">int</span> col)</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;      {</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="comm__common_8cpp.html#a9050542b1bb11f6418bae82e3ef4c192">index</a> = parity*offset_cb + dim*stride*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a>*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a> + (row*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a>+col)*stride + x_cb;</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="structquda_1_1gauge_1_1fieldorder__wrapper.html">fieldorder_wrapper&lt;Float,storeFloat&gt;</a>(u, <a class="code" href="comm__common_8cpp.html#a9050542b1bb11f6418bae82e3ef4c192">index</a>, scale, scale_inv);</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;      }</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;      <span class="keyword">template</span> &lt;<span class="keyword">typename</span> theirFloat&gt;</div><div class="line"><a name="l00762"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e_0851bfc944ce664513b027bdb1e7938b.html#ad08b3dd0c38cc7b44b1e2cde177c7d92">  762</a></span>&#160;      __device__ __host__ <span class="keywordtype">void</span> <a class="code" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e_0851bfc944ce664513b027bdb1e7938b.html#ad08b3dd0c38cc7b44b1e2cde177c7d92">atomic_add</a>(<span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5261c5f7423edd78086a027390e11983">x_cb</a>, <span class="keywordtype">int</span> row, <span class="keywordtype">int</span> col, <span class="keyword">const</span> complex&lt;theirFloat&gt; &amp;val)<span class="keyword"> const </span>{</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;<span class="preprocessor">#ifdef __CUDA_ARCH__</span></div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> vector&lt;storeFloat,2&gt;::type vec2;</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;  vec2 *u2 = <span class="keyword">reinterpret_cast&lt;</span>vec2*<span class="keyword">&gt;</span>(u + parity*offset_cb + dim*stride*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a>*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a> + (row*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a>+col)*stride + x_cb);</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;  <span class="keywordflow">if</span> (fixed &amp;&amp; !match&lt;storeFloat,theirFloat&gt;()) {</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    complex&lt;storeFloat&gt; val_(round(scale * val.real()), round(scale * val.imag()));</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    <a class="code" href="atomic_8cuh.html#a5723b0bba0d65bedce0e1bb329366d8c">atomicAdd</a>(u2, (vec2&amp;)val_);</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    <a class="code" href="atomic_8cuh.html#a5723b0bba0d65bedce0e1bb329366d8c">atomicAdd</a>(u2, (vec2&amp;)val);</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;  }</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;        <span class="keywordflow">if</span> (fixed &amp;&amp; !match&lt;storeFloat,theirFloat&gt;()) {</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    complex&lt;storeFloat&gt; val_(round(scale * val.real()), round(scale * val.imag()));</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;<span class="preprocessor">#pragma omp atomic update</span></div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    u[parity*offset_cb + dim*stride*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a>*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a> + (row*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a>+col)*stride + x_cb].x += val_.x;</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;#pragma omp atomic update</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    u[parity*offset_cb + dim*stride*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a>*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a> + (row*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a>+col)*stride + <a class="code" href="structquda_1_1gauge__wrapper.html#a5261c5f7423edd78086a027390e11983">x_cb</a>].y += val_.y;</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;<span class="preprocessor">#pragma omp atomic update</span></div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    u[parity*offset_cb + dim*stride*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a>*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a> + (row*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a>+col)*stride + x_cb].x += static_cast&lt;storeFloat&gt;(val.x);</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;<span class="preprocessor">#pragma omp atomic update</span></div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    u[parity*offset_cb + dim*stride*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a>*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a> + (row*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a>+col)*stride + x_cb].y += static_cast&lt;storeFloat&gt;(val.y);</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;  }</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;      }</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> helper, <span class="keyword">typename</span> reducer&gt;</div><div class="line"><a name="l00789"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e_0851bfc944ce664513b027bdb1e7938b.html#ac66fe95f0115b3bd9bd22328057d37ad">  789</a></span>&#160;        __host__ <span class="keywordtype">double</span> <a class="code" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e_0851bfc944ce664513b027bdb1e7938b.html#ac66fe95f0115b3bd9bd22328057d37ad">transform_reduce</a>(<a class="code" href="enum__quda_8h.html#a7e07bc0f2e37ab1df05cd3c87017ff33">QudaFieldLocation</a> location, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>, helper h, reducer r, <span class="keywordtype">double</span> <a class="code" href="namespacequda_1_1cublas.html#ac642c2c4f9dd3abfe528cc1581e5bf76">init</a>)<span class="keyword"> const </span>{</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;  <span class="keywordflow">if</span> (dim &gt;= geometry) <a class="code" href="util__quda_8h.html#af3bddfd9d113d50e8e0bbf58a35c5aac">errorQuda</a>(<span class="stringliteral">&quot;Request dimension %d exceeds dimensionality of the field %d&quot;</span>, dim, geometry);</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;        <span class="keywordtype">int</span> lower = (dim == -1) ? 0 : dim;</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;        <span class="keywordtype">int</span> upper = (dim == -1) ? geometry : dim+1;</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;        <span class="keywordtype">double</span> result = <a class="code" href="namespacequda_1_1cublas.html#ac642c2c4f9dd3abfe528cc1581e5bf76">init</a>;</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;        <span class="keywordflow">if</span> (location == <a class="code" href="enum__quda_8h.html#a35de1312d8bed4b94234a3092907e0d9a184379764fab0f101cab6f19a8a14690">QUDA_CUDA_FIELD_LOCATION</a>) {</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;          <a class="code" href="classthrust__allocator.html">thrust_allocator</a> <a class="code" href="namespacequda.html#a4fae7f819003f6b7116efc43e7830908">alloc</a>;</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;          thrust::device_ptr&lt;complex&lt;storeFloat&gt; &gt; ptr(u);</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;          result = thrust::transform_reduce(thrust::cuda::par(alloc),</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;                                            ptr+0*offset_cb+lower*stride*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a>*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a>,</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;                                            ptr+0*offset_cb+upper*stride*nColor*nColor, h, result, r);</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;          result = thrust::transform_reduce(thrust::cuda::par(alloc),</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;                                            ptr+1*offset_cb+lower*stride*nColor*nColor,</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;                                            ptr+1*offset_cb+upper*stride*nColor*nColor, h, result, r);</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;          result = thrust::transform_reduce(thrust::seq,</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;                                            u+0*offset_cb+lower*stride*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a>*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a>,</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;                                            u+0*offset_cb+upper*stride*nColor*nColor, h, result, r);</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;          result = thrust::transform_reduce(thrust::seq,</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;                                            u+1*offset_cb+lower*stride*nColor*nColor,</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;                                            u+1*offset_cb+upper*stride*nColor*nColor, h, result, r);</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;        }</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;        <span class="keywordflow">return</span> result;</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;      }</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    };</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> Float, <span class="keywordtype">int</span> nColor, <span class="keywordtype">bool</span> native_ghost, <span class="keyword">typename</span> storeFloat, <span class="keywordtype">bool</span> use_tex&gt;</div><div class="line"><a name="l00817"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_2b6e6ca5a27266b35ef9c885a15f8294.html">  817</a></span>&#160;      <span class="keyword">struct </span><a class="code" href="structquda_1_1gauge_1_1_ghost_accessor.html">GhostAccessor</a>&lt;Float,<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a>,<a class="code" href="enum__quda_8h.html#acb61fdc14d6b12e8c6177b6d966bd863a2237dcd2b3bc4294563478199248107c">QUDA_FLOAT2_GAUGE_ORDER</a>,native_ghost,storeFloat,use_tex&gt; {</div><div class="line"><a name="l00818"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_2b6e6ca5a27266b35ef9c885a15f8294.html#ad024c8b0f0b4d81eb9c16fcfbebbcf17">  818</a></span>&#160;      complex&lt;storeFloat&gt; *ghost[8];</div><div class="line"><a name="l00819"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_2b6e6ca5a27266b35ef9c885a15f8294.html#a259b3e76e5a7da33afff80b81a8c138e">  819</a></span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_2b6e6ca5a27266b35ef9c885a15f8294.html#a259b3e76e5a7da33afff80b81a8c138e">volumeCB</a>;</div><div class="line"><a name="l00820"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_2b6e6ca5a27266b35ef9c885a15f8294.html#a07e86bdf085a8936fcc74e7c9b538641">  820</a></span>&#160;      <span class="keywordtype">int</span> ghostVolumeCB[8];</div><div class="line"><a name="l00821"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_2b6e6ca5a27266b35ef9c885a15f8294.html#a90b6b5bd42dfd2106e6c1d0489dce777">  821</a></span>&#160;      Float <a class="code" href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_2b6e6ca5a27266b35ef9c885a15f8294.html#a90b6b5bd42dfd2106e6c1d0489dce777">scale</a>;</div><div class="line"><a name="l00822"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_2b6e6ca5a27266b35ef9c885a15f8294.html#a918d1b8895a4c608b803ae642ba5e9b0">  822</a></span>&#160;      Float <a class="code" href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_2b6e6ca5a27266b35ef9c885a15f8294.html#a918d1b8895a4c608b803ae642ba5e9b0">scale_inv</a>;</div><div class="line"><a name="l00823"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_2b6e6ca5a27266b35ef9c885a15f8294.html#a7665e2656dabbd079640bd7111f6b44a">  823</a></span>&#160;      <span class="keyword">static</span> constexpr <span class="keywordtype">bool</span> fixed = fixed_point&lt;Float,storeFloat&gt;();</div><div class="line"><a name="l00824"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_2b6e6ca5a27266b35ef9c885a15f8294.html#a8c2fa31b68cbbc1243d9b4db358604b7">  824</a></span>&#160;      <a class="code" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e_0851bfc944ce664513b027bdb1e7938b.html">Accessor&lt;Float,nColor,QUDA_FLOAT2_GAUGE_ORDER,storeFloat,use_tex&gt;</a> <a class="code" href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_2b6e6ca5a27266b35ef9c885a15f8294.html#a8c2fa31b68cbbc1243d9b4db358604b7">accessor</a>;</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;</div><div class="line"><a name="l00826"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_2b6e6ca5a27266b35ef9c885a15f8294.html#afcb587f9dfcfcadb559e817a0c42e5d1">  826</a></span>&#160;      <a class="code" href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_2b6e6ca5a27266b35ef9c885a15f8294.html#afcb587f9dfcfcadb559e817a0c42e5d1">GhostAccessor</a>(<span class="keyword">const</span> <a class="code" href="classquda_1_1_gauge_field.html">GaugeField</a> &amp;U, <span class="keywordtype">void</span> *gauge_, <span class="keywordtype">void</span> **ghost_=0)</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;  : volumeCB(U.VolumeCB()), accessor(U, gauge_, ghost_),</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    scale(static_cast&lt;Float&gt;(1.0)), scale_inv(static_cast&lt;Float&gt;(1.0))</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;      {</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;  <span class="keywordflow">if</span> (!native_ghost) assert(ghost_ != <span class="keyword">nullptr</span>);</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d=0; d&lt;4; d++) {</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    ghost[d] = !native_ghost ? <span class="keyword">static_cast&lt;</span>complex&lt;storeFloat&gt;*<span class="keyword">&gt;</span>(ghost_[d]) : <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    ghostVolumeCB[d] = U.<a class="code" href="classquda_1_1_gauge_field.html#a8e0ae774c1566179db3e3c5a2bc0b226">Nface</a>()*U.<a class="code" href="classquda_1_1_lattice_field.html#a64969b1180e27da1fdbc1959f1cf644c">SurfaceCB</a>(d);</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    ghost[d+4] = !native_ghost &amp;&amp; U.<a class="code" href="classquda_1_1_gauge_field.html#a02bc76f698126cbaa08301110983f779">Geometry</a>() == <a class="code" href="enum__quda_8h.html#a7589b295019a40887f1c10c76555feeaadc1a5ef802228fe4edd42346172c7605">QUDA_COARSE_GEOMETRY</a>? <span class="keyword">static_cast&lt;</span>complex&lt;storeFloat&gt;*<span class="keyword">&gt;</span>(ghost_[d+4]) : <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    ghostVolumeCB[d+4] = U.<a class="code" href="classquda_1_1_gauge_field.html#a8e0ae774c1566179db3e3c5a2bc0b226">Nface</a>()*U.<a class="code" href="classquda_1_1_lattice_field.html#a64969b1180e27da1fdbc1959f1cf644c">SurfaceCB</a>(d);</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;  }</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;  resetScale(U.<a class="code" href="classquda_1_1_lattice_field.html#ae8c8678bb923db27c8ea985546101f11">Scale</a>());</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;      }</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;</div><div class="line"><a name="l00840"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_2b6e6ca5a27266b35ef9c885a15f8294.html#a62bad3e25ca71736baf41f1c95da7220">  840</a></span>&#160;    <a class="code" href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_2b6e6ca5a27266b35ef9c885a15f8294.html#a62bad3e25ca71736baf41f1c95da7220">GhostAccessor</a>(<span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_2b6e6ca5a27266b35ef9c885a15f8294.html">GhostAccessor&lt;Float,nColor,QUDA_FLOAT2_GAUGE_ORDER,native_ghost,storeFloat,use_tex&gt;</a> &amp;a)</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;  : volumeCB(a.volumeCB), scale(a.scale), scale_inv(a.scale_inv), accessor(a.accessor)</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;      {</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d=0; d&lt;8; d++) {</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    ghost[d] = a.<a class="code" href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_2b6e6ca5a27266b35ef9c885a15f8294.html#ad024c8b0f0b4d81eb9c16fcfbebbcf17">ghost</a>[d];</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    ghostVolumeCB[d] = a.<a class="code" href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_2b6e6ca5a27266b35ef9c885a15f8294.html#a07e86bdf085a8936fcc74e7c9b538641">ghostVolumeCB</a>[d];</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;  }</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;      }</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;</div><div class="line"><a name="l00849"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_2b6e6ca5a27266b35ef9c885a15f8294.html#a8c42976dae197feb0a6b8bd1bf5923ed">  849</a></span>&#160;      <span class="keywordtype">void</span> <a class="code" href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_2b6e6ca5a27266b35ef9c885a15f8294.html#a8c42976dae197feb0a6b8bd1bf5923ed">resetScale</a>(Float max) {</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;  accessor.<a class="code" href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e_0851bfc944ce664513b027bdb1e7938b.html#ae0c33dfb8eeb1db3e84b449237bdd559">resetScale</a>(max);</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;  <span class="keywordflow">if</span> (fixed) {</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    scale = <span class="keyword">static_cast&lt;</span>Float<span class="keyword">&gt;</span>(std::numeric_limits&lt;storeFloat&gt;::max()) / max;</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    scale_inv = max / <span class="keyword">static_cast&lt;</span>Float<span class="keyword">&gt;</span>(std::numeric_limits&lt;storeFloat&gt;::max());</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;  }</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;      }</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;</div><div class="line"><a name="l00857"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_2b6e6ca5a27266b35ef9c885a15f8294.html#a4bc085efd93e90209b7d12a6c7c0566f">  857</a></span>&#160;      __device__ __host__ <span class="keyword">inline</span> <span class="keyword">const</span> complex&lt;Float&gt; <a class="code" href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_2b6e6ca5a27266b35ef9c885a15f8294.html#a4bc085efd93e90209b7d12a6c7c0566f">operator()</a>(<span class="keywordtype">int</span> d, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5261c5f7423edd78086a027390e11983">x_cb</a>, <span class="keywordtype">int</span> row, <span class="keywordtype">int</span> col)<span class="keyword"> const</span></div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;<span class="keyword">      </span>{</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;  <span class="keywordflow">if</span> (native_ghost) {</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    <span class="keywordflow">return</span> accessor(d%4, parity, x_cb+(d/4)*ghostVolumeCB[d]+volumeCB, row, col);</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    complex&lt;storeFloat&gt; <a class="code" href="covdev__test_8cpp.html#a788da19b1cbae7d08eb18da226046dd7">tmp</a> = ghost[d][ ((parity*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a> + row)*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a>+col)*ghostVolumeCB[d] + <a class="code" href="structquda_1_1gauge__wrapper.html#a5261c5f7423edd78086a027390e11983">x_cb</a> ];</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    <span class="keywordflow">if</span> (fixed) {</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;      <span class="keywordflow">return</span> scale_inv*complex&lt;Float&gt;(<span class="keyword">static_cast&lt;</span>Float<span class="keyword">&gt;</span>(tmp.x), static_cast&lt;Float&gt;(tmp.y));</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;      <span class="keywordflow">return</span> complex&lt;Float&gt;(tmp.x, tmp.y);</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    }</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;  }</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;      }</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;</div><div class="line"><a name="l00871"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_2b6e6ca5a27266b35ef9c885a15f8294.html#ad71603c5408da6df03363a8728086737">  871</a></span>&#160;      __device__ __host__ <span class="keyword">inline</span> <a class="code" href="structquda_1_1gauge_1_1fieldorder__wrapper.html">fieldorder_wrapper&lt;Float,storeFloat&gt;</a> <a class="code" href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_2b6e6ca5a27266b35ef9c885a15f8294.html#ad71603c5408da6df03363a8728086737">operator()</a>(<span class="keywordtype">int</span> d, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5261c5f7423edd78086a027390e11983">x_cb</a>, <span class="keywordtype">int</span> row, <span class="keywordtype">int</span> col)</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;      {</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;  <span class="keywordflow">if</span> (native_ghost)</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    <span class="keywordflow">return</span> accessor(d%4, parity, x_cb+(d/4)*ghostVolumeCB[d]+volumeCB, row, col);</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="structquda_1_1gauge_1_1fieldorder__wrapper.html">fieldorder_wrapper&lt;Float,storeFloat&gt;</a></div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;      (ghost[d], ((parity*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a> + row)*<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a>+col)*ghostVolumeCB[d] + <a class="code" href="structquda_1_1gauge__wrapper.html#a5261c5f7423edd78086a027390e11983">x_cb</a>, scale, scale_inv);</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;      }</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    };</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Float, <span class="keywordtype">int</span> <a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a>, <span class="keywordtype">int</span> nSpinCoarse, <a class="code" href="enum__quda_8h.html#a5e790fc01ee46c70ab9a83d1fff88d4c">QudaGaugeFieldOrder</a> order,</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    <span class="keywordtype">bool</span> native_ghost=<span class="keyword">true</span>, <span class="keyword">typename</span> storeFloat=Float, <span class="keywordtype">bool</span> use_tex=<span class="keyword">false</span>&gt;</div><div class="line"><a name="l00896"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_field_order.html">  896</a></span>&#160;      <span class="keyword">struct </span><a class="code" href="structquda_1_1gauge_1_1_field_order.html">FieldOrder</a> {</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;</div><div class="line"><a name="l00899"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_field_order.html#a951cabce05f2275a2b8d72a22ecd8223">  899</a></span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge_1_1_field_order.html#a951cabce05f2275a2b8d72a22ecd8223">volumeCB</a>;</div><div class="line"><a name="l00900"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_field_order.html#a6bf3d91a966b6d7e5ea97f99e4776b6b">  900</a></span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge_1_1_field_order.html#a6bf3d91a966b6d7e5ea97f99e4776b6b">nDim</a>;</div><div class="line"><a name="l00901"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_field_order.html#a49b862341d83841592fa206ff1875c4e">  901</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="classint__fastdiv.html">int_fastdiv</a> <a class="code" href="structquda_1_1gauge_1_1_field_order.html#a49b862341d83841592fa206ff1875c4e">geometry</a>;</div><div class="line"><a name="l00902"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_field_order.html#a9d0b6e1900d1144a7344c8c7a10aa932">  902</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="enum__quda_8h.html#a7e07bc0f2e37ab1df05cd3c87017ff33">QudaFieldLocation</a> <a class="code" href="structquda_1_1gauge_1_1_field_order.html#a9d0b6e1900d1144a7344c8c7a10aa932">location</a>;</div><div class="line"><a name="l00903"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_field_order.html#a3bb40080b86c03c5ef1d0b1eeb7c9207">  903</a></span>&#160;  <span class="keyword">static</span> constexpr <span class="keywordtype">int</span> nColorCoarse = nColor / nSpinCoarse;</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;</div><div class="line"><a name="l00905"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_field_order.html#a405b741ae30e7425881735616a32718b">  905</a></span>&#160;  <a class="code" href="structquda_1_1gauge_1_1_accessor.html">Accessor&lt;Float,nColor,order,storeFloat,use_tex&gt;</a> <a class="code" href="structquda_1_1gauge_1_1_field_order.html#a405b741ae30e7425881735616a32718b">accessor</a>;</div><div class="line"><a name="l00906"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_field_order.html#a13e953a77696e16216f7762d770d8503">  906</a></span>&#160;  <a class="code" href="structquda_1_1gauge_1_1_ghost_accessor.html">GhostAccessor&lt;Float,nColor,order,native_ghost,storeFloat,use_tex&gt;</a> <a class="code" href="structquda_1_1gauge_1_1_field_order.html#a13e953a77696e16216f7762d770d8503">ghostAccessor</a>;</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;</div><div class="line"><a name="l00912"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_field_order.html#a7240f324d6e16b49a91087647afd5f67">  912</a></span>&#160;      <a class="code" href="structquda_1_1gauge_1_1_field_order.html#a7240f324d6e16b49a91087647afd5f67">FieldOrder</a>(<a class="code" href="classquda_1_1_gauge_field.html">GaugeField</a> &amp;U, <span class="keywordtype">void</span> *gauge_=0, <span class="keywordtype">void</span> **ghost_=0)</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;      : volumeCB(U.VolumeCB()), nDim(U.Ndim()), geometry(U.Geometry()),</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    location(U.Location()),</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    accessor(U, gauge_, ghost_), ghostAccessor(U, gauge_, ghost_)</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;  {</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    <span class="keywordflow">if</span> (U.<a class="code" href="classquda_1_1_gauge_field.html#afdd2f0de51c876a311001738329083c6">Reconstruct</a>() != <a class="code" href="enum__quda_8h.html#a5cc304be12bc9174274636e1e7863841a41ab3553ef10af8aeb118f39d8f1e935">QUDA_RECONSTRUCT_NO</a>)</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;      <a class="code" href="util__quda_8h.html#af3bddfd9d113d50e8e0bbf58a35c5aac">errorQuda</a>(<span class="stringliteral">&quot;GaugeField ordering not supported with reconstruction&quot;</span>);</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;  }</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;</div><div class="line"><a name="l00921"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_field_order.html#a0ab665e186f045bda17335a40452c119">  921</a></span>&#160;      <a class="code" href="structquda_1_1gauge_1_1_field_order.html#a0ab665e186f045bda17335a40452c119">FieldOrder</a>(<span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_field_order.html">FieldOrder</a> &amp;o) : volumeCB(o.volumeCB),</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    nDim(o.nDim), geometry(o.geometry), location(o.location),</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    accessor(o.accessor), ghostAccessor(o.ghostAccessor)</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;  { }</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;</div><div class="line"><a name="l00926"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_field_order.html#a6e2082ddcb470b7ee4a2f9c9be152bbe">  926</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="structquda_1_1gauge_1_1_field_order.html#a6e2082ddcb470b7ee4a2f9c9be152bbe">resetScale</a>(<span class="keywordtype">double</span> max) {</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    accessor.<a class="code" href="structquda_1_1gauge_1_1_accessor.html#a1851487551035d00f0e9ac0f7eb63aaf">resetScale</a>(max);</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    ghostAccessor.<a class="code" href="structquda_1_1gauge_1_1_ghost_accessor.html#ac99bddfe8d81b397460c400f9de778a1">resetScale</a>(max);</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;  }</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;</div><div class="line"><a name="l00931"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_field_order.html#a23f8a30efa911802a1ca0baa648e359d">  931</a></span>&#160;  <span class="keyword">static</span> constexpr <span class="keywordtype">bool</span> <a class="code" href="structquda_1_1gauge_1_1_field_order.html#a23f8a30efa911802a1ca0baa648e359d">fixedPoint</a>() { <span class="keywordflow">return</span> fixed_point&lt;Float,storeFloat&gt;(); }</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;</div><div class="line"><a name="l00941"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_field_order.html#abb2dfbedd15829dffe365d5251fb507b">  941</a></span>&#160;  __device__ __host__ complex&lt;Float&gt; <a class="code" href="structquda_1_1gauge_1_1_field_order.html#abb2dfbedd15829dffe365d5251fb507b">operator()</a>(<span class="keywordtype">int</span> d, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> row, <span class="keywordtype">int</span> col)<span class="keyword"> const</span></div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;<span class="keyword">  </span>{ <span class="keywordflow">return</span> accessor(d,parity,x,row,col); }</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;</div><div class="line"><a name="l00952"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_field_order.html#a2bae2428a26a7777e62356680f57cbe6">  952</a></span>&#160;  __device__ __host__ <a class="code" href="structquda_1_1gauge_1_1fieldorder__wrapper.html">fieldorder_wrapper&lt;Float,storeFloat&gt;</a> operator() (<span class="keywordtype">int</span> d, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> row, <span class="keywordtype">int</span> col)</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;  { <span class="keywordflow">return</span> accessor(d,parity,x,row,col); }</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;</div><div class="line"><a name="l00963"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_field_order.html#a445fea7c209fafa7761c91c170ae69f2">  963</a></span>&#160;  __device__ __host__ complex&lt;Float&gt; <a class="code" href="structquda_1_1gauge_1_1_field_order.html#a445fea7c209fafa7761c91c170ae69f2">Ghost</a>(<span class="keywordtype">int</span> d, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> row, <span class="keywordtype">int</span> col)<span class="keyword"> const</span></div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;<span class="keyword">  </span>{ <span class="keywordflow">return</span> ghostAccessor(d,parity,x,row,col); }</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;</div><div class="line"><a name="l00974"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_field_order.html#a0cbe7ee6466c5f11475b54b3ef6114a7">  974</a></span>&#160;  __device__ __host__ <a class="code" href="structquda_1_1gauge_1_1fieldorder__wrapper.html">fieldorder_wrapper&lt;Float,storeFloat&gt;</a> <a class="code" href="structquda_1_1gauge_1_1_field_order.html#a0cbe7ee6466c5f11475b54b3ef6114a7">Ghost</a>(<span class="keywordtype">int</span> d, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> row, <span class="keywordtype">int</span> col)</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;  { <span class="keywordflow">return</span> ghostAccessor(d,parity,x,row,col); }</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;</div><div class="line"><a name="l00987"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_field_order.html#aae7557b006885d38dc998a105ff5a30d">  987</a></span>&#160;  __device__ __host__ <span class="keyword">inline</span> <span class="keyword">const</span> complex&lt;Float&gt; <a class="code" href="structquda_1_1gauge_1_1_field_order.html#aae7557b006885d38dc998a105ff5a30d">operator()</a>(<span class="keywordtype">int</span> d, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> s_row,</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;                   <span class="keywordtype">int</span> s_col, <span class="keywordtype">int</span> c_row, <span class="keywordtype">int</span> c_col)<span class="keyword"> const </span>{</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;    <span class="keywordflow">return</span> (*<span class="keyword">this</span>)(d, <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>, x, s_row*nColorCoarse + c_row, s_col*nColorCoarse + c_col);</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;  }</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;  __device__ __host__ <span class="keyword">inline</span> <a class="code" href="structquda_1_1gauge_1_1fieldorder__wrapper.html">fieldorder_wrapper&lt;Float,storeFloat&gt;</a> operator()</div><div class="line"><a name="l01003"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_field_order.html#ae04bfa642f486009d7461cf0189fef5d"> 1003</a></span>&#160;    (<span class="keywordtype">int</span> d, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> s_row, <span class="keywordtype">int</span> s_col, <span class="keywordtype">int</span> c_row, <span class="keywordtype">int</span> c_col) {</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    <span class="keywordflow">return</span> (*<span class="keyword">this</span>)(d, <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>, x, s_row*nColorCoarse + c_row, s_col*nColorCoarse + c_col);</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;  }</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;</div><div class="line"><a name="l01017"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_field_order.html#ad309ae448854ae83522584bcd04bf79f"> 1017</a></span>&#160;  __device__ __host__ <span class="keyword">inline</span> complex&lt;Float&gt; <a class="code" href="structquda_1_1gauge_1_1_field_order.html#ad309ae448854ae83522584bcd04bf79f">Ghost</a>(<span class="keywordtype">int</span> d, <span class="keywordtype">int</span> parity, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> s_row,</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;              <span class="keywordtype">int</span> s_col, <span class="keywordtype">int</span> c_row, <span class="keywordtype">int</span> c_col)<span class="keyword"> const </span>{</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;    <span class="keywordflow">return</span> Ghost(d, parity, x, s_row*nColorCoarse + c_row, s_col*nColorCoarse + c_col);</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;  }</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;  __device__ __host__ <span class="keyword">inline</span> <a class="code" href="structquda_1_1gauge_1_1fieldorder__wrapper.html">fieldorder_wrapper&lt;Float,storeFloat&gt;</a></div><div class="line"><a name="l01033"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_field_order.html#a62e60a688a5ede4e961eb88d8c9f9367"> 1033</a></span>&#160;    <a class="code" href="structquda_1_1gauge_1_1_field_order.html#a62e60a688a5ede4e961eb88d8c9f9367">Ghost</a>(<span class="keywordtype">int</span> d, <span class="keywordtype">int</span> parity, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> s_row, <span class="keywordtype">int</span> s_col, <span class="keywordtype">int</span> c_row, <span class="keywordtype">int</span> c_col) {</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;    <span class="keywordflow">return</span> Ghost(d, parity, x, s_row*nColorCoarse + c_row, s_col*nColorCoarse + c_col);</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;  }</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;        <span class="keyword">template</span> &lt;<span class="keyword">typename</span> theirFloat&gt;</div><div class="line"><a name="l01038"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_field_order.html#ae24e9e0d8b961ed6823131612b3505d8"> 1038</a></span>&#160;  __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structquda_1_1gauge_1_1_field_order.html#ae24e9e0d8b961ed6823131612b3505d8">atomicAdd</a>(<span class="keywordtype">int</span> d, <span class="keywordtype">int</span> parity, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> s_row, <span class="keywordtype">int</span> s_col,</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;              <span class="keywordtype">int</span> c_row, <span class="keywordtype">int</span> c_col, <span class="keyword">const</span> complex&lt;theirFloat&gt; &amp;val) {</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;    accessor.atomic_add(d, parity, x, s_row*nColorCoarse + c_row, s_col*nColorCoarse + c_col, val);</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;  }</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;</div><div class="line"><a name="l01044"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_field_order.html#adaeb3f73aa1115028b87be8185adde80"> 1044</a></span>&#160;  __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge_1_1_field_order.html#adaeb3f73aa1115028b87be8185adde80">Ncolor</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a>; }</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;</div><div class="line"><a name="l01047"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_field_order.html#a0e77b731093ae190daba2d7f534282bd"> 1047</a></span>&#160;  __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge_1_1_field_order.html#a0e77b731093ae190daba2d7f534282bd">Volume</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> 2*<a class="code" href="face__gauge_8cpp.html#aef2e90455f2a9cbc0eae8c4c96cd159b">volumeCB</a>; }</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;</div><div class="line"><a name="l01050"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_field_order.html#a22c0550dd86878879a57995d425d3293"> 1050</a></span>&#160;  __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge_1_1_field_order.html#a22c0550dd86878879a57995d425d3293">VolumeCB</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="face__gauge_8cpp.html#aef2e90455f2a9cbc0eae8c4c96cd159b">volumeCB</a>; }</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;</div><div class="line"><a name="l01053"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_field_order.html#af2427674e6e3dfb58946bd10a3da3d50"> 1053</a></span>&#160;  __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge_1_1_field_order.html#af2427674e6e3dfb58946bd10a3da3d50">Ndim</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> nDim; }</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;</div><div class="line"><a name="l01056"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_field_order.html#a7ce3920601ef919d1cacc0e1eda38ba5"> 1056</a></span>&#160;  __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge_1_1_field_order.html#a7ce3920601ef919d1cacc0e1eda38ba5">Geometry</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> geometry; }</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;</div><div class="line"><a name="l01059"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_field_order.html#ab3fa59bcc362fc84f2cbf16c4a285a3f"> 1059</a></span>&#160;  __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge_1_1_field_order.html#ab3fa59bcc362fc84f2cbf16c4a285a3f">NspinCoarse</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> nSpinCoarse; }</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;</div><div class="line"><a name="l01062"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_field_order.html#a5ea3a0e76116f1bf59e13f3a6cc9d088"> 1062</a></span>&#160;  __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge_1_1_field_order.html#a5ea3a0e76116f1bf59e13f3a6cc9d088">NcolorCoarse</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> nColorCoarse; }</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;</div><div class="line"><a name="l01069"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_field_order.html#a0834f59ac8a421ac7959b3a395183923"> 1069</a></span>&#160;  __host__ <span class="keywordtype">double</span> <a class="code" href="structquda_1_1gauge_1_1_field_order.html#a0834f59ac8a421ac7959b3a395183923">norm1</a>(<span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>=-1, <span class="keywordtype">bool</span> global=<span class="keyword">true</span>)<span class="keyword"> const </span>{</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;    <span class="keywordtype">double</span> nrm1 = accessor.transform_reduce(location, <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>, <a class="code" href="structquda_1_1gauge_1_1abs__.html">abs_&lt;double,storeFloat&gt;</a>(accessor.scale_inv),</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;                                                  thrust::plus&lt;double&gt;(), 0.0);</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;    <span class="keywordflow">if</span> (global) <a class="code" href="comm__quda_8h.html#ad219441b0cdddb8ddf27cf958557713e">comm_allreduce</a>(&amp;nrm1);</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;    <span class="keywordflow">return</span> nrm1;</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;  }</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;</div><div class="line"><a name="l01081"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_field_order.html#a3c47dab3b4b1df025e15360a74efad79"> 1081</a></span>&#160;  __host__ <span class="keywordtype">double</span> <a class="code" href="structquda_1_1gauge_1_1_field_order.html#a3c47dab3b4b1df025e15360a74efad79">norm2</a>(<span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>=-1, <span class="keywordtype">bool</span> global=<span class="keyword">true</span>)<span class="keyword"> const </span>{</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;    <span class="keywordtype">double</span> nrm2 = accessor.transform_reduce(location, <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>, <a class="code" href="structquda_1_1gauge_1_1square__.html">square_&lt;double,storeFloat&gt;</a>(accessor.scale_inv),</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;                                                  thrust::plus&lt;double&gt;(), 0.0);</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;    <span class="keywordflow">if</span> (global) <a class="code" href="comm__quda_8h.html#ad219441b0cdddb8ddf27cf958557713e">comm_allreduce</a>(&amp;nrm2);</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;    <span class="keywordflow">return</span> nrm2;</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;  }</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;</div><div class="line"><a name="l01093"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_field_order.html#a83413a86b675367b641675963eace5ab"> 1093</a></span>&#160;  __host__ <span class="keywordtype">double</span> <a class="code" href="structquda_1_1gauge_1_1_field_order.html#a83413a86b675367b641675963eace5ab">abs_max</a>(<span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>=-1, <span class="keywordtype">bool</span> global=<span class="keyword">true</span>)<span class="keyword"> const </span>{</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;    <span class="keywordtype">double</span> absmax = accessor.transform_reduce(location, <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>, <a class="code" href="structquda_1_1gauge_1_1abs__.html">abs_&lt;Float,storeFloat&gt;</a>(accessor.scale_inv),</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;                                                    thrust::maximum&lt;Float&gt;(), 0.0);</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;    <span class="keywordflow">if</span> (global) <a class="code" href="comm__quda_8h.html#abdf7d13f471c3c6b39e142c09fb130b4">comm_allreduce_max</a>(&amp;absmax);</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;    <span class="keywordflow">return</span> absmax;</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;  }</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;</div><div class="line"><a name="l01105"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_field_order.html#a342cfe197aee7d43e06d82700e7a101f"> 1105</a></span>&#160;  __host__ <span class="keywordtype">double</span> <a class="code" href="structquda_1_1gauge_1_1_field_order.html#a342cfe197aee7d43e06d82700e7a101f">abs_min</a>(<span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>=-1, <span class="keywordtype">bool</span> global=<span class="keyword">true</span>)<span class="keyword"> const </span>{</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;    <span class="keywordtype">double</span> absmin = accessor.transform_reduce(location, <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>, <a class="code" href="structquda_1_1gauge_1_1abs__.html">abs_&lt;Float,storeFloat&gt;</a>(accessor.scale_inv),</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;                                                    thrust::minimum&lt;Float&gt;(), std::numeric_limits&lt;double&gt;::max());</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;    <span class="keywordflow">if</span> (global) <a class="code" href="comm__quda_8h.html#aadfcf98463bceb3dc953a0b0d815179a">comm_allreduce_min</a>(&amp;absmin);</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;    <span class="keywordflow">return</span> absmin;</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;  }</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;</div><div class="line"><a name="l01113"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_field_order.html#a4f0b72d616f59624b2701360dffee3b7"> 1113</a></span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="structquda_1_1gauge_1_1_field_order.html#a4f0b72d616f59624b2701360dffee3b7">Bytes</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(<a class="code" href="face__gauge_8cpp.html#aef2e90455f2a9cbc0eae8c4c96cd159b">volumeCB</a>) * nColor * nColor * 2ll * <span class="keyword">sizeof</span>(storeFloat); }</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;      };</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;      <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> N, <span class="keyword">typename</span> Float, QudaGhostExchange ghostExchange_, QudaStaggeredPhase = QUDA_STAGGERED_PHASE_NO&gt;</div><div class="line"><a name="l01125"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct.html"> 1125</a></span>&#160;      <span class="keyword">struct </span><a class="code" href="structquda_1_1gauge_1_1_reconstruct.html">Reconstruct</a> {</div><div class="line"><a name="l01126"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct.html#aef8b5d92142fdb20b3b99dcfe90831f8"> 1126</a></span>&#160;        <span class="keyword">using</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct.html#aef8b5d92142fdb20b3b99dcfe90831f8">real</a> = <span class="keyword">typename</span> <a class="code" href="structquda_1_1mapper.html">mapper&lt;Float&gt;::type</a>;</div><div class="line"><a name="l01127"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct.html#a1455561f760b407f46cd1979e13b3ac2"> 1127</a></span>&#160;        <span class="keyword">using</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct.html#a1455561f760b407f46cd1979e13b3ac2">complex</a> = <a class="code" href="structquda_1_1gauge_1_1_reconstruct.html#a1455561f760b407f46cd1979e13b3ac2">complex&lt;real&gt;</a>;</div><div class="line"><a name="l01128"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct.html#a658db6f00e99c315aa161a00d657bad3"> 1128</a></span>&#160;        <a class="code" href="structquda_1_1gauge_1_1_reconstruct.html#aef8b5d92142fdb20b3b99dcfe90831f8">real</a> <a class="code" href="structquda_1_1gauge_1_1_reconstruct.html#a658db6f00e99c315aa161a00d657bad3">scale</a>;</div><div class="line"><a name="l01129"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct.html#ada6ef90c3eab849b350209967719dee2"> 1129</a></span>&#160;        <a class="code" href="structquda_1_1gauge_1_1_reconstruct.html#aef8b5d92142fdb20b3b99dcfe90831f8">real</a> <a class="code" href="structquda_1_1gauge_1_1_reconstruct.html#ada6ef90c3eab849b350209967719dee2">scale_inv</a>;</div><div class="line"><a name="l01130"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct.html#aaeef88dac7ab5b2f30e0b552fab560aa"> 1130</a></span>&#160;        <a class="code" href="structquda_1_1gauge_1_1_reconstruct.html#aaeef88dac7ab5b2f30e0b552fab560aa">Reconstruct</a>(<span class="keyword">const</span> <a class="code" href="classquda_1_1_gauge_field.html">GaugeField</a> &amp;u) : scale(u.LinkMax()), scale_inv(1.0 / scale) {}</div><div class="line"><a name="l01131"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct.html#a0eb9b69b6dc8c5498ff6938279ddb8f6"> 1131</a></span>&#160;        <a class="code" href="structquda_1_1gauge_1_1_reconstruct.html#a0eb9b69b6dc8c5498ff6938279ddb8f6">Reconstruct</a>(<span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct.html">Reconstruct&lt;N, Float, ghostExchange_&gt;</a> &amp;recon) : scale(recon.scale), scale_inv(recon.scale_inv)</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;        {</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;        }</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;</div><div class="line"><a name="l01135"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct.html#adb17cb7fb63831b2d88e784be6f9c30f"> 1135</a></span>&#160;        __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct.html#adb17cb7fb63831b2d88e784be6f9c30f">Pack</a>(<a class="code" href="structquda_1_1gauge_1_1_reconstruct.html#aef8b5d92142fdb20b3b99dcfe90831f8">real</a> <a class="code" href="staggered__invert__test_8cpp.html#af3806a0fd9f2d8dd7a627e9571984d33">out</a>[N], <span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct.html#a1455561f760b407f46cd1979e13b3ac2">complex</a> <a class="code" href="staggered__invert__test_8cpp.html#af61ff6c9724eb687e3057b6a1a977487">in</a>[N / 2], <span class="keywordtype">int</span> idx)<span class="keyword"> const</span></div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;<span class="keyword">        </span>{</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="structquda_1_1is_fixed.html">isFixed&lt;Float&gt;::value</a>) {</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;<span class="preprocessor">#pragma unroll</span></div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; N / 2; i++) {</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;              <a class="code" href="staggered__invert__test_8cpp.html#af3806a0fd9f2d8dd7a627e9571984d33">out</a>[2 * i + 0] = scale_inv * <a class="code" href="staggered__invert__test_8cpp.html#af61ff6c9724eb687e3057b6a1a977487">in</a>[i].real();</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;              <a class="code" href="staggered__invert__test_8cpp.html#af3806a0fd9f2d8dd7a627e9571984d33">out</a>[2 * i + 1] = scale_inv * <a class="code" href="staggered__invert__test_8cpp.html#af61ff6c9724eb687e3057b6a1a977487">in</a>[i].imag();</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;            }</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;          } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;<span class="preprocessor">#pragma unroll</span></div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; N / 2; i++) {</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;              <a class="code" href="staggered__invert__test_8cpp.html#af3806a0fd9f2d8dd7a627e9571984d33">out</a>[2 * i + 0] = <a class="code" href="staggered__invert__test_8cpp.html#af61ff6c9724eb687e3057b6a1a977487">in</a>[i].real();</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;              <a class="code" href="staggered__invert__test_8cpp.html#af3806a0fd9f2d8dd7a627e9571984d33">out</a>[2 * i + 1] = <a class="code" href="staggered__invert__test_8cpp.html#af61ff6c9724eb687e3057b6a1a977487">in</a>[i].imag();</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;            }</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;          }</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;        }</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;        <span class="keyword">template</span> &lt;<span class="keyword">typename</span> I&gt;</div><div class="line"><a name="l01153"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct.html#aa79bdab5a60b084dfd2c9d0856956bad"> 1153</a></span>&#160;        __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct.html#aa79bdab5a60b084dfd2c9d0856956bad">Unpack</a>(<a class="code" href="structquda_1_1gauge_1_1_reconstruct.html#a1455561f760b407f46cd1979e13b3ac2">complex</a> <a class="code" href="staggered__invert__test_8cpp.html#af3806a0fd9f2d8dd7a627e9571984d33">out</a>[N / 2], <span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct.html#aef8b5d92142fdb20b3b99dcfe90831f8">real</a> <a class="code" href="staggered__invert__test_8cpp.html#af61ff6c9724eb687e3057b6a1a977487">in</a>[N], <span class="keywordtype">int</span> idx, <span class="keywordtype">int</span> dir, <a class="code" href="structquda_1_1gauge_1_1_reconstruct.html#aef8b5d92142fdb20b3b99dcfe90831f8">real</a> <a class="code" href="structquda_1_1gauge__wrapper.html#a953756c13d685eacf355434ee7897a3c">phase</a>,</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;                                               <span class="keyword">const</span> I *<a class="code" href="covdev__test_8cpp.html#a7facd8f2fefe0ccaea751dff2592badb">X</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> *<a class="code" href="interface__quda_8cpp.html#a67b63ae29fb23d1a034f9ba7e0787745">R</a>)<span class="keyword"> const</span></div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;<span class="keyword">        </span>{</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="structquda_1_1is_fixed.html">isFixed&lt;Float&gt;::value</a>) {</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;<span class="preprocessor">#pragma unroll</span></div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; N / 2; i++) { <a class="code" href="staggered__invert__test_8cpp.html#af3806a0fd9f2d8dd7a627e9571984d33">out</a>[i] = scale * <a class="code" href="structquda_1_1gauge_1_1_reconstruct.html#a1455561f760b407f46cd1979e13b3ac2">complex</a>(<a class="code" href="staggered__invert__test_8cpp.html#af61ff6c9724eb687e3057b6a1a977487">in</a>[2 * i + 0], <a class="code" href="staggered__invert__test_8cpp.html#af61ff6c9724eb687e3057b6a1a977487">in</a>[2 * i + 1]); }</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;          } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;<span class="preprocessor">#pragma unroll</span></div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; N / 2; i++) { <a class="code" href="staggered__invert__test_8cpp.html#af3806a0fd9f2d8dd7a627e9571984d33">out</a>[i] = <a class="code" href="structquda_1_1gauge_1_1_reconstruct.html#a1455561f760b407f46cd1979e13b3ac2">complex</a>(<a class="code" href="staggered__invert__test_8cpp.html#af61ff6c9724eb687e3057b6a1a977487">in</a>[2 * i + 0], <a class="code" href="staggered__invert__test_8cpp.html#af61ff6c9724eb687e3057b6a1a977487">in</a>[2 * i + 1]); }</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;          }</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;        }</div><div class="line"><a name="l01164"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct.html#a9edb9b70ed2cd0efb83d7bb62376475d"> 1164</a></span>&#160;        __device__ __host__ <span class="keyword">inline</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct.html#aef8b5d92142fdb20b3b99dcfe90831f8">real</a> <a class="code" href="structquda_1_1gauge_1_1_reconstruct.html#a9edb9b70ed2cd0efb83d7bb62376475d">getPhase</a>(<span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct.html#a1455561f760b407f46cd1979e13b3ac2">complex</a> <a class="code" href="staggered__invert__test_8cpp.html#af61ff6c9724eb687e3057b6a1a977487">in</a>[N / 2])<span class="keyword"> const </span>{ <span class="keywordflow">return</span> 0; }</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;      };</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;      <span class="keyword">template</span> &lt;QudaGhostExchange ghostExchange_, <span class="keyword">typename</span> T, <span class="keyword">typename</span> I&gt;</div><div class="line"><a name="l01179"></a><span class="lineno"><a class="line" href="namespacequda_1_1gauge.html#a4850cc93d92c64fa56c2d2baaac537fe"> 1179</a></span>&#160;      __device__ __host__ <span class="keyword">inline</span> T <a class="code" href="namespacequda_1_1gauge.html#a4850cc93d92c64fa56c2d2baaac537fe">timeBoundary</a>(<span class="keywordtype">int</span> idx, <span class="keyword">const</span> I <a class="code" href="covdev__test_8cpp.html#a7facd8f2fefe0ccaea751dff2592badb">X</a>[<a class="code" href="quda__constants_8h.html#aa69925e50554e0ea81dd89fdcb572bbc">QUDA_MAX_DIM</a>], <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="interface__quda_8cpp.html#a67b63ae29fb23d1a034f9ba7e0787745">R</a>[QUDA_MAX_DIM],</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;          T tBoundary, T scale, <span class="keywordtype">int</span> firstTimeSliceBound, <span class="keywordtype">int</span> lastTimeSliceBound, <span class="keywordtype">bool</span> isFirstTimeSlice,</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;          <span class="keywordtype">bool</span> isLastTimeSlice, <a class="code" href="enum__quda_8h.html#a744e553dee90a2671fe00aba878c315b">QudaGhostExchange</a> ghostExchange = <a class="code" href="enum__quda_8h.html#a93131cceecad27ce4b964cb184e8d47aa505f87642177d56c25870c8a3a82c76e">QUDA_GHOST_EXCHANGE_NO</a>)</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;      {</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;        <span class="comment">// MWTODO: should this return tBoundary : scale or tBoundary*scale : scale</span></div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;        <span class="keywordflow">if</span> (ghostExchange_ == <a class="code" href="enum__quda_8h.html#a93131cceecad27ce4b964cb184e8d47aaab94b36fc680dd39f976636dac350e53">QUDA_GHOST_EXCHANGE_PAD</a></div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;            || (ghostExchange_ == <a class="code" href="enum__quda_8h.html#a93131cceecad27ce4b964cb184e8d47aa8ce4a4e003d703610a08578f413760c6">QUDA_GHOST_EXCHANGE_INVALID</a> &amp;&amp; ghostExchange != <a class="code" href="enum__quda_8h.html#a93131cceecad27ce4b964cb184e8d47aa31e2396004ebee77471a7efacb6cde4e">QUDA_GHOST_EXCHANGE_EXTENDED</a>)) {</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;          <span class="keywordflow">if</span> (idx &gt;= firstTimeSliceBound) { <span class="comment">// halo region on the first time slice</span></div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;            <span class="keywordflow">return</span> isFirstTimeSlice ? tBoundary : scale;</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (idx &gt;= lastTimeSliceBound) { <span class="comment">// last link on the last time slice</span></div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;            <span class="keywordflow">return</span> isLastTimeSlice ? tBoundary : scale;</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;          } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;            <span class="keywordflow">return</span> scale;</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;          }</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ghostExchange_ == <a class="code" href="enum__quda_8h.html#a93131cceecad27ce4b964cb184e8d47aa31e2396004ebee77471a7efacb6cde4e">QUDA_GHOST_EXCHANGE_EXTENDED</a></div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;            || (ghostExchange_ == <a class="code" href="enum__quda_8h.html#a93131cceecad27ce4b964cb184e8d47aa8ce4a4e003d703610a08578f413760c6">QUDA_GHOST_EXCHANGE_INVALID</a> &amp;&amp; ghostExchange == <a class="code" href="enum__quda_8h.html#a93131cceecad27ce4b964cb184e8d47aa31e2396004ebee77471a7efacb6cde4e">QUDA_GHOST_EXCHANGE_EXTENDED</a>)) {</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;          <span class="keywordflow">if</span> (idx &gt;= (<a class="code" href="interface__quda_8cpp.html#a67b63ae29fb23d1a034f9ba7e0787745">R</a>[3] - 1) * <a class="code" href="covdev__test_8cpp.html#a7facd8f2fefe0ccaea751dff2592badb">X</a>[0] * <a class="code" href="covdev__test_8cpp.html#a7facd8f2fefe0ccaea751dff2592badb">X</a>[1] * <a class="code" href="covdev__test_8cpp.html#a7facd8f2fefe0ccaea751dff2592badb">X</a>[2] / 2 &amp;&amp; idx &lt; <a class="code" href="interface__quda_8cpp.html#a67b63ae29fb23d1a034f9ba7e0787745">R</a>[3] * <a class="code" href="covdev__test_8cpp.html#a7facd8f2fefe0ccaea751dff2592badb">X</a>[0] * <a class="code" href="covdev__test_8cpp.html#a7facd8f2fefe0ccaea751dff2592badb">X</a>[1] * <a class="code" href="covdev__test_8cpp.html#a7facd8f2fefe0ccaea751dff2592badb">X</a>[2] / 2) {</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;            <span class="comment">// the boundary condition is on the R[3]-1 time slice</span></div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;            <span class="keywordflow">return</span> isFirstTimeSlice ? tBoundary : scale;</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (idx &gt;= (<a class="code" href="covdev__test_8cpp.html#a7facd8f2fefe0ccaea751dff2592badb">X</a>[3] - <a class="code" href="interface__quda_8cpp.html#a67b63ae29fb23d1a034f9ba7e0787745">R</a>[3] - 1) * <a class="code" href="covdev__test_8cpp.html#a7facd8f2fefe0ccaea751dff2592badb">X</a>[0] * <a class="code" href="covdev__test_8cpp.html#a7facd8f2fefe0ccaea751dff2592badb">X</a>[1] * <a class="code" href="covdev__test_8cpp.html#a7facd8f2fefe0ccaea751dff2592badb">X</a>[2] / 2 &amp;&amp; idx &lt; (<a class="code" href="covdev__test_8cpp.html#a7facd8f2fefe0ccaea751dff2592badb">X</a>[3] - <a class="code" href="interface__quda_8cpp.html#a67b63ae29fb23d1a034f9ba7e0787745">R</a>[3]) * <a class="code" href="covdev__test_8cpp.html#a7facd8f2fefe0ccaea751dff2592badb">X</a>[0] * <a class="code" href="covdev__test_8cpp.html#a7facd8f2fefe0ccaea751dff2592badb">X</a>[1] * <a class="code" href="covdev__test_8cpp.html#a7facd8f2fefe0ccaea751dff2592badb">X</a>[2] / 2) {</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;            <span class="comment">// the boundary condition lies on the X[3]-R[3]-1 time slice</span></div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;            <span class="keywordflow">return</span> isLastTimeSlice ? tBoundary : scale;</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;          } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;            <span class="keywordflow">return</span> scale;</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;          }</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;        }</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;        <span class="keywordflow">return</span> scale;</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;      }</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;      <span class="comment">// not actually used - here for reference</span></div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;      <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Float, <span class="keyword">typename</span> I&gt;</div><div class="line"><a name="l01212"></a><span class="lineno"><a class="line" href="namespacequda_1_1gauge.html#aff68c08526ea52e23cc12f9c23298eff"> 1212</a></span>&#160;      __device__ __host__ <span class="keyword">inline</span> Float <a class="code" href="namespacequda_1_1gauge.html#aff68c08526ea52e23cc12f9c23298eff">milcStaggeredPhase</a>(<span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> x[], <span class="keyword">const</span> I <a class="code" href="interface__quda_8cpp.html#a67b63ae29fb23d1a034f9ba7e0787745">R</a>[]) {</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;        <span class="comment">// could consider non-extended variant too?</span></div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;        Float sign = <span class="keyword">static_cast&lt;</span>Float<span class="keyword">&gt;</span>(1.0);</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;  <span class="keywordflow">switch</span> (dim) {</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;  <span class="keywordflow">case</span> 0: <span class="keywordflow">if</span> ( ((x[3] - R[3]) &amp; 1) != 0)                             sign = -static_cast&lt;Float&gt;(1.0); <span class="keywordflow">break</span>;</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;  <span class="keywordflow">case</span> 1: <span class="keywordflow">if</span> ( ((x[0] - R[0] + x[3] - R[3]) &amp; 1) != 0)               sign = -static_cast&lt;Float&gt;(1.0); <span class="keywordflow">break</span>;</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;  <span class="keywordflow">case</span> 2: <span class="keywordflow">if</span> ( ((x[0] - R[0] + x[1] - R[1] + x[3] - R[3]) &amp; 1) != 0) sign = -static_cast&lt;Float&gt;(1.0); <span class="keywordflow">break</span>;</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;  }</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;  <span class="keywordflow">return</span> sign;</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;      }</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;</div><div class="line"><a name="l01230"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4.html"> 1230</a></span>&#160;      <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Float, QudaGhostExchange ghostExchange_&gt; <span class="keyword">struct </span><a class="code" href="structquda_1_1gauge_1_1_reconstruct.html">Reconstruct</a>&lt;12, Float, ghostExchange_&gt; {</div><div class="line"><a name="l01231"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4.html#adaf5b77c6ad29008a19f9992f0839888"> 1231</a></span>&#160;        <span class="keyword">using</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4.html#adaf5b77c6ad29008a19f9992f0839888">real</a> = <span class="keyword">typename</span> <a class="code" href="structquda_1_1mapper.html">mapper&lt;Float&gt;::type</a>;</div><div class="line"><a name="l01232"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4.html#ae0365c6690ab9549435991d8473cf4be"> 1232</a></span>&#160;        <span class="keyword">using</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4.html#ae0365c6690ab9549435991d8473cf4be">complex</a> = <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4.html#ae0365c6690ab9549435991d8473cf4be">complex&lt;real&gt;</a>;</div><div class="line"><a name="l01233"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4.html#a71fbea07d9991735c8a338510ec1beb1"> 1233</a></span>&#160;        <span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4.html#adaf5b77c6ad29008a19f9992f0839888">real</a> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4.html#a71fbea07d9991735c8a338510ec1beb1">anisotropy</a>;</div><div class="line"><a name="l01234"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4.html#a0074e54be2603260fa5d04ebe5dddcf6"> 1234</a></span>&#160;        <span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4.html#adaf5b77c6ad29008a19f9992f0839888">real</a> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4.html#a0074e54be2603260fa5d04ebe5dddcf6">tBoundary</a>;</div><div class="line"><a name="l01235"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4.html#a56488c48c4dff8853bbba14585b6168b"> 1235</a></span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4.html#a56488c48c4dff8853bbba14585b6168b">firstTimeSliceBound</a>;</div><div class="line"><a name="l01236"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4.html#a5bbd537170aa21cafcada1c9fbf5fae8"> 1236</a></span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4.html#a5bbd537170aa21cafcada1c9fbf5fae8">lastTimeSliceBound</a>;</div><div class="line"><a name="l01237"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4.html#ad06b6fa935ec8cf6139bf00bb9c3ee6d"> 1237</a></span>&#160;        <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4.html#ad06b6fa935ec8cf6139bf00bb9c3ee6d">isFirstTimeSlice</a>;</div><div class="line"><a name="l01238"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4.html#a65004de43d6ffb3c5449966151df0ac8"> 1238</a></span>&#160;        <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4.html#a65004de43d6ffb3c5449966151df0ac8">isLastTimeSlice</a>;</div><div class="line"><a name="l01239"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4.html#addf40187cfe25214cd310c836ba93406"> 1239</a></span>&#160;        <a class="code" href="enum__quda_8h.html#a744e553dee90a2671fe00aba878c315b">QudaGhostExchange</a> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4.html#addf40187cfe25214cd310c836ba93406">ghostExchange</a>;</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;</div><div class="line"><a name="l01241"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4.html#a68c4d900e0c10e653892f0722fcf46b7"> 1241</a></span>&#160;        <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4.html#a68c4d900e0c10e653892f0722fcf46b7">Reconstruct</a>(<span class="keyword">const</span> <a class="code" href="classquda_1_1_gauge_field.html">GaugeField</a> &amp;u) :</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;          anisotropy(u.Anisotropy()),</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;          tBoundary(static_cast&lt;<a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4.html#adaf5b77c6ad29008a19f9992f0839888">real</a>&gt;(u.TBoundary())),</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;          firstTimeSliceBound(u.VolumeCB()),</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;          lastTimeSliceBound((u.<a class="code" href="covdev__test_8cpp.html#a7facd8f2fefe0ccaea751dff2592badb">X</a>()[3] - 1) * u.<a class="code" href="covdev__test_8cpp.html#a7facd8f2fefe0ccaea751dff2592badb">X</a>()[0] * u.<a class="code" href="covdev__test_8cpp.html#a7facd8f2fefe0ccaea751dff2592badb">X</a>()[1] * u.<a class="code" href="covdev__test_8cpp.html#a7facd8f2fefe0ccaea751dff2592badb">X</a>()[2] / 2),</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;          isFirstTimeSlice(<a class="code" href="comm__quda_8h.html#a6c081bfedfe939a19ca8acd025864f14">comm_coord</a>(3) == 0 ? true : false),</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;          isLastTimeSlice(<a class="code" href="comm__quda_8h.html#a6c081bfedfe939a19ca8acd025864f14">comm_coord</a>(3) == <a class="code" href="comm__quda_8h.html#ab6471b31d5a7f3f80e6561382c09b3b5">comm_dim</a>(3) - 1 ? true : false),</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;          ghostExchange(u.GhostExchange())</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;        {</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;        }</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;</div><div class="line"><a name="l01252"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4.html#ae5bb0c1f7d00259ed7d72b29e58d3920"> 1252</a></span>&#160;        <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4.html#ae5bb0c1f7d00259ed7d72b29e58d3920">Reconstruct</a>(<span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4.html">Reconstruct&lt;12, Float, ghostExchange_&gt;</a> &amp;recon) :</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;            anisotropy(recon.anisotropy),</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;            tBoundary(recon.tBoundary),</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;            firstTimeSliceBound(recon.firstTimeSliceBound),</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;            lastTimeSliceBound(recon.lastTimeSliceBound),</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;            isFirstTimeSlice(recon.isFirstTimeSlice),</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;            isLastTimeSlice(recon.isLastTimeSlice),</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;            ghostExchange(recon.ghostExchange)</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;        {</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;        }</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;</div><div class="line"><a name="l01263"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4.html#a420afc0023304fad223cb2936560fae6"> 1263</a></span>&#160;        __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4.html#a420afc0023304fad223cb2936560fae6">Pack</a>(<a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4.html#adaf5b77c6ad29008a19f9992f0839888">real</a> <a class="code" href="staggered__invert__test_8cpp.html#af3806a0fd9f2d8dd7a627e9571984d33">out</a>[12], <span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4.html#ae0365c6690ab9549435991d8473cf4be">complex</a> <a class="code" href="staggered__invert__test_8cpp.html#af61ff6c9724eb687e3057b6a1a977487">in</a>[9], <span class="keywordtype">int</span> idx)<span class="keyword"> const</span></div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;<span class="keyword">        </span>{</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;<span class="preprocessor">#pragma unroll</span></div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 6; i++) {</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;            out[2 * i + 0] = in[i].real();</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;            out[2 * i + 1] = in[i].imag();</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;          }</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;        }</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;        <span class="keyword">template</span> &lt;<span class="keyword">typename</span> I&gt;</div><div class="line"><a name="l01273"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4.html#a24aa93fcbd23e5af8ac88d46a0e33a5f"> 1273</a></span>&#160;        __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4.html#a24aa93fcbd23e5af8ac88d46a0e33a5f">Unpack</a>(<a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4.html#ae0365c6690ab9549435991d8473cf4be">complex</a> <a class="code" href="staggered__invert__test_8cpp.html#af3806a0fd9f2d8dd7a627e9571984d33">out</a>[9], <span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4.html#adaf5b77c6ad29008a19f9992f0839888">real</a> <a class="code" href="staggered__invert__test_8cpp.html#af61ff6c9724eb687e3057b6a1a977487">in</a>[12], <span class="keywordtype">int</span> idx, <span class="keywordtype">int</span> dir, <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4.html#adaf5b77c6ad29008a19f9992f0839888">real</a> <a class="code" href="structquda_1_1gauge__wrapper.html#a953756c13d685eacf355434ee7897a3c">phase</a>,</div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;                                               <span class="keyword">const</span> I *<a class="code" href="covdev__test_8cpp.html#a7facd8f2fefe0ccaea751dff2592badb">X</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> *<a class="code" href="interface__quda_8cpp.html#a67b63ae29fb23d1a034f9ba7e0787745">R</a>)<span class="keyword"> const</span></div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;<span class="keyword">        </span>{</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;<span class="preprocessor">#pragma unroll</span></div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 6; i++) out[i] = <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4.html#ae0365c6690ab9549435991d8473cf4be">complex</a>(in[2 * i + 0], in[2 * i + 1]);</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;          <span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4.html#adaf5b77c6ad29008a19f9992f0839888">real</a> u0 = dir &lt; 3 ?</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;            <a class="code" href="deflated__invert__test_8cpp.html#a2e99a9d1409689109095858dc2912d40">anisotropy</a> :</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;            timeBoundary&lt;ghostExchange_&gt;(idx, <a class="code" href="covdev__test_8cpp.html#a7facd8f2fefe0ccaea751dff2592badb">X</a>, <a class="code" href="interface__quda_8cpp.html#a67b63ae29fb23d1a034f9ba7e0787745">R</a>, tBoundary, <span class="keyword">static_cast&lt;</span><a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4.html#adaf5b77c6ad29008a19f9992f0839888">real</a><span class="keyword">&gt;</span>(1.0), firstTimeSliceBound,</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;                                         lastTimeSliceBound, isFirstTimeSlice, isLastTimeSlice, ghostExchange);</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;          <span class="comment">// out[6] = u0*conj(out[1]*out[5] - out[2]*out[4]);</span></div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;          out[6] = <a class="code" href="namespacequda.html#a070af9181985dd8169b9b5c9eebe65bf">cmul</a>(out[2], out[4]);</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;          out[6] = <a class="code" href="namespacequda.html#a3f32b5e8a1310c9f74c174f543591e3b">cmac</a>(out[1], out[5], -out[6]);</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;          out[6] = u0 * <a class="code" href="namespacequda.html#a043738f16cdeb082fa1a5158fbad36b3">conj</a>(out[6]);</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;          <span class="comment">// out[7] = u0*conj(out[2]*out[3] - out[0]*out[5]);</span></div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;          out[7] = <a class="code" href="namespacequda.html#a070af9181985dd8169b9b5c9eebe65bf">cmul</a>(out[0], out[5]);</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;          out[7] = <a class="code" href="namespacequda.html#a3f32b5e8a1310c9f74c174f543591e3b">cmac</a>(out[2], out[3], -out[7]);</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;          out[7] = u0 * <a class="code" href="namespacequda.html#a043738f16cdeb082fa1a5158fbad36b3">conj</a>(out[7]);</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;</div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;          <span class="comment">// out[8] = u0*conj(out[0]*out[4] - out[1]*out[3]);</span></div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;          out[8] = <a class="code" href="namespacequda.html#a070af9181985dd8169b9b5c9eebe65bf">cmul</a>(out[1], out[3]);</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;          out[8] = <a class="code" href="namespacequda.html#a3f32b5e8a1310c9f74c174f543591e3b">cmac</a>(out[0], out[4], -out[8]);</div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;          out[8] = u0 * <a class="code" href="namespacequda.html#a043738f16cdeb082fa1a5158fbad36b3">conj</a>(out[8]);</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;        }</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;</div><div class="line"><a name="l01300"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4.html#afe71729cdf3575b099efc6c058cec93e"> 1300</a></span>&#160;        __device__ __host__ <span class="keyword">inline</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4.html#adaf5b77c6ad29008a19f9992f0839888">real</a> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4.html#afe71729cdf3575b099efc6c058cec93e">getPhase</a>(<span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4.html#ae0365c6690ab9549435991d8473cf4be">complex</a> <a class="code" href="staggered__invert__test_8cpp.html#af61ff6c9724eb687e3057b6a1a977487">in</a>[9]) { <span class="keywordflow">return</span> 0; }</div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;      };</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;</div><div class="line"><a name="l01313"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct_3_0111_00_01_float_00_01ghost_exchange___01_4.html"> 1313</a></span>&#160;      <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Float, QudaGhostExchange ghostExchange_&gt; <span class="keyword">struct </span><a class="code" href="structquda_1_1gauge_1_1_reconstruct.html">Reconstruct</a>&lt;11, Float, ghostExchange_&gt; {</div><div class="line"><a name="l01314"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct_3_0111_00_01_float_00_01ghost_exchange___01_4.html#a8ef64635ed0c708b113903b9f3c09be1"> 1314</a></span>&#160;        <span class="keyword">using</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0111_00_01_float_00_01ghost_exchange___01_4.html#a8ef64635ed0c708b113903b9f3c09be1">real</a> = <span class="keyword">typename</span> <a class="code" href="structquda_1_1mapper.html">mapper&lt;Float&gt;::type</a>;</div><div class="line"><a name="l01315"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct_3_0111_00_01_float_00_01ghost_exchange___01_4.html#a4cef3ff2f952dec4fea1092412cb3b5a"> 1315</a></span>&#160;        <span class="keyword">using</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0111_00_01_float_00_01ghost_exchange___01_4.html#a4cef3ff2f952dec4fea1092412cb3b5a">complex</a> = <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0111_00_01_float_00_01ghost_exchange___01_4.html#a4cef3ff2f952dec4fea1092412cb3b5a">complex&lt;real&gt;</a>;</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;</div><div class="line"><a name="l01317"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct_3_0111_00_01_float_00_01ghost_exchange___01_4.html#af4aae736c3ca00f5398a0f1fe475f9a3"> 1317</a></span>&#160;        <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0111_00_01_float_00_01ghost_exchange___01_4.html#af4aae736c3ca00f5398a0f1fe475f9a3">Reconstruct</a>(<span class="keyword">const</span> <a class="code" href="classquda_1_1_gauge_field.html">GaugeField</a> &amp;u) { ; }</div><div class="line"><a name="l01318"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct_3_0111_00_01_float_00_01ghost_exchange___01_4.html#a357662aa85267630e34d08dbb0d00d30"> 1318</a></span>&#160;        <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0111_00_01_float_00_01ghost_exchange___01_4.html#a357662aa85267630e34d08dbb0d00d30">Reconstruct</a>(<span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0111_00_01_float_00_01ghost_exchange___01_4.html">Reconstruct&lt;11, Float, ghostExchange_&gt;</a> &amp;recon) {}</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;</div><div class="line"><a name="l01320"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct_3_0111_00_01_float_00_01ghost_exchange___01_4.html#a1a8bc564241b3503bdd1b7097fa45c1d"> 1320</a></span>&#160;        __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0111_00_01_float_00_01ghost_exchange___01_4.html#a1a8bc564241b3503bdd1b7097fa45c1d">Pack</a>(<a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0111_00_01_float_00_01ghost_exchange___01_4.html#a8ef64635ed0c708b113903b9f3c09be1">real</a> <a class="code" href="staggered__invert__test_8cpp.html#af3806a0fd9f2d8dd7a627e9571984d33">out</a>[10], <span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0111_00_01_float_00_01ghost_exchange___01_4.html#a4cef3ff2f952dec4fea1092412cb3b5a">complex</a> <a class="code" href="staggered__invert__test_8cpp.html#af61ff6c9724eb687e3057b6a1a977487">in</a>[9], <span class="keywordtype">int</span> idx)<span class="keyword"> const</span></div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;<span class="keyword">        </span>{</div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;<span class="preprocessor">#pragma unroll</span></div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 2; i++) {</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;            out[2 * i + 0] = in[i + 1].real();</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;            out[2 * i + 1] = in[i + 1].imag();</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;          }</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;          out[4] = in[5].real();</div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;          out[5] = in[5].imag();</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;          out[6] = in[0].imag();</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;          out[7] = in[4].imag();</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;          out[8] = in[8].imag();</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;          out[9] = 0.0;</div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;        }</div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;</div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;        <span class="keyword">template</span> &lt;<span class="keyword">typename</span> I&gt;</div><div class="line"><a name="l01336"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct_3_0111_00_01_float_00_01ghost_exchange___01_4.html#ad7042476e0097187d0c766a6d7e434c8"> 1336</a></span>&#160;        __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0111_00_01_float_00_01ghost_exchange___01_4.html#ad7042476e0097187d0c766a6d7e434c8">Unpack</a>(<a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0111_00_01_float_00_01ghost_exchange___01_4.html#a4cef3ff2f952dec4fea1092412cb3b5a">complex</a> <a class="code" href="staggered__invert__test_8cpp.html#af3806a0fd9f2d8dd7a627e9571984d33">out</a>[9], <span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0111_00_01_float_00_01ghost_exchange___01_4.html#a8ef64635ed0c708b113903b9f3c09be1">real</a> <a class="code" href="staggered__invert__test_8cpp.html#af61ff6c9724eb687e3057b6a1a977487">in</a>[10], <span class="keywordtype">int</span> idx, <span class="keywordtype">int</span> dir, <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0111_00_01_float_00_01ghost_exchange___01_4.html#a8ef64635ed0c708b113903b9f3c09be1">real</a> <a class="code" href="structquda_1_1gauge__wrapper.html#a953756c13d685eacf355434ee7897a3c">phase</a>,</div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;                                               <span class="keyword">const</span> I *<a class="code" href="covdev__test_8cpp.html#a7facd8f2fefe0ccaea751dff2592badb">X</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> *<a class="code" href="interface__quda_8cpp.html#a67b63ae29fb23d1a034f9ba7e0787745">R</a>)<span class="keyword"> const</span></div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;<span class="keyword">        </span>{</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;          out[0] = <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0111_00_01_float_00_01ghost_exchange___01_4.html#a4cef3ff2f952dec4fea1092412cb3b5a">complex</a>(0.0, in[6]);</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;          out[1] = <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0111_00_01_float_00_01ghost_exchange___01_4.html#a4cef3ff2f952dec4fea1092412cb3b5a">complex</a>(in[0], in[1]);</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;          out[2] = <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0111_00_01_float_00_01ghost_exchange___01_4.html#a4cef3ff2f952dec4fea1092412cb3b5a">complex</a>(in[2], in[3]);</div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;          out[3] = <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0111_00_01_float_00_01ghost_exchange___01_4.html#a4cef3ff2f952dec4fea1092412cb3b5a">complex</a>(-out[1].<a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0111_00_01_float_00_01ghost_exchange___01_4.html#a8ef64635ed0c708b113903b9f3c09be1">real</a>(), out[1].imag());</div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;          out[4] = <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0111_00_01_float_00_01ghost_exchange___01_4.html#a4cef3ff2f952dec4fea1092412cb3b5a">complex</a>(0.0, in[7]);</div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;          out[5] = <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0111_00_01_float_00_01ghost_exchange___01_4.html#a4cef3ff2f952dec4fea1092412cb3b5a">complex</a>(in[4], in[5]);</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;          out[6] = <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0111_00_01_float_00_01ghost_exchange___01_4.html#a4cef3ff2f952dec4fea1092412cb3b5a">complex</a>(-out[2].<a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0111_00_01_float_00_01ghost_exchange___01_4.html#a8ef64635ed0c708b113903b9f3c09be1">real</a>(), out[2].imag());</div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;          out[7] = <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0111_00_01_float_00_01ghost_exchange___01_4.html#a4cef3ff2f952dec4fea1092412cb3b5a">complex</a>(-out[5].<a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0111_00_01_float_00_01ghost_exchange___01_4.html#a8ef64635ed0c708b113903b9f3c09be1">real</a>(), out[5].imag());</div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;          out[8] = <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0111_00_01_float_00_01ghost_exchange___01_4.html#a4cef3ff2f952dec4fea1092412cb3b5a">complex</a>(0.0, in[8]);</div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;        }</div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;</div><div class="line"><a name="l01350"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct_3_0111_00_01_float_00_01ghost_exchange___01_4.html#ab007f1f3c3fea36358929bbc9cf3088e"> 1350</a></span>&#160;        __device__ __host__ <span class="keyword">inline</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0111_00_01_float_00_01ghost_exchange___01_4.html#a8ef64635ed0c708b113903b9f3c09be1">real</a> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0111_00_01_float_00_01ghost_exchange___01_4.html#ab007f1f3c3fea36358929bbc9cf3088e">getPhase</a>(<span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0111_00_01_float_00_01ghost_exchange___01_4.html#a4cef3ff2f952dec4fea1092412cb3b5a">complex</a> <a class="code" href="staggered__invert__test_8cpp.html#af61ff6c9724eb687e3057b6a1a977487">in</a>[9]) { <span class="keywordflow">return</span> 0; }</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;      };</div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;</div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;      <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Float, QudaGhostExchange ghostExchange_, QudaStaggeredPhase stag_phase&gt;</div><div class="line"><a name="l01362"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct_3_0113_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html"> 1362</a></span>&#160;      <span class="keyword">struct </span><a class="code" href="structquda_1_1gauge_1_1_reconstruct.html">Reconstruct</a>&lt;13, Float, ghostExchange_, stag_phase&gt; {</div><div class="line"><a name="l01363"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct_3_0113_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a531fa87473a6a9c738e37720963e0276"> 1363</a></span>&#160;        <span class="keyword">using</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0113_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a531fa87473a6a9c738e37720963e0276">real</a> = <span class="keyword">typename</span> <a class="code" href="structquda_1_1mapper.html">mapper&lt;Float&gt;::type</a>;</div><div class="line"><a name="l01364"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct_3_0113_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a410f3f8876601d193a59e0067d84f1b3"> 1364</a></span>&#160;        <span class="keyword">using</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0113_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a410f3f8876601d193a59e0067d84f1b3">complex</a> = <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0113_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a410f3f8876601d193a59e0067d84f1b3">complex&lt;real&gt;</a>;</div><div class="line"><a name="l01365"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct_3_0113_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a4f0e2bdac011b25978743b522dc4f5a1"> 1365</a></span>&#160;        <span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4.html">Reconstruct&lt;12, Float, ghostExchange_&gt;</a> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0113_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a4f0e2bdac011b25978743b522dc4f5a1">reconstruct_12</a>;</div><div class="line"><a name="l01366"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct_3_0113_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a958e93a930512f1729501e2fa896efb3"> 1366</a></span>&#160;        <span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0113_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a531fa87473a6a9c738e37720963e0276">real</a> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0113_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a958e93a930512f1729501e2fa896efb3">scale</a>;</div><div class="line"><a name="l01367"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct_3_0113_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a2d8ebea8d3240a6f044d8cf0d81283a1"> 1367</a></span>&#160;        <span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0113_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a531fa87473a6a9c738e37720963e0276">real</a> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0113_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a2d8ebea8d3240a6f044d8cf0d81283a1">scale_inv</a>;</div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;</div><div class="line"><a name="l01369"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct_3_0113_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a4e72a04128c0af01b5c67a993a18dafb"> 1369</a></span>&#160;        <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0113_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a4e72a04128c0af01b5c67a993a18dafb">Reconstruct</a>(<span class="keyword">const</span> <a class="code" href="classquda_1_1_gauge_field.html">GaugeField</a> &amp;u) : reconstruct_12(u), scale(u.Scale()), scale_inv(1.0 / scale) {}</div><div class="line"><a name="l01370"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct_3_0113_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a791759925f2884dc48fef16c9d25bc62"> 1370</a></span>&#160;        <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0113_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a791759925f2884dc48fef16c9d25bc62">Reconstruct</a>(<span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0113_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html">Reconstruct&lt;13, Float, ghostExchange_, stag_phase&gt;</a> &amp;recon) :</div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;            reconstruct_12(recon.reconstruct_12),</div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;            scale(recon.scale),</div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;            scale_inv(recon.scale_inv)</div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;        {</div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;        }</div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;</div><div class="line"><a name="l01377"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct_3_0113_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a68800abcd68749e8c7b5f71ee7eb09e3"> 1377</a></span>&#160;        __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0113_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a68800abcd68749e8c7b5f71ee7eb09e3">Pack</a>(<a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0113_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a531fa87473a6a9c738e37720963e0276">real</a> <a class="code" href="staggered__invert__test_8cpp.html#af3806a0fd9f2d8dd7a627e9571984d33">out</a>[12], <span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0113_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a410f3f8876601d193a59e0067d84f1b3">complex</a> <a class="code" href="staggered__invert__test_8cpp.html#af61ff6c9724eb687e3057b6a1a977487">in</a>[9], <span class="keywordtype">int</span> idx)<span class="keyword"> const</span></div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;<span class="keyword">        </span>{</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;          reconstruct_12.<a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4.html#a420afc0023304fad223cb2936560fae6">Pack</a>(out, in, idx);</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;        }</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;        <span class="keyword">template</span> &lt;<span class="keyword">typename</span> I&gt;</div><div class="line"><a name="l01383"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct_3_0113_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#ad4960075a0d41836f2ac88f4ba720e8f"> 1383</a></span>&#160;        __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0113_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#ad4960075a0d41836f2ac88f4ba720e8f">Unpack</a>(<a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0113_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a410f3f8876601d193a59e0067d84f1b3">complex</a> <a class="code" href="staggered__invert__test_8cpp.html#af3806a0fd9f2d8dd7a627e9571984d33">out</a>[9], <span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0113_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a531fa87473a6a9c738e37720963e0276">real</a> <a class="code" href="staggered__invert__test_8cpp.html#af61ff6c9724eb687e3057b6a1a977487">in</a>[12], <span class="keywordtype">int</span> idx, <span class="keywordtype">int</span> dir, <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0113_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a531fa87473a6a9c738e37720963e0276">real</a> <a class="code" href="structquda_1_1gauge__wrapper.html#a953756c13d685eacf355434ee7897a3c">phase</a>,</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;                                               <span class="keyword">const</span> I *<a class="code" href="covdev__test_8cpp.html#a7facd8f2fefe0ccaea751dff2592badb">X</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> *<a class="code" href="interface__quda_8cpp.html#a67b63ae29fb23d1a034f9ba7e0787745">R</a>)<span class="keyword"> const</span></div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;<span class="keyword">        </span>{</div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;<span class="preprocessor">#pragma unroll</span></div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 6; i++) out[i] = <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0113_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a410f3f8876601d193a59e0067d84f1b3">complex</a>(in[2 * i + 0], in[2 * i + 1]);</div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;          out[6] = <a class="code" href="namespacequda.html#a070af9181985dd8169b9b5c9eebe65bf">cmul</a>(out[2], out[4]);</div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;          out[6] = <a class="code" href="namespacequda.html#a3f32b5e8a1310c9f74c174f543591e3b">cmac</a>(out[1], out[5], -out[6]);</div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;          out[6] = scale_inv * <a class="code" href="namespacequda.html#a043738f16cdeb082fa1a5158fbad36b3">conj</a>(out[6]);</div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;</div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;          out[7] = <a class="code" href="namespacequda.html#a070af9181985dd8169b9b5c9eebe65bf">cmul</a>(out[0], out[5]);</div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;          out[7] = <a class="code" href="namespacequda.html#a3f32b5e8a1310c9f74c174f543591e3b">cmac</a>(out[2], out[3], -out[7]);</div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;          out[7] = scale_inv * <a class="code" href="namespacequda.html#a043738f16cdeb082fa1a5158fbad36b3">conj</a>(out[7]);</div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;</div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;          out[8] = <a class="code" href="namespacequda.html#a070af9181985dd8169b9b5c9eebe65bf">cmul</a>(out[1], out[3]);</div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;          out[8] = <a class="code" href="namespacequda.html#a3f32b5e8a1310c9f74c174f543591e3b">cmac</a>(out[0], out[4], -out[8]);</div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;          out[8] = scale_inv * <a class="code" href="namespacequda.html#a043738f16cdeb082fa1a5158fbad36b3">conj</a>(out[8]);</div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;</div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;          <span class="keywordflow">if</span> (stag_phase == <a class="code" href="enum__quda_8h.html#a2f13fac18d6933e9e21bc1cf2737b21aa3ddefa2065127060bce7d178208c51e0">QUDA_STAGGERED_PHASE_NO</a>) { <span class="comment">// dynamic phasing</span></div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;            <span class="comment">// Multiply the third row by exp(I*3*phase), since the cross product will end up in a scale factor of exp(-I*2*phase)</span></div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;            <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0113_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a531fa87473a6a9c738e37720963e0276">real</a> cos_sin[2];</div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;            <a class="code" href="structquda_1_1_trig.html">Trig&lt;isFixed&lt;real&gt;::value</a>, <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0113_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a531fa87473a6a9c738e37720963e0276">real</a>&gt;::SinCos(static_cast&lt;real&gt;(3. * phase), &amp;cos_sin[1], &amp;cos_sin[0]);</div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;            <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0113_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a410f3f8876601d193a59e0067d84f1b3">complex</a> A(cos_sin[0], cos_sin[1]);</div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;            out[6] = <a class="code" href="namespacequda.html#a070af9181985dd8169b9b5c9eebe65bf">cmul</a>(A, out[6]);</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;            out[7] = <a class="code" href="namespacequda.html#a070af9181985dd8169b9b5c9eebe65bf">cmul</a>(A, out[7]);</div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;            out[8] = <a class="code" href="namespacequda.html#a070af9181985dd8169b9b5c9eebe65bf">cmul</a>(A, out[8]);</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;          } <span class="keywordflow">else</span> { <span class="comment">// phase is +/- 1 so real multiply is sufficient</span></div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;            out[6] *= <a class="code" href="structquda_1_1gauge__wrapper.html#a953756c13d685eacf355434ee7897a3c">phase</a>;</div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;            out[7] *= <a class="code" href="structquda_1_1gauge__wrapper.html#a953756c13d685eacf355434ee7897a3c">phase</a>;</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;            out[8] *= <a class="code" href="structquda_1_1gauge__wrapper.html#a953756c13d685eacf355434ee7897a3c">phase</a>;</div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;          }</div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;        }</div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;</div><div class="line"><a name="l01416"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct_3_0113_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#acd0e54904e9e4fb7b18eeaf2eb027da6"> 1416</a></span>&#160;        __device__ __host__ <span class="keyword">inline</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0113_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a531fa87473a6a9c738e37720963e0276">real</a> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0113_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#acd0e54904e9e4fb7b18eeaf2eb027da6">getPhase</a>(<span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0113_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a410f3f8876601d193a59e0067d84f1b3">complex</a> <a class="code" href="staggered__invert__test_8cpp.html#af61ff6c9724eb687e3057b6a1a977487">in</a>[9])<span class="keyword"> const</span></div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;<span class="keyword">        </span>{</div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;<span class="preprocessor">#if 1 // phase from cross product</span></div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;          <span class="comment">// denominator = (U[0][0]*U[1][1] - U[0][1]*U[1][0])*</span></div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;          <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0113_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a410f3f8876601d193a59e0067d84f1b3">complex</a> denom = <a class="code" href="namespacequda.html#a043738f16cdeb082fa1a5158fbad36b3">conj</a>(in[0] * in[4] - in[1] * in[3]) * scale_inv;</div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;          <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0113_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a410f3f8876601d193a59e0067d84f1b3">complex</a> expI3Phase = in[8] / denom; <span class="comment">// numerator = U[2][2]</span></div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;</div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;          <span class="keywordflow">if</span> (stag_phase == <a class="code" href="enum__quda_8h.html#a2f13fac18d6933e9e21bc1cf2737b21aa3ddefa2065127060bce7d178208c51e0">QUDA_STAGGERED_PHASE_NO</a>) { <span class="comment">// dynamic phasing</span></div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="namespacequda.html#a519e30abf575a4084224e899c730e95f">arg</a>(expI3Phase) / <span class="keyword">static_cast&lt;</span><a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0113_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a531fa87473a6a9c738e37720963e0276">real</a><span class="keyword">&gt;</span>(3.0);</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;          } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;            <span class="keywordflow">return</span> expI3Phase.real() &gt; 0 ? 1 : -1;</div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;          }</div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;<span class="preprocessor">#else // phase from determinant</span></div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;          <a class="code" href="classquda_1_1_matrix.html">Matrix&lt;complex, 3&gt;</a> a;</div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;<span class="preprocessor">#pragma unroll</span></div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 9; i++) a(i) = scale_inv * in[i];</div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;          <span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_0113_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a410f3f8876601d193a59e0067d84f1b3">complex</a> det = <a class="code" href="namespacequda.html#aa2770ef66427e1e0861d7685d363907a">getDeterminant</a>(a);</div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a953756c13d685eacf355434ee7897a3c">phase</a> = <a class="code" href="namespacequda.html#a519e30abf575a4084224e899c730e95f">arg</a>(det) / 3;</div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;        }</div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;      };</div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;</div><div class="line"><a name="l01445"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html"> 1445</a></span>&#160;      <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Float, QudaGhostExchange ghostExchange_&gt; <span class="keyword">struct </span><a class="code" href="structquda_1_1gauge_1_1_reconstruct.html">Reconstruct</a>&lt;8, Float, ghostExchange_&gt; {</div><div class="line"><a name="l01446"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#a6f78c7e747d4ef53c41772f778ca2b57"> 1446</a></span>&#160;        <span class="keyword">using</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#a6f78c7e747d4ef53c41772f778ca2b57">real</a> = <span class="keyword">typename</span> <a class="code" href="structquda_1_1mapper.html">mapper&lt;Float&gt;::type</a>;</div><div class="line"><a name="l01447"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#a0205d96983e6cdce21bf8a21cb3289f3"> 1447</a></span>&#160;        <span class="keyword">using</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#a0205d96983e6cdce21bf8a21cb3289f3">complex</a> = <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#a0205d96983e6cdce21bf8a21cb3289f3">complex&lt;real&gt;</a>;</div><div class="line"><a name="l01448"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#aaf16b582a36be8775c756d8eab4d86f9"> 1448</a></span>&#160;        <span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#a0205d96983e6cdce21bf8a21cb3289f3">complex</a> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#aaf16b582a36be8775c756d8eab4d86f9">anisotropy</a>; <span class="comment">// imaginary value stores inverse</span></div><div class="line"><a name="l01449"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#ab6185def211352cc8c3a4a41b32252e3"> 1449</a></span>&#160;        <span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#a0205d96983e6cdce21bf8a21cb3289f3">complex</a> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#ab6185def211352cc8c3a4a41b32252e3">tBoundary</a>;  <span class="comment">// imaginary value stores inverse</span></div><div class="line"><a name="l01450"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#ac260178de19871519ee484bb4250f9e5"> 1450</a></span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#ac260178de19871519ee484bb4250f9e5">firstTimeSliceBound</a>;</div><div class="line"><a name="l01451"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#af34ae991d49d251efb5884712e6b5906"> 1451</a></span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#af34ae991d49d251efb5884712e6b5906">lastTimeSliceBound</a>;</div><div class="line"><a name="l01452"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#ae54e5ddde4d5d39e65bbd4232fb380ba"> 1452</a></span>&#160;        <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#ae54e5ddde4d5d39e65bbd4232fb380ba">isFirstTimeSlice</a>;</div><div class="line"><a name="l01453"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#a9b95dd23a6e219fef893d9e428a2805e"> 1453</a></span>&#160;        <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#a9b95dd23a6e219fef893d9e428a2805e">isLastTimeSlice</a>;</div><div class="line"><a name="l01454"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#a0cdbcb678c40b0e01b2e54e34e39fdfa"> 1454</a></span>&#160;        <a class="code" href="enum__quda_8h.html#a744e553dee90a2671fe00aba878c315b">QudaGhostExchange</a> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#a0cdbcb678c40b0e01b2e54e34e39fdfa">ghostExchange</a>;</div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;</div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;        <span class="comment">// scale factor is set when using recon-9</span></div><div class="line"><a name="l01457"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#a5c4d613a4a2667ea27a5115a5cd324bf"> 1457</a></span>&#160;        <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#a5c4d613a4a2667ea27a5115a5cd324bf">Reconstruct</a>(<span class="keyword">const</span> <a class="code" href="classquda_1_1_gauge_field.html">GaugeField</a> &amp;u, <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#a6f78c7e747d4ef53c41772f778ca2b57">real</a> scale = 1.0) :</div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;          anisotropy(u.Anisotropy() * scale, 1.0 / (u.Anisotropy() * scale)),</div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;          tBoundary(static_cast&lt;<a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#a6f78c7e747d4ef53c41772f778ca2b57">real</a>&gt;(u.TBoundary()) * scale, 1.0 / (static_cast&lt;<a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#a6f78c7e747d4ef53c41772f778ca2b57">real</a>&gt;(u.TBoundary()) * scale)),</div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;          firstTimeSliceBound(u.VolumeCB()),</div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;          lastTimeSliceBound((u.<a class="code" href="covdev__test_8cpp.html#a7facd8f2fefe0ccaea751dff2592badb">X</a>()[3] - 1) * u.<a class="code" href="covdev__test_8cpp.html#a7facd8f2fefe0ccaea751dff2592badb">X</a>()[0] * u.<a class="code" href="covdev__test_8cpp.html#a7facd8f2fefe0ccaea751dff2592badb">X</a>()[1] * u.<a class="code" href="covdev__test_8cpp.html#a7facd8f2fefe0ccaea751dff2592badb">X</a>()[2] / 2),</div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;          isFirstTimeSlice(<a class="code" href="comm__quda_8h.html#a6c081bfedfe939a19ca8acd025864f14">comm_coord</a>(3) == 0 ? true : false),</div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;          isLastTimeSlice(<a class="code" href="comm__quda_8h.html#a6c081bfedfe939a19ca8acd025864f14">comm_coord</a>(3) == <a class="code" href="comm__quda_8h.html#ab6471b31d5a7f3f80e6561382c09b3b5">comm_dim</a>(3) - 1 ? true : false),</div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;          ghostExchange(u.GhostExchange())</div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;        {</div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;        }</div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;</div><div class="line"><a name="l01468"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#a513cee707f5e19c80a4c066a96573e1b"> 1468</a></span>&#160;        <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#a513cee707f5e19c80a4c066a96573e1b">Reconstruct</a>(<span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html">Reconstruct&lt;8, Float, ghostExchange_&gt;</a> &amp;recon) :</div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;            anisotropy(recon.anisotropy),</div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;            tBoundary(recon.tBoundary),</div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;            firstTimeSliceBound(recon.firstTimeSliceBound),</div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;            lastTimeSliceBound(recon.lastTimeSliceBound),</div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;            isFirstTimeSlice(recon.isFirstTimeSlice),</div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;            isLastTimeSlice(recon.isLastTimeSlice),</div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;            ghostExchange(recon.ghostExchange)</div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;        {</div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;        }</div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;</div><div class="line"><a name="l01479"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#ab9916ee97e30fe7e3b482458aa124f3a"> 1479</a></span>&#160;        __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#ab9916ee97e30fe7e3b482458aa124f3a">Pack</a>(<a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#a6f78c7e747d4ef53c41772f778ca2b57">real</a> <a class="code" href="staggered__invert__test_8cpp.html#af3806a0fd9f2d8dd7a627e9571984d33">out</a>[8], <span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#a0205d96983e6cdce21bf8a21cb3289f3">complex</a> <a class="code" href="staggered__invert__test_8cpp.html#af61ff6c9724eb687e3057b6a1a977487">in</a>[9], <span class="keywordtype">int</span> idx)<span class="keyword"> const</span></div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;<span class="keyword">        </span>{</div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;          out[0] = <a class="code" href="structquda_1_1_trig.html">Trig&lt;isFixed&lt;Float&gt;::value</a>, <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#a6f78c7e747d4ef53c41772f778ca2b57">real</a>&gt;::Atan2(in[0].imag(), in[0].<a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#a6f78c7e747d4ef53c41772f778ca2b57">real</a>());</div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;          out[1] = <a class="code" href="structquda_1_1_trig.html">Trig&lt;isFixed&lt;Float&gt;::value</a>, <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#a6f78c7e747d4ef53c41772f778ca2b57">real</a>&gt;::Atan2(in[6].imag(), in[6].<a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#a6f78c7e747d4ef53c41772f778ca2b57">real</a>());</div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;<span class="preprocessor">#pragma unroll</span></div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; 4; i++) {</div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;            out[2 * i + 0] = in[i].real();</div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;            out[2 * i + 1] = in[i].imag();</div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;          }</div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;        }</div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;</div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;        <span class="keyword">template</span> &lt;<span class="keyword">typename</span> I&gt;</div><div class="line"><a name="l01491"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#a2eabfa36a5c974452f51a6d1b4199649"> 1491</a></span>&#160;        __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#a2eabfa36a5c974452f51a6d1b4199649">Unpack</a>(<a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#a0205d96983e6cdce21bf8a21cb3289f3">complex</a> <a class="code" href="staggered__invert__test_8cpp.html#af3806a0fd9f2d8dd7a627e9571984d33">out</a>[9], <span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#a6f78c7e747d4ef53c41772f778ca2b57">real</a> <a class="code" href="staggered__invert__test_8cpp.html#af61ff6c9724eb687e3057b6a1a977487">in</a>[8], <span class="keywordtype">int</span> idx, <span class="keywordtype">int</span> dir, <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#a6f78c7e747d4ef53c41772f778ca2b57">real</a> <a class="code" href="structquda_1_1gauge__wrapper.html#a953756c13d685eacf355434ee7897a3c">phase</a>,</div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;                                               <span class="keyword">const</span> I *<a class="code" href="covdev__test_8cpp.html#a7facd8f2fefe0ccaea751dff2592badb">X</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> *<a class="code" href="interface__quda_8cpp.html#a67b63ae29fb23d1a034f9ba7e0787745">R</a>, <span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#a0205d96983e6cdce21bf8a21cb3289f3">complex</a> scale, <span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#a0205d96983e6cdce21bf8a21cb3289f3">complex</a> u)<span class="keyword"> const</span></div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;<span class="keyword">        </span>{</div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;          <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#a6f78c7e747d4ef53c41772f778ca2b57">real</a> u0 = u.real();</div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;          <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#a6f78c7e747d4ef53c41772f778ca2b57">real</a> u0_inv = u.imag();</div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;</div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;<span class="preprocessor">#pragma unroll</span></div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt;= 3; i++)</div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;            out[i] = <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#a0205d96983e6cdce21bf8a21cb3289f3">complex</a>(in[2 * i + 0], in[2 * i + 1]); <span class="comment">// these elements are copied directly</span></div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;</div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;          <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#a6f78c7e747d4ef53c41772f778ca2b57">real</a> <a class="code" href="covdev__test_8cpp.html#a788da19b1cbae7d08eb18da226046dd7">tmp</a>[2];</div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;          <a class="code" href="structquda_1_1_trig.html">Trig&lt;isFixed&lt;Float&gt;::value</a>, <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#a6f78c7e747d4ef53c41772f778ca2b57">real</a>&gt;::SinCos(in[0], &amp;tmp[1], &amp;tmp[0]);</div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;          out[0] = <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#a0205d96983e6cdce21bf8a21cb3289f3">complex</a>(tmp[0], tmp[1]);</div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;</div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;          <a class="code" href="structquda_1_1_trig.html">Trig&lt;isFixed&lt;Float&gt;::value</a>, <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#a6f78c7e747d4ef53c41772f778ca2b57">real</a>&gt;::SinCos(in[1], &amp;tmp[1], &amp;tmp[0]);</div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;          out[6] = <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#a0205d96983e6cdce21bf8a21cb3289f3">complex</a>(tmp[0], tmp[1]);</div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;</div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;          <span class="comment">// First, reconstruct first row</span></div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;          <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#a6f78c7e747d4ef53c41772f778ca2b57">real</a> row_sum = out[1].real() * out[1].real();</div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;          row_sum += out[1].imag() * out[1].imag();</div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;          row_sum += out[2].real() * out[2].real();</div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;          row_sum += out[2].imag() * out[2].imag();</div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;          <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#a6f78c7e747d4ef53c41772f778ca2b57">real</a> row_sum_inv = <span class="keyword">static_cast&lt;</span><a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#a6f78c7e747d4ef53c41772f778ca2b57">real</a><span class="keyword">&gt;</span>(1.0) / row_sum;</div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;</div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;          <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#a6f78c7e747d4ef53c41772f778ca2b57">real</a> diff = u0_inv * u0_inv - row_sum;</div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;          <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#a6f78c7e747d4ef53c41772f778ca2b57">real</a> U00_mag = diff &gt; 0.0 ? diff * rsqrt(diff) : <span class="keyword">static_cast&lt;</span><a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#a6f78c7e747d4ef53c41772f778ca2b57">real</a><span class="keyword">&gt;</span>(0.0);</div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;</div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;          out[0] *= U00_mag;</div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;</div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;          <span class="comment">// Second, reconstruct first column</span></div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;          <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#a6f78c7e747d4ef53c41772f778ca2b57">real</a> column_sum = out[0].real() * out[0].real();</div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;          column_sum += out[0].imag() * out[0].imag();</div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;          column_sum += out[3].real() * out[3].real();</div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;          column_sum += out[3].imag() * out[3].imag();</div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;</div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;          diff = u0_inv * u0_inv - column_sum;</div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;          <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#a6f78c7e747d4ef53c41772f778ca2b57">real</a> U20_mag = diff &gt; 0.0 ? diff * rsqrt(diff) : <span class="keyword">static_cast&lt;</span><a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#a6f78c7e747d4ef53c41772f778ca2b57">real</a><span class="keyword">&gt;</span>(0.0);</div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;</div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;          out[6] *= U20_mag;</div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;</div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;          <span class="comment">// Finally, reconstruct last elements from SU(2) rotation</span></div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;          <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#a6f78c7e747d4ef53c41772f778ca2b57">real</a> r_inv2 = u0_inv * row_sum_inv;</div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;          {</div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;            <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#a0205d96983e6cdce21bf8a21cb3289f3">complex</a> A = <a class="code" href="namespacequda.html#a070af9181985dd8169b9b5c9eebe65bf">cmul</a>(<a class="code" href="namespacequda.html#a043738f16cdeb082fa1a5158fbad36b3">conj</a>(out[0]), out[3]);</div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;</div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;            <span class="comment">// out[4] = -(conj(out[6])*conj(out[2]) + u0*A*out[1])*r_inv2; // U11</span></div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;            out[4] = <a class="code" href="namespacequda.html#a070af9181985dd8169b9b5c9eebe65bf">cmul</a>(<a class="code" href="namespacequda.html#a043738f16cdeb082fa1a5158fbad36b3">conj</a>(out[6]), <a class="code" href="namespacequda.html#a043738f16cdeb082fa1a5158fbad36b3">conj</a>(out[2]));</div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;            out[4] = <a class="code" href="namespacequda.html#a3f32b5e8a1310c9f74c174f543591e3b">cmac</a>(u0 * A, out[1], out[4]);</div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;            out[4] = -r_inv2 * out[4];</div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;</div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;            <span class="comment">// out[5] = (conj(out[6])*conj(out[1]) - u0*A*out[2])*r_inv2;  // U12</span></div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;            out[5] = <a class="code" href="namespacequda.html#a070af9181985dd8169b9b5c9eebe65bf">cmul</a>(<a class="code" href="namespacequda.html#a043738f16cdeb082fa1a5158fbad36b3">conj</a>(out[6]), <a class="code" href="namespacequda.html#a043738f16cdeb082fa1a5158fbad36b3">conj</a>(out[1]));</div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;            out[5] = <a class="code" href="namespacequda.html#a3f32b5e8a1310c9f74c174f543591e3b">cmac</a>(-u0 * A, out[2], out[5]);</div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;            out[5] = r_inv2 * out[5];</div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;          }</div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;</div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;          {</div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;            <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#a0205d96983e6cdce21bf8a21cb3289f3">complex</a> A = <a class="code" href="namespacequda.html#a070af9181985dd8169b9b5c9eebe65bf">cmul</a>(<a class="code" href="namespacequda.html#a043738f16cdeb082fa1a5158fbad36b3">conj</a>(out[0]), out[6]);</div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;</div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;            <span class="comment">// out[7] = (conj(out[3])*conj(out[2]) - u0*A*out[1])*r_inv2;  // U21</span></div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;            out[7] = <a class="code" href="namespacequda.html#a070af9181985dd8169b9b5c9eebe65bf">cmul</a>(<a class="code" href="namespacequda.html#a043738f16cdeb082fa1a5158fbad36b3">conj</a>(out[3]), <a class="code" href="namespacequda.html#a043738f16cdeb082fa1a5158fbad36b3">conj</a>(out[2]));</div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;            out[7] = <a class="code" href="namespacequda.html#a3f32b5e8a1310c9f74c174f543591e3b">cmac</a>(-u0 * A, out[1], out[7]);</div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;            out[7] = r_inv2 * out[7];</div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;</div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;            <span class="comment">// out[8] = -(conj(out[3])*conj(out[1]) + u0*A*out[2])*r_inv2; // U12</span></div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;            out[8] = <a class="code" href="namespacequda.html#a070af9181985dd8169b9b5c9eebe65bf">cmul</a>(<a class="code" href="namespacequda.html#a043738f16cdeb082fa1a5158fbad36b3">conj</a>(out[3]), <a class="code" href="namespacequda.html#a043738f16cdeb082fa1a5158fbad36b3">conj</a>(out[1]));</div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;            out[8] = <a class="code" href="namespacequda.html#a3f32b5e8a1310c9f74c174f543591e3b">cmac</a>(u0 * A, out[2], out[8]);</div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;            out[8] = -r_inv2 * out[8];</div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;          }</div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;        }</div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;</div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;        <span class="keyword">template</span> &lt;<span class="keyword">typename</span> I&gt;</div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;        __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span></div><div class="line"><a name="l01564"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#ad4f244f8bd486b6b6f843d2c74b85a81"> 1564</a></span>&#160;        <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#ad4f244f8bd486b6b6f843d2c74b85a81">Unpack</a>(<a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#a0205d96983e6cdce21bf8a21cb3289f3">complex</a> <a class="code" href="staggered__invert__test_8cpp.html#af3806a0fd9f2d8dd7a627e9571984d33">out</a>[9], <span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#a6f78c7e747d4ef53c41772f778ca2b57">real</a> <a class="code" href="staggered__invert__test_8cpp.html#af61ff6c9724eb687e3057b6a1a977487">in</a>[8], <span class="keywordtype">int</span> idx, <span class="keywordtype">int</span> dir, <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#a6f78c7e747d4ef53c41772f778ca2b57">real</a> <a class="code" href="structquda_1_1gauge__wrapper.html#a953756c13d685eacf355434ee7897a3c">phase</a>, <span class="keyword">const</span> I *<a class="code" href="covdev__test_8cpp.html#a7facd8f2fefe0ccaea751dff2592badb">X</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> *<a class="code" href="interface__quda_8cpp.html#a67b63ae29fb23d1a034f9ba7e0787745">R</a>,</div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;               <span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#a0205d96983e6cdce21bf8a21cb3289f3">complex</a> scale = <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#a0205d96983e6cdce21bf8a21cb3289f3">complex</a>(static_cast&lt;real&gt;(1.0), static_cast&lt;real&gt;(1.0)))<span class="keyword"> const</span></div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;<span class="keyword">        </span>{</div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;          <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#a0205d96983e6cdce21bf8a21cb3289f3">complex</a> u = dir &lt; 3 ?</div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;            <a class="code" href="deflated__invert__test_8cpp.html#a2e99a9d1409689109095858dc2912d40">anisotropy</a> :</div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;            timeBoundary&lt;ghostExchange_&gt;(idx, <a class="code" href="covdev__test_8cpp.html#a7facd8f2fefe0ccaea751dff2592badb">X</a>, <a class="code" href="interface__quda_8cpp.html#a67b63ae29fb23d1a034f9ba7e0787745">R</a>, tBoundary, scale, firstTimeSliceBound, lastTimeSliceBound,</div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;                                         isFirstTimeSlice, isLastTimeSlice, ghostExchange);</div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;          Unpack(out, in, idx, dir, phase, X, R, scale, u);</div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;        }</div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;</div><div class="line"><a name="l01574"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#aabfff951b1c0665b279c06d9ba0768ad"> 1574</a></span>&#160;        __device__ __host__ <span class="keyword">inline</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#a6f78c7e747d4ef53c41772f778ca2b57">real</a> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#aabfff951b1c0665b279c06d9ba0768ad">getPhase</a>(<span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#a0205d96983e6cdce21bf8a21cb3289f3">complex</a> in[9]) { <span class="keywordflow">return</span> 0; }</div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;      };</div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;</div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;      <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Float, QudaGhostExchange ghostExchange_, QudaStaggeredPhase stag_phase&gt;</div><div class="line"><a name="l01586"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct_3_019_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html"> 1586</a></span>&#160;      <span class="keyword">struct </span><a class="code" href="structquda_1_1gauge_1_1_reconstruct.html">Reconstruct</a>&lt;9, Float, ghostExchange_, stag_phase&gt; {</div><div class="line"><a name="l01587"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct_3_019_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#ac46126e8b4a9441eb4f828f56e5fa27a"> 1587</a></span>&#160;        <span class="keyword">using</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_019_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#ac46126e8b4a9441eb4f828f56e5fa27a">real</a> = <span class="keyword">typename</span> <a class="code" href="structquda_1_1mapper.html">mapper&lt;Float&gt;::type</a>;</div><div class="line"><a name="l01588"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct_3_019_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a114b1768bcbbba232517a7f4d280a134"> 1588</a></span>&#160;        <span class="keyword">using</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_019_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a114b1768bcbbba232517a7f4d280a134">complex</a> = <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_019_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a114b1768bcbbba232517a7f4d280a134">complex&lt;real&gt;</a>;</div><div class="line"><a name="l01589"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct_3_019_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#ae4aba10c3926fe52bca15c7e12899dea"> 1589</a></span>&#160;        <span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html">Reconstruct&lt;8, Float, ghostExchange_&gt;</a> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_019_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#ae4aba10c3926fe52bca15c7e12899dea">reconstruct_8</a>;</div><div class="line"><a name="l01590"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct_3_019_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a9f7714d03a5fe29e567280e2c891ef14"> 1590</a></span>&#160;        <span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_019_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#ac46126e8b4a9441eb4f828f56e5fa27a">real</a> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_019_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a9f7714d03a5fe29e567280e2c891ef14">scale</a>;</div><div class="line"><a name="l01591"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct_3_019_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a7f4cd25f3c0fdb0cf2518906bfb73fbe"> 1591</a></span>&#160;        <span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_019_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#ac46126e8b4a9441eb4f828f56e5fa27a">real</a> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_019_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a7f4cd25f3c0fdb0cf2518906bfb73fbe">scale_inv</a>;</div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;</div><div class="line"><a name="l01593"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct_3_019_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a19763f4184aaa85654d70e5eabcc15d7"> 1593</a></span>&#160;        <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_019_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a19763f4184aaa85654d70e5eabcc15d7">Reconstruct</a>(<span class="keyword">const</span> <a class="code" href="classquda_1_1_gauge_field.html">GaugeField</a> &amp;u) : reconstruct_8(u), scale(u.Scale()), scale_inv(1.0 / scale) {}</div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;</div><div class="line"><a name="l01595"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct_3_019_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a8c37b11175aff9796871de376995de10"> 1595</a></span>&#160;        <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_019_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a8c37b11175aff9796871de376995de10">Reconstruct</a>(<span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_019_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html">Reconstruct&lt;9, Float, ghostExchange_, stag_phase&gt;</a> &amp;recon) :</div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;            reconstruct_8(recon.reconstruct_8),</div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;            scale(recon.scale),</div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;            scale_inv(recon.scale_inv)</div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;        {</div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;        }</div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;</div><div class="line"><a name="l01602"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct_3_019_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a846a8dbe5e9594fbbfcd82d72e0db209"> 1602</a></span>&#160;        __device__ __host__ <span class="keyword">inline</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_019_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#ac46126e8b4a9441eb4f828f56e5fa27a">real</a> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_019_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a846a8dbe5e9594fbbfcd82d72e0db209">getPhase</a>(<span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_019_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a114b1768bcbbba232517a7f4d280a134">complex</a> in[9])<span class="keyword"> const</span></div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;<span class="keyword">        </span>{</div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;<span class="preprocessor">#if 1 // phase from cross product</span></div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;          <span class="comment">// denominator = (U[0][0]*U[1][1] - U[0][1]*U[1][0])*</span></div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;          <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_019_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a114b1768bcbbba232517a7f4d280a134">complex</a> denom = <a class="code" href="namespacequda.html#a043738f16cdeb082fa1a5158fbad36b3">conj</a>(in[0] * in[4] - in[1] * in[3]) * scale_inv;</div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;          <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_019_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a114b1768bcbbba232517a7f4d280a134">complex</a> expI3Phase = in[8] / denom; <span class="comment">// numerator = U[2][2]</span></div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;          <span class="keywordflow">if</span> (stag_phase == <a class="code" href="enum__quda_8h.html#a2f13fac18d6933e9e21bc1cf2737b21aa3ddefa2065127060bce7d178208c51e0">QUDA_STAGGERED_PHASE_NO</a>) {</div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="namespacequda.html#a519e30abf575a4084224e899c730e95f">arg</a>(expI3Phase) / <span class="keyword">static_cast&lt;</span><a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_019_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#ac46126e8b4a9441eb4f828f56e5fa27a">real</a><span class="keyword">&gt;</span>(3.0);</div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;          } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;            <span class="keywordflow">return</span> expI3Phase.real() &gt; 0 ? 1 : -1;</div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;          }</div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;<span class="preprocessor">#else // phase from determinant</span></div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;          <a class="code" href="classquda_1_1_matrix.html">Matrix&lt;complex, 3&gt;</a> a;</div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;<span class="preprocessor">#pragma unroll</span></div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 9; i++) a(i) = scale_inv * in[i];</div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;          <span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_019_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a114b1768bcbbba232517a7f4d280a134">complex</a> det = <a class="code" href="namespacequda.html#aa2770ef66427e1e0861d7685d363907a">getDeterminant</a>(a);</div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;          <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_019_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#ac46126e8b4a9441eb4f828f56e5fa27a">real</a> phase = <a class="code" href="namespacequda.html#a519e30abf575a4084224e899c730e95f">arg</a>(det) / 3;</div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a953756c13d685eacf355434ee7897a3c">phase</a>;</div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;        }</div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;</div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;        <span class="comment">// Rescale the U3 input matrix by exp(-I*phase) to obtain an SU3 matrix multiplied by a real scale factor,</span></div><div class="line"><a name="l01624"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct_3_019_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a600a01a5d4996e1f3678e1a051c00999"> 1624</a></span>&#160;        __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_019_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a600a01a5d4996e1f3678e1a051c00999">Pack</a>(<a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_019_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#ac46126e8b4a9441eb4f828f56e5fa27a">real</a> out[8], <span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_019_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a114b1768bcbbba232517a7f4d280a134">complex</a> in[9], <span class="keywordtype">int</span> idx)<span class="keyword"> const</span></div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;<span class="keyword">        </span>{</div><div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;          <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_019_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#ac46126e8b4a9441eb4f828f56e5fa27a">real</a> phase = getPhase(in);</div><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;          <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_019_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a114b1768bcbbba232517a7f4d280a134">complex</a> su3[9];</div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;</div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;          <span class="keywordflow">if</span> (stag_phase == <a class="code" href="enum__quda_8h.html#a2f13fac18d6933e9e21bc1cf2737b21aa3ddefa2065127060bce7d178208c51e0">QUDA_STAGGERED_PHASE_NO</a>) {</div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;            <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_019_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#ac46126e8b4a9441eb4f828f56e5fa27a">real</a> cos_sin[2];</div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;            <a class="code" href="structquda_1_1_trig.html">Trig&lt;isFixed&lt;real&gt;::value</a>, <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_019_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#ac46126e8b4a9441eb4f828f56e5fa27a">real</a>&gt;::SinCos(static_cast&lt;real&gt;(-phase), &amp;cos_sin[1], &amp;cos_sin[0]);</div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;            <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_019_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a114b1768bcbbba232517a7f4d280a134">complex</a> z(cos_sin[0], cos_sin[1]);</div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;            z *= scale_inv;</div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;<span class="preprocessor">#pragma unroll</span></div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 9; i++) su3[i] = <a class="code" href="namespacequda.html#a070af9181985dd8169b9b5c9eebe65bf">cmul</a>(z, in[i]);</div><div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;          } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;<span class="preprocessor">#pragma unroll</span></div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 9; i++) { su3[i] = phase * in[i]; }</div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;          }</div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;          reconstruct_8.<a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#ab9916ee97e30fe7e3b482458aa124f3a">Pack</a>(out, su3, idx);</div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;        }</div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;</div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;        <span class="keyword">template</span> &lt;<span class="keyword">typename</span> I&gt;</div><div class="line"><a name="l01644"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_reconstruct_3_019_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a10b1b47d242c6cb1a7f2418b93f4ea8d"> 1644</a></span>&#160;        __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_019_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a10b1b47d242c6cb1a7f2418b93f4ea8d">Unpack</a>(<a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_019_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a114b1768bcbbba232517a7f4d280a134">complex</a> out[9], <span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_019_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#ac46126e8b4a9441eb4f828f56e5fa27a">real</a> in[8], <span class="keywordtype">int</span> idx, <span class="keywordtype">int</span> dir, <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_019_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#ac46126e8b4a9441eb4f828f56e5fa27a">real</a> phase,</div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;                                               <span class="keyword">const</span> I *X, <span class="keyword">const</span> <span class="keywordtype">int</span> *R)<span class="keyword"> const</span></div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;<span class="keyword">        </span>{</div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;          reconstruct_8.<a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#a2eabfa36a5c974452f51a6d1b4199649">Unpack</a>(out, in, idx, dir, phase, X, R, <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_019_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a114b1768bcbbba232517a7f4d280a134">complex</a>(static_cast&lt;real&gt;(1.0), static_cast&lt;real&gt;(1.0)),</div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;                               <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_019_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a114b1768bcbbba232517a7f4d280a134">complex</a>(static_cast&lt;real&gt;(1.0), static_cast&lt;real&gt;(1.0)));</div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;</div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;          <span class="keywordflow">if</span> (stag_phase == <a class="code" href="enum__quda_8h.html#a2f13fac18d6933e9e21bc1cf2737b21aa3ddefa2065127060bce7d178208c51e0">QUDA_STAGGERED_PHASE_NO</a>) { <span class="comment">// dynamic phase</span></div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;            <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_019_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#ac46126e8b4a9441eb4f828f56e5fa27a">real</a> cos_sin[2];</div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;            <a class="code" href="structquda_1_1_trig.html">Trig&lt;isFixed&lt;real&gt;::value</a>, <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_019_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#ac46126e8b4a9441eb4f828f56e5fa27a">real</a>&gt;::SinCos(static_cast&lt;real&gt;(phase), &amp;cos_sin[1], &amp;cos_sin[0]);</div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;            <a class="code" href="structquda_1_1gauge_1_1_reconstruct_3_019_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a114b1768bcbbba232517a7f4d280a134">complex</a> z(cos_sin[0], cos_sin[1]);</div><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;            z *= scale;</div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;<span class="preprocessor">#pragma unroll</span></div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 9; i++) out[i] = <a class="code" href="namespacequda.html#a070af9181985dd8169b9b5c9eebe65bf">cmul</a>(z, out[i]);</div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;          } <span class="keywordflow">else</span> { <span class="comment">// stagic phase</span></div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;<span class="preprocessor">#pragma unroll</span></div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 18; i++) { out[i] *= <a class="code" href="structquda_1_1gauge__wrapper.html#a953756c13d685eacf355434ee7897a3c">phase</a>; }</div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;          }</div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;        }</div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;      };</div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;</div><div class="line"><a name="l01664"></a><span class="lineno"><a class="line" href="namespacequda_1_1gauge.html#a038c45259e95c5426f880805d15b8a4e"> 1664</a></span>&#160;      __host__ __device__ constexpr <span class="keywordtype">int</span> <a class="code" href="namespacequda_1_1gauge.html#a038c45259e95c5426f880805d15b8a4e">ct_sqrt</a>(<span class="keywordtype">int</span> n, <span class="keywordtype">int</span> i = 1)</div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;      {</div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;        <span class="keywordflow">return</span> n == i ? n : (i * i &lt; n ? <a class="code" href="namespacequda_1_1gauge.html#a038c45259e95c5426f880805d15b8a4e">ct_sqrt</a>(n, i + 1) : i);</div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;      }</div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;</div><div class="line"><a name="l01674"></a><span class="lineno"><a class="line" href="namespacequda_1_1gauge.html#a6cd40608aabdb9080a2df09bb7c10203"> 1674</a></span>&#160;      __host__ __device__ constexpr <span class="keywordtype">int</span> <a class="code" href="namespacequda_1_1gauge.html#a6cd40608aabdb9080a2df09bb7c10203">Ncolor</a>(<span class="keywordtype">int</span> <a class="code" href="gauge__force__test_8cpp.html#a2bcd2adde36b870d02897e694ecc39cb">length</a>) { <span class="keywordflow">return</span> <a class="code" href="namespacequda_1_1gauge.html#a038c45259e95c5426f880805d15b8a4e">ct_sqrt</a>(length / 2); }</div><div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;</div><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;      <span class="comment">// we default to huge allocations for gauge field (for now)</span></div><div class="line"><a name="l01677"></a><span class="lineno"><a class="line" href="namespacequda_1_1gauge.html#afdd600791225065a6dc0d7e76d19f1de"> 1677</a></span>&#160;      constexpr <span class="keywordtype">bool</span> <a class="code" href="namespacequda_1_1gauge.html#afdd600791225065a6dc0d7e76d19f1de">default_huge_alloc</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;</div><div class="line"><a name="l01679"></a><span class="lineno"><a class="line" href="namespacequda_1_1gauge.html#a19e13125b751c0010b4e483f9b2030b9"> 1679</a></span>&#160;      <span class="keyword">template</span> &lt;QudaStaggeredPhase phase&gt; __host__ __device__ <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="namespacequda_1_1gauge.html#a19e13125b751c0010b4e483f9b2030b9">static_phase</a>()</div><div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;      {</div><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;        <span class="keywordflow">switch</span> (phase) {</div><div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="enum__quda_8h.html#a2f13fac18d6933e9e21bc1cf2737b21aaef16001e82f5d27acc1087288a42c3ac">QUDA_STAGGERED_PHASE_MILC</a>:</div><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="enum__quda_8h.html#a2f13fac18d6933e9e21bc1cf2737b21aa9bd154ebe1a472f43b8b448fe832b3d7">QUDA_STAGGERED_PHASE_CPS</a>:</div><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="enum__quda_8h.html#a2f13fac18d6933e9e21bc1cf2737b21aa6604eb56d082ee976633d53267f2d019">QUDA_STAGGERED_PHASE_TIFR</a>: <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;        <span class="keywordflow">default</span>: <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;        }</div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;      }</div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;</div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;      <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Float, <span class="keywordtype">int</span> <a class="code" href="gauge__force__test_8cpp.html#a2bcd2adde36b870d02897e694ecc39cb">length</a>, <span class="keywordtype">int</span> N, <span class="keywordtype">int</span> reconLenParam,</div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;          <a class="code" href="enum__quda_8h.html#a66bcb3446804c792fbe18f0301a3a56e">QudaStaggeredPhase</a> stag_phase = <a class="code" href="enum__quda_8h.html#a2f13fac18d6933e9e21bc1cf2737b21aa3ddefa2065127060bce7d178208c51e0">QUDA_STAGGERED_PHASE_NO</a>, <span class="keywordtype">bool</span> huge_alloc = <a class="code" href="namespacequda_1_1gauge.html#afdd600791225065a6dc0d7e76d19f1de">default_huge_alloc</a>,</div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;          <a class="code" href="enum__quda_8h.html#a744e553dee90a2671fe00aba878c315b">QudaGhostExchange</a> ghostExchange_ = <a class="code" href="enum__quda_8h.html#a93131cceecad27ce4b964cb184e8d47aa8ce4a4e003d703610a08578f413760c6">QUDA_GHOST_EXCHANGE_INVALID</a>, <span class="keywordtype">bool</span> use_inphase = <span class="keyword">false</span>&gt;</div><div class="line"><a name="l01692"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_float_n_order.html"> 1692</a></span>&#160;      <span class="keyword">struct </span><a class="code" href="structquda_1_1gauge_1_1_float_n_order.html">FloatNOrder</a> {</div><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;        <span class="keyword">using</span> <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html">Accessor</a></div><div class="line"><a name="l01694"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_float_n_order.html#a4e1f1444e500c11bd90c77975a512afb"> 1694</a></span>&#160;            = <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html">FloatNOrder&lt;Float, length, N, reconLenParam, stag_phase, huge_alloc, ghostExchange_, use_inphase&gt;</a>;</div><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;</div><div class="line"><a name="l01696"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_float_n_order.html#a3d100f3dfe5d8f8c84ce9fe115765896"> 1696</a></span>&#160;        <span class="keyword">using</span> <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html#a3d100f3dfe5d8f8c84ce9fe115765896">real</a> = <span class="keyword">typename</span> <a class="code" href="structquda_1_1mapper.html">mapper&lt;Float&gt;::type</a>;</div><div class="line"><a name="l01697"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_float_n_order.html#a99a439936285a7bf1b2110df9ab0fe7e"> 1697</a></span>&#160;        <span class="keyword">using</span> <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html#a99a439936285a7bf1b2110df9ab0fe7e">complex</a> = <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html#a99a439936285a7bf1b2110df9ab0fe7e">complex&lt;real&gt;</a>;</div><div class="line"><a name="l01698"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_float_n_order.html#afb469c92c368773342cbbed0c33a72b7"> 1698</a></span>&#160;        <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="structquda_1_1_vector_type.html">VectorType&lt;Float, N&gt;::type</a> <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html#afb469c92c368773342cbbed0c33a72b7">Vector</a>;</div><div class="line"><a name="l01699"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_float_n_order.html#a890b07983033a56ad804f247481614fd"> 1699</a></span>&#160;        <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="structquda_1_1_alloc_type.html">AllocType&lt;huge_alloc&gt;::type</a> <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html#a890b07983033a56ad804f247481614fd">AllocInt</a>;</div><div class="line"><a name="l01700"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_float_n_order.html#a29c2a84e83a0b2c211d1b65a59635268"> 1700</a></span>&#160;        <a class="code" href="structquda_1_1gauge_1_1_reconstruct.html">Reconstruct&lt;reconLenParam, Float, ghostExchange_, stag_phase&gt;</a> <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html#a29c2a84e83a0b2c211d1b65a59635268">reconstruct</a>;</div><div class="line"><a name="l01701"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_float_n_order.html#ab31c7a9725c2c5b86296f90707c54f02"> 1701</a></span>&#160;        <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> reconLen = (reconLenParam == 11) ? 10 : reconLenParam;</div><div class="line"><a name="l01702"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_float_n_order.html#a19eb2c2e2cd2faba93f348535e222e85"> 1702</a></span>&#160;        <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> hasPhase = (reconLen == 9 || reconLen == 13) ? 1 : 0;</div><div class="line"><a name="l01703"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_float_n_order.html#ac1448858b69d6ec508d76be27f51477e"> 1703</a></span>&#160;        Float *<a class="code" href="structquda_1_1gauge_1_1_float_n_order.html#ac1448858b69d6ec508d76be27f51477e">gauge</a>;</div><div class="line"><a name="l01704"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_float_n_order.html#a5c15129d2e5a16b6f09bd5b8bd95c539"> 1704</a></span>&#160;        <span class="keyword">const</span> AllocInt <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html#a5c15129d2e5a16b6f09bd5b8bd95c539">offset</a>;</div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;<span class="preprocessor">#ifdef USE_TEXTURE_OBJECTS</span></div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;        <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="structquda_1_1_tex_vector_type.html">TexVectorType&lt;real, N&gt;::type</a> TexVector;</div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;        cudaTextureObject_t tex;</div><div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> tex_offset;</div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01710"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_float_n_order.html#ad6140ba547968a3dcb9cab8aa56152fd"> 1710</a></span>&#160;      Float *ghost[4];</div><div class="line"><a name="l01711"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_float_n_order.html#a5dc7d06b470d4f9da02036ccae2bb714"> 1711</a></span>&#160;      <a class="code" href="enum__quda_8h.html#a744e553dee90a2671fe00aba878c315b">QudaGhostExchange</a> <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html#a5dc7d06b470d4f9da02036ccae2bb714">ghostExchange</a>;</div><div class="line"><a name="l01712"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_float_n_order.html#a61598fb940c012a30f6fd328afe7bc34"> 1712</a></span>&#160;      <span class="keywordtype">int</span> coords[<a class="code" href="quda__constants_8h.html#aa69925e50554e0ea81dd89fdcb572bbc">QUDA_MAX_DIM</a>];</div><div class="line"><a name="l01713"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_float_n_order.html#a169c7c3f99436173404f592fadd0e2fa"> 1713</a></span>&#160;      <a class="code" href="classint__fastdiv.html">int_fastdiv</a> X[<a class="code" href="quda__constants_8h.html#aa69925e50554e0ea81dd89fdcb572bbc">QUDA_MAX_DIM</a>];</div><div class="line"><a name="l01714"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_float_n_order.html#ae9ec6f9486dc6215781f7161e719565a"> 1714</a></span>&#160;      <span class="keywordtype">int</span> R[<a class="code" href="quda__constants_8h.html#aa69925e50554e0ea81dd89fdcb572bbc">QUDA_MAX_DIM</a>];</div><div class="line"><a name="l01715"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_float_n_order.html#a269ea1b61fcf1a289f0b726617b0f4cb"> 1715</a></span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html#a269ea1b61fcf1a289f0b726617b0f4cb">volumeCB</a>;</div><div class="line"><a name="l01716"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_float_n_order.html#ae0d16430a371cf6fbbe60e131f1f9959"> 1716</a></span>&#160;      <span class="keywordtype">int</span> faceVolumeCB[4];</div><div class="line"><a name="l01717"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_float_n_order.html#acfd9926ab02488c5423aec99b407bdfc"> 1717</a></span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html#acfd9926ab02488c5423aec99b407bdfc">stride</a>;</div><div class="line"><a name="l01718"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_float_n_order.html#a3133394862f8eb24dfc412c588eb55ad"> 1718</a></span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html#a3133394862f8eb24dfc412c588eb55ad">geometry</a>;</div><div class="line"><a name="l01719"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_float_n_order.html#a2a4a28c18e9ed010f17133086cbda5dc"> 1719</a></span>&#160;      <span class="keyword">const</span> AllocInt <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html#a2a4a28c18e9ed010f17133086cbda5dc">phaseOffset</a>;</div><div class="line"><a name="l01720"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_float_n_order.html#a20638e3041484f5fcc28faf84ab56f8d"> 1720</a></span>&#160;      <span class="keywordtype">void</span> *<a class="code" href="structquda_1_1gauge_1_1_float_n_order.html#a20638e3041484f5fcc28faf84ab56f8d">backup_h</a>; </div><div class="line"><a name="l01721"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_float_n_order.html#a31c0e2c4fd5a86b78793669c28143b3f"> 1721</a></span>&#160;      <span class="keywordtype">size_t</span> <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html#a31c0e2c4fd5a86b78793669c28143b3f">bytes</a>;</div><div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;</div><div class="line"><a name="l01723"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_float_n_order.html#a6351fb6fa9f56d2777e35c172db1f233"> 1723</a></span>&#160;    <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html#a6351fb6fa9f56d2777e35c172db1f233">FloatNOrder</a>(<span class="keyword">const</span> <a class="code" href="classquda_1_1_gauge_field.html">GaugeField</a> &amp;u, Float *gauge_=0, Float **ghost_=0, <span class="keywordtype">bool</span> <span class="keyword">override</span>=<span class="keyword">false</span>)</div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;      : reconstruct(u), gauge(gauge_ ? gauge_ : (Float*)u.Gauge_p()),</div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;  offset(u.Bytes()/(2*sizeof(Float))),</div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;#ifdef USE_TEXTURE_OBJECTS</div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;  tex(0), tex_offset(offset/N),</div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;#endif</div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;  ghostExchange(u.GhostExchange()),</div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;  volumeCB(u.VolumeCB()), stride(u.Stride()), geometry(u.Geometry()),</div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;  phaseOffset(u.PhaseOffset()), backup_h(nullptr), bytes(u.Bytes())</div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;      {</div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;  <span class="keywordflow">if</span> (geometry == <a class="code" href="enum__quda_8h.html#a7589b295019a40887f1c10c76555feeaadc1a5ef802228fe4edd42346172c7605">QUDA_COARSE_GEOMETRY</a>)</div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;    <a class="code" href="util__quda_8h.html#af3bddfd9d113d50e8e0bbf58a35c5aac">errorQuda</a>(<span class="stringliteral">&quot;This accessor does not support coarse-link fields (lacks support for bidirectional ghost zone&quot;</span>);</div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;</div><div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;        <span class="comment">// static_assert( !(stag_phase!=QUDA_STAGGERED_PHASE_NO &amp;&amp; reconLenParam != 18 &amp;&amp; reconLenParam != 12),</span></div><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;        <span class="comment">//         &quot;staggered phase only presently supported for 18 and 12 reconstruct&quot;);</span></div><div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 4; i++) {</div><div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;          X[i] = u.<a class="code" href="classquda_1_1_lattice_field.html#a96f46542c595993b72818d3d031cd72f">X</a>()[i];</div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;          R[i] = u.<a class="code" href="classquda_1_1_lattice_field.html#a96eccffaa1381a45cd03db7bdc4af2f1">R</a>()[i];</div><div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;    ghost[i] = ghost_ ? ghost_[i] : 0;</div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;    faceVolumeCB[i] = u.<a class="code" href="classquda_1_1_lattice_field.html#a64969b1180e27da1fdbc1959f1cf644c">SurfaceCB</a>(i)*u.<a class="code" href="classquda_1_1_gauge_field.html#a8e0ae774c1566179db3e3c5a2bc0b226">Nface</a>(); <span class="comment">// face volume equals surface * depth</span></div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;        }</div><div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;<span class="preprocessor">#ifdef USE_TEXTURE_OBJECTS</span></div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;  <span class="keywordflow">if</span> (u.<a class="code" href="classquda_1_1_lattice_field.html#a644c9306ed8f513cdb2c88c755e305d8">Location</a>() == <a class="code" href="enum__quda_8h.html#a35de1312d8bed4b94234a3092907e0d9a184379764fab0f101cab6f19a8a14690">QUDA_CUDA_FIELD_LOCATION</a>) tex = static_cast&lt;const cudaGaugeField&amp;&gt;(u).Tex();</div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;  <span class="keywordflow">if</span> (!huge_alloc &amp;&amp; this-&gt;gauge != u.<a class="code" href="classquda_1_1_gauge_field.html#ab875db966189cb025989e43275f78830">Gauge_p</a>() &amp;&amp; !<span class="keyword">override</span>) {</div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;    <a class="code" href="util__quda_8h.html#af3bddfd9d113d50e8e0bbf58a35c5aac">errorQuda</a>(<span class="stringliteral">&quot;Cannot use texture read since data pointer does not equal field pointer - use with huge_alloc=true instead&quot;</span>);</div><div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;  }</div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;      }</div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;</div><div class="line"><a name="l01752"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_float_n_order.html#a3d75054bbf71b2bfbce6176f0a9c6a9b"> 1752</a></span>&#160;    <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html#a3d75054bbf71b2bfbce6176f0a9c6a9b">FloatNOrder</a>(<span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html">FloatNOrder</a> &amp;order)</div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;      : reconstruct(order.reconstruct), gauge(order.gauge), offset(order.offset),</div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;#ifdef USE_TEXTURE_OBJECTS</div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;  tex(order.tex), tex_offset(order.tex_offset),</div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;#endif</div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;  ghostExchange(order.ghostExchange),</div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;        volumeCB(order.volumeCB), stride(order.stride), geometry(order.geometry),</div><div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;  phaseOffset(order.phaseOffset), backup_h(nullptr), bytes(order.bytes)</div><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;      {</div><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;4; i++) {</div><div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;    X[i] = order.<a class="code" href="structquda_1_1gauge_1_1_float_n_order.html#a169c7c3f99436173404f592fadd0e2fa">X</a>[i];</div><div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;    R[i] = order.<a class="code" href="structquda_1_1gauge_1_1_float_n_order.html#ae9ec6f9486dc6215781f7161e719565a">R</a>[i];</div><div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;    ghost[i] = order.<a class="code" href="structquda_1_1gauge_1_1_float_n_order.html#ad6140ba547968a3dcb9cab8aa56152fd">ghost</a>[i];</div><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;    faceVolumeCB[i] = order.<a class="code" href="structquda_1_1gauge_1_1_float_n_order.html#ae0d16430a371cf6fbbe60e131f1f9959">faceVolumeCB</a>[i];</div><div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;  }</div><div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;      }</div><div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;</div><div class="line"><a name="l01769"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_float_n_order.html#a461472a1690f2a8e2cb2ab78d03b2693"> 1769</a></span>&#160;      __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html#a461472a1690f2a8e2cb2ab78d03b2693">load</a>(<a class="code" href="structquda_1_1gauge_1_1_float_n_order.html#a99a439936285a7bf1b2110df9ab0fe7e">complex</a> v[length / 2], <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> dir, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>, <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html#a3d100f3dfe5d8f8c84ce9fe115765896">real</a> inphase = 1.0)<span class="keyword"> const</span></div><div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;<span class="keyword">      </span>{</div><div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> M = reconLen / N;</div><div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;        <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html#a3d100f3dfe5d8f8c84ce9fe115765896">real</a> <a class="code" href="covdev__test_8cpp.html#a788da19b1cbae7d08eb18da226046dd7">tmp</a>[reconLen];</div><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;</div><div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;<span class="preprocessor">#pragma unroll</span></div><div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;M; i++){</div><div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;          <span class="comment">// first do texture load from memory</span></div><div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;<span class="preprocessor">#if defined(USE_TEXTURE_OBJECTS) &amp;&amp; defined(__CUDA_ARCH__)</span></div><div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;    <span class="keywordflow">if</span> (!huge_alloc) { <span class="comment">// use textures unless we have a huge alloc</span></div><div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;            TexVector vecTmp = tex1Dfetch_&lt;TexVector&gt;(tex, parity * tex_offset + (dir * M + i) * stride + x);</div><div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;            <span class="comment">// now insert into output array</span></div><div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;<span class="preprocessor">#pragma unroll</span></div><div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; N; j++) copy(tmp[i * N + j], reinterpret_cast&lt;real *&gt;(&amp;vecTmp)[j]);</div><div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;          } <span class="keywordflow">else</span></div><div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;          {</div><div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;            <span class="comment">// first load from memory</span></div><div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;            Vector vecTmp = vector_load&lt;Vector&gt;(gauge + parity * offset, (dir * M + i) * stride + x);</div><div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;            <span class="comment">// second do copy converting into register type</span></div><div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;<span class="preprocessor">#pragma unroll</span></div><div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;N; j++) copy(tmp[i*N+j], reinterpret_cast&lt;Float*&gt;(&amp;vecTmp)[j]);</div><div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;          }</div><div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;        }</div><div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;</div><div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;        <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html#a3d100f3dfe5d8f8c84ce9fe115765896">real</a> phase = 0.; <span class="comment">// TODO - add texture support for phases</span></div><div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;</div><div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;        <span class="keywordflow">if</span> (hasPhase) {</div><div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;          <span class="keywordflow">if</span> (static_phase&lt;stag_phase&gt;() &amp;&amp; (reconLen == 13 || use_inphase)) {</div><div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;            phase = inphase;</div><div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;          } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;            <a class="code" href="namespacequda.html#abf5b4d5728021e058d90ff1d07446399">copy</a>(phase, (gauge + parity * offset)[phaseOffset / <span class="keyword">sizeof</span>(Float) + stride * dir + x]);</div><div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;            phase *= <span class="keyword">static_cast&lt;</span><a class="code" href="structquda_1_1gauge_1_1_float_n_order.html#a3d100f3dfe5d8f8c84ce9fe115765896">real</a><span class="keyword">&gt;</span>(2.0) * <span class="keyword">static_cast&lt;</span><a class="code" href="structquda_1_1gauge_1_1_float_n_order.html#a3d100f3dfe5d8f8c84ce9fe115765896">real</a><span class="keyword">&gt;</span>(M_PI);</div><div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;          }</div><div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;        }</div><div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;</div><div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;        reconstruct.<a class="code" href="structquda_1_1gauge_1_1_reconstruct.html#aa79bdab5a60b084dfd2c9d0856956bad">Unpack</a>(v, tmp, x, dir, phase, X, R);</div><div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;      }</div><div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;</div><div class="line"><a name="l01808"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_float_n_order.html#a231bc6fbb3842003f423778ed750386a"> 1808</a></span>&#160;      __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html#a231bc6fbb3842003f423778ed750386a">save</a>(<span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html#a99a439936285a7bf1b2110df9ab0fe7e">complex</a> v[length / 2], <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> dir, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>)</div><div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;      {</div><div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> M = reconLen / N;</div><div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;        <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html#a3d100f3dfe5d8f8c84ce9fe115765896">real</a> <a class="code" href="covdev__test_8cpp.html#a788da19b1cbae7d08eb18da226046dd7">tmp</a>[reconLen];</div><div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;        reconstruct.<a class="code" href="structquda_1_1gauge_1_1_reconstruct.html#adb17cb7fb63831b2d88e784be6f9c30f">Pack</a>(tmp, v, x);</div><div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;</div><div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;<span class="preprocessor">#pragma unroll</span></div><div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;M; i++){</div><div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;    Vector vecTmp;</div><div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;    <span class="comment">// first do copy converting into storage type</span></div><div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;<span class="preprocessor">#pragma unroll</span></div><div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;N; j++) copy(reinterpret_cast&lt;Float*&gt;(&amp;vecTmp)[j], tmp[i*N+j]);</div><div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;    <span class="comment">// second do vectorized copy into memory</span></div><div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;          <a class="code" href="namespacequda.html#aaeda4e4f5aabf19dae35f28e4c8802b7">vector_store</a>(gauge + parity * offset, x + (dir * M + i) * stride, vecTmp);</div><div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;        }</div><div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;        <span class="keywordflow">if</span> (hasPhase) {</div><div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;          <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html#a3d100f3dfe5d8f8c84ce9fe115765896">real</a> phase = reconstruct.<a class="code" href="structquda_1_1gauge_1_1_reconstruct.html#a9edb9b70ed2cd0efb83d7bb62376475d">getPhase</a>(v);</div><div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;          <a class="code" href="namespacequda.html#abf5b4d5728021e058d90ff1d07446399">copy</a>((gauge + parity * offset)[phaseOffset / <span class="keyword">sizeof</span>(Float) + dir * stride + x],</div><div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;               static_cast&lt;real&gt;(phase / (2. * M_PI)));</div><div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;        }</div><div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;      }</div><div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;</div><div class="line"><a name="l01840"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_float_n_order.html#acebff5cb90da9c2082179b1d0e55ca00"> 1840</a></span>&#160;      __device__ __host__ <span class="keyword">inline</span> <a class="code" href="structquda_1_1gauge__wrapper.html">gauge_wrapper&lt;real, Accessor&gt;</a> <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html#acebff5cb90da9c2082179b1d0e55ca00">operator()</a>(<span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5261c5f7423edd78086a027390e11983">x_cb</a>, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>, <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html#a3d100f3dfe5d8f8c84ce9fe115765896">real</a> phase = 1.0)</div><div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;      {</div><div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="structquda_1_1gauge__wrapper.html">gauge_wrapper&lt;real, Accessor&gt;</a>(*<span class="keyword">this</span>, <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>, <a class="code" href="structquda_1_1gauge__wrapper.html#a5261c5f7423edd78086a027390e11983">x_cb</a>, <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>, <a class="code" href="structquda_1_1gauge__wrapper.html#a953756c13d685eacf355434ee7897a3c">phase</a>);</div><div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;      }</div><div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;</div><div class="line"><a name="l01855"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_float_n_order.html#ac79546fdf132f89630f3ffabcac9924a"> 1855</a></span>&#160;      __device__ __host__ <span class="keyword">inline</span> <span class="keyword">const</span> <a class="code" href="structquda_1_1gauge__wrapper.html">gauge_wrapper&lt;real, Accessor&gt;</a> <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html#ac79546fdf132f89630f3ffabcac9924a">operator()</a>(<span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5261c5f7423edd78086a027390e11983">x_cb</a>, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>,</div><div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;                                                                                <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html#a3d100f3dfe5d8f8c84ce9fe115765896">real</a> phase = 1.0)<span class="keyword"> const</span></div><div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;<span class="keyword">      </span>{</div><div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="structquda_1_1gauge__wrapper.html">gauge_wrapper&lt;real, Accessor&gt;</a>(<span class="keyword">const_cast&lt;</span><a class="code" href="structquda_1_1gauge_1_1_float_n_order.html">Accessor</a> &amp;<span class="keyword">&gt;</span>(*this), <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>, <a class="code" href="structquda_1_1gauge__wrapper.html#a5261c5f7423edd78086a027390e11983">x_cb</a>, <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>, <a class="code" href="structquda_1_1gauge__wrapper.html#a953756c13d685eacf355434ee7897a3c">phase</a>);</div><div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;      }</div><div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;</div><div class="line"><a name="l01861"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_float_n_order.html#a0bf0b4220ecf3916c186f61539fffffa"> 1861</a></span>&#160;      __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html#a0bf0b4220ecf3916c186f61539fffffa">loadGhost</a>(<a class="code" href="structquda_1_1gauge_1_1_float_n_order.html#a99a439936285a7bf1b2110df9ab0fe7e">complex</a> v[length / 2], <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> dir, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>, <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html#a3d100f3dfe5d8f8c84ce9fe115765896">real</a> inphase = 1.0)<span class="keyword"> const</span></div><div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;<span class="keyword">      </span>{</div><div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;        <span class="keywordflow">if</span> (!ghost[dir]) { <span class="comment">// load from main field not separate array</span></div><div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;          load(v, volumeCB + x, dir, parity, inphase); <span class="comment">// an offset of size volumeCB puts us at the padded region</span></div><div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;          <span class="comment">// This also works perfectly when phases are stored. No need to change this.</span></div><div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">int</span> M = reconLen / N;</div><div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;          <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html#a3d100f3dfe5d8f8c84ce9fe115765896">real</a> <a class="code" href="covdev__test_8cpp.html#a788da19b1cbae7d08eb18da226046dd7">tmp</a>[reconLen];</div><div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;</div><div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;<span class="preprocessor">#pragma unroll</span></div><div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;M; i++) {</div><div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;      <span class="comment">// first do vectorized copy from memory into registers</span></div><div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;            Vector vecTmp = vector_load&lt;Vector&gt;(</div><div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;                ghost[dir] + parity * faceVolumeCB[dir] * (M * N + hasPhase), i * faceVolumeCB[dir] + x);</div><div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;            <span class="comment">// second do copy converting into register type</span></div><div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;<span class="preprocessor">#pragma unroll</span></div><div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; N; j++) copy(tmp[i * N + j], reinterpret_cast&lt;Float *&gt;(&amp;vecTmp)[j]);</div><div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;          }</div><div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;          <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html#a3d100f3dfe5d8f8c84ce9fe115765896">real</a> phase = 0.;</div><div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;</div><div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;          <span class="keywordflow">if</span> (hasPhase) {</div><div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;</div><div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;            <span class="comment">// if(stag_phase == QUDA_STAGGERED_PHASE_MILC )  {</span></div><div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;            <span class="comment">//   phase = inphase &lt; static_cast&lt;Float&gt;(0) ? static_cast&lt;Float&gt;(-1./(2.*M_PI)) : static_cast&lt;Float&gt;(1./2.*M_PI);</span></div><div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;            <span class="comment">// } else {</span></div><div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;            <a class="code" href="namespacequda.html#abf5b4d5728021e058d90ff1d07446399">copy</a>(phase, ghost[dir][parity * faceVolumeCB[dir] * (M * N + 1) + faceVolumeCB[dir] * M * N + x]);</div><div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;            phase *= <span class="keyword">static_cast&lt;</span><a class="code" href="structquda_1_1gauge_1_1_float_n_order.html#a3d100f3dfe5d8f8c84ce9fe115765896">real</a><span class="keyword">&gt;</span>(2.0) * <span class="keyword">static_cast&lt;</span><a class="code" href="structquda_1_1gauge_1_1_float_n_order.html#a3d100f3dfe5d8f8c84ce9fe115765896">real</a><span class="keyword">&gt;</span>(M_PI);</div><div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;            <span class="comment">// }</span></div><div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;          }</div><div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;          reconstruct.<a class="code" href="structquda_1_1gauge_1_1_reconstruct.html#aa79bdab5a60b084dfd2c9d0856956bad">Unpack</a>(v, tmp, x, dir, phase, X, R);</div><div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;        }</div><div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;      }</div><div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;</div><div class="line"><a name="l01894"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_float_n_order.html#a126e265e8de53c8164f399d9d5df2832"> 1894</a></span>&#160;      __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html#a126e265e8de53c8164f399d9d5df2832">saveGhost</a>(<span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html#a99a439936285a7bf1b2110df9ab0fe7e">complex</a> v[length / 2], <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> dir, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>)</div><div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;      {</div><div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;        <span class="keywordflow">if</span> (!ghost[dir]) { <span class="comment">// store in main field not separate array</span></div><div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;          save(v, volumeCB + x, dir, parity); <span class="comment">// an offset of size volumeCB puts us at the padded region</span></div><div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">int</span> M = reconLen / N;</div><div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;          <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html#a3d100f3dfe5d8f8c84ce9fe115765896">real</a> <a class="code" href="covdev__test_8cpp.html#a788da19b1cbae7d08eb18da226046dd7">tmp</a>[reconLen];</div><div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;          reconstruct.<a class="code" href="structquda_1_1gauge_1_1_reconstruct.html#adb17cb7fb63831b2d88e784be6f9c30f">Pack</a>(tmp, v, x);</div><div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;</div><div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;<span class="preprocessor">#pragma unroll</span></div><div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;M; i++) {</div><div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;      Vector vecTmp;</div><div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;      <span class="comment">// first do copy converting into storage type</span></div><div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;<span class="preprocessor">#pragma unroll</span></div><div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;N; j++) copy(reinterpret_cast&lt;Float*&gt;(&amp;vecTmp)[j], tmp[i*N+j]);</div><div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;      <span class="comment">// second do vectorized copy into memory</span></div><div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;      <a class="code" href="namespacequda.html#aaeda4e4f5aabf19dae35f28e4c8802b7">vector_store</a>(ghost[dir]+parity*faceVolumeCB[dir]*(M*N + hasPhase), i*faceVolumeCB[dir]+x, vecTmp);</div><div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;          }</div><div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;</div><div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;    <span class="keywordflow">if</span> (hasPhase) {</div><div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;            <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html#a3d100f3dfe5d8f8c84ce9fe115765896">real</a> phase = reconstruct.<a class="code" href="structquda_1_1gauge_1_1_reconstruct.html#a9edb9b70ed2cd0efb83d7bb62376475d">getPhase</a>(v);</div><div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;            <a class="code" href="namespacequda.html#abf5b4d5728021e058d90ff1d07446399">copy</a>(ghost[dir][parity * faceVolumeCB[dir] * (M * N + 1) + faceVolumeCB[dir] * M * N + x],</div><div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;                 static_cast&lt;real&gt;(phase / (2. * M_PI)));</div><div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;          }</div><div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;        }</div><div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;      }</div><div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;</div><div class="line"><a name="l01931"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_float_n_order.html#a073d8b12b5cfc55cbd06311cda5b5581"> 1931</a></span>&#160;      __device__ __host__ <span class="keyword">inline</span> <a class="code" href="structquda_1_1gauge__ghost__wrapper.html">gauge_ghost_wrapper&lt;real, Accessor&gt;</a> <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html#a073d8b12b5cfc55cbd06311cda5b5581">Ghost</a>(<span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>, <span class="keywordtype">int</span> ghost_idx, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>,</div><div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;                                                                           <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html#a3d100f3dfe5d8f8c84ce9fe115765896">real</a> phase = 1.0)</div><div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;      {</div><div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="structquda_1_1gauge__ghost__wrapper.html">gauge_ghost_wrapper&lt;real, Accessor&gt;</a>(*<span class="keyword">this</span>, <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>, ghost_idx, <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>, <a class="code" href="structquda_1_1gauge__wrapper.html#a953756c13d685eacf355434ee7897a3c">phase</a>);</div><div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;      }</div><div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;</div><div class="line"><a name="l01947"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_float_n_order.html#a7e43649d3648abc5293fc202d43a435c"> 1947</a></span>&#160;      __device__ __host__ <span class="keyword">inline</span> <span class="keyword">const</span> <a class="code" href="structquda_1_1gauge__ghost__wrapper.html">gauge_ghost_wrapper&lt;real, Accessor&gt;</a> <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html#a7e43649d3648abc5293fc202d43a435c">Ghost</a>(<span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>, <span class="keywordtype">int</span> ghost_idx, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>,</div><div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;                                                                                 <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html#a3d100f3dfe5d8f8c84ce9fe115765896">real</a> phase = 1.0)<span class="keyword"> const</span></div><div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;<span class="keyword">      </span>{</div><div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="structquda_1_1gauge__ghost__wrapper.html">gauge_ghost_wrapper&lt;real, Accessor&gt;</a>(<span class="keyword">const_cast&lt;</span><a class="code" href="structquda_1_1gauge_1_1_float_n_order.html">Accessor</a> &amp;<span class="keyword">&gt;</span>(*this), <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>, ghost_idx, <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>, <a class="code" href="structquda_1_1gauge__wrapper.html#a953756c13d685eacf355434ee7897a3c">phase</a>);</div><div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;      }</div><div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;</div><div class="line"><a name="l01953"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_float_n_order.html#a8c273a958c0835a1935920c93089afa6"> 1953</a></span>&#160;      __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html#a8c273a958c0835a1935920c93089afa6">loadGhostEx</a>(<a class="code" href="structquda_1_1gauge_1_1_float_n_order.html#a99a439936285a7bf1b2110df9ab0fe7e">complex</a> v[length / 2], <span class="keywordtype">int</span> buff_idx, <span class="keywordtype">int</span> extended_idx, <span class="keywordtype">int</span> dir,</div><div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;                                                  <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>, <span class="keywordtype">int</span> g, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> R[])<span class="keyword"> const</span></div><div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;<span class="keyword">      </span>{</div><div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> M = reconLen / N;</div><div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;        <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html#a3d100f3dfe5d8f8c84ce9fe115765896">real</a> <a class="code" href="covdev__test_8cpp.html#a788da19b1cbae7d08eb18da226046dd7">tmp</a>[reconLen];</div><div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;</div><div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;<span class="preprocessor">#pragma unroll</span></div><div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;M; i++) {</div><div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;    <span class="comment">// first do vectorized copy from memory</span></div><div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;    Vector vecTmp = vector_load&lt;Vector&gt;(ghost[<a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>] + ((dir*2+<a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>)*geometry+g)*R[<a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>]*faceVolumeCB[<a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>]*(M*N + hasPhase),</div><div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;                +i*R[dim]*faceVolumeCB[dim]+buff_idx);</div><div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;    <span class="comment">// second do copy converting into register type</span></div><div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;<span class="preprocessor">#pragma unroll</span></div><div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;N; j++) copy(tmp[i*N+j], reinterpret_cast&lt;Float*&gt;(&amp;vecTmp)[j]);</div><div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;  }</div><div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;        <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html#a3d100f3dfe5d8f8c84ce9fe115765896">real</a> phase = 0.;</div><div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;        <span class="keywordflow">if</span> (hasPhase)</div><div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;          <a class="code" href="namespacequda.html#abf5b4d5728021e058d90ff1d07446399">copy</a>(phase,</div><div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;               ghost[dim][((dir * 2 + parity) * geometry + g) * R[dim] * faceVolumeCB[dim] * (M * N + 1)</div><div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;                          + R[dim] * faceVolumeCB[dim] * M * N + buff_idx]);</div><div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;</div><div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;        <span class="comment">// use the extended_idx to determine the boundary condition</span></div><div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;        reconstruct.<a class="code" href="structquda_1_1gauge_1_1_reconstruct.html#aa79bdab5a60b084dfd2c9d0856956bad">Unpack</a>(v, tmp, extended_idx, g, 2. * M_PI * phase, X, R);</div><div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;      }</div><div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;</div><div class="line"><a name="l01978"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_float_n_order.html#aa4b32734977faad44c29b86f7367eec5"> 1978</a></span>&#160;      __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html#aa4b32734977faad44c29b86f7367eec5">saveGhostEx</a>(<span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html#a99a439936285a7bf1b2110df9ab0fe7e">complex</a> v[length / 2], <span class="keywordtype">int</span> buff_idx, <span class="keywordtype">int</span> extended_idx, <span class="keywordtype">int</span> dir,</div><div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;                                                  <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>, <span class="keywordtype">int</span> g, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> R[])</div><div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;      {</div><div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> M = reconLen / N;</div><div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;        <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html#a3d100f3dfe5d8f8c84ce9fe115765896">real</a> <a class="code" href="covdev__test_8cpp.html#a788da19b1cbae7d08eb18da226046dd7">tmp</a>[reconLen];</div><div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;        <span class="comment">// use the extended_idx to determine the boundary condition</span></div><div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;        reconstruct.<a class="code" href="structquda_1_1gauge_1_1_reconstruct.html#adb17cb7fb63831b2d88e784be6f9c30f">Pack</a>(tmp, v, extended_idx);</div><div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;</div><div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;<span class="preprocessor">#pragma unroll</span></div><div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;M; i++) {</div><div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;      Vector vecTmp;</div><div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;      <span class="comment">// first do copy converting into storage type</span></div><div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;<span class="preprocessor">#pragma unroll</span></div><div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;N; j++) copy(reinterpret_cast&lt;Float*&gt;(&amp;vecTmp)[j], tmp[i*N+j]);</div><div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;      <span class="comment">// second do vectorized copy to memory</span></div><div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;      <a class="code" href="namespacequda.html#aaeda4e4f5aabf19dae35f28e4c8802b7">vector_store</a>(ghost[dim] + ((dir*2+parity)*geometry+g)*R[dim]*faceVolumeCB[dim]*(M*N + hasPhase),</div><div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;       i*R[dim]*faceVolumeCB[dim]+buff_idx, vecTmp);</div><div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;    }</div><div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;    <span class="keywordflow">if</span> (hasPhase) {</div><div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;            <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html#a3d100f3dfe5d8f8c84ce9fe115765896">real</a> phase = reconstruct.<a class="code" href="structquda_1_1gauge_1_1_reconstruct.html#a9edb9b70ed2cd0efb83d7bb62376475d">getPhase</a>(v);</div><div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;            <a class="code" href="namespacequda.html#abf5b4d5728021e058d90ff1d07446399">copy</a>(ghost[dim][((dir * 2 + parity) * geometry + g) * R[dim] * faceVolumeCB[dim] * (M * N + 1)</div><div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;                            + R[dim] * faceVolumeCB[dim] * M * N + buff_idx],</div><div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;                 static_cast&lt;real&gt;(phase / (2. * M_PI)));</div><div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;          }</div><div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;      }</div><div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;</div><div class="line"><a name="l02007"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_float_n_order.html#a714541bb8db859517a8c014473c997ae"> 2007</a></span>&#160;      <span class="keywordtype">void</span> <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html#a714541bb8db859517a8c014473c997ae">save</a>() {</div><div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;  <span class="keywordflow">if</span> (backup_h) <a class="code" href="util__quda_8h.html#af3bddfd9d113d50e8e0bbf58a35c5aac">errorQuda</a>(<span class="stringliteral">&quot;Already allocated host backup&quot;</span>);</div><div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;  backup_h = <a class="code" href="malloc__quda_8h.html#a45d92b2c2231b848192b3086283d05b6">safe_malloc</a>(bytes);</div><div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;  cudaMemcpy(backup_h, gauge, bytes, cudaMemcpyDeviceToHost);</div><div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;  <a class="code" href="util__quda_8h.html#a7668e6580e0f57b0db3112fae4959e34">checkCudaError</a>();</div><div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;      }</div><div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;</div><div class="line"><a name="l02017"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_float_n_order.html#adce9f5c005c8887b53cf967836ee98b3"> 2017</a></span>&#160;      <span class="keywordtype">void</span> <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html#adce9f5c005c8887b53cf967836ee98b3">load</a>() {</div><div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;  cudaMemcpy(gauge, backup_h, bytes, cudaMemcpyHostToDevice);</div><div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;  <a class="code" href="malloc__quda_8h.html#ad733cb3f6cac705c8db7b0afad9b3843">host_free</a>(backup_h);</div><div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;  backup_h = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;  <a class="code" href="util__quda_8h.html#a7668e6580e0f57b0db3112fae4959e34">checkCudaError</a>();</div><div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;      }</div><div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;</div><div class="line"><a name="l02024"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_float_n_order.html#a69d904539395a0d212b117d2b73f6ff3"> 2024</a></span>&#160;      <span class="keywordtype">size_t</span> <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html#a69d904539395a0d212b117d2b73f6ff3">Bytes</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> reconLen * <span class="keyword">sizeof</span>(Float); }</div><div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;      };</div><div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;</div><div class="line"><a name="l02033"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_s.html"> 2033</a></span>&#160;      <span class="keyword">template</span> &lt;<span class="keyword">typename</span> real, <span class="keywordtype">int</span> length&gt; <span class="keyword">struct </span><a class="code" href="structquda_1_1gauge_1_1_s.html">S</a> {</div><div class="line"><a name="l02034"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_s.html#a7b030246421845a9eea7fc4cdb5d8a99"> 2034</a></span>&#160;        real v[<a class="code" href="gauge__force__test_8cpp.html#a2bcd2adde36b870d02897e694ecc39cb">length</a>];</div><div class="line"><a name="l02035"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_s.html#a8d0ce83e52bd4168a439e1338d0b00be"> 2035</a></span>&#160;        __host__ __device__ <span class="keyword">const</span> real &amp;<a class="code" href="structquda_1_1gauge_1_1_s.html#a8d0ce83e52bd4168a439e1338d0b00be">operator[]</a>(<span class="keywordtype">int</span> i)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> v[i]; }</div><div class="line"><a name="l02036"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_s.html#a33ae720c2c7eb345742b69f34fdeeb74"> 2036</a></span>&#160;        __host__ __device__ real &amp;<a class="code" href="structquda_1_1gauge_1_1_s.html#a33ae720c2c7eb345742b69f34fdeeb74">operator[]</a>(<span class="keywordtype">int</span> i) { <span class="keywordflow">return</span> v[i]; }</div><div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;      };</div><div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;</div><div class="line"><a name="l02043"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_legacy_order.html"> 2043</a></span>&#160;      <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Float, <span class="keywordtype">int</span> length&gt; <span class="keyword">struct </span><a class="code" href="structquda_1_1gauge_1_1_legacy_order.html">LegacyOrder</a> {</div><div class="line"><a name="l02044"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_legacy_order.html#a9829731b459477edbdcf63d0f942fe2d"> 2044</a></span>&#160;        <span class="keyword">using</span> <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html">Accessor</a> = <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html">LegacyOrder&lt;Float, length&gt;</a>;</div><div class="line"><a name="l02045"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_legacy_order.html#a74cb938c3e9438d4100efb0bd755c142"> 2045</a></span>&#160;        <span class="keyword">using</span> <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a74cb938c3e9438d4100efb0bd755c142">real</a> = <span class="keyword">typename</span> <a class="code" href="structquda_1_1mapper.html">mapper&lt;Float&gt;::type</a>;</div><div class="line"><a name="l02046"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_legacy_order.html#a2493fde8fb5407c76f393ce6d4fea448"> 2046</a></span>&#160;        <span class="keyword">using</span> <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a2493fde8fb5407c76f393ce6d4fea448">complex</a> = <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a2493fde8fb5407c76f393ce6d4fea448">complex&lt;real&gt;</a>;</div><div class="line"><a name="l02047"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_legacy_order.html#ac0e52c9b01f85a9c27a6b6c45b69f6d1"> 2047</a></span>&#160;        Float *ghost[<a class="code" href="quda__constants_8h.html#aa69925e50554e0ea81dd89fdcb572bbc">QUDA_MAX_DIM</a>];</div><div class="line"><a name="l02048"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_legacy_order.html#a345cb1bedd8061a2e2fb2790024f4ea3"> 2048</a></span>&#160;        <span class="keywordtype">int</span> faceVolumeCB[<a class="code" href="quda__constants_8h.html#aa69925e50554e0ea81dd89fdcb572bbc">QUDA_MAX_DIM</a>];</div><div class="line"><a name="l02049"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_legacy_order.html#a999a9379f1421034c388eb760c7e9a1d"> 2049</a></span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a999a9379f1421034c388eb760c7e9a1d">volumeCB</a>;</div><div class="line"><a name="l02050"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_legacy_order.html#a458bc13f94e1d88b4894f3d42adb9bf4"> 2050</a></span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a458bc13f94e1d88b4894f3d42adb9bf4">stride</a>;</div><div class="line"><a name="l02051"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_legacy_order.html#a35ce872b61adec2b381d814e12e61dd1"> 2051</a></span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a35ce872b61adec2b381d814e12e61dd1">geometry</a>;</div><div class="line"><a name="l02052"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_legacy_order.html#ab453ab1743da327fe21750ab43543122"> 2052</a></span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#ab453ab1743da327fe21750ab43543122">hasPhase</a>;</div><div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;</div><div class="line"><a name="l02054"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_legacy_order.html#afd5abf19c6706a4b8f1e940b4bad491b"> 2054</a></span>&#160;        <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#afd5abf19c6706a4b8f1e940b4bad491b">LegacyOrder</a>(<span class="keyword">const</span> <a class="code" href="classquda_1_1_gauge_field.html">GaugeField</a> &amp;u, Float **ghost_) :</div><div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;          volumeCB(u.VolumeCB()),</div><div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;          stride(u.Stride()),</div><div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;          geometry(u.Geometry()),</div><div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;          hasPhase(0)</div><div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;        {</div><div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;          <span class="keywordflow">if</span> (geometry == <a class="code" href="enum__quda_8h.html#a7589b295019a40887f1c10c76555feeaadc1a5ef802228fe4edd42346172c7605">QUDA_COARSE_GEOMETRY</a>)</div><div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;            <a class="code" href="util__quda_8h.html#af3bddfd9d113d50e8e0bbf58a35c5aac">errorQuda</a>(<span class="stringliteral">&quot;This accessor does not support coarse-link fields (lacks support for bidirectional ghost zone&quot;</span>);</div><div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;</div><div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 4; i++) {</div><div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;            ghost[i] = (ghost_) ? ghost_[i] : (Float *)(u.<a class="code" href="classquda_1_1_gauge_field.html#aedfa91e714c61b8e11caec9d2703dcfa">Ghost</a>()[i]);</div><div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;            faceVolumeCB[i] = u.<a class="code" href="classquda_1_1_lattice_field.html#a64969b1180e27da1fdbc1959f1cf644c">SurfaceCB</a>(i) * u.<a class="code" href="classquda_1_1_gauge_field.html#a8e0ae774c1566179db3e3c5a2bc0b226">Nface</a>(); <span class="comment">// face volume equals surface * depth</span></div><div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;          }</div><div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;        }</div><div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;</div><div class="line"><a name="l02069"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_legacy_order.html#a995a26bcee0938da5b912caf26346540"> 2069</a></span>&#160;        <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a995a26bcee0938da5b912caf26346540">LegacyOrder</a>(<span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html">LegacyOrder</a> &amp;order) :</div><div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;          volumeCB(order.volumeCB),</div><div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;          stride(order.stride),</div><div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;          geometry(order.geometry),</div><div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;          hasPhase(0)</div><div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;        {</div><div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 4; i++) {</div><div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;            ghost[i] = order.<a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#ac0e52c9b01f85a9c27a6b6c45b69f6d1">ghost</a>[i];</div><div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;            faceVolumeCB[i] = order.<a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a345cb1bedd8061a2e2fb2790024f4ea3">faceVolumeCB</a>[i];</div><div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;          }</div><div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;        }</div><div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;</div><div class="line"><a name="l02081"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_legacy_order.html#aba01a90167560e681244d0d09d7da92f"> 2081</a></span>&#160;        __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#aba01a90167560e681244d0d09d7da92f">loadGhost</a>(<a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a2493fde8fb5407c76f393ce6d4fea448">complex</a> v[length / 2], <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> dir, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>, <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a74cb938c3e9438d4100efb0bd755c142">real</a> phase = 1.0)<span class="keyword"> const</span></div><div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;<span class="keyword">        </span>{</div><div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;<span class="preprocessor">#if defined( __CUDA_ARCH__) &amp;&amp; !defined(DISABLE_TROVE)</span></div><div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;          <span class="keyword">typedef</span> <a class="code" href="structquda_1_1gauge_1_1_s.html">S&lt;Float, length&gt;</a> structure;</div><div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;          trove::coalesced_ptr&lt;structure&gt; ghost_((structure *)ghost[dir]);</div><div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;          structure v_ = ghost_[parity * faceVolumeCB[dir] + x];</div><div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;          <span class="keyword">auto</span> v_ = &amp;ghost[dir][(parity * faceVolumeCB[dir] + x) * length];</div><div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; length / 2; i++) v[i] = <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a2493fde8fb5407c76f393ce6d4fea448">complex</a>(v_[2 * i + 0], v_[2 * i + 1]);</div><div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;        }</div><div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;</div><div class="line"><a name="l02093"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_legacy_order.html#a044d74ff62c69d3c261b14d6f1bb7a41"> 2093</a></span>&#160;        __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a044d74ff62c69d3c261b14d6f1bb7a41">saveGhost</a>(<span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a2493fde8fb5407c76f393ce6d4fea448">complex</a> v[length / 2], <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> dir, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>)</div><div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;        {</div><div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;<span class="preprocessor">#if defined( __CUDA_ARCH__) &amp;&amp; !defined(DISABLE_TROVE)</span></div><div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;          <span class="keyword">typedef</span> <a class="code" href="structquda_1_1gauge_1_1_s.html">S&lt;Float, length&gt;</a> structure;</div><div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;          trove::coalesced_ptr&lt;structure&gt; ghost_((structure *)ghost[dir]);</div><div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;          structure v_;</div><div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; length / 2; i++) {</div><div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;            v_[2 * i + 0] = (Float)v[i].<a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a74cb938c3e9438d4100efb0bd755c142">real</a>();</div><div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;            v_[2 * i + 1] = (Float)v[i].imag();</div><div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;          }</div><div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;          ghost_[parity * faceVolumeCB[dir] + x] = v_;</div><div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;          <span class="keyword">auto</span> v_ = &amp;ghost[dir][(parity * faceVolumeCB[dir] + x) * length];</div><div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; length / 2; i++) {</div><div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;            v_[2 * i + 0] = (Float)v[i].<a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a74cb938c3e9438d4100efb0bd755c142">real</a>();</div><div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;            v_[2 * i + 1] = (Float)v[i].imag();</div><div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;          }</div><div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;        }</div><div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;</div><div class="line"><a name="l02123"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_legacy_order.html#a6ccfe9eb0a06f632c0edc1c19067fd6e"> 2123</a></span>&#160;        __device__ __host__ <span class="keyword">inline</span> <a class="code" href="structquda_1_1gauge__ghost__wrapper.html">gauge_ghost_wrapper&lt;real, Accessor&gt;</a> <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a6ccfe9eb0a06f632c0edc1c19067fd6e">Ghost</a>(<span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>, <span class="keywordtype">int</span> ghost_idx, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>,</div><div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;                                                                             <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a74cb938c3e9438d4100efb0bd755c142">real</a> phase = 1.0)</div><div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;        {</div><div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="structquda_1_1gauge__ghost__wrapper.html">gauge_ghost_wrapper&lt;real, Accessor&gt;</a>(*<span class="keyword">this</span>, <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>, ghost_idx, <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>, <a class="code" href="structquda_1_1gauge__wrapper.html#a953756c13d685eacf355434ee7897a3c">phase</a>);</div><div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;        }</div><div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;</div><div class="line"><a name="l02139"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_legacy_order.html#a27fd815a8bcf9c26feb5d0c2fe397896"> 2139</a></span>&#160;        __device__ __host__ <span class="keyword">inline</span> <span class="keyword">const</span> <a class="code" href="structquda_1_1gauge__ghost__wrapper.html">gauge_ghost_wrapper&lt;real, Accessor&gt;</a> <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a27fd815a8bcf9c26feb5d0c2fe397896">Ghost</a>(<span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>, <span class="keywordtype">int</span> ghost_idx, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>,</div><div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;                                                                                   <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a74cb938c3e9438d4100efb0bd755c142">real</a> phase = 1.0)<span class="keyword"> const</span></div><div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;<span class="keyword">        </span>{</div><div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="structquda_1_1gauge__ghost__wrapper.html">gauge_ghost_wrapper&lt;real, Accessor&gt;</a>(<span class="keyword">const_cast&lt;</span><a class="code" href="structquda_1_1gauge_1_1_legacy_order.html">Accessor</a> &amp;<span class="keyword">&gt;</span>(*this), <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>, ghost_idx, <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>, <a class="code" href="structquda_1_1gauge__wrapper.html#a953756c13d685eacf355434ee7897a3c">phase</a>);</div><div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;        }</div><div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;</div><div class="line"><a name="l02145"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_legacy_order.html#a6389bc5655dad026b644dae7a0cee278"> 2145</a></span>&#160;        __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a6389bc5655dad026b644dae7a0cee278">loadGhostEx</a>(<a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a2493fde8fb5407c76f393ce6d4fea448">complex</a> v[length / 2], <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> dummy, <span class="keywordtype">int</span> dir, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>, <span class="keywordtype">int</span> g,</div><div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;                                                    <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> R[])<span class="keyword"> const</span></div><div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;<span class="keyword">        </span>{</div><div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;<span class="preprocessor">#if defined( __CUDA_ARCH__) &amp;&amp; !defined(DISABLE_TROVE)</span></div><div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;  <span class="keyword">typedef</span> <a class="code" href="structquda_1_1gauge_1_1_s.html">S&lt;Float,length&gt;</a> structure;</div><div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;  trove::coalesced_ptr&lt;structure&gt; ghost_((structure*)ghost[dim]);</div><div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;  structure v_ = ghost_[((dir*2+<a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>)*R[dim]*faceVolumeCB[dim] + x)*geometry+g];</div><div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;          <span class="keyword">auto</span> v_ = &amp;ghost[<a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>][(((dir * 2 + <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>) * R[dim] * faceVolumeCB[dim] + x) * geometry + g) * length];</div><div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; length / 2; i++) v[i] = <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a2493fde8fb5407c76f393ce6d4fea448">complex</a>(v_[2 * i + 0], v_[2 * i + 1]);</div><div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;        }</div><div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;</div><div class="line"><a name="l02158"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_legacy_order.html#ae7a243d99fec1375a0679aa843812198"> 2158</a></span>&#160;        __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#ae7a243d99fec1375a0679aa843812198">saveGhostEx</a>(<span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a2493fde8fb5407c76f393ce6d4fea448">complex</a> v[length / 2], <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> dummy, <span class="keywordtype">int</span> dir, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>,</div><div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;                                                    <span class="keywordtype">int</span> g, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> R[])</div><div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;        {</div><div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;<span class="preprocessor">#if defined( __CUDA_ARCH__) &amp;&amp; !defined(DISABLE_TROVE)</span></div><div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;          <span class="keyword">typedef</span> <a class="code" href="structquda_1_1gauge_1_1_s.html">S&lt;Float, length&gt;</a> structure;</div><div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;          trove::coalesced_ptr&lt;structure&gt; ghost_((structure *)ghost[dim]);</div><div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;          structure v_;</div><div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; length / 2; i++) {</div><div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;            v_[2 * i + 0] = (Float)v[i].<a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a74cb938c3e9438d4100efb0bd755c142">real</a>();</div><div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;            v_[2 * i + 1] = (Float)v[i].imag();</div><div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;          }</div><div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;          ghost_[((dir * 2 + <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>) * R[dim] * faceVolumeCB[dim] + x) * geometry + g] = v_;</div><div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;          <span class="keyword">auto</span> v_ = &amp;ghost[<a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>][(((dir * 2 + <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>) * R[dim] * faceVolumeCB[dim] + x) * geometry + g) * length];</div><div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; length / 2; i++) {</div><div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;            v_[2 * i + 0] = (Float)v[i].<a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a74cb938c3e9438d4100efb0bd755c142">real</a>();</div><div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;            v_[2 * i + 1] = (Float)v[i].imag();</div><div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;          }</div><div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;        }</div><div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;      };</div><div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;</div><div class="line"><a name="l02184"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_q_d_p_order.html"> 2184</a></span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Float, <span class="keywordtype">int</span> length&gt; <span class="keyword">struct </span><a class="code" href="structquda_1_1gauge_1_1_q_d_p_order.html">QDPOrder</a> : <span class="keyword">public</span> <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html">LegacyOrder</a>&lt;Float,length&gt; {</div><div class="line"><a name="l02185"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_q_d_p_order.html#aa6c8f5c4a1792028f713d621d4471381"> 2185</a></span>&#160;      <span class="keyword">using</span> <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html">Accessor</a> = <a class="code" href="structquda_1_1gauge_1_1_q_d_p_order.html">QDPOrder&lt;Float, length&gt;</a>;</div><div class="line"><a name="l02186"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_q_d_p_order.html#a9922e5625d4423f361c4f5f2282c07a9"> 2186</a></span>&#160;      <span class="keyword">using</span> <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a74cb938c3e9438d4100efb0bd755c142">real</a> = <span class="keyword">typename</span> <a class="code" href="structquda_1_1mapper.html">mapper&lt;Float&gt;::type</a>;</div><div class="line"><a name="l02187"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_q_d_p_order.html#af127fb73d1170d011fd727e766825189"> 2187</a></span>&#160;      <span class="keyword">using</span> <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a2493fde8fb5407c76f393ce6d4fea448">complex</a> = <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a2493fde8fb5407c76f393ce6d4fea448">complex&lt;real&gt;</a>;</div><div class="line"><a name="l02188"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_q_d_p_order.html#ad477b1247e176c6e95caa99039110367"> 2188</a></span>&#160;      Float *<a class="code" href="structquda_1_1gauge__wrapper.html#a74e48d66e79a75aa5b890a214e27028e">gauge</a>[<a class="code" href="quda__constants_8h.html#aa69925e50554e0ea81dd89fdcb572bbc">QUDA_MAX_DIM</a>];</div><div class="line"><a name="l02189"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_q_d_p_order.html#a168d11efaa373f4d5ac00716c311e732"> 2189</a></span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge_1_1_q_d_p_order.html#a168d11efaa373f4d5ac00716c311e732">volumeCB</a>;</div><div class="line"><a name="l02190"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_q_d_p_order.html#a650891d0d1f90bf9a447db9bb957173f"> 2190</a></span>&#160;    <a class="code" href="structquda_1_1gauge_1_1_q_d_p_order.html#a650891d0d1f90bf9a447db9bb957173f">QDPOrder</a>(<span class="keyword">const</span> <a class="code" href="classquda_1_1_gauge_field.html">GaugeField</a> &amp;u, Float *gauge_=0, Float **ghost_=0)</div><div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;      : <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html">LegacyOrder</a>&lt;Float,length&gt;(u, ghost_), volumeCB(u.VolumeCB())</div><div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;  { <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;4; i++) gauge[i] = gauge_ ? ((Float**)gauge_)[i] : ((Float**)u.<a class="code" href="classquda_1_1_gauge_field.html#ab875db966189cb025989e43275f78830">Gauge_p</a>())[i]; }</div><div class="line"><a name="l02193"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_q_d_p_order.html#a20da02f53f384094cd538c4a91712634"> 2193</a></span>&#160;    <a class="code" href="structquda_1_1gauge_1_1_q_d_p_order.html#a20da02f53f384094cd538c4a91712634">QDPOrder</a>(<span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_q_d_p_order.html">QDPOrder</a> &amp;order) : <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html">LegacyOrder</a>&lt;Float,length&gt;(order), volumeCB(order.volumeCB) {</div><div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;4; i++) gauge[i] = order.<a class="code" href="structquda_1_1gauge_1_1_q_d_p_order.html#ad477b1247e176c6e95caa99039110367">gauge</a>[i];</div><div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;      }</div><div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;</div><div class="line"><a name="l02197"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_q_d_p_order.html#a421625328d7fe9a772c71727c899b952"> 2197</a></span>&#160;      __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structquda_1_1gauge_1_1_q_d_p_order.html#a421625328d7fe9a772c71727c899b952">load</a>(<a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a2493fde8fb5407c76f393ce6d4fea448">complex</a> v[length / 2], <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> dir, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>, <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a74cb938c3e9438d4100efb0bd755c142">real</a> inphase = 1.0)<span class="keyword"> const</span></div><div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;<span class="keyword">      </span>{</div><div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;<span class="preprocessor">#if defined( __CUDA_ARCH__) &amp;&amp; !defined(DISABLE_TROVE)</span></div><div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;  <span class="keyword">typedef</span> <a class="code" href="structquda_1_1gauge_1_1_s.html">S&lt;Float,length&gt;</a> structure;</div><div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;  trove::coalesced_ptr&lt;structure&gt; gauge_((structure*)gauge[dir]);</div><div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;  structure v_ = gauge_[parity*volumeCB + x];</div><div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;        <span class="keyword">auto</span> v_ = &amp;gauge[dir][(parity * volumeCB + x) * length];</div><div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; length / 2; i++) v[i] = <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a2493fde8fb5407c76f393ce6d4fea448">complex</a>(v_[2 * i + 0], v_[2 * i + 1]);</div><div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;      }</div><div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;</div><div class="line"><a name="l02209"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_q_d_p_order.html#a62d4b6ce4ce456edfd3f4ab1e761af98"> 2209</a></span>&#160;      __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structquda_1_1gauge_1_1_q_d_p_order.html#a62d4b6ce4ce456edfd3f4ab1e761af98">save</a>(<span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a2493fde8fb5407c76f393ce6d4fea448">complex</a> v[length / 2], <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> dir, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>)</div><div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;      {</div><div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;<span class="preprocessor">#if defined( __CUDA_ARCH__) &amp;&amp; !defined(DISABLE_TROVE)</span></div><div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;  <span class="keyword">typedef</span> <a class="code" href="structquda_1_1gauge_1_1_s.html">S&lt;Float,length&gt;</a> structure;</div><div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;  trove::coalesced_ptr&lt;structure&gt; gauge_((structure*)gauge[dir]);</div><div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;  structure v_;</div><div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; length / 2; i++) {</div><div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;          v_[2 * i + 0] = (Float)v[i].<a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a74cb938c3e9438d4100efb0bd755c142">real</a>();</div><div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;          v_[2 * i + 1] = (Float)v[i].imag();</div><div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;        }</div><div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;        gauge_[parity * volumeCB + x] = v_;</div><div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;        <span class="keyword">auto</span> v_ = &amp;gauge[dir][(parity * volumeCB + x) * length];</div><div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; length / 2; i++) {</div><div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;          v_[2 * i + 0] = (Float)v[i].<a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a74cb938c3e9438d4100efb0bd755c142">real</a>();</div><div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;          v_[2 * i + 1] = (Float)v[i].imag();</div><div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;        }</div><div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;      }</div><div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;</div><div class="line"><a name="l02239"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_q_d_p_order.html#ae68df6b81ac33589eb10744eed4327df"> 2239</a></span>&#160;      __device__ __host__ <span class="keyword">inline</span> <a class="code" href="structquda_1_1gauge__wrapper.html">gauge_wrapper&lt;real, Accessor&gt;</a> <a class="code" href="structquda_1_1gauge_1_1_q_d_p_order.html#ae68df6b81ac33589eb10744eed4327df">operator()</a>(<span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5261c5f7423edd78086a027390e11983">x_cb</a>, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>)</div><div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;      {</div><div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="structquda_1_1gauge__wrapper.html">gauge_wrapper&lt;real, Accessor&gt;</a>(*<span class="keyword">this</span>, <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>, <a class="code" href="structquda_1_1gauge__wrapper.html#a5261c5f7423edd78086a027390e11983">x_cb</a>, <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>);</div><div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;      }</div><div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;</div><div class="line"><a name="l02254"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_q_d_p_order.html#a2e8c9fd778f4b80c302d5832d977fd15"> 2254</a></span>&#160;      __device__ __host__ <span class="keyword">inline</span> <span class="keyword">const</span> <a class="code" href="structquda_1_1gauge__wrapper.html">gauge_wrapper&lt;real, Accessor&gt;</a> <a class="code" href="structquda_1_1gauge_1_1_q_d_p_order.html#a2e8c9fd778f4b80c302d5832d977fd15">operator()</a>(<span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5261c5f7423edd78086a027390e11983">x_cb</a>, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>)<span class="keyword"> const</span></div><div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;<span class="keyword">      </span>{</div><div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="structquda_1_1gauge__wrapper.html">gauge_wrapper&lt;real, QDPOrder&lt;Float, length&gt;</a>&gt;(<span class="keyword">const_cast&lt;</span><a class="code" href="structquda_1_1gauge_1_1_legacy_order.html">Accessor</a> &amp;<span class="keyword">&gt;</span>(*this), <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>, <a class="code" href="structquda_1_1gauge__wrapper.html#a5261c5f7423edd78086a027390e11983">x_cb</a>, <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>);</div><div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;      }</div><div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;</div><div class="line"><a name="l02259"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_q_d_p_order.html#aab1d4ebc76b9c6302b6f2d461377d323"> 2259</a></span>&#160;      <span class="keywordtype">size_t</span> <a class="code" href="structquda_1_1gauge_1_1_q_d_p_order.html#aab1d4ebc76b9c6302b6f2d461377d323">Bytes</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> length * <span class="keyword">sizeof</span>(Float); }</div><div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;    };</div><div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;</div><div class="line"><a name="l02266"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_q_d_p_j_i_t_order.html"> 2266</a></span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Float, <span class="keywordtype">int</span> length&gt; <span class="keyword">struct </span><a class="code" href="structquda_1_1gauge_1_1_q_d_p_j_i_t_order.html">QDPJITOrder</a> : <span class="keyword">public</span> <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html">LegacyOrder</a>&lt;Float,length&gt; {</div><div class="line"><a name="l02267"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_q_d_p_j_i_t_order.html#a79fd683812a6f1d88fecd954a53256fc"> 2267</a></span>&#160;      <span class="keyword">using</span> <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html">Accessor</a> = <a class="code" href="structquda_1_1gauge_1_1_q_d_p_j_i_t_order.html">QDPJITOrder&lt;Float, length&gt;</a>;</div><div class="line"><a name="l02268"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_q_d_p_j_i_t_order.html#abdea2e415c827e4777a13ae9cad30c5e"> 2268</a></span>&#160;      <span class="keyword">using</span> <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a74cb938c3e9438d4100efb0bd755c142">real</a> = <span class="keyword">typename</span> <a class="code" href="structquda_1_1mapper.html">mapper&lt;Float&gt;::type</a>;</div><div class="line"><a name="l02269"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_q_d_p_j_i_t_order.html#a737ca005397cc1dda235c2777191de26"> 2269</a></span>&#160;      <span class="keyword">using</span> <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a2493fde8fb5407c76f393ce6d4fea448">complex</a> = <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a2493fde8fb5407c76f393ce6d4fea448">complex&lt;real&gt;</a>;</div><div class="line"><a name="l02270"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_q_d_p_j_i_t_order.html#aa787d2389aeded95c0e097edc2421259"> 2270</a></span>&#160;      Float *<a class="code" href="structquda_1_1gauge__wrapper.html#a74e48d66e79a75aa5b890a214e27028e">gauge</a>[<a class="code" href="quda__constants_8h.html#aa69925e50554e0ea81dd89fdcb572bbc">QUDA_MAX_DIM</a>];</div><div class="line"><a name="l02271"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_q_d_p_j_i_t_order.html#a94f3bb60a5aeb2d8f7e18c2dafaccc6b"> 2271</a></span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge_1_1_q_d_p_j_i_t_order.html#a94f3bb60a5aeb2d8f7e18c2dafaccc6b">volumeCB</a>;</div><div class="line"><a name="l02272"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_q_d_p_j_i_t_order.html#af4cf567ef342fdf088e58da8b75c7ef6"> 2272</a></span>&#160;    <a class="code" href="structquda_1_1gauge_1_1_q_d_p_j_i_t_order.html#af4cf567ef342fdf088e58da8b75c7ef6">QDPJITOrder</a>(<span class="keyword">const</span> <a class="code" href="classquda_1_1_gauge_field.html">GaugeField</a> &amp;u, Float *gauge_=0, Float **ghost_=0)</div><div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;      : <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html">LegacyOrder</a>&lt;Float,length&gt;(u, ghost_), volumeCB(u.VolumeCB())</div><div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;  { <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;4; i++) gauge[i] = gauge_ ? ((Float**)gauge_)[i] : ((Float**)u.<a class="code" href="classquda_1_1_gauge_field.html#ab875db966189cb025989e43275f78830">Gauge_p</a>())[i]; }</div><div class="line"><a name="l02275"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_q_d_p_j_i_t_order.html#a9353c705ee37eb8e14eaadd99c59e5c9"> 2275</a></span>&#160;    <a class="code" href="structquda_1_1gauge_1_1_q_d_p_j_i_t_order.html#a9353c705ee37eb8e14eaadd99c59e5c9">QDPJITOrder</a>(<span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_q_d_p_j_i_t_order.html">QDPJITOrder</a> &amp;order) : <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html">LegacyOrder</a>&lt;Float,length&gt;(order), volumeCB(order.volumeCB) {</div><div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;4; i++) gauge[i] = order.<a class="code" href="structquda_1_1gauge_1_1_q_d_p_j_i_t_order.html#aa787d2389aeded95c0e097edc2421259">gauge</a>[i];</div><div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;      }</div><div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;</div><div class="line"><a name="l02279"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_q_d_p_j_i_t_order.html#a845da87a81a9d897ba6e27bfd62c78d5"> 2279</a></span>&#160;      __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structquda_1_1gauge_1_1_q_d_p_j_i_t_order.html#a845da87a81a9d897ba6e27bfd62c78d5">load</a>(<a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a2493fde8fb5407c76f393ce6d4fea448">complex</a> v[length / 2], <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> dir, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>, <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a74cb938c3e9438d4100efb0bd755c142">real</a> inphase = 1.0)<span class="keyword"> const</span></div><div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;<span class="keyword">      </span>{</div><div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; length / 2; i++) {</div><div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;          v[i].real((<a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a74cb938c3e9438d4100efb0bd755c142">real</a>)gauge[dir][((0 * (length / 2) + i) * 2 + parity) * volumeCB + x]);</div><div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;          v[i].imag((<a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a74cb938c3e9438d4100efb0bd755c142">real</a>)gauge[dir][((1 * (length / 2) + i) * 2 + parity) * volumeCB + x]);</div><div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;        }</div><div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;      }</div><div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;</div><div class="line"><a name="l02287"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_q_d_p_j_i_t_order.html#a13939966a4277a232ed6c3155e7dfe3d"> 2287</a></span>&#160;      __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structquda_1_1gauge_1_1_q_d_p_j_i_t_order.html#a13939966a4277a232ed6c3155e7dfe3d">save</a>(<span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a2493fde8fb5407c76f393ce6d4fea448">complex</a> v[length / 2], <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> dir, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>)</div><div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;      {</div><div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; length / 2; i++) {</div><div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;          gauge[dir][((0 * (length / 2) + i) * 2 + <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>) * volumeCB + x] = v[i].<a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a74cb938c3e9438d4100efb0bd755c142">real</a>();</div><div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;          gauge[dir][((1 * (length / 2) + i) * 2 + <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>) * volumeCB + x] = v[i].imag();</div><div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;        }</div><div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;      }</div><div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;</div><div class="line"><a name="l02305"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_q_d_p_j_i_t_order.html#a583cfa66426cb2ad385c44a4f2227c80"> 2305</a></span>&#160;      __device__ __host__ <span class="keyword">inline</span> <a class="code" href="structquda_1_1gauge__wrapper.html">gauge_wrapper&lt;real, Accessor&gt;</a> <a class="code" href="structquda_1_1gauge_1_1_q_d_p_j_i_t_order.html#a583cfa66426cb2ad385c44a4f2227c80">operator()</a>(<span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5261c5f7423edd78086a027390e11983">x_cb</a>, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>)</div><div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;      {</div><div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="structquda_1_1gauge__wrapper.html">gauge_wrapper&lt;real, Accessor&gt;</a>(*<span class="keyword">this</span>, <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>, <a class="code" href="structquda_1_1gauge__wrapper.html#a5261c5f7423edd78086a027390e11983">x_cb</a>, <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>);</div><div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;      }</div><div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;</div><div class="line"><a name="l02320"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_q_d_p_j_i_t_order.html#a65fa1c01c65f133fed67d54038a148f2"> 2320</a></span>&#160;      __device__ __host__ <span class="keyword">inline</span> <span class="keyword">const</span> <a class="code" href="structquda_1_1gauge__wrapper.html">gauge_wrapper&lt;real, Accessor&gt;</a> <a class="code" href="structquda_1_1gauge_1_1_q_d_p_j_i_t_order.html#a65fa1c01c65f133fed67d54038a148f2">operator()</a>(<span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5261c5f7423edd78086a027390e11983">x_cb</a>, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>)<span class="keyword"> const</span></div><div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;<span class="keyword">      </span>{</div><div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="structquda_1_1gauge__wrapper.html">gauge_wrapper&lt;real, QDPJITOrder&lt;Float, length&gt;</a>&gt;(<span class="keyword">const_cast&lt;</span><a class="code" href="structquda_1_1gauge_1_1_legacy_order.html">Accessor</a> &amp;<span class="keyword">&gt;</span>(*this), <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>, <a class="code" href="structquda_1_1gauge__wrapper.html#a5261c5f7423edd78086a027390e11983">x_cb</a>, <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>);</div><div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;      }</div><div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;</div><div class="line"><a name="l02325"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_q_d_p_j_i_t_order.html#a1f6aea06e7f3b74ea251d5979ef4bed0"> 2325</a></span>&#160;      <span class="keywordtype">size_t</span> <a class="code" href="structquda_1_1gauge_1_1_q_d_p_j_i_t_order.html#a1f6aea06e7f3b74ea251d5979ef4bed0">Bytes</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> length * <span class="keyword">sizeof</span>(Float); }</div><div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;    };</div><div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;</div><div class="line"><a name="l02332"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_m_i_l_c_order.html"> 2332</a></span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Float, <span class="keywordtype">int</span> length&gt; <span class="keyword">struct </span><a class="code" href="structquda_1_1gauge_1_1_m_i_l_c_order.html">MILCOrder</a> : <span class="keyword">public</span> <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html">LegacyOrder</a>&lt;Float,length&gt; {</div><div class="line"><a name="l02333"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_m_i_l_c_order.html#a38c49e16f8b6b20fad22db5c69c09110"> 2333</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html">Accessor</a> = <a class="code" href="structquda_1_1gauge_1_1_m_i_l_c_order.html">MILCOrder&lt;Float, length&gt;</a>;</div><div class="line"><a name="l02334"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_m_i_l_c_order.html#a105794f7a07b8c2ab5a5a218551957ea"> 2334</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a74cb938c3e9438d4100efb0bd755c142">real</a> = <span class="keyword">typename</span> <a class="code" href="structquda_1_1mapper.html">mapper&lt;Float&gt;::type</a>;</div><div class="line"><a name="l02335"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_m_i_l_c_order.html#a6e13ee4fdad38f5661c4810dc70f84b8"> 2335</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a2493fde8fb5407c76f393ce6d4fea448">complex</a> = <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a2493fde8fb5407c76f393ce6d4fea448">complex&lt;real&gt;</a>;</div><div class="line"><a name="l02336"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_m_i_l_c_order.html#a94dc1f1de5a50a5f5368148d475d37be"> 2336</a></span>&#160;    Float *<a class="code" href="structquda_1_1gauge_1_1_m_i_l_c_order.html#a94dc1f1de5a50a5f5368148d475d37be">gauge</a>;</div><div class="line"><a name="l02337"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_m_i_l_c_order.html#a6db06e6868d9c2b32838a0882cafd35e"> 2337</a></span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge_1_1_m_i_l_c_order.html#a6db06e6868d9c2b32838a0882cafd35e">volumeCB</a>;</div><div class="line"><a name="l02338"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_m_i_l_c_order.html#a2df3d286e0ad7cda68c209b5d549c8ad"> 2338</a></span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge_1_1_m_i_l_c_order.html#a2df3d286e0ad7cda68c209b5d549c8ad">geometry</a>;</div><div class="line"><a name="l02339"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_m_i_l_c_order.html#acc84b16e69b70b30d9bbc339fbee63b1"> 2339</a></span>&#160;  <a class="code" href="structquda_1_1gauge_1_1_m_i_l_c_order.html#acc84b16e69b70b30d9bbc339fbee63b1">MILCOrder</a>(<span class="keyword">const</span> <a class="code" href="classquda_1_1_gauge_field.html">GaugeField</a> &amp;u, Float *gauge_=0, Float **ghost_=0) :</div><div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;    <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html">LegacyOrder</a>&lt;Float,length&gt;(u, ghost_), gauge(gauge_ ? gauge_ : (Float*)u.Gauge_p()),</div><div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;      volumeCB(u.VolumeCB()), geometry(u.Geometry()) { ; }</div><div class="line"><a name="l02342"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_m_i_l_c_order.html#a01cba00cb5cc6fa0bb7588950b96f18d"> 2342</a></span>&#160;  <a class="code" href="structquda_1_1gauge_1_1_m_i_l_c_order.html#a01cba00cb5cc6fa0bb7588950b96f18d">MILCOrder</a>(<span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_m_i_l_c_order.html">MILCOrder</a> &amp;order) : <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html">LegacyOrder</a>&lt;Float,length&gt;(order),</div><div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;      gauge(order.gauge), volumeCB(order.volumeCB), geometry(order.geometry)</div><div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;      { ; }</div><div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;</div><div class="line"><a name="l02346"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_m_i_l_c_order.html#a4604719c6491c0b88c35b4a5025cb4d8"> 2346</a></span>&#160;      __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structquda_1_1gauge_1_1_m_i_l_c_order.html#a4604719c6491c0b88c35b4a5025cb4d8">load</a>(<a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a2493fde8fb5407c76f393ce6d4fea448">complex</a> v[length / 2], <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> dir, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>, <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a74cb938c3e9438d4100efb0bd755c142">real</a> inphase = 1.0)<span class="keyword"> const</span></div><div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;<span class="keyword">      </span>{</div><div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;<span class="preprocessor">#if defined( __CUDA_ARCH__) &amp;&amp; !defined(DISABLE_TROVE)</span></div><div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;      <span class="keyword">typedef</span> <a class="code" href="structquda_1_1gauge_1_1_s.html">S&lt;Float,length&gt;</a> structure;</div><div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;      trove::coalesced_ptr&lt;structure&gt; gauge_((structure*)gauge);</div><div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;      structure v_ = gauge_[(parity*volumeCB+x)*geometry + dir];</div><div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;        <span class="keyword">auto</span> v_ = &amp;gauge[((parity * volumeCB + x) * geometry + dir) * <a class="code" href="gauge__force__test_8cpp.html#a2bcd2adde36b870d02897e694ecc39cb">length</a>];</div><div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; length / 2; i++) v[i] = <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a2493fde8fb5407c76f393ce6d4fea448">complex</a>(v_[2 * i + 0], v_[2 * i + 1]);</div><div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;    }</div><div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;</div><div class="line"><a name="l02358"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_m_i_l_c_order.html#acfc75ce93d116aa0f1270819c1cefc9c"> 2358</a></span>&#160;    __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structquda_1_1gauge_1_1_m_i_l_c_order.html#acfc75ce93d116aa0f1270819c1cefc9c">save</a>(<span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a2493fde8fb5407c76f393ce6d4fea448">complex</a> v[length / 2], <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> dir, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>)</div><div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;    {</div><div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;<span class="preprocessor">#if defined( __CUDA_ARCH__) &amp;&amp; !defined(DISABLE_TROVE)</span></div><div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;      <span class="keyword">typedef</span> <a class="code" href="structquda_1_1gauge_1_1_s.html">S&lt;Float,length&gt;</a> structure;</div><div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;      trove::coalesced_ptr&lt;structure&gt; gauge_((structure*)gauge);</div><div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;      structure v_;</div><div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; length / 2; i++) {</div><div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;        v_[2 * i + 0] = v[i].real();</div><div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;        v_[2 * i + 1] = v[i].imag();</div><div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;      }</div><div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;      gauge_[(parity*volumeCB+x)*geometry + dir] = v_;</div><div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;      <span class="keyword">auto</span> v_ = &amp;gauge[((parity * volumeCB + x) * geometry + dir) * <a class="code" href="gauge__force__test_8cpp.html#a2bcd2adde36b870d02897e694ecc39cb">length</a>];</div><div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; length / 2; i++) {</div><div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;        v_[2 * i + 0] = v[i].real();</div><div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;        v_[2 * i + 1] = v[i].imag();</div><div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;      }</div><div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;    }</div><div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;</div><div class="line"><a name="l02388"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_m_i_l_c_order.html#a8eb9f14f8d065b730af9d4477c87509a"> 2388</a></span>&#160;    __device__ __host__ <span class="keyword">inline</span> <a class="code" href="structquda_1_1gauge__wrapper.html">gauge_wrapper&lt;real, Accessor&gt;</a> <a class="code" href="structquda_1_1gauge_1_1_m_i_l_c_order.html#a8eb9f14f8d065b730af9d4477c87509a">operator()</a>(<span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5261c5f7423edd78086a027390e11983">x_cb</a>, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>)</div><div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;    {</div><div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="structquda_1_1gauge__wrapper.html">gauge_wrapper&lt;real, Accessor&gt;</a>(*<span class="keyword">this</span>, <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>, <a class="code" href="structquda_1_1gauge__wrapper.html#a5261c5f7423edd78086a027390e11983">x_cb</a>, <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>);</div><div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;    }</div><div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;</div><div class="line"><a name="l02403"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_m_i_l_c_order.html#aee0c1127f4b9e818dbedda2d0d0a2cbe"> 2403</a></span>&#160;    __device__ __host__ <span class="keyword">inline</span> <span class="keyword">const</span> <a class="code" href="structquda_1_1gauge__wrapper.html">gauge_wrapper&lt;real, Accessor&gt;</a> <a class="code" href="structquda_1_1gauge_1_1_m_i_l_c_order.html#aee0c1127f4b9e818dbedda2d0d0a2cbe">operator()</a>(<span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5261c5f7423edd78086a027390e11983">x_cb</a>, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>)<span class="keyword"> const</span></div><div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="structquda_1_1gauge__wrapper.html">gauge_wrapper&lt;real, MILCOrder&lt;Float, length&gt;</a>&gt;(<span class="keyword">const_cast&lt;</span><a class="code" href="structquda_1_1gauge_1_1_legacy_order.html">Accessor</a> &amp;<span class="keyword">&gt;</span>(*this), <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>, <a class="code" href="structquda_1_1gauge__wrapper.html#a5261c5f7423edd78086a027390e11983">x_cb</a>, <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>);</div><div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;    }</div><div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;</div><div class="line"><a name="l02408"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_m_i_l_c_order.html#a0232c529388721f1f657f5dc6bc381db"> 2408</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structquda_1_1gauge_1_1_m_i_l_c_order.html#a0232c529388721f1f657f5dc6bc381db">Bytes</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> length * <span class="keyword">sizeof</span>(Float); }</div><div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;  };</div><div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;</div><div class="line"><a name="l02426"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_m_i_l_c_site_order.html"> 2426</a></span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Float, <span class="keywordtype">int</span> length&gt; <span class="keyword">struct </span><a class="code" href="structquda_1_1gauge_1_1_m_i_l_c_site_order.html">MILCSiteOrder</a> : <span class="keyword">public</span> <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html">LegacyOrder</a>&lt;Float,length&gt; {</div><div class="line"><a name="l02427"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_m_i_l_c_site_order.html#aea04e75a1ab8db362c4052e90e1dc3bd"> 2427</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html">Accessor</a> = <a class="code" href="structquda_1_1gauge_1_1_m_i_l_c_site_order.html">MILCSiteOrder&lt;Float, length&gt;</a>;</div><div class="line"><a name="l02428"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_m_i_l_c_site_order.html#a1db750226dc375274b6841f2518074d0"> 2428</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a74cb938c3e9438d4100efb0bd755c142">real</a> = <span class="keyword">typename</span> <a class="code" href="structquda_1_1mapper.html">mapper&lt;Float&gt;::type</a>;</div><div class="line"><a name="l02429"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_m_i_l_c_site_order.html#a3522576c1fa3c947784debdd8135b52b"> 2429</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a2493fde8fb5407c76f393ce6d4fea448">complex</a> = <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a2493fde8fb5407c76f393ce6d4fea448">complex&lt;real&gt;</a>;</div><div class="line"><a name="l02430"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_m_i_l_c_site_order.html#ab821ae99dac5dea429783a9bea629356"> 2430</a></span>&#160;    Float *<a class="code" href="structquda_1_1gauge_1_1_m_i_l_c_site_order.html#ab821ae99dac5dea429783a9bea629356">gauge</a>;</div><div class="line"><a name="l02431"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_m_i_l_c_site_order.html#a02b54a0759ccb9e37c2e8461ac70ada5"> 2431</a></span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge_1_1_m_i_l_c_site_order.html#a02b54a0759ccb9e37c2e8461ac70ada5">volumeCB</a>;</div><div class="line"><a name="l02432"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_m_i_l_c_site_order.html#adc5f47968b10333baf254379f57a7d42"> 2432</a></span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge_1_1_m_i_l_c_site_order.html#adc5f47968b10333baf254379f57a7d42">geometry</a>;</div><div class="line"><a name="l02433"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_m_i_l_c_site_order.html#a5b00f455cb7b2a93293a47c8371e5778"> 2433</a></span>&#160;    <span class="keyword">const</span> <span class="keywordtype">size_t</span> <a class="code" href="structquda_1_1gauge_1_1_m_i_l_c_site_order.html#a5b00f455cb7b2a93293a47c8371e5778">offset</a>;</div><div class="line"><a name="l02434"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_m_i_l_c_site_order.html#a05255de0b2cde2f4749a59ce19251bbf"> 2434</a></span>&#160;    <span class="keyword">const</span> <span class="keywordtype">size_t</span> <a class="code" href="structquda_1_1gauge_1_1_m_i_l_c_site_order.html#a05255de0b2cde2f4749a59ce19251bbf">size</a>;</div><div class="line"><a name="l02435"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_m_i_l_c_site_order.html#ac1323d48d70f2f3056cb48412baaf066"> 2435</a></span>&#160;    <a class="code" href="structquda_1_1gauge_1_1_m_i_l_c_site_order.html#ac1323d48d70f2f3056cb48412baaf066">MILCSiteOrder</a>(<span class="keyword">const</span> <a class="code" href="classquda_1_1_gauge_field.html">GaugeField</a> &amp;u, Float *gauge_ = 0, Float **ghost_ = 0) :</div><div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;      <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html">LegacyOrder</a>&lt;Float, length&gt;(u, ghost_),</div><div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;      gauge(gauge_ ? gauge_ : (Float *)u.Gauge_p()),</div><div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;      volumeCB(u.VolumeCB()),</div><div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;      geometry(u.Geometry()),</div><div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;      offset(u.SiteOffset()),</div><div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;      size(u.SiteSize())</div><div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;    {</div><div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;      <span class="keywordflow">if</span> ((uintptr_t)((<span class="keywordtype">char</span> *)gauge + offset) % 16 != 0) { <a class="code" href="util__quda_8h.html#af3bddfd9d113d50e8e0bbf58a35c5aac">errorQuda</a>(<span class="stringliteral">&quot;MILC structure has misaligned offset&quot;</span>); }</div><div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;    }</div><div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;</div><div class="line"><a name="l02446"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_m_i_l_c_site_order.html#a794222a839fbf1b0976f7be33109450d"> 2446</a></span>&#160;    <a class="code" href="structquda_1_1gauge_1_1_m_i_l_c_site_order.html#a794222a839fbf1b0976f7be33109450d">MILCSiteOrder</a>(<span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_m_i_l_c_site_order.html">MILCSiteOrder</a> &amp;order) :</div><div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;      <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html">LegacyOrder</a>&lt;Float, length&gt;(order),</div><div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;      gauge(order.gauge),</div><div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;      volumeCB(order.volumeCB),</div><div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;      geometry(order.geometry),</div><div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;      offset(order.offset),</div><div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;      size(order.size)</div><div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;    {</div><div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;    }</div><div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;</div><div class="line"><a name="l02456"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_m_i_l_c_site_order.html#a49c7abef30fa492a5158b29e45dd02cd"> 2456</a></span>&#160;    __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structquda_1_1gauge_1_1_m_i_l_c_site_order.html#a49c7abef30fa492a5158b29e45dd02cd">load</a>(<a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a2493fde8fb5407c76f393ce6d4fea448">complex</a> v[length / 2], <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> dir, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>, <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a74cb938c3e9438d4100efb0bd755c142">real</a> inphase = 1.0)<span class="keyword"> const</span></div><div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;      <span class="comment">// get base pointer</span></div><div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;      <span class="keyword">const</span> Float *gauge0 = <span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span>Float*<span class="keyword">&gt;</span>(<span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(<a class="code" href="structquda_1_1gauge__wrapper.html#a74e48d66e79a75aa5b890a214e27028e">gauge</a>) + (parity*volumeCB+x)*size + offset);</div><div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;</div><div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;<span class="preprocessor">#if defined( __CUDA_ARCH__) &amp;&amp; !defined(DISABLE_TROVE)</span></div><div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;      <span class="keyword">typedef</span> <a class="code" href="structquda_1_1gauge_1_1_s.html">S&lt;Float,length&gt;</a> structure;</div><div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;      trove::coalesced_ptr&lt;structure&gt; gauge_((structure*)gauge0);</div><div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;      structure v_ = gauge_[dir];</div><div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;      <span class="keyword">auto</span> v_ = &amp;gauge0[dir * <a class="code" href="gauge__force__test_8cpp.html#a2bcd2adde36b870d02897e694ecc39cb">length</a>];</div><div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; length / 2; i++) v[i] = <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a2493fde8fb5407c76f393ce6d4fea448">complex</a>(v_[2 * i + 0], v_[2 * i + 1]);</div><div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;    }</div><div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;</div><div class="line"><a name="l02471"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_m_i_l_c_site_order.html#a89c729da893d8a3f4ae0e38bb4266c34"> 2471</a></span>&#160;    __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structquda_1_1gauge_1_1_m_i_l_c_site_order.html#a89c729da893d8a3f4ae0e38bb4266c34">save</a>(<span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a2493fde8fb5407c76f393ce6d4fea448">complex</a> v[length / 2], <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> dir, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>)</div><div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;    {</div><div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;      <span class="comment">// get base pointer</span></div><div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;      Float *gauge0 = <span class="keyword">reinterpret_cast&lt;</span>Float*<span class="keyword">&gt;</span>(<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(<a class="code" href="structquda_1_1gauge__wrapper.html#a74e48d66e79a75aa5b890a214e27028e">gauge</a>) + (parity*volumeCB+x)*size + offset);</div><div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;</div><div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;<span class="preprocessor">#if defined( __CUDA_ARCH__) &amp;&amp; !defined(DISABLE_TROVE)</span></div><div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;      <span class="keyword">typedef</span> <a class="code" href="structquda_1_1gauge_1_1_s.html">S&lt;Float,length&gt;</a> structure;</div><div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;      trove::coalesced_ptr&lt;structure&gt; gauge_((structure*)gauge0);</div><div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;      structure v_;</div><div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; length / 2; i++) {</div><div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;        v_[2 * i + 0] = v[i].real();</div><div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;        v_[2 * i + 1] = v[i].imag();</div><div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;      }</div><div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;      gauge_[dir] = v_;</div><div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; length / 2; i++) {</div><div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;        gauge0[dir * length + 2 * i + 0] = v[i].real();</div><div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;        gauge0[dir * length + 2 * i + 1] = v[i].imag();</div><div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;      }</div><div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;    }</div><div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;</div><div class="line"><a name="l02503"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_m_i_l_c_site_order.html#aa7833e2076587b80d3154fd60bc8dbb3"> 2503</a></span>&#160;    __device__ __host__ <span class="keyword">inline</span> <a class="code" href="structquda_1_1gauge__wrapper.html">gauge_wrapper&lt;real, Accessor&gt;</a> <a class="code" href="structquda_1_1gauge_1_1_m_i_l_c_site_order.html#aa7833e2076587b80d3154fd60bc8dbb3">operator()</a>(<span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5261c5f7423edd78086a027390e11983">x_cb</a>, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>)</div><div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;    {</div><div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="structquda_1_1gauge__wrapper.html">gauge_wrapper&lt;real, Accessor&gt;</a>(*<span class="keyword">this</span>, <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>, <a class="code" href="structquda_1_1gauge__wrapper.html#a5261c5f7423edd78086a027390e11983">x_cb</a>, <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>);</div><div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;    }</div><div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;</div><div class="line"><a name="l02518"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_m_i_l_c_site_order.html#a7e096af236f85d166e4668cce20e2bf6"> 2518</a></span>&#160;    __device__ __host__ <span class="keyword">inline</span> <span class="keyword">const</span> <a class="code" href="structquda_1_1gauge__wrapper.html">gauge_wrapper&lt;real, Accessor&gt;</a> <a class="code" href="structquda_1_1gauge_1_1_m_i_l_c_site_order.html#a7e096af236f85d166e4668cce20e2bf6">operator()</a>(<span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5261c5f7423edd78086a027390e11983">x_cb</a>, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>)<span class="keyword"> const</span></div><div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="structquda_1_1gauge__wrapper.html">gauge_wrapper&lt;real, Accessor&gt;</a>(<span class="keyword">const_cast&lt;</span><a class="code" href="structquda_1_1gauge_1_1_legacy_order.html">Accessor</a> &amp;<span class="keyword">&gt;</span>(*this), <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>, <a class="code" href="structquda_1_1gauge__wrapper.html#a5261c5f7423edd78086a027390e11983">x_cb</a>, <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>);</div><div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;    }</div><div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;</div><div class="line"><a name="l02523"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_m_i_l_c_site_order.html#aad27cf3b921d7d47c8928cb15c3c9097"> 2523</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structquda_1_1gauge_1_1_m_i_l_c_site_order.html#aad27cf3b921d7d47c8928cb15c3c9097">Bytes</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> length * <span class="keyword">sizeof</span>(Float); }</div><div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;  };</div><div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;</div><div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;</div><div class="line"><a name="l02531"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_c_p_s_order.html"> 2531</a></span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Float, <span class="keywordtype">int</span> length&gt; <span class="keyword">struct </span><a class="code" href="structquda_1_1gauge_1_1_c_p_s_order.html">CPSOrder</a> : <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html">LegacyOrder</a>&lt;Float,length&gt; {</div><div class="line"><a name="l02532"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_c_p_s_order.html#a9cf55d2dfcc8c28a478a68203d207d2b"> 2532</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html">Accessor</a> = <a class="code" href="structquda_1_1gauge_1_1_c_p_s_order.html">CPSOrder&lt;Float, length&gt;</a>;</div><div class="line"><a name="l02533"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_c_p_s_order.html#a789e7bafff767fd5fbc8c10968470743"> 2533</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="structquda_1_1gauge_1_1_c_p_s_order.html#a789e7bafff767fd5fbc8c10968470743">real</a> = <span class="keyword">typename</span> <a class="code" href="structquda_1_1mapper.html">mapper&lt;Float&gt;::type</a>;</div><div class="line"><a name="l02534"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_c_p_s_order.html#a6aec507a0874b2d4fbaffa80ca747645"> 2534</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a2493fde8fb5407c76f393ce6d4fea448">complex</a> = <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a2493fde8fb5407c76f393ce6d4fea448">complex&lt;real&gt;</a>;</div><div class="line"><a name="l02535"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_c_p_s_order.html#af2ee6441bd5066fe36064cc4fbef8b1c"> 2535</a></span>&#160;    Float *<a class="code" href="structquda_1_1gauge_1_1_c_p_s_order.html#af2ee6441bd5066fe36064cc4fbef8b1c">gauge</a>;</div><div class="line"><a name="l02536"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_c_p_s_order.html#a0b6c0e60042fb6a1baded8dbdda03870"> 2536</a></span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge_1_1_c_p_s_order.html#a0b6c0e60042fb6a1baded8dbdda03870">volumeCB</a>;</div><div class="line"><a name="l02537"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_c_p_s_order.html#a890d14f24b8df508fe50db28e5cb6693"> 2537</a></span>&#160;    <span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_c_p_s_order.html#a789e7bafff767fd5fbc8c10968470743">real</a> <a class="code" href="structquda_1_1gauge_1_1_c_p_s_order.html#a890d14f24b8df508fe50db28e5cb6693">anisotropy</a>;</div><div class="line"><a name="l02538"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_c_p_s_order.html#a1d1337c0164a536b3e6dd6145d44f79d"> 2538</a></span>&#160;    <span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_c_p_s_order.html#a789e7bafff767fd5fbc8c10968470743">real</a> <a class="code" href="structquda_1_1gauge_1_1_c_p_s_order.html#a1d1337c0164a536b3e6dd6145d44f79d">anisotropy_inv</a>;</div><div class="line"><a name="l02539"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_c_p_s_order.html#a73d06378e9d38cf0039960ae1ab50c66"> 2539</a></span>&#160;    <span class="keyword">static</span> constexpr <span class="keywordtype">int</span> Nc = 3;</div><div class="line"><a name="l02540"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_c_p_s_order.html#a9fdb177eb208c86b096fab5d74698429"> 2540</a></span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge_1_1_c_p_s_order.html#a9fdb177eb208c86b096fab5d74698429">geometry</a>;</div><div class="line"><a name="l02541"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_c_p_s_order.html#aeb6ffcf1219a375c62cad5ac00afa404"> 2541</a></span>&#160;    <a class="code" href="structquda_1_1gauge_1_1_c_p_s_order.html#aeb6ffcf1219a375c62cad5ac00afa404">CPSOrder</a>(<span class="keyword">const</span> <a class="code" href="classquda_1_1_gauge_field.html">GaugeField</a> &amp;u, Float *gauge_ = 0, Float **ghost_ = 0) :</div><div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;      <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html">LegacyOrder</a>&lt;Float, length&gt;(u, ghost_),</div><div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;      gauge(gauge_ ? gauge_ : (Float *)u.Gauge_p()),</div><div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;      volumeCB(u.VolumeCB()),</div><div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;      anisotropy(u.Anisotropy()),</div><div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;      anisotropy_inv(1.0 / anisotropy),</div><div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;      geometry(u.Geometry())</div><div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;    {</div><div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;      <span class="keywordflow">if</span> (length != 18) <a class="code" href="util__quda_8h.html#af3bddfd9d113d50e8e0bbf58a35c5aac">errorQuda</a>(<span class="stringliteral">&quot;Gauge length %d not supported&quot;</span>, length);</div><div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;    }</div><div class="line"><a name="l02551"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_c_p_s_order.html#ab44c81ff05fc7277c467d7d5742abe91"> 2551</a></span>&#160;    <a class="code" href="structquda_1_1gauge_1_1_c_p_s_order.html#ab44c81ff05fc7277c467d7d5742abe91">CPSOrder</a>(<span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_c_p_s_order.html">CPSOrder</a> &amp;order) :</div><div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;      <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html">LegacyOrder</a>&lt;Float, length&gt;(order),</div><div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;      gauge(order.gauge),</div><div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;      volumeCB(order.volumeCB),</div><div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;      anisotropy(order.anisotropy),</div><div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;      anisotropy_inv(order.anisotropy_inv),</div><div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;      geometry(order.geometry)</div><div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;    {</div><div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;      ;</div><div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;    }</div><div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;</div><div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;    <span class="comment">// we need to transpose and scale for CPS ordering</span></div><div class="line"><a name="l02563"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_c_p_s_order.html#ae23a5c9fde124fcf8cef192e02edd21d"> 2563</a></span>&#160;    __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structquda_1_1gauge_1_1_c_p_s_order.html#ae23a5c9fde124fcf8cef192e02edd21d">load</a>(<a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a2493fde8fb5407c76f393ce6d4fea448">complex</a> v[9], <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> dir, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>, Float inphase = 1.0)<span class="keyword"> const</span></div><div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;<span class="preprocessor">#if defined( __CUDA_ARCH__) &amp;&amp; !defined(DISABLE_TROVE)</span></div><div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;      <span class="keyword">typedef</span> <a class="code" href="structquda_1_1gauge_1_1_s.html">S&lt;Float,length&gt;</a> structure;</div><div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;      trove::coalesced_ptr&lt;structure&gt; gauge_((structure*)gauge);</div><div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;      structure v_ = gauge_[((parity*volumeCB+x)*geometry + dir)];</div><div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;      <span class="keyword">auto</span> v_ = &amp;gauge[((parity * volumeCB + x) * geometry + dir) * <a class="code" href="gauge__force__test_8cpp.html#a2bcd2adde36b870d02897e694ecc39cb">length</a>];</div><div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;Nc; i++) {</div><div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;Nc; j++) {</div><div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;          v[i * Nc + j] = <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a2493fde8fb5407c76f393ce6d4fea448">complex</a>(v_[(j * Nc + i) * 2 + 0], v_[(j * Nc + i) * 2 + 1]) * anisotropy_inv;</div><div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;        }</div><div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;      }</div><div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;    }</div><div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;</div><div class="line"><a name="l02579"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_c_p_s_order.html#a3e0cac228ff44cffae9f481ea77767b2"> 2579</a></span>&#160;    __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structquda_1_1gauge_1_1_c_p_s_order.html#a3e0cac228ff44cffae9f481ea77767b2">save</a>(<span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a2493fde8fb5407c76f393ce6d4fea448">complex</a> v[9], <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> dir, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>)</div><div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;    {</div><div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;<span class="preprocessor">#if defined( __CUDA_ARCH__) &amp;&amp; !defined(DISABLE_TROVE)</span></div><div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;      <span class="keyword">typedef</span> <a class="code" href="structquda_1_1gauge_1_1_s.html">S&lt;Float,length&gt;</a> structure;</div><div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;      trove::coalesced_ptr&lt;structure&gt; gauge_((structure*)gauge);</div><div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;      structure v_;</div><div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;Nc; i++)</div><div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; Nc; j++) {</div><div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;          v_[(j * Nc + i) * 2 + 0] = anisotropy * v[i * Nc + j].<a class="code" href="structquda_1_1gauge_1_1_c_p_s_order.html#a789e7bafff767fd5fbc8c10968470743">real</a>();</div><div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;          v_[(j * Nc + i) * 2 + 1] = anisotropy * v[i * Nc + j].imag();</div><div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;        }</div><div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;      gauge_[((parity*volumeCB+x)*geometry + dir)] = v_;</div><div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;      <span class="keyword">auto</span> v_ = &amp;gauge[((parity * volumeCB + x) * geometry + dir) * <a class="code" href="gauge__force__test_8cpp.html#a2bcd2adde36b870d02897e694ecc39cb">length</a>];</div><div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;Nc; i++) {</div><div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;Nc; j++) {</div><div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;          v_[(j * Nc + i) * 2 + 0] = anisotropy * v[i * Nc + j].<a class="code" href="structquda_1_1gauge_1_1_c_p_s_order.html#a789e7bafff767fd5fbc8c10968470743">real</a>();</div><div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;          v_[(j * Nc + i) * 2 + 1] = anisotropy * v[i * Nc + j].imag();</div><div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;        }</div><div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;      }</div><div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;    }</div><div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;</div><div class="line"><a name="l02612"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_c_p_s_order.html#a589c566e6c857c4eabf4795fa836afc2"> 2612</a></span>&#160;    __device__ __host__ <span class="keyword">inline</span> <a class="code" href="structquda_1_1gauge__wrapper.html">gauge_wrapper&lt;real, Accessor&gt;</a> <a class="code" href="structquda_1_1gauge_1_1_c_p_s_order.html#a589c566e6c857c4eabf4795fa836afc2">operator()</a>(<span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5261c5f7423edd78086a027390e11983">x_cb</a>, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>)</div><div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;    {</div><div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="structquda_1_1gauge__wrapper.html">gauge_wrapper&lt;real, Accessor&gt;</a>(*<span class="keyword">this</span>, <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>, <a class="code" href="structquda_1_1gauge__wrapper.html#a5261c5f7423edd78086a027390e11983">x_cb</a>, <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>);</div><div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;    }</div><div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;</div><div class="line"><a name="l02627"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_c_p_s_order.html#a26a252a3e172faccdd81f27952c136f2"> 2627</a></span>&#160;    __device__ __host__ <span class="keyword">inline</span> <span class="keyword">const</span> <a class="code" href="structquda_1_1gauge__wrapper.html">gauge_wrapper&lt;real, Accessor&gt;</a> <a class="code" href="structquda_1_1gauge_1_1_c_p_s_order.html#a26a252a3e172faccdd81f27952c136f2">operator()</a>(<span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5261c5f7423edd78086a027390e11983">x_cb</a>, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>)<span class="keyword"> const</span></div><div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="structquda_1_1gauge__wrapper.html">gauge_wrapper&lt;real, Accessor&gt;</a>(<span class="keyword">const_cast&lt;</span><a class="code" href="structquda_1_1gauge_1_1_legacy_order.html">Accessor</a> &amp;<span class="keyword">&gt;</span>(*this), <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>, <a class="code" href="structquda_1_1gauge__wrapper.html#a5261c5f7423edd78086a027390e11983">x_cb</a>, <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>);</div><div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;    }</div><div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;</div><div class="line"><a name="l02632"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_c_p_s_order.html#a1a5516dfff3e1eda0f0e525c3a26a141"> 2632</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structquda_1_1gauge_1_1_c_p_s_order.html#a1a5516dfff3e1eda0f0e525c3a26a141">Bytes</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> Nc * Nc * 2 * <span class="keyword">sizeof</span>(Float); }</div><div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;  };</div><div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;</div><div class="line"><a name="l02642"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_b_q_c_d_order.html"> 2642</a></span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Float, <span class="keywordtype">int</span> length&gt; <span class="keyword">struct </span><a class="code" href="structquda_1_1gauge_1_1_b_q_c_d_order.html">BQCDOrder</a> : <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html">LegacyOrder</a>&lt;Float,length&gt; {</div><div class="line"><a name="l02643"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_b_q_c_d_order.html#a5ef454d7bd66c2c2bd100547eafd5c1e"> 2643</a></span>&#160;      <span class="keyword">using</span> <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html">Accessor</a> = <a class="code" href="structquda_1_1gauge_1_1_b_q_c_d_order.html">BQCDOrder&lt;Float, length&gt;</a>;</div><div class="line"><a name="l02644"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_b_q_c_d_order.html#ad02e7fdd5c92fcfc17641d8d7b992cd2"> 2644</a></span>&#160;      <span class="keyword">using</span> <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a74cb938c3e9438d4100efb0bd755c142">real</a> = <span class="keyword">typename</span> <a class="code" href="structquda_1_1mapper.html">mapper&lt;Float&gt;::type</a>;</div><div class="line"><a name="l02645"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_b_q_c_d_order.html#a9b28e6a79b8eb9bc8d54a169a33b4a91"> 2645</a></span>&#160;      <span class="keyword">using</span> <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a2493fde8fb5407c76f393ce6d4fea448">complex</a> = <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a2493fde8fb5407c76f393ce6d4fea448">complex&lt;real&gt;</a>;</div><div class="line"><a name="l02646"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_b_q_c_d_order.html#a6335a3b2fb5a85183f0e0d418b8e17d6"> 2646</a></span>&#160;      Float *<a class="code" href="structquda_1_1gauge_1_1_b_q_c_d_order.html#a6335a3b2fb5a85183f0e0d418b8e17d6">gauge</a>;</div><div class="line"><a name="l02647"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_b_q_c_d_order.html#ad2e917299fd0915aa0d76f1a6af36068"> 2647</a></span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge_1_1_b_q_c_d_order.html#ad2e917299fd0915aa0d76f1a6af36068">volumeCB</a>;</div><div class="line"><a name="l02648"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_b_q_c_d_order.html#a75d3612142f9aafc49cf59ddc7f0e1f5"> 2648</a></span>&#160;      <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge_1_1_b_q_c_d_order.html#a75d3612142f9aafc49cf59ddc7f0e1f5">exVolumeCB</a>; <span class="comment">// extended checkerboard volume</span></div><div class="line"><a name="l02649"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_b_q_c_d_order.html#a824acfa54b74c06f611aa3224e097060"> 2649</a></span>&#160;      <span class="keyword">static</span> constexpr <span class="keywordtype">int</span> Nc = 3;</div><div class="line"><a name="l02650"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_b_q_c_d_order.html#ab29db910f2804102a95f51d8ac6c3378"> 2650</a></span>&#160;      <a class="code" href="structquda_1_1gauge_1_1_b_q_c_d_order.html#ab29db910f2804102a95f51d8ac6c3378">BQCDOrder</a>(<span class="keyword">const</span> <a class="code" href="classquda_1_1_gauge_field.html">GaugeField</a> &amp;u, Float *gauge_ = 0, Float **ghost_ = 0) :</div><div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;        <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html">LegacyOrder</a>&lt;Float, length&gt;(u, ghost_),</div><div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;        gauge(gauge_ ? gauge_ : (Float *)u.Gauge_p()),</div><div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;        volumeCB(u.VolumeCB())</div><div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;      {</div><div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;        <span class="keywordflow">if</span> (length != 18) <a class="code" href="util__quda_8h.html#af3bddfd9d113d50e8e0bbf58a35c5aac">errorQuda</a>(<span class="stringliteral">&quot;Gauge length %d not supported&quot;</span>, length);</div><div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;        <span class="comment">// compute volumeCB + halo region</span></div><div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;        exVolumeCB = u.<a class="code" href="classquda_1_1_lattice_field.html#a96f46542c595993b72818d3d031cd72f">X</a>()[0]/2 + 2;</div><div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=1; i&lt;4; i++) exVolumeCB *= u.<a class="code" href="classquda_1_1_lattice_field.html#a96f46542c595993b72818d3d031cd72f">X</a>()[i] + 2;</div><div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;      }</div><div class="line"><a name="l02660"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_b_q_c_d_order.html#ac8835f13d5c6a60d0708176ff549806f"> 2660</a></span>&#160;      <a class="code" href="structquda_1_1gauge_1_1_b_q_c_d_order.html#ac8835f13d5c6a60d0708176ff549806f">BQCDOrder</a>(<span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_b_q_c_d_order.html">BQCDOrder</a> &amp;order) :</div><div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;        <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html">LegacyOrder</a>&lt;Float, length&gt;(order),</div><div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;        gauge(order.gauge),</div><div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;        volumeCB(order.volumeCB),</div><div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;        exVolumeCB(order.exVolumeCB)</div><div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;      {</div><div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;        <span class="keywordflow">if</span> (length != 18) <a class="code" href="util__quda_8h.html#af3bddfd9d113d50e8e0bbf58a35c5aac">errorQuda</a>(<span class="stringliteral">&quot;Gauge length %d not supported&quot;</span>, length);</div><div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;      }</div><div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;</div><div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;      <span class="comment">// we need to transpose for BQCD ordering</span></div><div class="line"><a name="l02670"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_b_q_c_d_order.html#a0415eaf9f614299d0f35033a7a37da5d"> 2670</a></span>&#160;      __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structquda_1_1gauge_1_1_b_q_c_d_order.html#a0415eaf9f614299d0f35033a7a37da5d">load</a>(<a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a2493fde8fb5407c76f393ce6d4fea448">complex</a> v[9], <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> dir, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>, <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a74cb938c3e9438d4100efb0bd755c142">real</a> inphase = 1.0)<span class="keyword"> const</span></div><div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;<span class="keyword">      </span>{</div><div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;<span class="preprocessor">#if defined( __CUDA_ARCH__) &amp;&amp; !defined(DISABLE_TROVE)</span></div><div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;        <span class="keyword">typedef</span> <a class="code" href="structquda_1_1gauge_1_1_s.html">S&lt;Float, length&gt;</a> structure;</div><div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;        trove::coalesced_ptr&lt;structure&gt; gauge_((structure *)gauge);</div><div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;        structure v_ = gauge_[(dir * 2 + <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>) * exVolumeCB + x];</div><div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;        <span class="keyword">auto</span> v_ = &amp;gauge[((dir * 2 + <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>) * exVolumeCB + x) * <a class="code" href="gauge__force__test_8cpp.html#a2bcd2adde36b870d02897e694ecc39cb">length</a>];</div><div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; Nc; i++) {</div><div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; Nc; j++) { v[i * Nc + j] = <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a2493fde8fb5407c76f393ce6d4fea448">complex</a>(v_[(j * Nc + i) * 2 + 0], v_[(j * Nc + i) * 2 + 1]); }</div><div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;        }</div><div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;      }</div><div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;</div><div class="line"><a name="l02684"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_b_q_c_d_order.html#afe746011348c256043ccd6d451d20e56"> 2684</a></span>&#160;      __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structquda_1_1gauge_1_1_b_q_c_d_order.html#afe746011348c256043ccd6d451d20e56">save</a>(<span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a2493fde8fb5407c76f393ce6d4fea448">complex</a> v[9], <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> dir, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>)</div><div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;      {</div><div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;<span class="preprocessor">#if defined( __CUDA_ARCH__) &amp;&amp; !defined(DISABLE_TROVE)</span></div><div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;  <span class="keyword">typedef</span> <a class="code" href="structquda_1_1gauge_1_1_s.html">S&lt;Float,length&gt;</a> structure;</div><div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;  trove::coalesced_ptr&lt;structure&gt; gauge_((structure*)gauge);</div><div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;  structure v_;</div><div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;Nc; i++)</div><div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; Nc; j++) {</div><div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;            v_[(j * Nc + i) * 2 + 0] = v[i * Nc + j].<a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a74cb938c3e9438d4100efb0bd755c142">real</a>();</div><div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;            v_[(j * Nc + i) * 2 + 1] = v[i * Nc + j].imag();</div><div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;          }</div><div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;        gauge_[(dir * 2 + <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>) * exVolumeCB + x] = v_;</div><div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;        <span class="keyword">auto</span> v_ = &amp;gauge[((dir * 2 + <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>) * exVolumeCB + x) * <a class="code" href="gauge__force__test_8cpp.html#a2bcd2adde36b870d02897e694ecc39cb">length</a>];</div><div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; Nc; i++) {</div><div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; Nc; j++) {</div><div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;            v_[(j * Nc + i) * 2 + 0] = v[i * Nc + j].<a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a74cb938c3e9438d4100efb0bd755c142">real</a>();</div><div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;            v_[(j * Nc + i) * 2 + 1] = v[i * Nc + j].imag();</div><div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;          }</div><div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;        }</div><div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;      }</div><div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;</div><div class="line"><a name="l02717"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_b_q_c_d_order.html#a00a6c08a81a3599d18dbaead6f86377a"> 2717</a></span>&#160;      __device__ __host__ <span class="keyword">inline</span> <a class="code" href="structquda_1_1gauge__wrapper.html">gauge_wrapper&lt;real, Accessor&gt;</a> <a class="code" href="structquda_1_1gauge_1_1_b_q_c_d_order.html#a00a6c08a81a3599d18dbaead6f86377a">operator()</a>(<span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5261c5f7423edd78086a027390e11983">x_cb</a>, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>)</div><div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;      {</div><div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="structquda_1_1gauge__wrapper.html">gauge_wrapper&lt;real, Accessor&gt;</a>(*<span class="keyword">this</span>, <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>, <a class="code" href="structquda_1_1gauge__wrapper.html#a5261c5f7423edd78086a027390e11983">x_cb</a>, <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>);</div><div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;      }</div><div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;</div><div class="line"><a name="l02732"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_b_q_c_d_order.html#aa58d1109e8818be4481232fce9261491"> 2732</a></span>&#160;      __device__ __host__ <span class="keyword">inline</span> <span class="keyword">const</span> <a class="code" href="structquda_1_1gauge__wrapper.html">gauge_wrapper&lt;real, Accessor&gt;</a> <a class="code" href="structquda_1_1gauge_1_1_b_q_c_d_order.html#aa58d1109e8818be4481232fce9261491">operator()</a>(<span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5261c5f7423edd78086a027390e11983">x_cb</a>, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>)<span class="keyword"> const</span></div><div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;<span class="keyword">      </span>{</div><div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="structquda_1_1gauge__wrapper.html">gauge_wrapper&lt;real, Accessor&gt;</a>(<span class="keyword">const_cast&lt;</span><a class="code" href="structquda_1_1gauge_1_1_legacy_order.html">Accessor</a> &amp;<span class="keyword">&gt;</span>(*this), <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>, <a class="code" href="structquda_1_1gauge__wrapper.html#a5261c5f7423edd78086a027390e11983">x_cb</a>, <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>);</div><div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;      }</div><div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;</div><div class="line"><a name="l02737"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_b_q_c_d_order.html#a5961956a4d13dbade930d81184cbf202"> 2737</a></span>&#160;      <span class="keywordtype">size_t</span> <a class="code" href="structquda_1_1gauge_1_1_b_q_c_d_order.html#a5961956a4d13dbade930d81184cbf202">Bytes</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> Nc * Nc * 2 * <span class="keyword">sizeof</span>(Float); }</div><div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;    };</div><div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;</div><div class="line"><a name="l02744"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_t_i_f_r_order.html"> 2744</a></span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Float, <span class="keywordtype">int</span> length&gt; <span class="keyword">struct </span><a class="code" href="structquda_1_1gauge_1_1_t_i_f_r_order.html">TIFROrder</a> : <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html">LegacyOrder</a>&lt;Float,length&gt; {</div><div class="line"><a name="l02745"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_t_i_f_r_order.html#aab7cb1ec99c721c206a413ae65973905"> 2745</a></span>&#160;      <span class="keyword">using</span> <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html">Accessor</a> = <a class="code" href="structquda_1_1gauge_1_1_t_i_f_r_order.html">TIFROrder&lt;Float, length&gt;</a>;</div><div class="line"><a name="l02746"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_t_i_f_r_order.html#a47a928e5afbf714d297f30fe09adb475"> 2746</a></span>&#160;      <span class="keyword">using</span> <a class="code" href="structquda_1_1gauge_1_1_t_i_f_r_order.html#a47a928e5afbf714d297f30fe09adb475">real</a> = <span class="keyword">typename</span> <a class="code" href="structquda_1_1mapper.html">mapper&lt;Float&gt;::type</a>;</div><div class="line"><a name="l02747"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_t_i_f_r_order.html#afc36e35825af14fc42a8a261eab88143"> 2747</a></span>&#160;      <span class="keyword">using</span> <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a2493fde8fb5407c76f393ce6d4fea448">complex</a> = <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a2493fde8fb5407c76f393ce6d4fea448">complex&lt;real&gt;</a>;</div><div class="line"><a name="l02748"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_t_i_f_r_order.html#af97113dce0c18319c65d15feb69d1043"> 2748</a></span>&#160;      Float *<a class="code" href="structquda_1_1gauge_1_1_t_i_f_r_order.html#af97113dce0c18319c65d15feb69d1043">gauge</a>;</div><div class="line"><a name="l02749"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_t_i_f_r_order.html#ad9f1f4950dfebf99b297edb4ac8e1928"> 2749</a></span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge_1_1_t_i_f_r_order.html#ad9f1f4950dfebf99b297edb4ac8e1928">volumeCB</a>;</div><div class="line"><a name="l02750"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_t_i_f_r_order.html#a3ae1ca639347732595cd7f91e8694508"> 2750</a></span>&#160;      <span class="keyword">static</span> constexpr <span class="keywordtype">int</span> Nc = 3;</div><div class="line"><a name="l02751"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_t_i_f_r_order.html#a0a067282a203366c05124f3589c4e8b8"> 2751</a></span>&#160;      <span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_t_i_f_r_order.html#a47a928e5afbf714d297f30fe09adb475">real</a> <a class="code" href="structquda_1_1gauge_1_1_t_i_f_r_order.html#a0a067282a203366c05124f3589c4e8b8">scale</a>;</div><div class="line"><a name="l02752"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_t_i_f_r_order.html#a83584126da49a6d7d94bf1bb24ab23a1"> 2752</a></span>&#160;      <span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_t_i_f_r_order.html#a47a928e5afbf714d297f30fe09adb475">real</a> <a class="code" href="structquda_1_1gauge_1_1_t_i_f_r_order.html#a83584126da49a6d7d94bf1bb24ab23a1">scale_inv</a>;</div><div class="line"><a name="l02753"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_t_i_f_r_order.html#a21a66a7e4408045937ee3a0fecce832d"> 2753</a></span>&#160;      <a class="code" href="structquda_1_1gauge_1_1_t_i_f_r_order.html#a21a66a7e4408045937ee3a0fecce832d">TIFROrder</a>(<span class="keyword">const</span> <a class="code" href="classquda_1_1_gauge_field.html">GaugeField</a> &amp;u, Float *gauge_ = 0, Float **ghost_ = 0) :</div><div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;        <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html">LegacyOrder</a>&lt;Float, length&gt;(u, ghost_),</div><div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;        gauge(gauge_ ? gauge_ : (Float *)u.Gauge_p()),</div><div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;        volumeCB(u.VolumeCB()),</div><div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;        scale(u.Scale()),</div><div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;        scale_inv(1.0 / scale)</div><div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;      {</div><div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;        <span class="keywordflow">if</span> (length != 18) <a class="code" href="util__quda_8h.html#af3bddfd9d113d50e8e0bbf58a35c5aac">errorQuda</a>(<span class="stringliteral">&quot;Gauge length %d not supported&quot;</span>, length);</div><div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;      }</div><div class="line"><a name="l02762"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_t_i_f_r_order.html#a2526585fc94356c5e1b50208206f2047"> 2762</a></span>&#160;      <a class="code" href="structquda_1_1gauge_1_1_t_i_f_r_order.html#a2526585fc94356c5e1b50208206f2047">TIFROrder</a>(<span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_t_i_f_r_order.html">TIFROrder</a> &amp;order) :</div><div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;        <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html">LegacyOrder</a>&lt;Float, length&gt;(order),</div><div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;        gauge(order.gauge),</div><div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;        volumeCB(order.volumeCB),</div><div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;        scale(order.scale),</div><div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;        scale_inv(1.0 / scale)</div><div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;      {</div><div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;        <span class="keywordflow">if</span> (length != 18) <a class="code" href="util__quda_8h.html#af3bddfd9d113d50e8e0bbf58a35c5aac">errorQuda</a>(<span class="stringliteral">&quot;Gauge length %d not supported&quot;</span>, length);</div><div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;      }</div><div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;</div><div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;      <span class="comment">// we need to transpose for TIFR ordering</span></div><div class="line"><a name="l02773"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_t_i_f_r_order.html#af50107c14b42f7566d404ca771f4202a"> 2773</a></span>&#160;      __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structquda_1_1gauge_1_1_t_i_f_r_order.html#af50107c14b42f7566d404ca771f4202a">load</a>(<a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a2493fde8fb5407c76f393ce6d4fea448">complex</a> v[9], <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> dir, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>, <a class="code" href="structquda_1_1gauge_1_1_t_i_f_r_order.html#a47a928e5afbf714d297f30fe09adb475">real</a> inphase = 1.0)<span class="keyword"> const</span></div><div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;<span class="keyword">      </span>{</div><div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;<span class="preprocessor">#if defined( __CUDA_ARCH__) &amp;&amp; !defined(DISABLE_TROVE)</span></div><div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;        <span class="keyword">typedef</span> <a class="code" href="structquda_1_1gauge_1_1_s.html">S&lt;Float, length&gt;</a> structure;</div><div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;        trove::coalesced_ptr&lt;structure&gt; gauge_((structure *)gauge);</div><div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;        structure v_ = gauge_[(dir * 2 + <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>) * volumeCB + x];</div><div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;        <span class="keyword">auto</span> v_ = &amp;gauge[((dir * 2 + <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>) * volumeCB + x) * <a class="code" href="gauge__force__test_8cpp.html#a2bcd2adde36b870d02897e694ecc39cb">length</a>];</div><div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; Nc; i++) {</div><div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; Nc; j++) {</div><div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;            v[i * Nc + j] = <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a2493fde8fb5407c76f393ce6d4fea448">complex</a>(v_[(j * Nc + i) * 2 + 0], v_[(j * Nc + i) * 2 + 1]) * scale_inv;</div><div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;          }</div><div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;        }</div><div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;      }</div><div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;</div><div class="line"><a name="l02789"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_t_i_f_r_order.html#aebd7eabf1359306f94aec71c4353de30"> 2789</a></span>&#160;      __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structquda_1_1gauge_1_1_t_i_f_r_order.html#aebd7eabf1359306f94aec71c4353de30">save</a>(<span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a2493fde8fb5407c76f393ce6d4fea448">complex</a> v[9], <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> dir, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>)</div><div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;      {</div><div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;<span class="preprocessor">#if defined( __CUDA_ARCH__) &amp;&amp; !defined(DISABLE_TROVE)</span></div><div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;  <span class="keyword">typedef</span> <a class="code" href="structquda_1_1gauge_1_1_s.html">S&lt;Float,length&gt;</a> structure;</div><div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;  trove::coalesced_ptr&lt;structure&gt; gauge_((structure*)gauge);</div><div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;  structure v_;</div><div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;Nc; i++)</div><div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; Nc; j++) {</div><div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;            v_[(j * Nc + i) * 2 + 0] = v[i * Nc + j].<a class="code" href="structquda_1_1gauge_1_1_t_i_f_r_order.html#a47a928e5afbf714d297f30fe09adb475">real</a>() * scale;</div><div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;            v_[(j * Nc + i) * 2 + 1] = v[i * Nc + j].imag() * scale;</div><div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;          }</div><div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;        gauge_[(dir * 2 + <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>) * volumeCB + x] = v_;</div><div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;        <span class="keyword">auto</span> v_ = &amp;gauge[((dir * 2 + <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>) * volumeCB + x) * <a class="code" href="gauge__force__test_8cpp.html#a2bcd2adde36b870d02897e694ecc39cb">length</a>];</div><div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; Nc; i++) {</div><div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; Nc; j++) {</div><div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;            v_[(j * Nc + i) * 2 + 0] = v[i * Nc + j].<a class="code" href="structquda_1_1gauge_1_1_t_i_f_r_order.html#a47a928e5afbf714d297f30fe09adb475">real</a>() * scale;</div><div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;            v_[(j * Nc + i) * 2 + 1] = v[i * Nc + j].imag() * scale;</div><div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;          }</div><div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;        }</div><div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;      }</div><div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;</div><div class="line"><a name="l02822"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_t_i_f_r_order.html#add3ec1c96159cbb8aa9855d2b41858bb"> 2822</a></span>&#160;      __device__ __host__ <span class="keyword">inline</span> <a class="code" href="structquda_1_1gauge__wrapper.html">gauge_wrapper&lt;real, Accessor&gt;</a> <a class="code" href="structquda_1_1gauge_1_1_t_i_f_r_order.html#add3ec1c96159cbb8aa9855d2b41858bb">operator()</a>(<span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5261c5f7423edd78086a027390e11983">x_cb</a>, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>)</div><div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;      {</div><div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="structquda_1_1gauge__wrapper.html">gauge_wrapper&lt;real, Accessor&gt;</a>(*<span class="keyword">this</span>, <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>, <a class="code" href="structquda_1_1gauge__wrapper.html#a5261c5f7423edd78086a027390e11983">x_cb</a>, <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>);</div><div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;      }</div><div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;</div><div class="line"><a name="l02837"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_t_i_f_r_order.html#a158c65216bb7cf5b0f7c0fd32239ff71"> 2837</a></span>&#160;      __device__ __host__ <span class="keyword">inline</span> <span class="keyword">const</span> <a class="code" href="structquda_1_1gauge__wrapper.html">gauge_wrapper&lt;real, Accessor&gt;</a> <a class="code" href="structquda_1_1gauge_1_1_t_i_f_r_order.html#a158c65216bb7cf5b0f7c0fd32239ff71">operator()</a>(<span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5261c5f7423edd78086a027390e11983">x_cb</a>, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>)<span class="keyword"> const</span></div><div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;<span class="keyword">      </span>{</div><div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="structquda_1_1gauge__wrapper.html">gauge_wrapper&lt;real, Accessor&gt;</a>(<span class="keyword">const_cast&lt;</span><a class="code" href="structquda_1_1gauge_1_1_legacy_order.html">Accessor</a> &amp;<span class="keyword">&gt;</span>(*this), <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>, <a class="code" href="structquda_1_1gauge__wrapper.html#a5261c5f7423edd78086a027390e11983">x_cb</a>, <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>);</div><div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;      }</div><div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;</div><div class="line"><a name="l02842"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_t_i_f_r_order.html#af259239519e5e22f04264934df0b51be"> 2842</a></span>&#160;      <span class="keywordtype">size_t</span> <a class="code" href="structquda_1_1gauge_1_1_t_i_f_r_order.html#af259239519e5e22f04264934df0b51be">Bytes</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> Nc * Nc * 2 * <span class="keyword">sizeof</span>(Float); }</div><div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;    };</div><div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;</div><div class="line"><a name="l02849"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_t_i_f_r_padded_order.html"> 2849</a></span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Float, <span class="keywordtype">int</span> length&gt; <span class="keyword">struct </span><a class="code" href="structquda_1_1gauge_1_1_t_i_f_r_padded_order.html">TIFRPaddedOrder</a> : <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html">LegacyOrder</a>&lt;Float,length&gt; {</div><div class="line"><a name="l02850"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_t_i_f_r_padded_order.html#a544efbd997e6f5eb339bf01c5815b5de"> 2850</a></span>&#160;      <span class="keyword">using</span> <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html">Accessor</a> = <a class="code" href="structquda_1_1gauge_1_1_t_i_f_r_padded_order.html">TIFRPaddedOrder&lt;Float, length&gt;</a>;</div><div class="line"><a name="l02851"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_t_i_f_r_padded_order.html#abdc4313ad33edf1ac73bf63fce932e75"> 2851</a></span>&#160;      <span class="keyword">using</span> <a class="code" href="structquda_1_1gauge_1_1_t_i_f_r_padded_order.html#abdc4313ad33edf1ac73bf63fce932e75">real</a> = <span class="keyword">typename</span> <a class="code" href="structquda_1_1mapper.html">mapper&lt;Float&gt;::type</a>;</div><div class="line"><a name="l02852"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_t_i_f_r_padded_order.html#ae144d8fc172ea9911bdab1fa15930e1c"> 2852</a></span>&#160;      <span class="keyword">using</span> <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a2493fde8fb5407c76f393ce6d4fea448">complex</a> = <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a2493fde8fb5407c76f393ce6d4fea448">complex&lt;real&gt;</a>;</div><div class="line"><a name="l02853"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_t_i_f_r_padded_order.html#afffffad0c8404b29410abac78cabec27"> 2853</a></span>&#160;      Float *<a class="code" href="structquda_1_1gauge_1_1_t_i_f_r_padded_order.html#afffffad0c8404b29410abac78cabec27">gauge</a>;</div><div class="line"><a name="l02854"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_t_i_f_r_padded_order.html#af3b12b99f8643201034124af23afe979"> 2854</a></span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge_1_1_t_i_f_r_padded_order.html#af3b12b99f8643201034124af23afe979">volumeCB</a>;</div><div class="line"><a name="l02855"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_t_i_f_r_padded_order.html#afb18d2fa17ef78ffd859ba56b979c36e"> 2855</a></span>&#160;      <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge_1_1_t_i_f_r_padded_order.html#afb18d2fa17ef78ffd859ba56b979c36e">exVolumeCB</a>;</div><div class="line"><a name="l02856"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_t_i_f_r_padded_order.html#a2426d4699dab067a681af32d1b174e7a"> 2856</a></span>&#160;      <span class="keyword">static</span> constexpr <span class="keywordtype">int</span> Nc = 3;</div><div class="line"><a name="l02857"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_t_i_f_r_padded_order.html#aa1d83701348258431dadc24336da7f27"> 2857</a></span>&#160;      <span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_t_i_f_r_padded_order.html#abdc4313ad33edf1ac73bf63fce932e75">real</a> <a class="code" href="structquda_1_1gauge_1_1_t_i_f_r_padded_order.html#aa1d83701348258431dadc24336da7f27">scale</a>;</div><div class="line"><a name="l02858"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_t_i_f_r_padded_order.html#abfc31dd03863633b5ebf2b33479a832f"> 2858</a></span>&#160;      <span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_t_i_f_r_padded_order.html#abdc4313ad33edf1ac73bf63fce932e75">real</a> <a class="code" href="structquda_1_1gauge_1_1_t_i_f_r_padded_order.html#abfc31dd03863633b5ebf2b33479a832f">scale_inv</a>;</div><div class="line"><a name="l02859"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_t_i_f_r_padded_order.html#a1d69528680ef7c1fc7f75d816d14e975"> 2859</a></span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>[4];</div><div class="line"><a name="l02860"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_t_i_f_r_padded_order.html#a8d8d2f6562632fe070ed0cb420190e47"> 2860</a></span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> exDim[4];</div><div class="line"><a name="l02861"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_t_i_f_r_padded_order.html#a6a65fe758adab6acf1aa84ca969aa96e"> 2861</a></span>&#160;      <a class="code" href="structquda_1_1gauge_1_1_t_i_f_r_padded_order.html#a6a65fe758adab6acf1aa84ca969aa96e">TIFRPaddedOrder</a>(<span class="keyword">const</span> <a class="code" href="classquda_1_1_gauge_field.html">GaugeField</a> &amp;u, Float *gauge_ = 0, Float **ghost_ = 0) :</div><div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;        <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html">LegacyOrder</a>&lt;Float, length&gt;(u, ghost_),</div><div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;        gauge(gauge_ ? gauge_ : (Float *)u.Gauge_p()),</div><div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;        volumeCB(u.VolumeCB()),</div><div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;        exVolumeCB(1),</div><div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;        scale(u.Scale()),</div><div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;        scale_inv(1.0 / scale),</div><div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;        dim {u.<a class="code" href="classquda_1_1_lattice_field.html#a96f46542c595993b72818d3d031cd72f">X</a>()[0], u.<a class="code" href="classquda_1_1_lattice_field.html#a96f46542c595993b72818d3d031cd72f">X</a>()[1], u.<a class="code" href="classquda_1_1_lattice_field.html#a96f46542c595993b72818d3d031cd72f">X</a>()[2], u.<a class="code" href="classquda_1_1_lattice_field.html#a96f46542c595993b72818d3d031cd72f">X</a>()[3]},</div><div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;        exDim {u.X()[0], u.X()[1], u.X()[2] + 4, u.X()[3]}</div><div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;      {</div><div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;        <span class="keywordflow">if</span> (length != 18) <a class="code" href="util__quda_8h.html#af3bddfd9d113d50e8e0bbf58a35c5aac">errorQuda</a>(<span class="stringliteral">&quot;Gauge length %d not supported&quot;</span>, length);</div><div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;</div><div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;        <span class="comment">// exVolumeCB is the padded checkboard volume</span></div><div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;4; i++) exVolumeCB *= exDim[i];</div><div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;  exVolumeCB /= 2;</div><div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;      }</div><div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;</div><div class="line"><a name="l02878"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_t_i_f_r_padded_order.html#a26b85515eb39eb5d5f9f26f3deaadfa7"> 2878</a></span>&#160;      <a class="code" href="structquda_1_1gauge_1_1_t_i_f_r_padded_order.html#a26b85515eb39eb5d5f9f26f3deaadfa7">TIFRPaddedOrder</a>(<span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_t_i_f_r_padded_order.html">TIFRPaddedOrder</a> &amp;order) :</div><div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;        <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html">LegacyOrder</a>&lt;Float, length&gt;(order),</div><div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;        gauge(order.gauge),</div><div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;        volumeCB(order.volumeCB),</div><div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;        exVolumeCB(order.exVolumeCB),</div><div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;        scale(order.scale),</div><div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;        scale_inv(order.scale_inv),</div><div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;        dim {order.<a class="code" href="structquda_1_1gauge_1_1_t_i_f_r_padded_order.html#a1d69528680ef7c1fc7f75d816d14e975">dim</a>[0], order.<a class="code" href="structquda_1_1gauge_1_1_t_i_f_r_padded_order.html#a1d69528680ef7c1fc7f75d816d14e975">dim</a>[1], order.<a class="code" href="structquda_1_1gauge_1_1_t_i_f_r_padded_order.html#a1d69528680ef7c1fc7f75d816d14e975">dim</a>[2], order.<a class="code" href="structquda_1_1gauge_1_1_t_i_f_r_padded_order.html#a1d69528680ef7c1fc7f75d816d14e975">dim</a>[3]},</div><div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;        exDim {order.exDim[0], order.exDim[1], order.exDim[2], order.exDim[3]}</div><div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;      {</div><div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;        <span class="keywordflow">if</span> (length != 18) <a class="code" href="util__quda_8h.html#af3bddfd9d113d50e8e0bbf58a35c5aac">errorQuda</a>(<span class="stringliteral">&quot;Gauge length %d not supported&quot;</span>, length);</div><div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;      }</div><div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;</div><div class="line"><a name="l02895"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_t_i_f_r_padded_order.html#a762d40435c317bb75b5e4074bfdb5de3"> 2895</a></span>&#160;      __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge_1_1_t_i_f_r_padded_order.html#a762d40435c317bb75b5e4074bfdb5de3">getPaddedIndex</a>(<span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5261c5f7423edd78086a027390e11983">x_cb</a>, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>)<span class="keyword"> const </span>{</div><div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;  <span class="comment">// find coordinates</span></div><div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;  <span class="keywordtype">int</span> coord[4];</div><div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;  <a class="code" href="namespacequda.html#a416e52d2ea7f201272f902122f06668d">getCoords</a>(coord, x_cb, dim, parity);</div><div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;</div><div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;  <span class="comment">// get z-extended index</span></div><div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;  coord[2] += 2; <span class="comment">// offset for halo</span></div><div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacequda.html#ac39b1ae3f7dc813ed8f258d3cffbd642">linkIndex</a>(coord, exDim);</div><div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;      }</div><div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;</div><div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;      <span class="comment">// we need to transpose for TIFR ordering</span></div><div class="line"><a name="l02906"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_t_i_f_r_padded_order.html#aea5cb071eb8c078550d6c1380984dca6"> 2906</a></span>&#160;      __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structquda_1_1gauge_1_1_t_i_f_r_padded_order.html#aea5cb071eb8c078550d6c1380984dca6">load</a>(<a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a2493fde8fb5407c76f393ce6d4fea448">complex</a> v[9], <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> dir, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>, <a class="code" href="structquda_1_1gauge_1_1_t_i_f_r_padded_order.html#abdc4313ad33edf1ac73bf63fce932e75">real</a> inphase = 1.0)<span class="keyword"> const</span></div><div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;<span class="keyword">      </span>{</div><div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;        <span class="keywordtype">int</span> y = getPaddedIndex(x, parity);</div><div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;</div><div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;<span class="preprocessor">#if defined( __CUDA_ARCH__) &amp;&amp; !defined(DISABLE_TROVE)</span></div><div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;  <span class="keyword">typedef</span> <a class="code" href="structquda_1_1gauge_1_1_s.html">S&lt;Float,length&gt;</a> structure;</div><div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;  trove::coalesced_ptr&lt;structure&gt; gauge_((structure*)gauge);</div><div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;  structure v_ = gauge_[(dir*2+<a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>)*exVolumeCB + y];</div><div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;        <span class="keyword">auto</span> v_ = &amp;gauge[((dir * 2 + <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>) * exVolumeCB + y) * <a class="code" href="gauge__force__test_8cpp.html#a2bcd2adde36b870d02897e694ecc39cb">length</a>];</div><div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; Nc; i++) {</div><div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; Nc; j++) {</div><div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;            v[i * Nc + j] = <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a2493fde8fb5407c76f393ce6d4fea448">complex</a>(v_[(j * Nc + i) * 2 + 0], v_[(j * Nc + i) * 2 + 1]) * scale_inv;</div><div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;          }</div><div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;        }</div><div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;      }</div><div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;</div><div class="line"><a name="l02924"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_t_i_f_r_padded_order.html#a5e07ba81503bc204f62d35eb90b61c86"> 2924</a></span>&#160;      __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structquda_1_1gauge_1_1_t_i_f_r_padded_order.html#a5e07ba81503bc204f62d35eb90b61c86">save</a>(<span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1_legacy_order.html#a2493fde8fb5407c76f393ce6d4fea448">complex</a> v[9], <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> dir, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>)</div><div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;      {</div><div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;        <span class="keywordtype">int</span> y = getPaddedIndex(x, parity);</div><div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;</div><div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;<span class="preprocessor">#if defined( __CUDA_ARCH__) &amp;&amp; !defined(DISABLE_TROVE)</span></div><div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;  <span class="keyword">typedef</span> <a class="code" href="structquda_1_1gauge_1_1_s.html">S&lt;Float,length&gt;</a> structure;</div><div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;  trove::coalesced_ptr&lt;structure&gt; gauge_((structure*)gauge);</div><div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;  structure v_;</div><div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;Nc; i++)</div><div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; Nc; j++) {</div><div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;            v_[(j * Nc + i) * 2 + 0] = v[i * Nc + j].<a class="code" href="structquda_1_1gauge_1_1_t_i_f_r_padded_order.html#abdc4313ad33edf1ac73bf63fce932e75">real</a>() * scale;</div><div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;            v_[(j * Nc + i) * 2 + 1] = v[i * Nc + j].imag() * scale;</div><div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;          }</div><div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;        gauge_[(dir * 2 + <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>) * exVolumeCB + y] = v_;</div><div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;        <span class="keyword">auto</span> v_ = &amp;gauge[((dir * 2 + <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>) * exVolumeCB + y) * <a class="code" href="gauge__force__test_8cpp.html#a2bcd2adde36b870d02897e694ecc39cb">length</a>];</div><div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; Nc; i++) {</div><div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; Nc; j++) {</div><div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;            v_[(j * Nc + i) * 2 + 0] = v[i * Nc + j].<a class="code" href="structquda_1_1gauge_1_1_t_i_f_r_padded_order.html#abdc4313ad33edf1ac73bf63fce932e75">real</a>() * scale;</div><div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;            v_[(j * Nc + i) * 2 + 1] = v[i * Nc + j].imag() * scale;</div><div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;          }</div><div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;        }</div><div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;      }</div><div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;</div><div class="line"><a name="l02959"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_t_i_f_r_padded_order.html#ad88b168d332b1e9c19fb8642ab9abe19"> 2959</a></span>&#160;      __device__ __host__ <span class="keyword">inline</span> <a class="code" href="structquda_1_1gauge__wrapper.html">gauge_wrapper&lt;real, Accessor&gt;</a> <a class="code" href="structquda_1_1gauge_1_1_t_i_f_r_padded_order.html#ad88b168d332b1e9c19fb8642ab9abe19">operator()</a>(<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5261c5f7423edd78086a027390e11983">x_cb</a>, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>)</div><div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;      {</div><div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="structquda_1_1gauge__wrapper.html">gauge_wrapper&lt;real, Accessor&gt;</a>(*<span class="keyword">this</span>, <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>, <a class="code" href="structquda_1_1gauge__wrapper.html#a5261c5f7423edd78086a027390e11983">x_cb</a>, <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>);</div><div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;      }</div><div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;</div><div class="line"><a name="l02974"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_t_i_f_r_padded_order.html#a65ed051b6e31fc0b1270c8419aa16237"> 2974</a></span>&#160;      __device__ __host__ <span class="keyword">inline</span> <span class="keyword">const</span> <a class="code" href="structquda_1_1gauge__wrapper.html">gauge_wrapper&lt;real, Accessor&gt;</a> <a class="code" href="structquda_1_1gauge_1_1_t_i_f_r_padded_order.html#a65ed051b6e31fc0b1270c8419aa16237">operator()</a>(<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5261c5f7423edd78086a027390e11983">x_cb</a>, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>)<span class="keyword"> const</span></div><div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;<span class="keyword">      </span>{</div><div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="structquda_1_1gauge__wrapper.html">gauge_wrapper&lt;real, Accessor&gt;</a>(<span class="keyword">const_cast&lt;</span><a class="code" href="structquda_1_1gauge_1_1_legacy_order.html">Accessor</a> &amp;<span class="keyword">&gt;</span>(*this), <a class="code" href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">dim</a>, <a class="code" href="structquda_1_1gauge__wrapper.html#a5261c5f7423edd78086a027390e11983">x_cb</a>, <a class="code" href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">parity</a>);</div><div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;      }</div><div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;</div><div class="line"><a name="l02979"></a><span class="lineno"><a class="line" href="structquda_1_1gauge_1_1_t_i_f_r_padded_order.html#a96bfa8ddb8ba93d86b1861b62d595305"> 2979</a></span>&#160;      <span class="keywordtype">size_t</span> <a class="code" href="structquda_1_1gauge_1_1_t_i_f_r_padded_order.html#a96bfa8ddb8ba93d86b1861b62d595305">Bytes</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> Nc * Nc * 2 * <span class="keyword">sizeof</span>(Float); }</div><div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;    };</div><div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;</div><div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;  } <span class="comment">// namespace gauge</span></div><div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;</div><div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> otherFloat, <span class="keyword">typename</span> storeFloat&gt;</div><div class="line"><a name="l02985"></a><span class="lineno"><a class="line" href="structquda_1_1complex_3_01double_01_4.html#a5e3890478b977cb27af07322759abc70"> 2985</a></span>&#160;    __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structquda_1_1complex_3_01double_01_4.html#a415edb68e98c50ed9eacdbcf28781efa">complex&lt;double&gt;::operator=</a>(<span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1fieldorder__wrapper.html">gauge::fieldorder_wrapper&lt;otherFloat,storeFloat&gt;</a> &amp;a) {</div><div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;    x = a.<a class="code" href="structquda_1_1gauge_1_1fieldorder__wrapper.html#a8481a3e0b6670a33818206802171d657">real</a>();</div><div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;    y = a.<a class="code" href="structquda_1_1gauge_1_1fieldorder__wrapper.html#aa496f194271d518008d6c88b75d407a2">imag</a>();</div><div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;  }</div><div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;</div><div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> otherFloat, <span class="keyword">typename</span> storeFloat&gt;</div><div class="line"><a name="l02991"></a><span class="lineno"><a class="line" href="structquda_1_1complex_3_01float_01_4.html#a25085e565cc482498db72478cd84263d"> 2991</a></span>&#160;    __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structquda_1_1complex_3_01float_01_4.html#aa16dbca5ee984cd8edf468303374d8a3">complex&lt;float&gt;::operator=</a>(<span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1fieldorder__wrapper.html">gauge::fieldorder_wrapper&lt;otherFloat,storeFloat&gt;</a> &amp;a) {</div><div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;    x = a.<a class="code" href="structquda_1_1gauge_1_1fieldorder__wrapper.html#a8481a3e0b6670a33818206802171d657">real</a>();</div><div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;    y = a.<a class="code" href="structquda_1_1gauge_1_1fieldorder__wrapper.html#aa496f194271d518008d6c88b75d407a2">imag</a>();</div><div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;  }</div><div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;</div><div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> otherFloat, <span class="keyword">typename</span> storeFloat&gt;</div><div class="line"><a name="l02997"></a><span class="lineno"><a class="line" href="structquda_1_1complex_3_01double_01_4.html#a19991055871abc37a207d8adbfe86281"> 2997</a></span>&#160;    __device__ __host__ <span class="keyword">inline</span> <a class="code" href="structquda_1_1complex_3_01double_01_4.html#a95cf9854a2323a37af7785ee78a2c196">complex&lt;double&gt;::complex</a>(<span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1fieldorder__wrapper.html">gauge::fieldorder_wrapper&lt;otherFloat,storeFloat&gt;</a> &amp;a) {</div><div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;    x = a.<a class="code" href="structquda_1_1gauge_1_1fieldorder__wrapper.html#a8481a3e0b6670a33818206802171d657">real</a>();</div><div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;    y = a.<a class="code" href="structquda_1_1gauge_1_1fieldorder__wrapper.html#aa496f194271d518008d6c88b75d407a2">imag</a>();</div><div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;  }</div><div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;</div><div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> otherFloat, <span class="keyword">typename</span> storeFloat&gt;</div><div class="line"><a name="l03003"></a><span class="lineno"><a class="line" href="structquda_1_1complex_3_01float_01_4.html#a8adc17c11fd9210705b61561f8213edb"> 3003</a></span>&#160;    __device__ __host__ <span class="keyword">inline</span> <a class="code" href="structquda_1_1complex_3_01float_01_4.html#a6ece55234b752478b121323da96b48d0">complex&lt;float&gt;::complex</a>(<span class="keyword">const</span> <a class="code" href="structquda_1_1gauge_1_1fieldorder__wrapper.html">gauge::fieldorder_wrapper&lt;otherFloat,storeFloat&gt;</a> &amp;a) {</div><div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;    x = a.<a class="code" href="structquda_1_1gauge_1_1fieldorder__wrapper.html#a8481a3e0b6670a33818206802171d657">real</a>();</div><div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;    y = a.<a class="code" href="structquda_1_1gauge_1_1fieldorder__wrapper.html#aa496f194271d518008d6c88b75d407a2">imag</a>();</div><div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;  }</div><div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;</div><div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;  <span class="comment">// Use traits to reduce the template explosion</span></div><div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <a class="code" href="enum__quda_8h.html#a829ee8aa93bd9465811ae1ef9e0eedcc">QudaReconstructType</a>, <span class="keywordtype">int</span> N = 18, <a class="code" href="enum__quda_8h.html#a66bcb3446804c792fbe18f0301a3a56e">QudaStaggeredPhase</a> stag = <a class="code" href="enum__quda_8h.html#a2f13fac18d6933e9e21bc1cf2737b21aa3ddefa2065127060bce7d178208c51e0">QUDA_STAGGERED_PHASE_NO</a>,</div><div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;      <span class="keywordtype">bool</span> huge_alloc = <a class="code" href="namespacequda_1_1gauge.html#afdd600791225065a6dc0d7e76d19f1de">gauge::default_huge_alloc</a>, <a class="code" href="enum__quda_8h.html#a744e553dee90a2671fe00aba878c315b">QudaGhostExchange</a> ghostExchange = <a class="code" href="enum__quda_8h.html#a93131cceecad27ce4b964cb184e8d47aa8ce4a4e003d703610a08578f413760c6">QUDA_GHOST_EXCHANGE_INVALID</a>,</div><div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;      <span class="keywordtype">bool</span> use_inphase = <span class="keyword">false</span>&gt;</div><div class="line"><a name="l03012"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__mapper.html"> 3012</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structquda_1_1gauge__mapper.html">gauge_mapper</a> {</div><div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;  };</div><div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;</div><div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;  <span class="comment">// double precision</span></div><div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> N, QudaStaggeredPhase stag, <span class="keywordtype">bool</span> huge_alloc, QudaGhostExchange ghostExchange, <span class="keywordtype">bool</span> use_inphase&gt;</div><div class="line"><a name="l03017"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__mapper_3_01double_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t___n_o_00_01_n_00_01d04ce04d89bedac01bd2a9a29b8fc9ef.html"> 3017</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structquda_1_1gauge__mapper.html">gauge_mapper</a>&lt;double, <a class="code" href="enum__quda_8h.html#a5cc304be12bc9174274636e1e7863841a41ab3553ef10af8aeb118f39d8f1e935">QUDA_RECONSTRUCT_NO</a>, N, stag, huge_alloc, ghostExchange, use_inphase&gt; {</div><div class="line"><a name="l03018"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__mapper_3_01double_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t___n_o_00_01_n_00_01d04ce04d89bedac01bd2a9a29b8fc9ef.html#a1c3f887aa4f119bb080b604ab7bf570d"> 3018</a></span>&#160;    <span class="keyword">typedef</span> <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html">gauge::FloatNOrder&lt;double, N, 2, N, stag, huge_alloc, ghostExchange, use_inphase&gt;</a> <a class="code" href="structquda_1_1gauge__mapper_3_01double_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t___n_o_00_01_n_00_01d04ce04d89bedac01bd2a9a29b8fc9ef.html#a1c3f887aa4f119bb080b604ab7bf570d">type</a>;</div><div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;  };</div><div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> N, QudaStaggeredPhase stag, <span class="keywordtype">bool</span> huge_alloc, QudaGhostExchange ghostExchange, <span class="keywordtype">bool</span> use_inphase&gt;</div><div class="line"><a name="l03021"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__mapper_3_01double_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__13_00_01_n_00_01st9f47b01002957aa79e1ec780785ef084.html"> 3021</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structquda_1_1gauge__mapper.html">gauge_mapper</a>&lt;double, <a class="code" href="enum__quda_8h.html#a5cc304be12bc9174274636e1e7863841a979c49b45c3a054e53ee1aed9685bc60">QUDA_RECONSTRUCT_13</a>, N, stag, huge_alloc, ghostExchange, use_inphase&gt; {</div><div class="line"><a name="l03022"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__mapper_3_01double_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__13_00_01_n_00_01st9f47b01002957aa79e1ec780785ef084.html#aa160a315dadd1812fdc507c9b96d6bb9"> 3022</a></span>&#160;    <span class="keyword">typedef</span> <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html">gauge::FloatNOrder&lt;double, N, 2, 13, stag, huge_alloc, ghostExchange, use_inphase&gt;</a> <a class="code" href="structquda_1_1gauge__mapper_3_01double_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__13_00_01_n_00_01st9f47b01002957aa79e1ec780785ef084.html#aa160a315dadd1812fdc507c9b96d6bb9">type</a>;</div><div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;  };</div><div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> N, QudaStaggeredPhase stag, <span class="keywordtype">bool</span> huge_alloc, QudaGhostExchange ghostExchange, <span class="keywordtype">bool</span> use_inphase&gt;</div><div class="line"><a name="l03025"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__mapper_3_01double_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__12_00_01_n_00_01st2bfe0c646d280c0cfa115a9c40ec25b6.html"> 3025</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structquda_1_1gauge__mapper.html">gauge_mapper</a>&lt;double, <a class="code" href="enum__quda_8h.html#a5cc304be12bc9174274636e1e7863841a75dea1bc5914c39d84665ee0fc7b2432">QUDA_RECONSTRUCT_12</a>, N, stag, huge_alloc, ghostExchange, use_inphase&gt; {</div><div class="line"><a name="l03026"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__mapper_3_01double_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__12_00_01_n_00_01st2bfe0c646d280c0cfa115a9c40ec25b6.html#aa4594e7f4d649b2ac896f7522da3b7dd"> 3026</a></span>&#160;    <span class="keyword">typedef</span> <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html">gauge::FloatNOrder&lt;double, N, 2, 12, stag, huge_alloc, ghostExchange, use_inphase&gt;</a> <a class="code" href="structquda_1_1gauge__mapper_3_01double_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__12_00_01_n_00_01st2bfe0c646d280c0cfa115a9c40ec25b6.html#aa4594e7f4d649b2ac896f7522da3b7dd">type</a>;</div><div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;  };</div><div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> N, QudaStaggeredPhase stag, <span class="keywordtype">bool</span> huge_alloc, QudaGhostExchange ghostExchange, <span class="keywordtype">bool</span> use_inphase&gt;</div><div class="line"><a name="l03029"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__mapper_3_01double_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__10_00_01_n_00_01st54aa8efa4151999eaeb3ea09a969f5cf.html"> 3029</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structquda_1_1gauge__mapper.html">gauge_mapper</a>&lt;double, <a class="code" href="enum__quda_8h.html#a5cc304be12bc9174274636e1e7863841ac73ec20dcdd9bb298a7615e70b70799d">QUDA_RECONSTRUCT_10</a>, N, stag, huge_alloc, ghostExchange, use_inphase&gt; {</div><div class="line"><a name="l03030"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__mapper_3_01double_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__10_00_01_n_00_01st54aa8efa4151999eaeb3ea09a969f5cf.html#a7592ce36c3c2bff845b6120a3406294f"> 3030</a></span>&#160;    <span class="keyword">typedef</span> <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html">gauge::FloatNOrder&lt;double, N, 2, 11, stag, huge_alloc, ghostExchange, use_inphase&gt;</a> <a class="code" href="structquda_1_1gauge__mapper_3_01double_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__10_00_01_n_00_01st54aa8efa4151999eaeb3ea09a969f5cf.html#a7592ce36c3c2bff845b6120a3406294f">type</a>;</div><div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;  };</div><div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> N, QudaStaggeredPhase stag, <span class="keywordtype">bool</span> huge_alloc, QudaGhostExchange ghostExchange, <span class="keywordtype">bool</span> use_inphase&gt;</div><div class="line"><a name="l03033"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__mapper_3_01double_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__9_00_01_n_00_01stacee8be82bf35cbdd2c9bf0e645d6b117.html"> 3033</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structquda_1_1gauge__mapper.html">gauge_mapper</a>&lt;double, <a class="code" href="enum__quda_8h.html#a5cc304be12bc9174274636e1e7863841af1832705631a3fa4a26b9de29d1e4e70">QUDA_RECONSTRUCT_9</a>, N, stag, huge_alloc, ghostExchange, use_inphase&gt; {</div><div class="line"><a name="l03034"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__mapper_3_01double_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__9_00_01_n_00_01stacee8be82bf35cbdd2c9bf0e645d6b117.html#a08abeb4ad02fb5a877406e4b0d14a768"> 3034</a></span>&#160;    <span class="keyword">typedef</span> <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html">gauge::FloatNOrder&lt;double, N, 2, 9, stag, huge_alloc, ghostExchange, use_inphase&gt;</a> <a class="code" href="structquda_1_1gauge__mapper_3_01double_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__9_00_01_n_00_01stacee8be82bf35cbdd2c9bf0e645d6b117.html#a08abeb4ad02fb5a877406e4b0d14a768">type</a>;</div><div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;  };</div><div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> N, QudaStaggeredPhase stag, <span class="keywordtype">bool</span> huge_alloc, QudaGhostExchange ghostExchange, <span class="keywordtype">bool</span> use_inphase&gt;</div><div class="line"><a name="l03037"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__mapper_3_01double_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__8_00_01_n_00_01sta727838eb2b4770a9aa7a352b2a1c79a5.html"> 3037</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structquda_1_1gauge__mapper.html">gauge_mapper</a>&lt;double, <a class="code" href="enum__quda_8h.html#a5cc304be12bc9174274636e1e7863841aad305d7711f78203e925196a6d92bc7b">QUDA_RECONSTRUCT_8</a>, N, stag, huge_alloc, ghostExchange, use_inphase&gt; {</div><div class="line"><a name="l03038"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__mapper_3_01double_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__8_00_01_n_00_01sta727838eb2b4770a9aa7a352b2a1c79a5.html#a65d87b307241347039136997b68b3e34"> 3038</a></span>&#160;    <span class="keyword">typedef</span> <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html">gauge::FloatNOrder&lt;double, N, 2, 8, stag, huge_alloc, ghostExchange, use_inphase&gt;</a> <a class="code" href="structquda_1_1gauge__mapper_3_01double_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__8_00_01_n_00_01sta727838eb2b4770a9aa7a352b2a1c79a5.html#a65d87b307241347039136997b68b3e34">type</a>;</div><div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;  };</div><div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;</div><div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;  <span class="comment">// single precision</span></div><div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> N, QudaStaggeredPhase stag, <span class="keywordtype">bool</span> huge_alloc, QudaGhostExchange ghostExchange, <span class="keywordtype">bool</span> use_inphase&gt;</div><div class="line"><a name="l03043"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__mapper_3_01float_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t___n_o_00_01_n_00_01sc628be7b5877881a73471ebcaf78cddc.html"> 3043</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structquda_1_1gauge__mapper.html">gauge_mapper</a>&lt;float, <a class="code" href="enum__quda_8h.html#a5cc304be12bc9174274636e1e7863841a41ab3553ef10af8aeb118f39d8f1e935">QUDA_RECONSTRUCT_NO</a>, N, stag, huge_alloc, ghostExchange, use_inphase&gt; {</div><div class="line"><a name="l03044"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__mapper_3_01float_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t___n_o_00_01_n_00_01sc628be7b5877881a73471ebcaf78cddc.html#a52aaa248ab213dda6e135b4763b1decb"> 3044</a></span>&#160;    <span class="keyword">typedef</span> <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html">gauge::FloatNOrder&lt;float, N, 2, N, stag, huge_alloc, ghostExchange, use_inphase&gt;</a> <a class="code" href="structquda_1_1gauge__mapper_3_01float_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t___n_o_00_01_n_00_01sc628be7b5877881a73471ebcaf78cddc.html#a52aaa248ab213dda6e135b4763b1decb">type</a>;</div><div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;  };</div><div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> N, QudaStaggeredPhase stag, <span class="keywordtype">bool</span> huge_alloc, QudaGhostExchange ghostExchange, <span class="keywordtype">bool</span> use_inphase&gt;</div><div class="line"><a name="l03047"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__mapper_3_01float_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__13_00_01_n_00_01stae3dc473a15d610b6b48c11919a62343a.html"> 3047</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structquda_1_1gauge__mapper.html">gauge_mapper</a>&lt;float, <a class="code" href="enum__quda_8h.html#a5cc304be12bc9174274636e1e7863841a979c49b45c3a054e53ee1aed9685bc60">QUDA_RECONSTRUCT_13</a>, N, stag, huge_alloc, ghostExchange, use_inphase&gt; {</div><div class="line"><a name="l03048"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__mapper_3_01float_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__13_00_01_n_00_01stae3dc473a15d610b6b48c11919a62343a.html#a3a33edf551ab6ab7e7b7eabd57a21484"> 3048</a></span>&#160;    <span class="keyword">typedef</span> <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html">gauge::FloatNOrder&lt;float, N, 4, 13, stag, huge_alloc, ghostExchange, use_inphase&gt;</a> <a class="code" href="structquda_1_1gauge__mapper_3_01float_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__13_00_01_n_00_01stae3dc473a15d610b6b48c11919a62343a.html#a3a33edf551ab6ab7e7b7eabd57a21484">type</a>;</div><div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;  };</div><div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> N, QudaStaggeredPhase stag, <span class="keywordtype">bool</span> huge_alloc, QudaGhostExchange ghostExchange, <span class="keywordtype">bool</span> use_inphase&gt;</div><div class="line"><a name="l03051"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__mapper_3_01float_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__12_00_01_n_00_01sta5e02132e1241a1ab0101213ce6b322bd.html"> 3051</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structquda_1_1gauge__mapper.html">gauge_mapper</a>&lt;float, <a class="code" href="enum__quda_8h.html#a5cc304be12bc9174274636e1e7863841a75dea1bc5914c39d84665ee0fc7b2432">QUDA_RECONSTRUCT_12</a>, N, stag, huge_alloc, ghostExchange, use_inphase&gt; {</div><div class="line"><a name="l03052"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__mapper_3_01float_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__12_00_01_n_00_01sta5e02132e1241a1ab0101213ce6b322bd.html#ae172719e4c3eb5015dbf485274477841"> 3052</a></span>&#160;    <span class="keyword">typedef</span> <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html">gauge::FloatNOrder&lt;float, N, 4, 12, stag, huge_alloc, ghostExchange, use_inphase&gt;</a> <a class="code" href="structquda_1_1gauge__mapper_3_01float_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__12_00_01_n_00_01sta5e02132e1241a1ab0101213ce6b322bd.html#ae172719e4c3eb5015dbf485274477841">type</a>;</div><div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;  };</div><div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> N, QudaStaggeredPhase stag, <span class="keywordtype">bool</span> huge_alloc, QudaGhostExchange ghostExchange, <span class="keywordtype">bool</span> use_inphase&gt;</div><div class="line"><a name="l03055"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__mapper_3_01float_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__10_00_01_n_00_01sta55f60513675629526a9d9eb2c7343b53.html"> 3055</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structquda_1_1gauge__mapper.html">gauge_mapper</a>&lt;float, <a class="code" href="enum__quda_8h.html#a5cc304be12bc9174274636e1e7863841ac73ec20dcdd9bb298a7615e70b70799d">QUDA_RECONSTRUCT_10</a>, N, stag, huge_alloc, ghostExchange, use_inphase&gt; {</div><div class="line"><a name="l03056"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__mapper_3_01float_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__10_00_01_n_00_01sta55f60513675629526a9d9eb2c7343b53.html#a511f3904458550c3214cfaef01367989"> 3056</a></span>&#160;    <span class="keyword">typedef</span> <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html">gauge::FloatNOrder&lt;float, N, 2, 11, stag, huge_alloc, ghostExchange, use_inphase&gt;</a> <a class="code" href="structquda_1_1gauge__mapper_3_01float_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__10_00_01_n_00_01sta55f60513675629526a9d9eb2c7343b53.html#a511f3904458550c3214cfaef01367989">type</a>;</div><div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;  };</div><div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> N, QudaStaggeredPhase stag, <span class="keywordtype">bool</span> huge_alloc, QudaGhostExchange ghostExchange, <span class="keywordtype">bool</span> use_inphase&gt;</div><div class="line"><a name="l03059"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__mapper_3_01float_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__9_00_01_n_00_01stag7e92965b2032902f71786a0b5036e623.html"> 3059</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structquda_1_1gauge__mapper.html">gauge_mapper</a>&lt;float, <a class="code" href="enum__quda_8h.html#a5cc304be12bc9174274636e1e7863841af1832705631a3fa4a26b9de29d1e4e70">QUDA_RECONSTRUCT_9</a>, N, stag, huge_alloc, ghostExchange, use_inphase&gt; {</div><div class="line"><a name="l03060"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__mapper_3_01float_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__9_00_01_n_00_01stag7e92965b2032902f71786a0b5036e623.html#acf515d453afc6ecf459989eba9762391"> 3060</a></span>&#160;    <span class="keyword">typedef</span> <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html">gauge::FloatNOrder&lt;float, N, 4, 9, stag, huge_alloc, ghostExchange, use_inphase&gt;</a> <a class="code" href="structquda_1_1gauge__mapper_3_01float_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__9_00_01_n_00_01stag7e92965b2032902f71786a0b5036e623.html#acf515d453afc6ecf459989eba9762391">type</a>;</div><div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;  };</div><div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> N, QudaStaggeredPhase stag, <span class="keywordtype">bool</span> huge_alloc, QudaGhostExchange ghostExchange, <span class="keywordtype">bool</span> use_inphase&gt;</div><div class="line"><a name="l03063"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__mapper_3_01float_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__8_00_01_n_00_01stagcd53a91849eda926634b4b11907ab37d.html"> 3063</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structquda_1_1gauge__mapper.html">gauge_mapper</a>&lt;float, <a class="code" href="enum__quda_8h.html#a5cc304be12bc9174274636e1e7863841aad305d7711f78203e925196a6d92bc7b">QUDA_RECONSTRUCT_8</a>, N, stag, huge_alloc, ghostExchange, use_inphase&gt; {</div><div class="line"><a name="l03064"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__mapper_3_01float_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__8_00_01_n_00_01stagcd53a91849eda926634b4b11907ab37d.html#a19793701891e8a3fa0689c7454cd9b7c"> 3064</a></span>&#160;    <span class="keyword">typedef</span> <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html">gauge::FloatNOrder&lt;float, N, 4, 8, stag, huge_alloc, ghostExchange, use_inphase&gt;</a> <a class="code" href="structquda_1_1gauge__mapper_3_01float_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__8_00_01_n_00_01stagcd53a91849eda926634b4b11907ab37d.html#a19793701891e8a3fa0689c7454cd9b7c">type</a>;</div><div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;  };</div><div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;</div><div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;  <span class="comment">// half precision</span></div><div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> N, QudaStaggeredPhase stag, <span class="keywordtype">bool</span> huge_alloc, QudaGhostExchange ghostExchange, <span class="keywordtype">bool</span> use_inphase&gt;</div><div class="line"><a name="l03069"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__mapper_3_01short_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t___n_o_00_01_n_00_01s8d62358dfffba98a1ac205290ef41137.html"> 3069</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structquda_1_1gauge__mapper.html">gauge_mapper</a>&lt;short, <a class="code" href="enum__quda_8h.html#a5cc304be12bc9174274636e1e7863841a41ab3553ef10af8aeb118f39d8f1e935">QUDA_RECONSTRUCT_NO</a>, N, stag, huge_alloc, ghostExchange, use_inphase&gt; {</div><div class="line"><a name="l03070"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__mapper_3_01short_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t___n_o_00_01_n_00_01s8d62358dfffba98a1ac205290ef41137.html#a3f88aa5b7b78d31c63d68af34a443840"> 3070</a></span>&#160;    <span class="keyword">typedef</span> <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html">gauge::FloatNOrder&lt;short, N, 2, N, stag, huge_alloc, ghostExchange, use_inphase&gt;</a> <a class="code" href="structquda_1_1gauge__mapper_3_01short_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t___n_o_00_01_n_00_01s8d62358dfffba98a1ac205290ef41137.html#a3f88aa5b7b78d31c63d68af34a443840">type</a>;</div><div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;  };</div><div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> N, QudaStaggeredPhase stag, <span class="keywordtype">bool</span> huge_alloc, QudaGhostExchange ghostExchange, <span class="keywordtype">bool</span> use_inphase&gt;</div><div class="line"><a name="l03073"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__mapper_3_01short_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__13_00_01_n_00_01sta3fb5c8e95e4124ae0bd62f1be5b3d821.html"> 3073</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structquda_1_1gauge__mapper.html">gauge_mapper</a>&lt;short, <a class="code" href="enum__quda_8h.html#a5cc304be12bc9174274636e1e7863841a979c49b45c3a054e53ee1aed9685bc60">QUDA_RECONSTRUCT_13</a>, N, stag, huge_alloc, ghostExchange, use_inphase&gt; {</div><div class="line"><a name="l03074"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__mapper_3_01short_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__13_00_01_n_00_01sta3fb5c8e95e4124ae0bd62f1be5b3d821.html#a2c2ee705f55133601bcd1ce7442018f3"> 3074</a></span>&#160;    <span class="keyword">typedef</span> <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html">gauge::FloatNOrder&lt;short, N, 4, 13, stag, huge_alloc, ghostExchange, use_inphase&gt;</a> <a class="code" href="structquda_1_1gauge__mapper_3_01short_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__13_00_01_n_00_01sta3fb5c8e95e4124ae0bd62f1be5b3d821.html#a2c2ee705f55133601bcd1ce7442018f3">type</a>;</div><div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;  };</div><div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> N, QudaStaggeredPhase stag, <span class="keywordtype">bool</span> huge_alloc, QudaGhostExchange ghostExchange, <span class="keywordtype">bool</span> use_inphase&gt;</div><div class="line"><a name="l03077"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__mapper_3_01short_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__12_00_01_n_00_01sta68ba267ce7fdb075b65222ebaa0558ed.html"> 3077</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structquda_1_1gauge__mapper.html">gauge_mapper</a>&lt;short, <a class="code" href="enum__quda_8h.html#a5cc304be12bc9174274636e1e7863841a75dea1bc5914c39d84665ee0fc7b2432">QUDA_RECONSTRUCT_12</a>, N, stag, huge_alloc, ghostExchange, use_inphase&gt; {</div><div class="line"><a name="l03078"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__mapper_3_01short_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__12_00_01_n_00_01sta68ba267ce7fdb075b65222ebaa0558ed.html#a2cec2cb6ab207f633b554cfdcfccded8"> 3078</a></span>&#160;    <span class="keyword">typedef</span> <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html">gauge::FloatNOrder&lt;short, N, 4, 12, stag, huge_alloc, ghostExchange, use_inphase&gt;</a> <a class="code" href="structquda_1_1gauge__mapper_3_01short_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__12_00_01_n_00_01sta68ba267ce7fdb075b65222ebaa0558ed.html#a2cec2cb6ab207f633b554cfdcfccded8">type</a>;</div><div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;  };</div><div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> N, QudaStaggeredPhase stag, <span class="keywordtype">bool</span> huge_alloc, QudaGhostExchange ghostExchange, <span class="keywordtype">bool</span> use_inphase&gt;</div><div class="line"><a name="l03081"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__mapper_3_01short_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__10_00_01_n_00_01sta8caa40d035ba517fbb13224e7576f08e.html"> 3081</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structquda_1_1gauge__mapper.html">gauge_mapper</a>&lt;short, <a class="code" href="enum__quda_8h.html#a5cc304be12bc9174274636e1e7863841ac73ec20dcdd9bb298a7615e70b70799d">QUDA_RECONSTRUCT_10</a>, N, stag, huge_alloc, ghostExchange, use_inphase&gt; {</div><div class="line"><a name="l03082"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__mapper_3_01short_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__10_00_01_n_00_01sta8caa40d035ba517fbb13224e7576f08e.html#a34d5f6dd4d77c99f568f22e31c56a4e1"> 3082</a></span>&#160;    <span class="keyword">typedef</span> <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html">gauge::FloatNOrder&lt;short, N, 2, 11, stag, huge_alloc, ghostExchange, use_inphase&gt;</a> <a class="code" href="structquda_1_1gauge__mapper_3_01short_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__10_00_01_n_00_01sta8caa40d035ba517fbb13224e7576f08e.html#a34d5f6dd4d77c99f568f22e31c56a4e1">type</a>;</div><div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;  };</div><div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> N, QudaStaggeredPhase stag, <span class="keywordtype">bool</span> huge_alloc, QudaGhostExchange ghostExchange, <span class="keywordtype">bool</span> use_inphase&gt;</div><div class="line"><a name="l03085"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__mapper_3_01short_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__9_00_01_n_00_01stagabe2076f04b407b412e5192d2ba58b59.html"> 3085</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structquda_1_1gauge__mapper.html">gauge_mapper</a>&lt;short, <a class="code" href="enum__quda_8h.html#a5cc304be12bc9174274636e1e7863841af1832705631a3fa4a26b9de29d1e4e70">QUDA_RECONSTRUCT_9</a>, N, stag, huge_alloc, ghostExchange, use_inphase&gt; {</div><div class="line"><a name="l03086"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__mapper_3_01short_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__9_00_01_n_00_01stagabe2076f04b407b412e5192d2ba58b59.html#ad49a8df2de4e83a6ba83aacf37aa0440"> 3086</a></span>&#160;    <span class="keyword">typedef</span> <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html">gauge::FloatNOrder&lt;short, N, 4, 9, stag, huge_alloc, ghostExchange, use_inphase&gt;</a> <a class="code" href="structquda_1_1gauge__mapper_3_01short_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__9_00_01_n_00_01stagabe2076f04b407b412e5192d2ba58b59.html#ad49a8df2de4e83a6ba83aacf37aa0440">type</a>;</div><div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;  };</div><div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> N, QudaStaggeredPhase stag, <span class="keywordtype">bool</span> huge_alloc, QudaGhostExchange ghostExchange, <span class="keywordtype">bool</span> use_inphase&gt;</div><div class="line"><a name="l03089"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__mapper_3_01short_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__8_00_01_n_00_01stagf6d13b3f3009dd8eae09254d0b962822.html"> 3089</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structquda_1_1gauge__mapper.html">gauge_mapper</a>&lt;short, <a class="code" href="enum__quda_8h.html#a5cc304be12bc9174274636e1e7863841aad305d7711f78203e925196a6d92bc7b">QUDA_RECONSTRUCT_8</a>, N, stag, huge_alloc, ghostExchange, use_inphase&gt; {</div><div class="line"><a name="l03090"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__mapper_3_01short_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__8_00_01_n_00_01stagf6d13b3f3009dd8eae09254d0b962822.html#a2dafbcdef82d5038b5cb70330f90fb4c"> 3090</a></span>&#160;    <span class="keyword">typedef</span> <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html">gauge::FloatNOrder&lt;short, N, 4, 8, stag, huge_alloc, ghostExchange, use_inphase&gt;</a> <a class="code" href="structquda_1_1gauge__mapper_3_01short_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__8_00_01_n_00_01stagf6d13b3f3009dd8eae09254d0b962822.html#a2dafbcdef82d5038b5cb70330f90fb4c">type</a>;</div><div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;  };</div><div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;</div><div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;  <span class="comment">// quarter precision</span></div><div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> N, QudaStaggeredPhase stag, <span class="keywordtype">bool</span> huge_alloc, QudaGhostExchange ghostExchange, <span class="keywordtype">bool</span> use_inphase&gt;</div><div class="line"><a name="l03095"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__mapper_3_01char_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t___n_o_00_01_n_00_01stc8a71736ea66c08a424ee6c3abbe78cc.html"> 3095</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structquda_1_1gauge__mapper.html">gauge_mapper</a>&lt;char, <a class="code" href="enum__quda_8h.html#a5cc304be12bc9174274636e1e7863841a41ab3553ef10af8aeb118f39d8f1e935">QUDA_RECONSTRUCT_NO</a>, N, stag, huge_alloc, ghostExchange, use_inphase&gt; {</div><div class="line"><a name="l03096"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__mapper_3_01char_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t___n_o_00_01_n_00_01stc8a71736ea66c08a424ee6c3abbe78cc.html#a299481837b140204a38c90cce84e214d"> 3096</a></span>&#160;    <span class="keyword">typedef</span> <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html">gauge::FloatNOrder&lt;char, N, 2, N, stag, huge_alloc, ghostExchange, use_inphase&gt;</a> <a class="code" href="structquda_1_1gauge__mapper_3_01char_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t___n_o_00_01_n_00_01stc8a71736ea66c08a424ee6c3abbe78cc.html#a299481837b140204a38c90cce84e214d">type</a>;</div><div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;  };</div><div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> N, QudaStaggeredPhase stag, <span class="keywordtype">bool</span> huge_alloc, QudaGhostExchange ghostExchange, <span class="keywordtype">bool</span> use_inphase&gt;</div><div class="line"><a name="l03099"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__mapper_3_01char_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__13_00_01_n_00_01stagea58f59eb11dcedb2557bbcc931c95b0.html"> 3099</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structquda_1_1gauge__mapper.html">gauge_mapper</a>&lt;char, <a class="code" href="enum__quda_8h.html#a5cc304be12bc9174274636e1e7863841a979c49b45c3a054e53ee1aed9685bc60">QUDA_RECONSTRUCT_13</a>, N, stag, huge_alloc, ghostExchange, use_inphase&gt; {</div><div class="line"><a name="l03100"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__mapper_3_01char_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__13_00_01_n_00_01stagea58f59eb11dcedb2557bbcc931c95b0.html#a947153d2d79bdfe67ed3616e3d1bea92"> 3100</a></span>&#160;    <span class="keyword">typedef</span> <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html">gauge::FloatNOrder&lt;char, N, 4, 13, stag, huge_alloc, ghostExchange, use_inphase&gt;</a> <a class="code" href="structquda_1_1gauge__mapper_3_01char_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__13_00_01_n_00_01stagea58f59eb11dcedb2557bbcc931c95b0.html#a947153d2d79bdfe67ed3616e3d1bea92">type</a>;</div><div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;  };</div><div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> N, QudaStaggeredPhase stag, <span class="keywordtype">bool</span> huge_alloc, QudaGhostExchange ghostExchange, <span class="keywordtype">bool</span> use_inphase&gt;</div><div class="line"><a name="l03103"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__mapper_3_01char_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__12_00_01_n_00_01stag0fc2ea3a3777b69e201179ebb538c566.html"> 3103</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structquda_1_1gauge__mapper.html">gauge_mapper</a>&lt;char, <a class="code" href="enum__quda_8h.html#a5cc304be12bc9174274636e1e7863841a75dea1bc5914c39d84665ee0fc7b2432">QUDA_RECONSTRUCT_12</a>, N, stag, huge_alloc, ghostExchange, use_inphase&gt; {</div><div class="line"><a name="l03104"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__mapper_3_01char_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__12_00_01_n_00_01stag0fc2ea3a3777b69e201179ebb538c566.html#ae7127323096cf2d2c287507f36ee3404"> 3104</a></span>&#160;    <span class="keyword">typedef</span> <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html">gauge::FloatNOrder&lt;char, N, 4, 12, stag, huge_alloc, ghostExchange, use_inphase&gt;</a> <a class="code" href="structquda_1_1gauge__mapper_3_01char_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__12_00_01_n_00_01stag0fc2ea3a3777b69e201179ebb538c566.html#ae7127323096cf2d2c287507f36ee3404">type</a>;</div><div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;  };</div><div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> N, QudaStaggeredPhase stag, <span class="keywordtype">bool</span> huge_alloc, QudaGhostExchange ghostExchange, <span class="keywordtype">bool</span> use_inphase&gt;</div><div class="line"><a name="l03107"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__mapper_3_01char_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__10_00_01_n_00_01stagaef0cb5983acbe36c0f881a37986f4f3.html"> 3107</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structquda_1_1gauge__mapper.html">gauge_mapper</a>&lt;char, <a class="code" href="enum__quda_8h.html#a5cc304be12bc9174274636e1e7863841ac73ec20dcdd9bb298a7615e70b70799d">QUDA_RECONSTRUCT_10</a>, N, stag, huge_alloc, ghostExchange, use_inphase&gt; {</div><div class="line"><a name="l03108"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__mapper_3_01char_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__10_00_01_n_00_01stagaef0cb5983acbe36c0f881a37986f4f3.html#af2d0d5d390ca2fcf85cad3dadb58e6aa"> 3108</a></span>&#160;    <span class="keyword">typedef</span> <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html">gauge::FloatNOrder&lt;char, N, 2, 11, stag, huge_alloc, ghostExchange, use_inphase&gt;</a> <a class="code" href="structquda_1_1gauge__mapper_3_01char_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__10_00_01_n_00_01stagaef0cb5983acbe36c0f881a37986f4f3.html#af2d0d5d390ca2fcf85cad3dadb58e6aa">type</a>;</div><div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;  };</div><div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> N, QudaStaggeredPhase stag, <span class="keywordtype">bool</span> huge_alloc, QudaGhostExchange ghostExchange, <span class="keywordtype">bool</span> use_inphase&gt;</div><div class="line"><a name="l03111"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__mapper_3_01char_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__9_00_01_n_00_01stag_ccb9fbed9e009d8660b4b9d3e7a9e56b.html"> 3111</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structquda_1_1gauge__mapper.html">gauge_mapper</a>&lt;char, <a class="code" href="enum__quda_8h.html#a5cc304be12bc9174274636e1e7863841af1832705631a3fa4a26b9de29d1e4e70">QUDA_RECONSTRUCT_9</a>, N, stag, huge_alloc, ghostExchange, use_inphase&gt; {</div><div class="line"><a name="l03112"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__mapper_3_01char_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__9_00_01_n_00_01stag_ccb9fbed9e009d8660b4b9d3e7a9e56b.html#ab3ee29fa036600a684b4245515cee573"> 3112</a></span>&#160;    <span class="keyword">typedef</span> <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html">gauge::FloatNOrder&lt;char, N, 4, 9, stag, huge_alloc, ghostExchange, use_inphase&gt;</a> <a class="code" href="structquda_1_1gauge__mapper_3_01char_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__9_00_01_n_00_01stag_ccb9fbed9e009d8660b4b9d3e7a9e56b.html#ab3ee29fa036600a684b4245515cee573">type</a>;</div><div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;  };</div><div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> N, QudaStaggeredPhase stag, <span class="keywordtype">bool</span> huge_alloc, QudaGhostExchange ghostExchange, <span class="keywordtype">bool</span> use_inphase&gt;</div><div class="line"><a name="l03115"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__mapper_3_01char_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__8_00_01_n_00_01stag_df8ff27d21ab7fa4e74225ab113828c2.html"> 3115</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structquda_1_1gauge__mapper.html">gauge_mapper</a>&lt;char, <a class="code" href="enum__quda_8h.html#a5cc304be12bc9174274636e1e7863841aad305d7711f78203e925196a6d92bc7b">QUDA_RECONSTRUCT_8</a>, N, stag, huge_alloc, ghostExchange, use_inphase&gt; {</div><div class="line"><a name="l03116"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__mapper_3_01char_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__8_00_01_n_00_01stag_df8ff27d21ab7fa4e74225ab113828c2.html#ad44c829405231609b9053849eb905e42"> 3116</a></span>&#160;    <span class="keyword">typedef</span> <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html">gauge::FloatNOrder&lt;char, N, 4, 8, stag, huge_alloc, ghostExchange, use_inphase&gt;</a> <a class="code" href="structquda_1_1gauge__mapper_3_01char_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__8_00_01_n_00_01stag_df8ff27d21ab7fa4e74225ab113828c2.html#ad44c829405231609b9053849eb905e42">type</a>;</div><div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;  };</div><div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;</div><div class="line"><a name="l03119"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__order__mapper.html"> 3119</a></span>&#160;  <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, QudaGaugeFieldOrder order, <span class="keywordtype">int</span> Nc&gt; <span class="keyword">struct </span><a class="code" href="structquda_1_1gauge__order__mapper.html">gauge_order_mapper</a> { };</div><div class="line"><a name="l03120"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__order__mapper_3_01_t_00_01_q_u_d_a___q_d_p___g_a_u_g_e___o_r_d_e_r_00_01_nc_01_4.html#add59e7e5d9b274d7b03a2f8559ac2a67"> 3120</a></span>&#160;  <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keywordtype">int</span> Nc&gt; <span class="keyword">struct </span><a class="code" href="structquda_1_1gauge__order__mapper.html">gauge_order_mapper</a>&lt;T,<a class="code" href="enum__quda_8h.html#acb61fdc14d6b12e8c6177b6d966bd863a85ce3606ffcab0df5df3e6d2b069edc9">QUDA_QDP_GAUGE_ORDER</a>,Nc&gt; { <span class="keyword">typedef</span> <a class="code" href="structquda_1_1gauge_1_1_q_d_p_order.html">gauge::QDPOrder&lt;T, 2*Nc*Nc&gt;</a> <a class="code" href="structquda_1_1gauge__order__mapper_3_01_t_00_01_q_u_d_a___q_d_p___g_a_u_g_e___o_r_d_e_r_00_01_nc_01_4.html#add59e7e5d9b274d7b03a2f8559ac2a67">type</a>; };</div><div class="line"><a name="l03121"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__order__mapper_3_01_t_00_01_q_u_d_a___q_d_p_j_i_t___g_a_u_g_e___o_r_d_e_r_00_01_nc_01_4.html#ab398e1804330499a578535f2846b4f4f"> 3121</a></span>&#160;  <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keywordtype">int</span> Nc&gt; <span class="keyword">struct </span><a class="code" href="structquda_1_1gauge__order__mapper.html">gauge_order_mapper</a>&lt;T,<a class="code" href="enum__quda_8h.html#acb61fdc14d6b12e8c6177b6d966bd863adee3c71246633d4f99b956adbc59c076">QUDA_QDPJIT_GAUGE_ORDER</a>,Nc&gt; { <span class="keyword">typedef</span> <a class="code" href="structquda_1_1gauge_1_1_q_d_p_j_i_t_order.html">gauge::QDPJITOrder&lt;T, 2*Nc*Nc&gt;</a> <a class="code" href="structquda_1_1gauge__order__mapper_3_01_t_00_01_q_u_d_a___q_d_p_j_i_t___g_a_u_g_e___o_r_d_e_r_00_01_nc_01_4.html#ab398e1804330499a578535f2846b4f4f">type</a>; };</div><div class="line"><a name="l03122"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__order__mapper_3_01_t_00_01_q_u_d_a___m_i_l_c___g_a_u_g_e___o_r_d_e_r_00_01_nc_01_4.html#a21cfb170d60f63fd1ac6f22194cb597f"> 3122</a></span>&#160;  <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keywordtype">int</span> Nc&gt; <span class="keyword">struct </span><a class="code" href="structquda_1_1gauge__order__mapper.html">gauge_order_mapper</a>&lt;T,<a class="code" href="enum__quda_8h.html#acb61fdc14d6b12e8c6177b6d966bd863adb1a4116b2cbd52bd33641d7400f0989">QUDA_MILC_GAUGE_ORDER</a>,Nc&gt; { <span class="keyword">typedef</span> <a class="code" href="structquda_1_1gauge_1_1_m_i_l_c_order.html">gauge::MILCOrder&lt;T, 2*Nc*Nc&gt;</a> <a class="code" href="structquda_1_1gauge__order__mapper_3_01_t_00_01_q_u_d_a___m_i_l_c___g_a_u_g_e___o_r_d_e_r_00_01_nc_01_4.html#a21cfb170d60f63fd1ac6f22194cb597f">type</a>; };</div><div class="line"><a name="l03123"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__order__mapper_3_01_t_00_01_q_u_d_a___b_q_c_d___g_a_u_g_e___o_r_d_e_r_00_01_nc_01_4.html#af29cadaa1a552793c63454c3c5c01d1a"> 3123</a></span>&#160;  <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keywordtype">int</span> Nc&gt; <span class="keyword">struct </span><a class="code" href="structquda_1_1gauge__order__mapper.html">gauge_order_mapper</a>&lt;T,<a class="code" href="enum__quda_8h.html#acb61fdc14d6b12e8c6177b6d966bd863a335830aa4556580bfcf73019615ec35d">QUDA_BQCD_GAUGE_ORDER</a>,Nc&gt; { <span class="keyword">typedef</span> <a class="code" href="structquda_1_1gauge_1_1_b_q_c_d_order.html">gauge::BQCDOrder&lt;T, 2*Nc*Nc&gt;</a> <a class="code" href="structquda_1_1gauge__order__mapper_3_01_t_00_01_q_u_d_a___b_q_c_d___g_a_u_g_e___o_r_d_e_r_00_01_nc_01_4.html#af29cadaa1a552793c63454c3c5c01d1a">type</a>; };</div><div class="line"><a name="l03124"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__order__mapper_3_01_t_00_01_q_u_d_a___t_i_f_r___g_a_u_g_e___o_r_d_e_r_00_01_nc_01_4.html#a50c0e861240ea2e68ea93517d45d104c"> 3124</a></span>&#160;  <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keywordtype">int</span> Nc&gt; <span class="keyword">struct </span><a class="code" href="structquda_1_1gauge__order__mapper.html">gauge_order_mapper</a>&lt;T,<a class="code" href="enum__quda_8h.html#acb61fdc14d6b12e8c6177b6d966bd863a4ba8fd46dcb8d319a6632eebbe2da32b">QUDA_TIFR_GAUGE_ORDER</a>,Nc&gt; { <span class="keyword">typedef</span> <a class="code" href="structquda_1_1gauge_1_1_t_i_f_r_order.html">gauge::TIFROrder&lt;T, 2*Nc*Nc&gt;</a> <a class="code" href="structquda_1_1gauge__order__mapper_3_01_t_00_01_q_u_d_a___t_i_f_r___g_a_u_g_e___o_r_d_e_r_00_01_nc_01_4.html#a50c0e861240ea2e68ea93517d45d104c">type</a>; };</div><div class="line"><a name="l03125"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__order__mapper_3_01_t_00_01_q_u_d_a___t_i_f_r___p_a_d_d_e_d___g_a_u_g_e___o_r_d_e_r_00_01_nc_01_4.html#a69d6b3c692fea1b364b53826d85c7f66"> 3125</a></span>&#160;  <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keywordtype">int</span> Nc&gt; <span class="keyword">struct </span><a class="code" href="structquda_1_1gauge__order__mapper.html">gauge_order_mapper</a>&lt;T,<a class="code" href="enum__quda_8h.html#acb61fdc14d6b12e8c6177b6d966bd863ada452210f42cce91ccd6c4f1d4650576">QUDA_TIFR_PADDED_GAUGE_ORDER</a>,Nc&gt; { <span class="keyword">typedef</span> <a class="code" href="structquda_1_1gauge_1_1_t_i_f_r_padded_order.html">gauge::TIFRPaddedOrder&lt;T, 2*Nc*Nc&gt;</a> <a class="code" href="structquda_1_1gauge__order__mapper_3_01_t_00_01_q_u_d_a___t_i_f_r___p_a_d_d_e_d___g_a_u_g_e___o_r_d_e_r_00_01_nc_01_4.html#a69d6b3c692fea1b364b53826d85c7f66">type</a>; };</div><div class="line"><a name="l03126"></a><span class="lineno"><a class="line" href="structquda_1_1gauge__order__mapper_3_01_t_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e___o_r_d_e_r_00_01_nc_01_4.html#a5de8c462db71c01ba6fb589fa89833c1"> 3126</a></span>&#160;  <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keywordtype">int</span> Nc&gt; <span class="keyword">struct </span><a class="code" href="structquda_1_1gauge__order__mapper.html">gauge_order_mapper</a>&lt;T,<a class="code" href="enum__quda_8h.html#acb61fdc14d6b12e8c6177b6d966bd863a2237dcd2b3bc4294563478199248107c">QUDA_FLOAT2_GAUGE_ORDER</a>,Nc&gt; { <span class="keyword">typedef</span> <a class="code" href="structquda_1_1gauge_1_1_float_n_order.html">gauge::FloatNOrder&lt;T, 2*Nc*Nc, 2, 2*Nc*Nc&gt;</a> <a class="code" href="structquda_1_1gauge__order__mapper_3_01_t_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e___o_r_d_e_r_00_01_nc_01_4.html#a5de8c462db71c01ba6fb589fa89833c1">type</a>; };</div><div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;</div><div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;  <span class="comment">// experiments in reducing template instantation boilerplate</span></div><div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;  <span class="comment">// can this be replaced with a C++11 variant that uses variadic templates?</span></div><div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;</div><div class="line"><a name="l03131"></a><span class="lineno"><a class="line" href="gauge__field__order_8h.html#ae83d10b51cc0100f784e7e08789daafd"> 3131</a></span>&#160;<span class="preprocessor">#define INSTANTIATE_RECONSTRUCT(func, g, ...)       \</span></div><div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;<span class="preprocessor">  {                 \</span></div><div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;<span class="preprocessor">    if (!data.isNative())           \</span></div><div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;<span class="preprocessor">      errorQuda(&quot;Field order %d and precision %d is not native&quot;, g.Order(), g.Precision()); \</span></div><div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;<span class="preprocessor">    if( g.Reconstruct() == QUDA_RECONSTRUCT_NO) {     \</span></div><div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;<span class="preprocessor">      typedef typename gauge_mapper&lt;Float,QUDA_RECONSTRUCT_NO&gt;::type Gauge; \</span></div><div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;<span class="preprocessor">      func(Gauge(g), g, __VA_ARGS__);         \</span></div><div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;<span class="preprocessor">    } else if( g.Reconstruct() == QUDA_RECONSTRUCT_13){     \</span></div><div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;<span class="preprocessor">      typedef typename gauge_mapper&lt;Float,QUDA_RECONSTRUCT_13&gt;::type Gauge; \</span></div><div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;<span class="preprocessor">      func(Gauge(g), g, __VA_ARGS__);         \</span></div><div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;<span class="preprocessor">    } else if( g.Reconstruct() == QUDA_RECONSTRUCT_12){     \</span></div><div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;<span class="preprocessor">      typedef typename gauge_mapper&lt;Float,QUDA_RECONSTRUCT_12&gt;::type Gauge; \</span></div><div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;<span class="preprocessor">      func(Gauge(g), g, __VA_ARGS__);         \</span></div><div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;<span class="preprocessor">    } else if( g.Reconstruct() == QUDA_RECONSTRUCT_9){      \</span></div><div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;<span class="preprocessor">      typedef typename gauge_mapper&lt;Float,QUDA_RECONSTRUCT_9&gt;::type Gauge; \</span></div><div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;<span class="preprocessor">      func(Gauge(g), g, __VA_ARGS__);         \</span></div><div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;<span class="preprocessor">    } else if( g.Reconstruct() == QUDA_RECONSTRUCT_8){      \</span></div><div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;<span class="preprocessor">      typedef typename gauge_mapper&lt;Float,QUDA_RECONSTRUCT_8&gt;::type Gauge; \</span></div><div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;<span class="preprocessor">      func(Gauge(g), g, __VA_ARGS__);         \</span></div><div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;<span class="preprocessor">    } else {                \</span></div><div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;<span class="preprocessor">      errorQuda(&quot;Reconstruction type %d of gauge field not supported&quot;, g.Reconstruct()); \</span></div><div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;<span class="preprocessor">    }                 \</span></div><div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;<span class="preprocessor">  }</span></div><div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;</div><div class="line"><a name="l03155"></a><span class="lineno"><a class="line" href="gauge__field__order_8h.html#ab6adb0234b0543c56a467f7baa75ffcb"> 3155</a></span>&#160;<span class="preprocessor">#define INSTANTIATE_PRECISION(func, lat, ...)       \</span></div><div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;<span class="preprocessor">  {                 \</span></div><div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;<span class="preprocessor">    if (lat.Precision() == QUDA_DOUBLE_PRECISION) {     \</span></div><div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;<span class="preprocessor">      func&lt;double&gt;(lat, __VA_ARGS__);         \</span></div><div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;<span class="preprocessor">    } else if(lat.Precision() == QUDA_SINGLE_PRECISION) {   \</span></div><div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;<span class="preprocessor">      func&lt;float&gt;(lat, __VA_ARGS__);          \</span></div><div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;<span class="preprocessor">    } else {                \</span></div><div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;<span class="preprocessor">      errorQuda(&quot;Precision %d not supported&quot;, lat.Precision());   \</span></div><div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;<span class="preprocessor">    }                 \</span></div><div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;<span class="preprocessor">  }</span></div><div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;</div><div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;} <span class="comment">// namespace quda</span></div><div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;</div><div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;<span class="preprocessor">#endif // _GAUGE_ORDER_H</span></div><div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_3_0111_00_01_float_00_01ghost_exchange___01_4_html_ad7042476e0097187d0c766a6d7e434c8"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct_3_0111_00_01_float_00_01ghost_exchange___01_4.html#ad7042476e0097187d0c766a6d7e434c8">quda::gauge::Reconstruct&lt; 11, Float, ghostExchange_ &gt;::Unpack</a></div><div class="ttdeci">__device__ __host__ void Unpack(complex out[9], const real in[10], int idx, int dir, real phase, const I *X, const int *R) const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01336">gauge_field_order.h:1336</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_e___o_r18e8f8cc0cf320665821408416e0c3d7_html_ae423b3bafd85384c19dcfa5680e59da9"><div class="ttname"><a href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_e___o_r18e8f8cc0cf320665821408416e0c3d7.html#ae423b3bafd85384c19dcfa5680e59da9">quda::gauge::Accessor&lt; Float, nColor, QUDA_QDP_GAUGE_ORDER, storeFloat, use_tex &gt;::u</a></div><div class="ttdeci">complex&lt; storeFloat &gt; * u[QUDA_MAX_GEOMETRY]</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00371">gauge_field_order.h:371</a></div></div>
<div class="ttc" id="structquda_1_1gauge__mapper_3_01double_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__9_00_01_n_00_01stacee8be82bf35cbdd2c9bf0e645d6b117_html_a08abeb4ad02fb5a877406e4b0d14a768"><div class="ttname"><a href="structquda_1_1gauge__mapper_3_01double_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__9_00_01_n_00_01stacee8be82bf35cbdd2c9bf0e645d6b117.html#a08abeb4ad02fb5a877406e4b0d14a768">quda::gauge_mapper&lt; double, QUDA_RECONSTRUCT_9, N, stag, huge_alloc, ghostExchange, use_inphase &gt;::type</a></div><div class="ttdeci">gauge::FloatNOrder&lt; double, N, 2, 9, stag, huge_alloc, ghostExchange, use_inphase &gt; type</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l03034">gauge_field_order.h:3034</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_t_i_f_r_order_html"><div class="ttname"><a href="structquda_1_1gauge_1_1_t_i_f_r_order.html">quda::gauge::TIFROrder</a></div><div class="ttdoc">struct to define TIFR ordered gauge fields: [mu][parity][volumecb][col][row] </div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02744">gauge_field_order.h:2744</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1fieldorder__wrapper_html_af766cd5dca93a9e0d93cb3f98dea3eaa"><div class="ttname"><a href="structquda_1_1gauge_1_1fieldorder__wrapper.html#af766cd5dca93a9e0d93cb3f98dea3eaa">quda::gauge::fieldorder_wrapper::scale</a></div><div class="ttdeci">const Float scale</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00238">gauge_field_order.h:238</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_m_i_l_c_order_html_a8eb9f14f8d065b730af9d4477c87509a"><div class="ttname"><a href="structquda_1_1gauge_1_1_m_i_l_c_order.html#a8eb9f14f8d065b730af9d4477c87509a">quda::gauge::MILCOrder::operator()</a></div><div class="ttdeci">__device__ __host__ gauge_wrapper&lt; real, Accessor &gt; operator()(int dim, int x_cb, int parity)</div><div class="ttdoc">This accessor routine returns a gauge_wrapper to this object, allowing us to overload various operato...</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02388">gauge_field_order.h:2388</a></div></div>
<div class="ttc" id="namespacequda_1_1gauge_html_a6cd40608aabdb9080a2df09bb7c10203"><div class="ttname"><a href="namespacequda_1_1gauge.html#a6cd40608aabdb9080a2df09bb7c10203">quda::gauge::Ncolor</a></div><div class="ttdeci">__host__ __device__ constexpr int Ncolor(int length)</div><div class="ttdoc">Return the number of colors of the accessor based on the length of the field. </div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01674">gauge_field_order.h:1674</a></div></div>
<div class="ttc" id="structquda_1_1gauge__order__mapper_3_01_t_00_01_q_u_d_a___t_i_f_r___g_a_u_g_e___o_r_d_e_r_00_01_nc_01_4_html_a50c0e861240ea2e68ea93517d45d104c"><div class="ttname"><a href="structquda_1_1gauge__order__mapper_3_01_t_00_01_q_u_d_a___t_i_f_r___g_a_u_g_e___o_r_d_e_r_00_01_nc_01_4.html#a50c0e861240ea2e68ea93517d45d104c">quda::gauge_order_mapper&lt; T, QUDA_TIFR_GAUGE_ORDER, Nc &gt;::type</a></div><div class="ttdeci">gauge::TIFROrder&lt; T, 2 *Nc *Nc &gt; type</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l03124">gauge_field_order.h:3124</a></div></div>
<div class="ttc" id="enum__quda_8h_html_a2f13fac18d6933e9e21bc1cf2737b21aa6604eb56d082ee976633d53267f2d019"><div class="ttname"><a href="enum__quda_8h.html#a2f13fac18d6933e9e21bc1cf2737b21aa6604eb56d082ee976633d53267f2d019">QUDA_STAGGERED_PHASE_TIFR</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00492">enum_quda.h:492</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_3_019_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4_html_a9f7714d03a5fe29e567280e2c891ef14"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct_3_019_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a9f7714d03a5fe29e567280e2c891ef14">quda::gauge::Reconstruct&lt; 9, Float, ghostExchange_, stag_phase &gt;::scale</a></div><div class="ttdeci">const real scale</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01590">gauge_field_order.h:1590</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1fieldorder__wrapper_html_af59c2c6b8a0037af11786e1f1c8430e5"><div class="ttname"><a href="structquda_1_1gauge_1_1fieldorder__wrapper.html#af59c2c6b8a0037af11786e1f1c8430e5">quda::gauge::fieldorder_wrapper::operator-</a></div><div class="ttdeci">__device__ __host__ complex&lt; Float &gt; operator-() const</div><div class="ttdoc">negation operator </div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00269">gauge_field_order.h:269</a></div></div>
<div class="ttc" id="namespacequda_1_1gauge_html_a94ec8809009843f4f40299778f0fb92e"><div class="ttname"><a href="namespacequda_1_1gauge.html#a94ec8809009843f4f40299778f0fb92e">quda::gauge::fixed_point&lt; float, short &gt;</a></div><div class="ttdeci">__host__ __device__ constexpr bool fixed_point&lt; float, short &gt;()</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00220">gauge_field_order.h:220</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_legacy_order_html_a6ccfe9eb0a06f632c0edc1c19067fd6e"><div class="ttname"><a href="structquda_1_1gauge_1_1_legacy_order.html#a6ccfe9eb0a06f632c0edc1c19067fd6e">quda::gauge::LegacyOrder::Ghost</a></div><div class="ttdeci">__device__ __host__ gauge_ghost_wrapper&lt; real, Accessor &gt; Ghost(int dim, int ghost_idx, int parity, real phase=1.0)</div><div class="ttdoc">This accessor routine returns a gauge_ghost_wrapper to this object, allowing us to overload various o...</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02123">gauge_field_order.h:2123</a></div></div>
<div class="ttc" id="structquda_1_1gauge__wrapper_html"><div class="ttname"><a href="structquda_1_1gauge__wrapper.html">quda::gauge_wrapper</a></div><div class="ttdoc">gauge_wrapper is an internal class that is used to wrap instances of gauge accessors, currying in a specific location on the field. The operator() accessors in gauge-field accessors return instances to this class, allowing us to then use operator overloading upon this class to interact with the Matrix class. As a result we can include gauge-field accessors directly in Matrix expressions in kernels without having to declare temporaries with explicit calls to the load/save methods in the gauge-field accessors. </div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00044">gauge_field_order.h:44</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g_e___ob3f8ab569f1b01e2fe1b1e99b6b90783_html_a7e01072e90b4eec60c975be1a9d0de3e"><div class="ttname"><a href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g_e___ob3f8ab569f1b01e2fe1b1e99b6b90783.html#a7e01072e90b4eec60c975be1a9d0de3e">quda::gauge::Accessor&lt; Float, nColor, QUDA_MILC_GAUGE_ORDER, storeFloat, use_tex &gt;::operator()</a></div><div class="ttdeci">__device__ __host__ complex&lt; Float &gt; operator()(int d, int parity, int x, int row, int col) const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00549">gauge_field_order.h:549</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_legacy_order_html_a35ce872b61adec2b381d814e12e61dd1"><div class="ttname"><a href="structquda_1_1gauge_1_1_legacy_order.html#a35ce872b61adec2b381d814e12e61dd1">quda::gauge::LegacyOrder::geometry</a></div><div class="ttdeci">const int geometry</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02051">gauge_field_order.h:2051</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g_e___ob3f8ab569f1b01e2fe1b1e99b6b90783_html_aa7ec76754773b64c99fbd087d5c304fd"><div class="ttname"><a href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g_e___ob3f8ab569f1b01e2fe1b1e99b6b90783.html#aa7ec76754773b64c99fbd087d5c304fd">quda::gauge::Accessor&lt; Float, nColor, QUDA_MILC_GAUGE_ORDER, storeFloat, use_tex &gt;::Accessor</a></div><div class="ttdeci">Accessor(const Accessor&lt; Float, nColor, QUDA_MILC_GAUGE_ORDER, storeFloat, use_tex &gt; &amp;a)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00538">gauge_field_order.h:538</a></div></div>
<div class="ttc" id="enum__quda_8h_html_a5cc304be12bc9174274636e1e7863841a41ab3553ef10af8aeb118f39d8f1e935"><div class="ttname"><a href="enum__quda_8h.html#a5cc304be12bc9174274636e1e7863841a41ab3553ef10af8aeb118f39d8f1e935">QUDA_RECONSTRUCT_NO</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00067">enum_quda.h:67</a></div></div>
<div class="ttc" id="fast__intdiv_8h_html"><div class="ttname"><a href="fast__intdiv_8h.html">fast_intdiv.h</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_accessor_html_a4c42d26a22ef886f5a143d73c1ea79d4"><div class="ttname"><a href="structquda_1_1gauge_1_1_accessor.html#a4c42d26a22ef886f5a143d73c1ea79d4">quda::gauge::Accessor::dummy</a></div><div class="ttdeci">complex&lt; Float &gt; dummy</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00343">gauge_field_order.h:343</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g_e___ob3f8ab569f1b01e2fe1b1e99b6b90783_html_a521b20db37d2f59dac308b4fe75deca3"><div class="ttname"><a href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g_e___ob3f8ab569f1b01e2fe1b1e99b6b90783.html#a521b20db37d2f59dac308b4fe75deca3">quda::gauge::Accessor&lt; Float, nColor, QUDA_MILC_GAUGE_ORDER, storeFloat, use_tex &gt;::volumeCB</a></div><div class="ttdeci">const int volumeCB</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00524">gauge_field_order.h:524</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1fieldorder__wrapper_html_a77dfc72683e622e3a257c33156ae4e25"><div class="ttname"><a href="structquda_1_1gauge_1_1fieldorder__wrapper.html#a77dfc72683e622e3a257c33156ae4e25">quda::gauge::fieldorder_wrapper::scale_inv</a></div><div class="ttdeci">const Float scale_inv</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00239">gauge_field_order.h:239</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_legacy_order_html_ac0e52c9b01f85a9c27a6b6c45b69f6d1"><div class="ttname"><a href="structquda_1_1gauge_1_1_legacy_order.html#ac0e52c9b01f85a9c27a6b6c45b69f6d1">quda::gauge::LegacyOrder::ghost</a></div><div class="ttdeci">Float * ghost[QUDA_MAX_DIM]</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02047">gauge_field_order.h:2047</a></div></div>
<div class="ttc" id="structquda_1_1gauge__mapper_3_01short_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__9_00_01_n_00_01stagabe2076f04b407b412e5192d2ba58b59_html_ad49a8df2de4e83a6ba83aacf37aa0440"><div class="ttname"><a href="structquda_1_1gauge__mapper_3_01short_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__9_00_01_n_00_01stagabe2076f04b407b412e5192d2ba58b59.html#ad49a8df2de4e83a6ba83aacf37aa0440">quda::gauge_mapper&lt; short, QUDA_RECONSTRUCT_9, N, stag, huge_alloc, ghostExchange, use_inphase &gt;::type</a></div><div class="ttdeci">gauge::FloatNOrder&lt; short, N, 4, 9, stag, huge_alloc, ghostExchange, use_inphase &gt; type</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l03086">gauge_field_order.h:3086</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_html_a1455561f760b407f46cd1979e13b3ac2"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct.html#a1455561f760b407f46cd1979e13b3ac2">quda::gauge::Reconstruct&lt; reconLenParam, Float, ghostExchange_, stag_phase &gt;::complex</a></div><div class="ttdeci">complex&lt; real &gt; complex</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01127">gauge_field_order.h:1127</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_3_0113_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4_html_a410f3f8876601d193a59e0067d84f1b3"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct_3_0113_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a410f3f8876601d193a59e0067d84f1b3">quda::gauge::Reconstruct&lt; 13, Float, ghostExchange_, stag_phase &gt;::complex</a></div><div class="ttdeci">complex&lt; real &gt; complex</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01364">gauge_field_order.h:1364</a></div></div>
<div class="ttc" id="enum__quda_8h_html_a5cc304be12bc9174274636e1e7863841ac73ec20dcdd9bb298a7615e70b70799d"><div class="ttname"><a href="enum__quda_8h.html#a5cc304be12bc9174274636e1e7863841ac73ec20dcdd9bb298a7615e70b70799d">QUDA_RECONSTRUCT_10</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00072">enum_quda.h:72</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_html_a658db6f00e99c315aa161a00d657bad3"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct.html#a658db6f00e99c315aa161a00d657bad3">quda::gauge::Reconstruct::scale</a></div><div class="ttdeci">real scale</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01128">gauge_field_order.h:1128</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_float_n_order_html_ae9ec6f9486dc6215781f7161e719565a"><div class="ttname"><a href="structquda_1_1gauge_1_1_float_n_order.html#ae9ec6f9486dc6215781f7161e719565a">quda::gauge::FloatNOrder::R</a></div><div class="ttdeci">int R[QUDA_MAX_DIM]</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01714">gauge_field_order.h:1714</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e_0851bfc944ce664513b027bdb1e7938b_html_af7baeb52ee488ad2841aa2f1a0c49ad5"><div class="ttname"><a href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e_0851bfc944ce664513b027bdb1e7938b.html#af7baeb52ee488ad2841aa2f1a0c49ad5">quda::gauge::Accessor&lt; Float, nColor, QUDA_FLOAT2_GAUGE_ORDER, storeFloat, use_tex &gt;::stride</a></div><div class="ttdeci">const int stride</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00691">gauge_field_order.h:691</a></div></div>
<div class="ttc" id="structquda_1_1complex_3_01char_01_4_html"><div class="ttname"><a href="structquda_1_1complex_3_01char_01_4.html">quda::complex&lt; char &gt;</a></div><div class="ttdef"><b>Definition:</b> <a href="complex__quda_8h_source.html#l00710">complex_quda.h:710</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g656a684b71192f463c0c771174ee66f3_html_aaa8f76b78ae50323da4b7022fc3f0a75"><div class="ttname"><a href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g656a684b71192f463c0c771174ee66f3.html#aaa8f76b78ae50323da4b7022fc3f0a75">quda::gauge::GhostAccessor&lt; Float, nColor, QUDA_MILC_GAUGE_ORDER, native_ghost, storeFloat, use_tex &gt;::scale_inv</a></div><div class="ttdeci">Float scale_inv</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00623">gauge_field_order.h:623</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_html_aef8b5d92142fdb20b3b99dcfe90831f8"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct.html#aef8b5d92142fdb20b3b99dcfe90831f8">quda::gauge::Reconstruct&lt; reconLenParam, Float, ghostExchange_, stag_phase &gt;::real</a></div><div class="ttdeci">typename mapper&lt; Float &gt;::type real</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01126">gauge_field_order.h:1126</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_legacy_order_html_a458bc13f94e1d88b4894f3d42adb9bf4"><div class="ttname"><a href="structquda_1_1gauge_1_1_legacy_order.html#a458bc13f94e1d88b4894f3d42adb9bf4">quda::gauge::LegacyOrder::stride</a></div><div class="ttdeci">const int stride</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02050">gauge_field_order.h:2050</a></div></div>
<div class="ttc" id="structquda_1_1gauge__wrapper_html_a953756c13d685eacf355434ee7897a3c"><div class="ttname"><a href="structquda_1_1gauge__wrapper.html#a953756c13d685eacf355434ee7897a3c">quda::gauge_wrapper::phase</a></div><div class="ttdeci">const Float phase</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00048">gauge_field_order.h:48</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_3_019_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4_html_a114b1768bcbbba232517a7f4d280a134"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct_3_019_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a114b1768bcbbba232517a7f4d280a134">quda::gauge::Reconstruct&lt; 9, Float, ghostExchange_, stag_phase &gt;::complex</a></div><div class="ttdeci">complex&lt; real &gt; complex</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01588">gauge_field_order.h:1588</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4_html_a24aa93fcbd23e5af8ac88d46a0e33a5f"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4.html#a24aa93fcbd23e5af8ac88d46a0e33a5f">quda::gauge::Reconstruct&lt; 12, Float, ghostExchange_ &gt;::Unpack</a></div><div class="ttdeci">__device__ __host__ void Unpack(complex out[9], const real in[12], int idx, int dir, real phase, const I *X, const int *R) const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01273">gauge_field_order.h:1273</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_m_i_l_c_site_order_html_a5b00f455cb7b2a93293a47c8371e5778"><div class="ttname"><a href="structquda_1_1gauge_1_1_m_i_l_c_site_order.html#a5b00f455cb7b2a93293a47c8371e5778">quda::gauge::MILCSiteOrder::offset</a></div><div class="ttdeci">const size_t offset</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02433">gauge_field_order.h:2433</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e_0851bfc944ce664513b027bdb1e7938b_html_ae0c33dfb8eeb1db3e84b449237bdd559"><div class="ttname"><a href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e_0851bfc944ce664513b027bdb1e7938b.html#ae0c33dfb8eeb1db3e84b449237bdd559">quda::gauge::Accessor&lt; Float, nColor, QUDA_FLOAT2_GAUGE_ORDER, storeFloat, use_tex &gt;::resetScale</a></div><div class="ttdeci">void resetScale(Float max_)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00725">gauge_field_order.h:725</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4_html_aaf16b582a36be8775c756d8eab4d86f9"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#aaf16b582a36be8775c756d8eab4d86f9">quda::gauge::Reconstruct&lt; 8, Float, ghostExchange_ &gt;::anisotropy</a></div><div class="ttdeci">const complex anisotropy</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01448">gauge_field_order.h:1448</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_q_d_p_j_i_t_order_html_a9353c705ee37eb8e14eaadd99c59e5c9"><div class="ttname"><a href="structquda_1_1gauge_1_1_q_d_p_j_i_t_order.html#a9353c705ee37eb8e14eaadd99c59e5c9">quda::gauge::QDPJITOrder::QDPJITOrder</a></div><div class="ttdeci">QDPJITOrder(const QDPJITOrder &amp;order)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02275">gauge_field_order.h:2275</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_t_i_f_r_order_html_a158c65216bb7cf5b0f7c0fd32239ff71"><div class="ttname"><a href="structquda_1_1gauge_1_1_t_i_f_r_order.html#a158c65216bb7cf5b0f7c0fd32239ff71">quda::gauge::TIFROrder::operator()</a></div><div class="ttdeci">__device__ __host__ const gauge_wrapper&lt; real, Accessor &gt; operator()(int dim, int x_cb, int parity) const</div><div class="ttdoc">This accessor routine returns a const gauge_wrapper to this object, allowing us to overload various o...</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02837">gauge_field_order.h:2837</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_float_n_order_html_a890b07983033a56ad804f247481614fd"><div class="ttname"><a href="structquda_1_1gauge_1_1_float_n_order.html#a890b07983033a56ad804f247481614fd">quda::gauge::FloatNOrder::AllocInt</a></div><div class="ttdeci">AllocType&lt; huge_alloc &gt;::type AllocInt</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01699">gauge_field_order.h:1699</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_q_d_p_j_i_t_order_html"><div class="ttname"><a href="structquda_1_1gauge_1_1_q_d_p_j_i_t_order.html">quda::gauge::QDPJITOrder</a></div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02266">gauge_field_order.h:2266</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_edba98cba7f194488e42e7a830abb1e97_html"><div class="ttname"><a href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_edba98cba7f194488e42e7a830abb1e97.html">quda::gauge::GhostAccessor&lt; Float, nColor, QUDA_QDP_GAUGE_ORDER, native_ghost, storeFloat, use_tex &gt;</a></div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00468">gauge_field_order.h:468</a></div></div>
<div class="ttc" id="namespacequda_html_ac39b1ae3f7dc813ed8f258d3cffbd642"><div class="ttname"><a href="namespacequda.html#ac39b1ae3f7dc813ed8f258d3cffbd642">quda::linkIndex</a></div><div class="ttdeci">static __device__ __host__ int linkIndex(const int x[], const I X[4])</div><div class="ttdef"><b>Definition:</b> <a href="index__helper_8cuh_source.html#l00046">index_helper.cuh:46</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4_html_adaf5b77c6ad29008a19f9992f0839888"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4.html#adaf5b77c6ad29008a19f9992f0839888">quda::gauge::Reconstruct&lt; 12, Float, ghostExchange_ &gt;::real</a></div><div class="ttdeci">typename mapper&lt; Float &gt;::type real</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01231">gauge_field_order.h:1231</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_html_a0eb9b69b6dc8c5498ff6938279ddb8f6"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct.html#a0eb9b69b6dc8c5498ff6938279ddb8f6">quda::gauge::Reconstruct::Reconstruct</a></div><div class="ttdeci">Reconstruct(const Reconstruct&lt; N, Float, ghostExchange_ &gt; &amp;recon)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01131">gauge_field_order.h:1131</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4_html_a5c4d613a4a2667ea27a5115a5cd324bf"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#a5c4d613a4a2667ea27a5115a5cd324bf">quda::gauge::Reconstruct&lt; 8, Float, ghostExchange_ &gt;::Reconstruct</a></div><div class="ttdeci">Reconstruct(const GaugeField &amp;u, real scale=1.0)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01457">gauge_field_order.h:1457</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_t_i_f_r_order_html_a2526585fc94356c5e1b50208206f2047"><div class="ttname"><a href="structquda_1_1gauge_1_1_t_i_f_r_order.html#a2526585fc94356c5e1b50208206f2047">quda::gauge::TIFROrder::TIFROrder</a></div><div class="ttdeci">TIFROrder(const TIFROrder &amp;order)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02762">gauge_field_order.h:2762</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_m_i_l_c_site_order_html_ac1323d48d70f2f3056cb48412baaf066"><div class="ttname"><a href="structquda_1_1gauge_1_1_m_i_l_c_site_order.html#ac1323d48d70f2f3056cb48412baaf066">quda::gauge::MILCSiteOrder::MILCSiteOrder</a></div><div class="ttdeci">MILCSiteOrder(const GaugeField &amp;u, Float *gauge_=0, Float **ghost_=0)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02435">gauge_field_order.h:2435</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1square___3_01_reduce_type_00_01short_01_4_html_a2239341e1135930359e23f18a96ba283"><div class="ttname"><a href="structquda_1_1gauge_1_1square___3_01_reduce_type_00_01short_01_4.html#a2239341e1135930359e23f18a96ba283">quda::gauge::square_&lt; ReduceType, short &gt;::operator()</a></div><div class="ttdeci">__host__ __device__ ReduceType operator()(const quda::complex&lt; short &gt; &amp;x)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00181">gauge_field_order.h:181</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_m_i_l_c_order_html_a4604719c6491c0b88c35b4a5025cb4d8"><div class="ttname"><a href="structquda_1_1gauge_1_1_m_i_l_c_order.html#a4604719c6491c0b88c35b4a5025cb4d8">quda::gauge::MILCOrder::load</a></div><div class="ttdeci">__device__ __host__ void load(complex v[length/2], int x, int dir, int parity, real inphase=1.0) const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02346">gauge_field_order.h:2346</a></div></div>
<div class="ttc" id="structquda_1_1gauge__mapper_3_01char_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__10_00_01_n_00_01stagaef0cb5983acbe36c0f881a37986f4f3_html_af2d0d5d390ca2fcf85cad3dadb58e6aa"><div class="ttname"><a href="structquda_1_1gauge__mapper_3_01char_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__10_00_01_n_00_01stagaef0cb5983acbe36c0f881a37986f4f3.html#af2d0d5d390ca2fcf85cad3dadb58e6aa">quda::gauge_mapper&lt; char, QUDA_RECONSTRUCT_10, N, stag, huge_alloc, ghostExchange, use_inphase &gt;::type</a></div><div class="ttdeci">gauge::FloatNOrder&lt; char, N, 2, 11, stag, huge_alloc, ghostExchange, use_inphase &gt; type</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l03108">gauge_field_order.h:3108</a></div></div>
<div class="ttc" id="structquda_1_1gauge__ghost__wrapper_html_aeb8ff558d06d95d01d3762e83d2d2fd9"><div class="ttname"><a href="structquda_1_1gauge__ghost__wrapper.html#aeb8ff558d06d95d01d3762e83d2d2fd9">quda::gauge_ghost_wrapper::operator=</a></div><div class="ttdeci">__device__ __host__ void operator=(const M &amp;a)</div><div class="ttdoc">Assignment operator with Matrix instance as input. </div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00138">gauge_field_order.h:138</a></div></div>
<div class="ttc" id="namespacequda_html_abeed8b3819eb6b18921f208412fe40d1"><div class="ttname"><a href="namespacequda.html#abeed8b3819eb6b18921f208412fe40d1">quda::norm</a></div><div class="ttdeci">__host__ __device__ ValueType norm(const complex&lt; ValueType &gt; &amp;z)</div><div class="ttdoc">Returns the magnitude of z squared. </div><div class="ttdef"><b>Definition:</b> <a href="complex__quda_8h_source.html#l01092">complex_quda.h:1092</a></div></div>
<div class="ttc" id="namespacequda_1_1gauge_html_afdd600791225065a6dc0d7e76d19f1de"><div class="ttname"><a href="namespacequda_1_1gauge.html#afdd600791225065a6dc0d7e76d19f1de">quda::gauge::default_huge_alloc</a></div><div class="ttdeci">constexpr bool default_huge_alloc</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01677">gauge_field_order.h:1677</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_3_019_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4_html_a8c37b11175aff9796871de376995de10"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct_3_019_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a8c37b11175aff9796871de376995de10">quda::gauge::Reconstruct&lt; 9, Float, ghostExchange_, stag_phase &gt;::Reconstruct</a></div><div class="ttdeci">Reconstruct(const Reconstruct&lt; 9, Float, ghostExchange_, stag_phase &gt; &amp;recon)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01595">gauge_field_order.h:1595</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1fieldorder__wrapper_html_ae04cc4f10549a5e4e8269bfd8ba130ae"><div class="ttname"><a href="structquda_1_1gauge_1_1fieldorder__wrapper.html#ae04cc4f10549a5e4e8269bfd8ba130ae">quda::gauge::fieldorder_wrapper::fieldorder_wrapper</a></div><div class="ttdeci">__device__ __host__ fieldorder_wrapper(complex&lt; storeFloat &gt; *v, int idx, Float scale, Float scale_inv)</div><div class="ttdoc">fieldorder_wrapper constructor </div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00246">gauge_field_order.h:246</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_3_0113_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4_html_a68800abcd68749e8c7b5f71ee7eb09e3"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct_3_0113_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a68800abcd68749e8c7b5f71ee7eb09e3">quda::gauge::Reconstruct&lt; 13, Float, ghostExchange_, stag_phase &gt;::Pack</a></div><div class="ttdeci">__device__ __host__ void Pack(real out[12], const complex in[9], int idx) const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01377">gauge_field_order.h:1377</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_legacy_order_html_ab453ab1743da327fe21750ab43543122"><div class="ttname"><a href="structquda_1_1gauge_1_1_legacy_order.html#ab453ab1743da327fe21750ab43543122">quda::gauge::LegacyOrder::hasPhase</a></div><div class="ttdeci">const int hasPhase</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02052">gauge_field_order.h:2052</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g656a684b71192f463c0c771174ee66f3_html_aabcf0c8430ff9d5e2cee70834c6ccabf"><div class="ttname"><a href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g656a684b71192f463c0c771174ee66f3.html#aabcf0c8430ff9d5e2cee70834c6ccabf">quda::gauge::GhostAccessor&lt; Float, nColor, QUDA_MILC_GAUGE_ORDER, native_ghost, storeFloat, use_tex &gt;::GhostAccessor</a></div><div class="ttdeci">GhostAccessor(const GaugeField &amp;U, void *gauge_=0, void **ghost_=0)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00626">gauge_field_order.h:626</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1fieldorder__wrapper_html"><div class="ttname"><a href="structquda_1_1gauge_1_1fieldorder__wrapper.html">quda::gauge::fieldorder_wrapper</a></div><div class="ttdoc">fieldorder_wrapper is an internal class that is used to wrap instances of FieldOrder accessors...</div><div class="ttdef"><b>Definition:</b> <a href="complex__quda_8h_source.html#l00032">complex_quda.h:32</a></div></div>
<div class="ttc" id="structquda_1_1gauge__wrapper_html_ad2d275ef18602d6c92fadc63a8e5a185"><div class="ttname"><a href="structquda_1_1gauge__wrapper.html#ad2d275ef18602d6c92fadc63a8e5a185">quda::gauge_wrapper::operator=</a></div><div class="ttdeci">__device__ __host__ void operator=(const M &amp;a)</div><div class="ttdoc">Assignment operator with Matrix instance as input. </div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00072">gauge_field_order.h:72</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_m_i_l_c_order_html"><div class="ttname"><a href="structquda_1_1gauge_1_1_m_i_l_c_order.html">quda::gauge::MILCOrder</a></div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02332">gauge_field_order.h:2332</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_q_d_p_order_html_ae68df6b81ac33589eb10744eed4327df"><div class="ttname"><a href="structquda_1_1gauge_1_1_q_d_p_order.html#ae68df6b81ac33589eb10744eed4327df">quda::gauge::QDPOrder::operator()</a></div><div class="ttdeci">__device__ __host__ gauge_wrapper&lt; real, Accessor &gt; operator()(int dim, int x_cb, int parity)</div><div class="ttdoc">This accessor routine returns a gauge_wrapper to this object, allowing us to overload various operato...</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02239">gauge_field_order.h:2239</a></div></div>
<div class="ttc" id="structquda_1_1gauge__mapper_3_01float_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__10_00_01_n_00_01sta55f60513675629526a9d9eb2c7343b53_html_a511f3904458550c3214cfaef01367989"><div class="ttname"><a href="structquda_1_1gauge__mapper_3_01float_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__10_00_01_n_00_01sta55f60513675629526a9d9eb2c7343b53.html#a511f3904458550c3214cfaef01367989">quda::gauge_mapper&lt; float, QUDA_RECONSTRUCT_10, N, stag, huge_alloc, ghostExchange, use_inphase &gt;::type</a></div><div class="ttdeci">gauge::FloatNOrder&lt; float, N, 2, 11, stag, huge_alloc, ghostExchange, use_inphase &gt; type</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l03056">gauge_field_order.h:3056</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_t_i_f_r_padded_order_html_a5e07ba81503bc204f62d35eb90b61c86"><div class="ttname"><a href="structquda_1_1gauge_1_1_t_i_f_r_padded_order.html#a5e07ba81503bc204f62d35eb90b61c86">quda::gauge::TIFRPaddedOrder::save</a></div><div class="ttdeci">__device__ __host__ void save(const complex v[9], int x, int dir, int parity)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02924">gauge_field_order.h:2924</a></div></div>
<div class="ttc" id="namespacequda_1_1gauge_html_a038c45259e95c5426f880805d15b8a4e"><div class="ttname"><a href="namespacequda_1_1gauge.html#a038c45259e95c5426f880805d15b8a4e">quda::gauge::ct_sqrt</a></div><div class="ttdeci">__host__ __device__ constexpr int ct_sqrt(int n, int i=1)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01664">gauge_field_order.h:1664</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_e___o_r18e8f8cc0cf320665821408416e0c3d7_html_a0bed839ec79e5df0dcaeae5186de1d28"><div class="ttname"><a href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_e___o_r18e8f8cc0cf320665821408416e0c3d7.html#a0bed839ec79e5df0dcaeae5186de1d28">quda::gauge::Accessor&lt; Float, nColor, QUDA_QDP_GAUGE_ORDER, storeFloat, use_tex &gt;::resetScale</a></div><div class="ttdeci">void resetScale(Float max)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00395">gauge_field_order.h:395</a></div></div>
<div class="ttc" id="util__quda_8h_html_af3bddfd9d113d50e8e0bbf58a35c5aac"><div class="ttname"><a href="util__quda_8h.html#af3bddfd9d113d50e8e0bbf58a35c5aac">errorQuda</a></div><div class="ttdeci">#define errorQuda(...)</div><div class="ttdef"><b>Definition:</b> <a href="util__quda_8h_source.html#l00121">util_quda.h:121</a></div></div>
<div class="ttc" id="enum__quda_8h_html_acb61fdc14d6b12e8c6177b6d966bd863a335830aa4556580bfcf73019615ec35d"><div class="ttname"><a href="enum__quda_8h.html#acb61fdc14d6b12e8c6177b6d966bd863a335830aa4556580bfcf73019615ec35d">QUDA_BQCD_GAUGE_ORDER</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00046">enum_quda.h:46</a></div></div>
<div class="ttc" id="structquda_1_1gauge__mapper_3_01double_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__12_00_01_n_00_01st2bfe0c646d280c0cfa115a9c40ec25b6_html_aa4594e7f4d649b2ac896f7522da3b7dd"><div class="ttname"><a href="structquda_1_1gauge__mapper_3_01double_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__12_00_01_n_00_01st2bfe0c646d280c0cfa115a9c40ec25b6.html#aa4594e7f4d649b2ac896f7522da3b7dd">quda::gauge_mapper&lt; double, QUDA_RECONSTRUCT_12, N, stag, huge_alloc, ghostExchange, use_inphase &gt;::type</a></div><div class="ttdeci">gauge::FloatNOrder&lt; double, N, 2, 12, stag, huge_alloc, ghostExchange, use_inphase &gt; type</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l03026">gauge_field_order.h:3026</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_t_i_f_r_order_html_aebd7eabf1359306f94aec71c4353de30"><div class="ttname"><a href="structquda_1_1gauge_1_1_t_i_f_r_order.html#aebd7eabf1359306f94aec71c4353de30">quda::gauge::TIFROrder::save</a></div><div class="ttdeci">__device__ __host__ void save(const complex v[9], int x, int dir, int parity)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02789">gauge_field_order.h:2789</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_2b6e6ca5a27266b35ef9c885a15f8294_html_a62bad3e25ca71736baf41f1c95da7220"><div class="ttname"><a href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_2b6e6ca5a27266b35ef9c885a15f8294.html#a62bad3e25ca71736baf41f1c95da7220">quda::gauge::GhostAccessor&lt; Float, nColor, QUDA_FLOAT2_GAUGE_ORDER, native_ghost, storeFloat, use_tex &gt;::GhostAccessor</a></div><div class="ttdeci">GhostAccessor(const GhostAccessor&lt; Float, nColor, QUDA_FLOAT2_GAUGE_ORDER, native_ghost, storeFloat, use_tex &gt; &amp;a)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00840">gauge_field_order.h:840</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_t_i_f_r_order_html_af50107c14b42f7566d404ca771f4202a"><div class="ttname"><a href="structquda_1_1gauge_1_1_t_i_f_r_order.html#af50107c14b42f7566d404ca771f4202a">quda::gauge::TIFROrder::load</a></div><div class="ttdeci">__device__ __host__ void load(complex v[9], int x, int dir, int parity, real inphase=1.0) const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02773">gauge_field_order.h:2773</a></div></div>
<div class="ttc" id="enum__quda_8h_html_a35de1312d8bed4b94234a3092907e0d9a184379764fab0f101cab6f19a8a14690"><div class="ttname"><a href="enum__quda_8h.html#a35de1312d8bed4b94234a3092907e0d9a184379764fab0f101cab6f19a8a14690">QUDA_CUDA_FIELD_LOCATION</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00326">enum_quda.h:326</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_float_n_order_html_adce9f5c005c8887b53cf967836ee98b3"><div class="ttname"><a href="structquda_1_1gauge_1_1_float_n_order.html#adce9f5c005c8887b53cf967836ee98b3">quda::gauge::FloatNOrder::load</a></div><div class="ttdeci">void load()</div><div class="ttdoc">Restore the field from the host after tuning. </div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02017">gauge_field_order.h:2017</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4_html"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4.html">quda::gauge::Reconstruct&lt; 12, Float, ghostExchange_ &gt;</a></div><div class="ttdoc">Gauge reconstruct 12 helper where we reconstruct the third row from the cross product of the first tw...</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01230">gauge_field_order.h:1230</a></div></div>
<div class="ttc" id="malloc__quda_8h_html_ad733cb3f6cac705c8db7b0afad9b3843"><div class="ttname"><a href="malloc__quda_8h.html#ad733cb3f6cac705c8db7b0afad9b3843">host_free</a></div><div class="ttdeci">#define host_free(ptr)</div><div class="ttdef"><b>Definition:</b> <a href="malloc__quda_8h_source.html#l00071">malloc_quda.h:71</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_float_n_order_html_a3d100f3dfe5d8f8c84ce9fe115765896"><div class="ttname"><a href="structquda_1_1gauge_1_1_float_n_order.html#a3d100f3dfe5d8f8c84ce9fe115765896">quda::gauge::FloatNOrder::real</a></div><div class="ttdeci">typename mapper&lt; Float &gt;::type real</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01696">gauge_field_order.h:1696</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_field_order_html_a83413a86b675367b641675963eace5ab"><div class="ttname"><a href="structquda_1_1gauge_1_1_field_order.html#a83413a86b675367b641675963eace5ab">quda::gauge::FieldOrder::abs_max</a></div><div class="ttdeci">__host__ double abs_max(int dim=-1, bool global=true) const</div><div class="ttdoc">Returns the Linfinity norm of the field in a given dimension. </div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01093">gauge_field_order.h:1093</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1square___html"><div class="ttname"><a href="structquda_1_1gauge_1_1square__.html">quda::gauge::square_</a></div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00165">gauge_field_order.h:165</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1fieldorder__wrapper_html_a80e4b9bd0e7e0ef31ffcc64797bf763d"><div class="ttname"><a href="structquda_1_1gauge_1_1fieldorder__wrapper.html#a80e4b9bd0e7e0ef31ffcc64797bf763d">quda::gauge::fieldorder_wrapper::v</a></div><div class="ttdeci">complex&lt; storeFloat &gt; * v</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00236">gauge_field_order.h:236</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_t_i_f_r_order_html_a83584126da49a6d7d94bf1bb24ab23a1"><div class="ttname"><a href="structquda_1_1gauge_1_1_t_i_f_r_order.html#a83584126da49a6d7d94bf1bb24ab23a1">quda::gauge::TIFROrder::scale_inv</a></div><div class="ttdeci">const real scale_inv</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02752">gauge_field_order.h:2752</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_c_p_s_order_html_a1a5516dfff3e1eda0f0e525c3a26a141"><div class="ttname"><a href="structquda_1_1gauge_1_1_c_p_s_order.html#a1a5516dfff3e1eda0f0e525c3a26a141">quda::gauge::CPSOrder::Bytes</a></div><div class="ttdeci">size_t Bytes() const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02632">gauge_field_order.h:2632</a></div></div>
<div class="ttc" id="enum__quda_8h_html_acb61fdc14d6b12e8c6177b6d966bd863a85ce3606ffcab0df5df3e6d2b069edc9"><div class="ttname"><a href="enum__quda_8h.html#acb61fdc14d6b12e8c6177b6d966bd863a85ce3606ffcab0df5df3e6d2b069edc9">QUDA_QDP_GAUGE_ORDER</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00041">enum_quda.h:41</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_t_i_f_r_padded_order_html_aa1d83701348258431dadc24336da7f27"><div class="ttname"><a href="structquda_1_1gauge_1_1_t_i_f_r_padded_order.html#aa1d83701348258431dadc24336da7f27">quda::gauge::TIFRPaddedOrder::scale</a></div><div class="ttdeci">const real scale</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02857">gauge_field_order.h:2857</a></div></div>
<div class="ttc" id="namespacequda_html_a3f32b5e8a1310c9f74c174f543591e3b"><div class="ttname"><a href="namespacequda.html#a3f32b5e8a1310c9f74c174f543591e3b">quda::cmac</a></div><div class="ttdeci">__host__ __device__ complex&lt; real &gt; cmac(const complex&lt; real &gt; &amp;x, const complex&lt; real &gt; &amp;y, const complex&lt; real &gt; &amp;z)</div><div class="ttdef"><b>Definition:</b> <a href="complex__quda_8h_source.html#l01372">complex_quda.h:1372</a></div></div>
<div class="ttc" id="comm__quda_8h_html_ab6471b31d5a7f3f80e6561382c09b3b5"><div class="ttname"><a href="comm__quda_8h.html#ab6471b31d5a7f3f80e6561382c09b3b5">comm_dim</a></div><div class="ttdeci">int comm_dim(int dim)</div><div class="ttdef"><b>Definition:</b> <a href="comm__common_8cpp_source.html#l00424">comm_common.cpp:424</a></div></div>
<div class="ttc" id="structquda_1_1gauge__mapper_3_01short_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__10_00_01_n_00_01sta8caa40d035ba517fbb13224e7576f08e_html_a34d5f6dd4d77c99f568f22e31c56a4e1"><div class="ttname"><a href="structquda_1_1gauge__mapper_3_01short_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__10_00_01_n_00_01sta8caa40d035ba517fbb13224e7576f08e.html#a34d5f6dd4d77c99f568f22e31c56a4e1">quda::gauge_mapper&lt; short, QUDA_RECONSTRUCT_10, N, stag, huge_alloc, ghostExchange, use_inphase &gt;::type</a></div><div class="ttdeci">gauge::FloatNOrder&lt; short, N, 2, 11, stag, huge_alloc, ghostExchange, use_inphase &gt; type</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l03082">gauge_field_order.h:3082</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_float_n_order_html_a99a439936285a7bf1b2110df9ab0fe7e"><div class="ttname"><a href="structquda_1_1gauge_1_1_float_n_order.html#a99a439936285a7bf1b2110df9ab0fe7e">quda::gauge::FloatNOrder::complex</a></div><div class="ttdeci">complex&lt; real &gt; complex</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01697">gauge_field_order.h:1697</a></div></div>
<div class="ttc" id="structquda_1_1gauge__mapper_3_01double_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__10_00_01_n_00_01st54aa8efa4151999eaeb3ea09a969f5cf_html_a7592ce36c3c2bff845b6120a3406294f"><div class="ttname"><a href="structquda_1_1gauge__mapper_3_01double_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__10_00_01_n_00_01st54aa8efa4151999eaeb3ea09a969f5cf.html#a7592ce36c3c2bff845b6120a3406294f">quda::gauge_mapper&lt; double, QUDA_RECONSTRUCT_10, N, stag, huge_alloc, ghostExchange, use_inphase &gt;::type</a></div><div class="ttdeci">gauge::FloatNOrder&lt; double, N, 2, 11, stag, huge_alloc, ghostExchange, use_inphase &gt; type</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l03030">gauge_field_order.h:3030</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g_e___ob3f8ab569f1b01e2fe1b1e99b6b90783_html_a8a271c728386ed3761fd5fbcab95f1af"><div class="ttname"><a href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g_e___ob3f8ab569f1b01e2fe1b1e99b6b90783.html#a8a271c728386ed3761fd5fbcab95f1af">quda::gauge::Accessor&lt; Float, nColor, QUDA_MILC_GAUGE_ORDER, storeFloat, use_tex &gt;::scale_inv</a></div><div class="ttdeci">Float scale_inv</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00527">gauge_field_order.h:527</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_c_p_s_order_html_ae23a5c9fde124fcf8cef192e02edd21d"><div class="ttname"><a href="structquda_1_1gauge_1_1_c_p_s_order.html#ae23a5c9fde124fcf8cef192e02edd21d">quda::gauge::CPSOrder::load</a></div><div class="ttdeci">__device__ __host__ void load(complex v[9], int x, int dir, int parity, Float inphase=1.0) const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02563">gauge_field_order.h:2563</a></div></div>
<div class="ttc" id="namespacequda_html_a4fae7f819003f6b7116efc43e7830908"><div class="ttname"><a href="namespacequda.html#a4fae7f819003f6b7116efc43e7830908">quda::alloc</a></div><div class="ttdeci">static std::map&lt; void *, MemAlloc &gt; alloc[N_ALLOC_TYPE]</div><div class="ttdef"><b>Definition:</b> <a href="malloc_8cpp_source.html#l00053">malloc.cpp:53</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4_html_a5bbd537170aa21cafcada1c9fbf5fae8"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4.html#a5bbd537170aa21cafcada1c9fbf5fae8">quda::gauge::Reconstruct&lt; 12, Float, ghostExchange_ &gt;::lastTimeSliceBound</a></div><div class="ttdeci">const int lastTimeSliceBound</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01236">gauge_field_order.h:1236</a></div></div>
<div class="ttc" id="enum__quda_8h_html_acb61fdc14d6b12e8c6177b6d966bd863a2237dcd2b3bc4294563478199248107c"><div class="ttname"><a href="enum__quda_8h.html#acb61fdc14d6b12e8c6177b6d966bd863a2237dcd2b3bc4294563478199248107c">QUDA_FLOAT2_GAUGE_ORDER</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00039">enum_quda.h:39</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_t_i_f_r_padded_order_html"><div class="ttname"><a href="structquda_1_1gauge_1_1_t_i_f_r_padded_order.html">quda::gauge::TIFRPaddedOrder</a></div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02849">gauge_field_order.h:2849</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_t_i_f_r_padded_order_html_abfc31dd03863633b5ebf2b33479a832f"><div class="ttname"><a href="structquda_1_1gauge_1_1_t_i_f_r_padded_order.html#abfc31dd03863633b5ebf2b33479a832f">quda::gauge::TIFRPaddedOrder::scale_inv</a></div><div class="ttdeci">const real scale_inv</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02858">gauge_field_order.h:2858</a></div></div>
<div class="ttc" id="namespacequda_1_1gauge_html_a4850cc93d92c64fa56c2d2baaac537fe"><div class="ttname"><a href="namespacequda_1_1gauge.html#a4850cc93d92c64fa56c2d2baaac537fe">quda::gauge::timeBoundary</a></div><div class="ttdeci">__device__ __host__ T timeBoundary(int idx, const I X[QUDA_MAX_DIM], const int R[QUDA_MAX_DIM], T tBoundary, T scale, int firstTimeSliceBound, int lastTimeSliceBound, bool isFirstTimeSlice, bool isLastTimeSlice, QudaGhostExchange ghostExchange=QUDA_GHOST_EXCHANGE_NO)</div><div class="ttdoc">timeBoundary Compute boundary condition correction </div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01179">gauge_field_order.h:1179</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e_0851bfc944ce664513b027bdb1e7938b_html_acfe2d7943e3074672e6e370240e56a45"><div class="ttname"><a href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e_0851bfc944ce664513b027bdb1e7938b.html#acfe2d7943e3074672e6e370240e56a45">quda::gauge::Accessor&lt; Float, nColor, QUDA_FLOAT2_GAUGE_ORDER, storeFloat, use_tex &gt;::max</a></div><div class="ttdeci">Float max</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00693">gauge_field_order.h:693</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_3_019_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4_html_a19763f4184aaa85654d70e5eabcc15d7"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct_3_019_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a19763f4184aaa85654d70e5eabcc15d7">quda::gauge::Reconstruct&lt; 9, Float, ghostExchange_, stag_phase &gt;::Reconstruct</a></div><div class="ttdeci">Reconstruct(const GaugeField &amp;u)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01593">gauge_field_order.h:1593</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e_0851bfc944ce664513b027bdb1e7938b_html_a91a34bb6d9ae7d7a58cfd8573fcc4bf6"><div class="ttname"><a href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e_0851bfc944ce664513b027bdb1e7938b.html#a91a34bb6d9ae7d7a58cfd8573fcc4bf6">quda::gauge::Accessor&lt; Float, nColor, QUDA_FLOAT2_GAUGE_ORDER, storeFloat, use_tex &gt;::u</a></div><div class="ttdeci">complex&lt; storeFloat &gt; * u</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00684">gauge_field_order.h:684</a></div></div>
<div class="ttc" id="covdev__test_8cpp_html_a788da19b1cbae7d08eb18da226046dd7"><div class="ttname"><a href="covdev__test_8cpp.html#a788da19b1cbae7d08eb18da226046dd7">tmp</a></div><div class="ttdeci">cudaColorSpinorField * tmp</div><div class="ttdef"><b>Definition:</b> <a href="covdev__test_8cpp_source.html#l00044">covdev_test.cpp:44</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_3_019_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4_html_a7f4cd25f3c0fdb0cf2518906bfb73fbe"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct_3_019_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a7f4cd25f3c0fdb0cf2518906bfb73fbe">quda::gauge::Reconstruct&lt; 9, Float, ghostExchange_, stag_phase &gt;::scale_inv</a></div><div class="ttdeci">const real scale_inv</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01591">gauge_field_order.h:1591</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1square___html_a761453dc4a7f75f0aed655a6be79aa58"><div class="ttname"><a href="structquda_1_1gauge_1_1square__.html#a761453dc4a7f75f0aed655a6be79aa58">quda::gauge::square_::square_</a></div><div class="ttdeci">square_(ReduceType scale)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00166">gauge_field_order.h:166</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_field_order_html_abb2dfbedd15829dffe365d5251fb507b"><div class="ttname"><a href="structquda_1_1gauge_1_1_field_order.html#abb2dfbedd15829dffe365d5251fb507b">quda::gauge::FieldOrder::operator()</a></div><div class="ttdeci">__device__ __host__ complex&lt; Float &gt; operator()(int d, int parity, int x, int row, int col) const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00941">gauge_field_order.h:941</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_e___o_r18e8f8cc0cf320665821408416e0c3d7_html_a839bdd1a61f7e61aea7c23098ce22ce0"><div class="ttname"><a href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_e___o_r18e8f8cc0cf320665821408416e0c3d7.html#a839bdd1a61f7e61aea7c23098ce22ce0">quda::gauge::Accessor&lt; Float, nColor, QUDA_QDP_GAUGE_ORDER, storeFloat, use_tex &gt;::operator()</a></div><div class="ttdeci">__device__ __host__ fieldorder_wrapper&lt; Float, storeFloat &gt; operator()(int d, int parity, int x, int row, int col)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00413">gauge_field_order.h:413</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_c_p_s_order_html"><div class="ttname"><a href="structquda_1_1gauge_1_1_c_p_s_order.html">quda::gauge::CPSOrder</a></div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02531">gauge_field_order.h:2531</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1abs___3_01_float_00_01int_01_4_html_a72aacc1d254044a9811ffafc70d3b701"><div class="ttname"><a href="structquda_1_1gauge_1_1abs___3_01_float_00_01int_01_4.html#a72aacc1d254044a9811ffafc70d3b701">quda::gauge::abs_&lt; Float, int &gt;::scale</a></div><div class="ttdeci">Float scale</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00212">gauge_field_order.h:212</a></div></div>
<div class="ttc" id="classquda_1_1_lattice_field_html_ae8c8678bb923db27c8ea985546101f11"><div class="ttname"><a href="classquda_1_1_lattice_field.html#ae8c8678bb923db27c8ea985546101f11">quda::LatticeField::Scale</a></div><div class="ttdeci">double Scale() const</div><div class="ttdef"><b>Definition:</b> <a href="lattice__field_8h_source.html#l00556">lattice_field.h:556</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_2b6e6ca5a27266b35ef9c885a15f8294_html_a07e86bdf085a8936fcc74e7c9b538641"><div class="ttname"><a href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_2b6e6ca5a27266b35ef9c885a15f8294.html#a07e86bdf085a8936fcc74e7c9b538641">quda::gauge::GhostAccessor&lt; Float, nColor, QUDA_FLOAT2_GAUGE_ORDER, native_ghost, storeFloat, use_tex &gt;::ghostVolumeCB</a></div><div class="ttdeci">int ghostVolumeCB[8]</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00820">gauge_field_order.h:820</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_m_i_l_c_order_html_a0232c529388721f1f657f5dc6bc381db"><div class="ttname"><a href="structquda_1_1gauge_1_1_m_i_l_c_order.html#a0232c529388721f1f657f5dc6bc381db">quda::gauge::MILCOrder::Bytes</a></div><div class="ttdeci">size_t Bytes() const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02408">gauge_field_order.h:2408</a></div></div>
<div class="ttc" id="structquda_1_1complex_3_01char_01_4_html_a611a70ec9a63a1e1d708737dd4525c0b"><div class="ttname"><a href="structquda_1_1complex_3_01char_01_4.html#a611a70ec9a63a1e1d708737dd4525c0b">quda::complex&lt; char &gt;::real</a></div><div class="ttdeci">__host__ __device__ char real() const volatile</div><div class="ttdef"><b>Definition:</b> <a href="complex__quda_8h_source.html#l00739">complex_quda.h:739</a></div></div>
<div class="ttc" id="structquda_1_1gauge__mapper_3_01float_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__12_00_01_n_00_01sta5e02132e1241a1ab0101213ce6b322bd_html_ae172719e4c3eb5015dbf485274477841"><div class="ttname"><a href="structquda_1_1gauge__mapper_3_01float_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__12_00_01_n_00_01sta5e02132e1241a1ab0101213ce6b322bd.html#ae172719e4c3eb5015dbf485274477841">quda::gauge_mapper&lt; float, QUDA_RECONSTRUCT_12, N, stag, huge_alloc, ghostExchange, use_inphase &gt;::type</a></div><div class="ttdeci">gauge::FloatNOrder&lt; float, N, 4, 12, stag, huge_alloc, ghostExchange, use_inphase &gt; type</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l03052">gauge_field_order.h:3052</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_3_0111_00_01_float_00_01ghost_exchange___01_4_html"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct_3_0111_00_01_float_00_01ghost_exchange___01_4.html">quda::gauge::Reconstruct&lt; 11, Float, ghostExchange_ &gt;</a></div><div class="ttdoc">Gauge reconstruct helper for Momentum field with 10 packed elements (really 9 from the Lie algebra...</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01313">gauge_field_order.h:1313</a></div></div>
<div class="ttc" id="structquda_1_1gauge__mapper_3_01float_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__13_00_01_n_00_01stae3dc473a15d610b6b48c11919a62343a_html_a3a33edf551ab6ab7e7b7eabd57a21484"><div class="ttname"><a href="structquda_1_1gauge__mapper_3_01float_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__13_00_01_n_00_01stae3dc473a15d610b6b48c11919a62343a.html#a3a33edf551ab6ab7e7b7eabd57a21484">quda::gauge_mapper&lt; float, QUDA_RECONSTRUCT_13, N, stag, huge_alloc, ghostExchange, use_inphase &gt;::type</a></div><div class="ttdeci">gauge::FloatNOrder&lt; float, N, 4, 13, stag, huge_alloc, ghostExchange, use_inphase &gt; type</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l03048">gauge_field_order.h:3048</a></div></div>
<div class="ttc" id="comm__quda_8h_html_a6c081bfedfe939a19ca8acd025864f14"><div class="ttname"><a href="comm__quda_8h.html#a6c081bfedfe939a19ca8acd025864f14">comm_coord</a></div><div class="ttdeci">int comm_coord(int dim)</div><div class="ttdef"><b>Definition:</b> <a href="comm__common_8cpp_source.html#l00431">comm_common.cpp:431</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1square___3_01_reduce_type_00_01char_01_4_html_a12d95fbdf5375799d69ec3e926908ca3"><div class="ttname"><a href="structquda_1_1gauge_1_1square___3_01_reduce_type_00_01char_01_4.html#a12d95fbdf5375799d69ec3e926908ca3">quda::gauge::square_&lt; ReduceType, char &gt;::square_</a></div><div class="ttdeci">square_(const ReduceType scale)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00173">gauge_field_order.h:173</a></div></div>
<div class="ttc" id="structquda_1_1complex_3_01double_01_4_html_a95cf9854a2323a37af7785ee78a2c196"><div class="ttname"><a href="structquda_1_1complex_3_01double_01_4.html#a95cf9854a2323a37af7785ee78a2c196">quda::complex&lt; double &gt;::complex</a></div><div class="ttdeci">__host__ __device__ complex()</div><div class="ttdef"><b>Definition:</b> <a href="complex__quda_8h_source.html#l00585">complex_quda.h:585</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_html_aaeef88dac7ab5b2f30e0b552fab560aa"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct.html#aaeef88dac7ab5b2f30e0b552fab560aa">quda::gauge::Reconstruct::Reconstruct</a></div><div class="ttdeci">Reconstruct(const GaugeField &amp;u)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01130">gauge_field_order.h:1130</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_c_p_s_order_html_a789e7bafff767fd5fbc8c10968470743"><div class="ttname"><a href="structquda_1_1gauge_1_1_c_p_s_order.html#a789e7bafff767fd5fbc8c10968470743">quda::gauge::CPSOrder::real</a></div><div class="ttdeci">typename mapper&lt; Float &gt;::type real</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02533">gauge_field_order.h:2533</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_float_n_order_html_a169c7c3f99436173404f592fadd0e2fa"><div class="ttname"><a href="structquda_1_1gauge_1_1_float_n_order.html#a169c7c3f99436173404f592fadd0e2fa">quda::gauge::FloatNOrder::X</a></div><div class="ttdeci">int_fastdiv X[QUDA_MAX_DIM]</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01713">gauge_field_order.h:1713</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_q_d_p_order_html_a62d4b6ce4ce456edfd3f4ab1e761af98"><div class="ttname"><a href="structquda_1_1gauge_1_1_q_d_p_order.html#a62d4b6ce4ce456edfd3f4ab1e761af98">quda::gauge::QDPOrder::save</a></div><div class="ttdeci">__device__ __host__ void save(const complex v[length/2], int x, int dir, int parity)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02209">gauge_field_order.h:2209</a></div></div>
<div class="ttc" id="namespacequda_html_abf5b4d5728021e058d90ff1d07446399"><div class="ttname"><a href="namespacequda.html#abf5b4d5728021e058d90ff1d07446399">quda::copy</a></div><div class="ttdeci">__host__ __device__ void copy(T1 &amp;a, const T2 &amp;b)</div><div class="ttdef"><b>Definition:</b> <a href="register__traits_8h_source.html#l00152">register_traits.h:152</a></div></div>
<div class="ttc" id="structquda_1_1gauge__order__mapper_html"><div class="ttname"><a href="structquda_1_1gauge__order__mapper.html">quda::gauge_order_mapper</a></div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l03119">gauge_field_order.h:3119</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_legacy_order_html_a995a26bcee0938da5b912caf26346540"><div class="ttname"><a href="structquda_1_1gauge_1_1_legacy_order.html#a995a26bcee0938da5b912caf26346540">quda::gauge::LegacyOrder::LegacyOrder</a></div><div class="ttdeci">LegacyOrder(const LegacyOrder &amp;order)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02069">gauge_field_order.h:2069</a></div></div>
<div class="ttc" id="structquda_1_1gauge__ghost__wrapper_html_a34d1df05b6647252d6c455d6b06ebd32"><div class="ttname"><a href="structquda_1_1gauge__ghost__wrapper.html#a34d1df05b6647252d6c455d6b06ebd32">quda::gauge_ghost_wrapper::ghost_idx</a></div><div class="ttdeci">const int ghost_idx</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00111">gauge_field_order.h:111</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_float_n_order_html_a29c2a84e83a0b2c211d1b65a59635268"><div class="ttname"><a href="structquda_1_1gauge_1_1_float_n_order.html#a29c2a84e83a0b2c211d1b65a59635268">quda::gauge::FloatNOrder::reconstruct</a></div><div class="ttdeci">Reconstruct&lt; reconLenParam, Float, ghostExchange_, stag_phase &gt; reconstruct</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01700">gauge_field_order.h:1700</a></div></div>
<div class="ttc" id="interface__quda_8cpp_html_a67b63ae29fb23d1a034f9ba7e0787745"><div class="ttname"><a href="interface__quda_8cpp.html#a67b63ae29fb23d1a034f9ba7e0787745">R</a></div><div class="ttdeci">static int R[4]</div><div class="ttdef"><b>Definition:</b> <a href="interface__quda_8cpp_source.html#l00084">interface_quda.cpp:84</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1abs___3_01_float_00_01int_01_4_html_a7d8a83f222b5f1defe3e4fe4136f800d"><div class="ttname"><a href="structquda_1_1gauge_1_1abs___3_01_float_00_01int_01_4.html#a7d8a83f222b5f1defe3e4fe4136f800d">quda::gauge::abs_&lt; Float, int &gt;::abs_</a></div><div class="ttdeci">abs_(const Float scale)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00213">gauge_field_order.h:213</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_edba98cba7f194488e42e7a830abb1e97_html_a661f0d4b02e6019c16bd9688c891093a"><div class="ttname"><a href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_edba98cba7f194488e42e7a830abb1e97.html#a661f0d4b02e6019c16bd9688c891093a">quda::gauge::GhostAccessor&lt; Float, nColor, QUDA_QDP_GAUGE_ORDER, native_ghost, storeFloat, use_tex &gt;::scale</a></div><div class="ttdeci">Float scale</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00471">gauge_field_order.h:471</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_edba98cba7f194488e42e7a830abb1e97_html_aea9c6d1e9305972703e7e871a0fded1c"><div class="ttname"><a href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_edba98cba7f194488e42e7a830abb1e97.html#aea9c6d1e9305972703e7e871a0fded1c">quda::gauge::GhostAccessor&lt; Float, nColor, QUDA_QDP_GAUGE_ORDER, native_ghost, storeFloat, use_tex &gt;::operator()</a></div><div class="ttdeci">__device__ __host__ fieldorder_wrapper&lt; Float, storeFloat &gt; operator()(int d, int parity, int x, int row, int col)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00516">gauge_field_order.h:516</a></div></div>
<div class="ttc" id="deflated__invert__test_8cpp_html_a2e99a9d1409689109095858dc2912d40"><div class="ttname"><a href="deflated__invert__test_8cpp.html#a2e99a9d1409689109095858dc2912d40">anisotropy</a></div><div class="ttdeci">double anisotropy</div><div class="ttdef"><b>Definition:</b> <a href="test__util_8cpp_source.html#l01650">test_util.cpp:1650</a></div></div>
<div class="ttc" id="classquda_1_1_lattice_field_html_a64969b1180e27da1fdbc1959f1cf644c"><div class="ttname"><a href="classquda_1_1_lattice_field.html#a64969b1180e27da1fdbc1959f1cf644c">quda::LatticeField::SurfaceCB</a></div><div class="ttdeci">const int * SurfaceCB() const</div><div class="ttdef"><b>Definition:</b> <a href="lattice__field_8h_source.html#l00515">lattice_field.h:515</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e_0851bfc944ce664513b027bdb1e7938b_html_ad08b3dd0c38cc7b44b1e2cde177c7d92"><div class="ttname"><a href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e_0851bfc944ce664513b027bdb1e7938b.html#ad08b3dd0c38cc7b44b1e2cde177c7d92">quda::gauge::Accessor&lt; Float, nColor, QUDA_FLOAT2_GAUGE_ORDER, storeFloat, use_tex &gt;::atomic_add</a></div><div class="ttdeci">__device__ __host__ void atomic_add(int dim, int parity, int x_cb, int row, int col, const complex&lt; theirFloat &gt; &amp;val) const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00762">gauge_field_order.h:762</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g656a684b71192f463c0c771174ee66f3_html_a43aaf4defc7b9e2a0689129c84055bff"><div class="ttname"><a href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g656a684b71192f463c0c771174ee66f3.html#a43aaf4defc7b9e2a0689129c84055bff">quda::gauge::GhostAccessor&lt; Float, nColor, QUDA_MILC_GAUGE_ORDER, native_ghost, storeFloat, use_tex &gt;::ghostOffset</a></div><div class="ttdeci">int ghostOffset[8]</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00621">gauge_field_order.h:621</a></div></div>
<div class="ttc" id="classquda_1_1_gauge_field_html_a02bc76f698126cbaa08301110983f779"><div class="ttname"><a href="classquda_1_1_gauge_field.html#a02bc76f698126cbaa08301110983f779">quda::GaugeField::Geometry</a></div><div class="ttdeci">QudaFieldGeometry Geometry() const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field_8h_source.html#l00258">gauge_field.h:258</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_float_n_order_html_a69d904539395a0d212b117d2b73f6ff3"><div class="ttname"><a href="structquda_1_1gauge_1_1_float_n_order.html#a69d904539395a0d212b117d2b73f6ff3">quda::gauge::FloatNOrder::Bytes</a></div><div class="ttdeci">size_t Bytes() const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02024">gauge_field_order.h:2024</a></div></div>
<div class="ttc" id="enum__quda_8h_html_acb61fdc14d6b12e8c6177b6d966bd863ada452210f42cce91ccd6c4f1d4650576"><div class="ttname"><a href="enum__quda_8h.html#acb61fdc14d6b12e8c6177b6d966bd863ada452210f42cce91ccd6c4f1d4650576">QUDA_TIFR_PADDED_GAUGE_ORDER</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00048">enum_quda.h:48</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1fieldorder__wrapper_html_a8b1a346c52f0b0eab22992b0dfda491d"><div class="ttname"><a href="structquda_1_1gauge_1_1fieldorder__wrapper.html#a8b1a346c52f0b0eab22992b0dfda491d">quda::gauge::fieldorder_wrapper::operator-=</a></div><div class="ttdeci">__device__ __host__ void operator-=(const complex&lt; theirFloat &gt; &amp;a)</div><div class="ttdoc">Operator-= with complex number instance as input. </div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00312">gauge_field_order.h:312</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_field_order_html_a405b741ae30e7425881735616a32718b"><div class="ttname"><a href="structquda_1_1gauge_1_1_field_order.html#a405b741ae30e7425881735616a32718b">quda::gauge::FieldOrder::accessor</a></div><div class="ttdeci">Accessor&lt; Float, nColor, order, storeFloat, use_tex &gt; accessor</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00905">gauge_field_order.h:905</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e_0851bfc944ce664513b027bdb1e7938b_html_a06c4536e37aaedc49201fa6f276c3406"><div class="ttname"><a href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e_0851bfc944ce664513b027bdb1e7938b.html#a06c4536e37aaedc49201fa6f276c3406">quda::gauge::Accessor&lt; Float, nColor, QUDA_FLOAT2_GAUGE_ORDER, storeFloat, use_tex &gt;::volumeCB</a></div><div class="ttdeci">const int volumeCB</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00690">gauge_field_order.h:690</a></div></div>
<div class="ttc" id="classint__fastdiv_html"><div class="ttname"><a href="classint__fastdiv.html">int_fastdiv</a></div><div class="ttdef"><b>Definition:</b> <a href="fast__intdiv_8h_source.html#l00020">fast_intdiv.h:20</a></div></div>
<div class="ttc" id="structquda_1_1gauge__order__mapper_3_01_t_00_01_q_u_d_a___b_q_c_d___g_a_u_g_e___o_r_d_e_r_00_01_nc_01_4_html_af29cadaa1a552793c63454c3c5c01d1a"><div class="ttname"><a href="structquda_1_1gauge__order__mapper_3_01_t_00_01_q_u_d_a___b_q_c_d___g_a_u_g_e___o_r_d_e_r_00_01_nc_01_4.html#af29cadaa1a552793c63454c3c5c01d1a">quda::gauge_order_mapper&lt; T, QUDA_BQCD_GAUGE_ORDER, Nc &gt;::type</a></div><div class="ttdeci">gauge::BQCDOrder&lt; T, 2 *Nc *Nc &gt; type</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l03123">gauge_field_order.h:3123</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g656a684b71192f463c0c771174ee66f3_html_ab687ad590c4ab8683651c664ba21424d"><div class="ttname"><a href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g656a684b71192f463c0c771174ee66f3.html#ab687ad590c4ab8683651c664ba21424d">quda::gauge::GhostAccessor&lt; Float, nColor, QUDA_MILC_GAUGE_ORDER, native_ghost, storeFloat, use_tex &gt;::GhostAccessor</a></div><div class="ttdeci">GhostAccessor(const GhostAccessor&lt; Float, nColor, QUDA_MILC_GAUGE_ORDER, native_ghost, storeFloat, use_tex &gt; &amp;a)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00642">gauge_field_order.h:642</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1abs___3_01_float_00_01short_01_4_html_aa1666115f8b7b7b91005a15c2f4b27a9"><div class="ttname"><a href="structquda_1_1gauge_1_1abs___3_01_float_00_01short_01_4.html#aa1666115f8b7b7b91005a15c2f4b27a9">quda::gauge::abs_&lt; Float, short &gt;::abs_</a></div><div class="ttdeci">abs_(const Float scale)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00206">gauge_field_order.h:206</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_t_i_f_r_order_html_ad9f1f4950dfebf99b297edb4ac8e1928"><div class="ttname"><a href="structquda_1_1gauge_1_1_t_i_f_r_order.html#ad9f1f4950dfebf99b297edb4ac8e1928">quda::gauge::TIFROrder::volumeCB</a></div><div class="ttdeci">const int volumeCB</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02749">gauge_field_order.h:2749</a></div></div>
<div class="ttc" id="structquda_1_1complex_3_01short_01_4_html"><div class="ttname"><a href="structquda_1_1complex_3_01short_01_4.html">quda::complex&lt; short &gt;</a></div><div class="ttdef"><b>Definition:</b> <a href="complex__quda_8h_source.html#l00757">complex_quda.h:757</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_t_i_f_r_padded_order_html_a96bfa8ddb8ba93d86b1861b62d595305"><div class="ttname"><a href="structquda_1_1gauge_1_1_t_i_f_r_padded_order.html#a96bfa8ddb8ba93d86b1861b62d595305">quda::gauge::TIFRPaddedOrder::Bytes</a></div><div class="ttdeci">size_t Bytes() const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02979">gauge_field_order.h:2979</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_legacy_order_html_a999a9379f1421034c388eb760c7e9a1d"><div class="ttname"><a href="structquda_1_1gauge_1_1_legacy_order.html#a999a9379f1421034c388eb760c7e9a1d">quda::gauge::LegacyOrder::volumeCB</a></div><div class="ttdeci">const int volumeCB</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02049">gauge_field_order.h:2049</a></div></div>
<div class="ttc" id="gauge__force__test_8cpp_html_a2bcd2adde36b870d02897e694ecc39cb"><div class="ttname"><a href="gauge__force__test_8cpp.html#a2bcd2adde36b870d02897e694ecc39cb">length</a></div><div class="ttdeci">int length[]</div><div class="ttdef"><b>Definition:</b> <a href="gauge__force__test_8cpp_source.html#l00034">gauge_force_test.cpp:34</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_t_i_f_r_order_html_af97113dce0c18319c65d15feb69d1043"><div class="ttname"><a href="structquda_1_1gauge_1_1_t_i_f_r_order.html#af97113dce0c18319c65d15feb69d1043">quda::gauge::TIFROrder::gauge</a></div><div class="ttdeci">Float * gauge</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02748">gauge_field_order.h:2748</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e_0851bfc944ce664513b027bdb1e7938b_html_a9fd0a0611ee431918f6ac1dffe887d79"><div class="ttname"><a href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e_0851bfc944ce664513b027bdb1e7938b.html#a9fd0a0611ee431918f6ac1dffe887d79">quda::gauge::Accessor&lt; Float, nColor, QUDA_FLOAT2_GAUGE_ORDER, storeFloat, use_tex &gt;::scale</a></div><div class="ttdeci">Float scale</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00694">gauge_field_order.h:694</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_2b6e6ca5a27266b35ef9c885a15f8294_html_a8c2fa31b68cbbc1243d9b4db358604b7"><div class="ttname"><a href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_2b6e6ca5a27266b35ef9c885a15f8294.html#a8c2fa31b68cbbc1243d9b4db358604b7">quda::gauge::GhostAccessor&lt; Float, nColor, QUDA_FLOAT2_GAUGE_ORDER, native_ghost, storeFloat, use_tex &gt;::accessor</a></div><div class="ttdeci">Accessor&lt; Float, nColor, QUDA_FLOAT2_GAUGE_ORDER, storeFloat, use_tex &gt; accessor</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00824">gauge_field_order.h:824</a></div></div>
<div class="ttc" id="texture__helper_8cuh_html"><div class="ttname"><a href="texture__helper_8cuh.html">texture_helper.cuh</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1fieldorder__wrapper_html_a1abe5792511bb445f8dcbe5d44be31ca"><div class="ttname"><a href="structquda_1_1gauge_1_1fieldorder__wrapper.html#a1abe5792511bb445f8dcbe5d44be31ca">quda::gauge::fieldorder_wrapper::operator=</a></div><div class="ttdeci">__device__ __host__ void operator=(const fieldorder_wrapper&lt; Float, storeFloat &gt; &amp;a)</div><div class="ttdoc">Assignment operator with fieldorder_wrapper instance as input. </div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00277">gauge_field_order.h:277</a></div></div>
<div class="ttc" id="structquda_1_1gauge__mapper_3_01double_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__13_00_01_n_00_01st9f47b01002957aa79e1ec780785ef084_html_aa160a315dadd1812fdc507c9b96d6bb9"><div class="ttname"><a href="structquda_1_1gauge__mapper_3_01double_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__13_00_01_n_00_01st9f47b01002957aa79e1ec780785ef084.html#aa160a315dadd1812fdc507c9b96d6bb9">quda::gauge_mapper&lt; double, QUDA_RECONSTRUCT_13, N, stag, huge_alloc, ghostExchange, use_inphase &gt;::type</a></div><div class="ttdeci">gauge::FloatNOrder&lt; double, N, 2, 13, stag, huge_alloc, ghostExchange, use_inphase &gt; type</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l03022">gauge_field_order.h:3022</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_e___o_r18e8f8cc0cf320665821408416e0c3d7_html_a5dd933c7020bcd49fdf36120c76d660c"><div class="ttname"><a href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_e___o_r18e8f8cc0cf320665821408416e0c3d7.html#a5dd933c7020bcd49fdf36120c76d660c">quda::gauge::Accessor&lt; Float, nColor, QUDA_QDP_GAUGE_ORDER, storeFloat, use_tex &gt;::transform_reduce</a></div><div class="ttdeci">__host__ double transform_reduce(QudaFieldLocation location, int dim, helper h, reducer r, double init) const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00446">gauge_field_order.h:446</a></div></div>
<div class="ttc" id="structquda_1_1gauge__ghost__wrapper_html_a97783cef31f79df168ca1f9a99f4d370"><div class="ttname"><a href="structquda_1_1gauge__ghost__wrapper.html#a97783cef31f79df168ca1f9a99f4d370">quda::gauge_ghost_wrapper::gauge</a></div><div class="ttdeci">T &amp; gauge</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00114">gauge_field_order.h:114</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_legacy_order_html_aba01a90167560e681244d0d09d7da92f"><div class="ttname"><a href="structquda_1_1gauge_1_1_legacy_order.html#aba01a90167560e681244d0d09d7da92f">quda::gauge::LegacyOrder::loadGhost</a></div><div class="ttdeci">__device__ __host__ void loadGhost(complex v[length/2], int x, int dir, int parity, real phase=1.0) const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02081">gauge_field_order.h:2081</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_b_q_c_d_order_html_a00a6c08a81a3599d18dbaead6f86377a"><div class="ttname"><a href="structquda_1_1gauge_1_1_b_q_c_d_order.html#a00a6c08a81a3599d18dbaead6f86377a">quda::gauge::BQCDOrder::operator()</a></div><div class="ttdeci">__device__ __host__ gauge_wrapper&lt; real, Accessor &gt; operator()(int dim, int x_cb, int parity)</div><div class="ttdoc">This accessor routine returns a gauge_wrapper to this object, allowing us to overload various operato...</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02717">gauge_field_order.h:2717</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4_html_ad4f244f8bd486b6b6f843d2c74b85a81"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#ad4f244f8bd486b6b6f843d2c74b85a81">quda::gauge::Reconstruct&lt; 8, Float, ghostExchange_ &gt;::Unpack</a></div><div class="ttdeci">__device__ __host__ void Unpack(complex out[9], const real in[8], int idx, int dir, real phase, const I *X, const int *R, const complex scale=complex(static_cast&lt; real &gt;(1.0), static_cast&lt; real &gt;(1.0))) const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01564">gauge_field_order.h:1564</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_q_d_p_order_html_a20da02f53f384094cd538c4a91712634"><div class="ttname"><a href="structquda_1_1gauge_1_1_q_d_p_order.html#a20da02f53f384094cd538c4a91712634">quda::gauge::QDPOrder::QDPOrder</a></div><div class="ttdeci">QDPOrder(const QDPOrder &amp;order)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02193">gauge_field_order.h:2193</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g_e___ob3f8ab569f1b01e2fe1b1e99b6b90783_html_a469557fb123e53adce7567f90e916b69"><div class="ttname"><a href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g_e___ob3f8ab569f1b01e2fe1b1e99b6b90783.html#a469557fb123e53adce7567f90e916b69">quda::gauge::Accessor&lt; Float, nColor, QUDA_MILC_GAUGE_ORDER, storeFloat, use_tex &gt;::Accessor</a></div><div class="ttdeci">Accessor(const GaugeField &amp;U, void *gauge_=0, void **ghost_=0)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00530">gauge_field_order.h:530</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4_html_a65004de43d6ffb3c5449966151df0ac8"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4.html#a65004de43d6ffb3c5449966151df0ac8">quda::gauge::Reconstruct&lt; 12, Float, ghostExchange_ &gt;::isLastTimeSlice</a></div><div class="ttdeci">const bool isLastTimeSlice</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01238">gauge_field_order.h:1238</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_q_d_p_j_i_t_order_html_a583cfa66426cb2ad385c44a4f2227c80"><div class="ttname"><a href="structquda_1_1gauge_1_1_q_d_p_j_i_t_order.html#a583cfa66426cb2ad385c44a4f2227c80">quda::gauge::QDPJITOrder::operator()</a></div><div class="ttdeci">__device__ __host__ gauge_wrapper&lt; real, Accessor &gt; operator()(int dim, int x_cb, int parity)</div><div class="ttdoc">This accessor routine returns a gauge_wrapper to this object, allowing us to overload various operato...</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02305">gauge_field_order.h:2305</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_accessor_html_a4dc9e7058ca2c7f87a2ac1f2612140e3"><div class="ttname"><a href="structquda_1_1gauge_1_1_accessor.html#a4dc9e7058ca2c7f87a2ac1f2612140e3">quda::gauge::Accessor::Accessor</a></div><div class="ttdeci">Accessor(const GaugeField &amp;, void *gauge_=0, void **ghost_=0)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00344">gauge_field_order.h:344</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g656a684b71192f463c0c771174ee66f3_html_a343d8e01c6800c5620def6ce0c5a1551"><div class="ttname"><a href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g656a684b71192f463c0c771174ee66f3.html#a343d8e01c6800c5620def6ce0c5a1551">quda::gauge::GhostAccessor&lt; Float, nColor, QUDA_MILC_GAUGE_ORDER, native_ghost, storeFloat, use_tex &gt;::ghost</a></div><div class="ttdeci">complex&lt; storeFloat &gt; * ghost[8]</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00620">gauge_field_order.h:620</a></div></div>
<div class="ttc" id="structquda_1_1gauge__mapper_3_01float_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t___n_o_00_01_n_00_01sc628be7b5877881a73471ebcaf78cddc_html_a52aaa248ab213dda6e135b4763b1decb"><div class="ttname"><a href="structquda_1_1gauge__mapper_3_01float_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t___n_o_00_01_n_00_01sc628be7b5877881a73471ebcaf78cddc.html#a52aaa248ab213dda6e135b4763b1decb">quda::gauge_mapper&lt; float, QUDA_RECONSTRUCT_NO, N, stag, huge_alloc, ghostExchange, use_inphase &gt;::type</a></div><div class="ttdeci">gauge::FloatNOrder&lt; float, N, 2, N, stag, huge_alloc, ghostExchange, use_inphase &gt; type</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l03044">gauge_field_order.h:3044</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_t_i_f_r_order_html_add3ec1c96159cbb8aa9855d2b41858bb"><div class="ttname"><a href="structquda_1_1gauge_1_1_t_i_f_r_order.html#add3ec1c96159cbb8aa9855d2b41858bb">quda::gauge::TIFROrder::operator()</a></div><div class="ttdeci">__device__ __host__ gauge_wrapper&lt; real, Accessor &gt; operator()(int dim, int x_cb, int parity)</div><div class="ttdoc">This accessor routine returns a gauge_wrapper to this object, allowing us to overload various operato...</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02822">gauge_field_order.h:2822</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_edba98cba7f194488e42e7a830abb1e97_html_a07febabba6f47da6d1d9cc70b8cd86a0"><div class="ttname"><a href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_edba98cba7f194488e42e7a830abb1e97.html#a07febabba6f47da6d1d9cc70b8cd86a0">quda::gauge::GhostAccessor&lt; Float, nColor, QUDA_QDP_GAUGE_ORDER, native_ghost, storeFloat, use_tex &gt;::GhostAccessor</a></div><div class="ttdeci">GhostAccessor(const GhostAccessor&lt; Float, nColor, QUDA_QDP_GAUGE_ORDER, native_ghost, storeFloat, use_tex &gt; &amp;a)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00491">gauge_field_order.h:491</a></div></div>
<div class="ttc" id="classquda_1_1_matrix_html_a663ab9ae31395811a443268c9bd24654"><div class="ttname"><a href="classquda_1_1_matrix.html#a663ab9ae31395811a443268c9bd24654">quda::Matrix::operator=</a></div><div class="ttdeci">__device__ __host__ void operator=(const Matrix&lt; U, N &gt; &amp;b)</div><div class="ttdef"><b>Definition:</b> <a href="quda__matrix_8h_source.html#l00121">quda_matrix.h:121</a></div></div>
<div class="ttc" id="namespacequda_html"><div class="ttname"><a href="namespacequda.html">quda</a></div><div class="ttdef"><b>Definition:</b> <a href="blas__cublas_8h_source.html#l00005">blas_cublas.h:5</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_s_html"><div class="ttname"><a href="structquda_1_1clover_1_1_s.html">quda::clover::S</a></div><div class="ttdoc">This is just a dummy structure we use for trove to define the required structure size. </div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00794">clover_field_order.h:794</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_legacy_order_html_a2493fde8fb5407c76f393ce6d4fea448"><div class="ttname"><a href="structquda_1_1gauge_1_1_legacy_order.html#a2493fde8fb5407c76f393ce6d4fea448">quda::gauge::LegacyOrder::complex</a></div><div class="ttdeci">complex&lt; real &gt; complex</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02046">gauge_field_order.h:2046</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_s_html_a8d0ce83e52bd4168a439e1338d0b00be"><div class="ttname"><a href="structquda_1_1gauge_1_1_s.html#a8d0ce83e52bd4168a439e1338d0b00be">quda::gauge::S::operator[]</a></div><div class="ttdeci">__host__ __device__ const real &amp; operator[](int i) const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02035">gauge_field_order.h:2035</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g_e___ob3f8ab569f1b01e2fe1b1e99b6b90783_html_ab0638d3207a827964ae3cb4d0459e094"><div class="ttname"><a href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g_e___ob3f8ab569f1b01e2fe1b1e99b6b90783.html#ab0638d3207a827964ae3cb4d0459e094">quda::gauge::Accessor&lt; Float, nColor, QUDA_MILC_GAUGE_ORDER, storeFloat, use_tex &gt;::u</a></div><div class="ttdeci">complex&lt; storeFloat &gt; * u</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00523">gauge_field_order.h:523</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_3_019_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4_html_ae4aba10c3926fe52bca15c7e12899dea"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct_3_019_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#ae4aba10c3926fe52bca15c7e12899dea">quda::gauge::Reconstruct&lt; 9, Float, ghostExchange_, stag_phase &gt;::reconstruct_8</a></div><div class="ttdeci">const Reconstruct&lt; 8, Float, ghostExchange_ &gt; reconstruct_8</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01589">gauge_field_order.h:1589</a></div></div>
<div class="ttc" id="thrust__helper_8cuh_html"><div class="ttname"><a href="thrust__helper_8cuh.html">thrust_helper.cuh</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g_e___ob3f8ab569f1b01e2fe1b1e99b6b90783_html_a119ab6f6efb84fe00ea783d0865a6d45"><div class="ttname"><a href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g_e___ob3f8ab569f1b01e2fe1b1e99b6b90783.html#a119ab6f6efb84fe00ea783d0865a6d45">quda::gauge::Accessor&lt; Float, nColor, QUDA_MILC_GAUGE_ORDER, storeFloat, use_tex &gt;::resetScale</a></div><div class="ttdeci">void resetScale(Float max)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00542">gauge_field_order.h:542</a></div></div>
<div class="ttc" id="classquda_1_1_gauge_field_html_a8e0ae774c1566179db3e3c5a2bc0b226"><div class="ttname"><a href="classquda_1_1_gauge_field.html#a8e0ae774c1566179db3e3c5a2bc0b226">quda::GaugeField::Nface</a></div><div class="ttdeci">int Nface() const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field_8h_source.html#l00281">gauge_field.h:281</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_q_d_p_order_html_a168d11efaa373f4d5ac00716c311e732"><div class="ttname"><a href="structquda_1_1gauge_1_1_q_d_p_order.html#a168d11efaa373f4d5ac00716c311e732">quda::gauge::QDPOrder::volumeCB</a></div><div class="ttdeci">const int volumeCB</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02189">gauge_field_order.h:2189</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4_html_ae5bb0c1f7d00259ed7d72b29e58d3920"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4.html#ae5bb0c1f7d00259ed7d72b29e58d3920">quda::gauge::Reconstruct&lt; 12, Float, ghostExchange_ &gt;::Reconstruct</a></div><div class="ttdeci">Reconstruct(const Reconstruct&lt; 12, Float, ghostExchange_ &gt; &amp;recon)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01252">gauge_field_order.h:1252</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_float_n_order_html_a20638e3041484f5fcc28faf84ab56f8d"><div class="ttname"><a href="structquda_1_1gauge_1_1_float_n_order.html#a20638e3041484f5fcc28faf84ab56f8d">quda::gauge::FloatNOrder::backup_h</a></div><div class="ttdeci">void * backup_h</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01720">gauge_field_order.h:1720</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1fieldorder__wrapper_html_a81bd1662dab72a1ce85d34653ff9d391"><div class="ttname"><a href="structquda_1_1gauge_1_1fieldorder__wrapper.html#a81bd1662dab72a1ce85d34653ff9d391">quda::gauge::fieldorder_wrapper::operator+=</a></div><div class="ttdeci">__device__ __host__ void operator+=(const complex&lt; theirFloat &gt; &amp;a)</div><div class="ttdoc">Operator+= with complex number instance as input. </div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00299">gauge_field_order.h:299</a></div></div>
<div class="ttc" id="namespacequda_1_1gauge_html_a455f7c20cd5e809a8e782da36affe7e8"><div class="ttname"><a href="namespacequda_1_1gauge.html#a455f7c20cd5e809a8e782da36affe7e8">quda::gauge::match&lt; short, short &gt;</a></div><div class="ttdeci">__host__ __device__ constexpr bool match&lt; short, short &gt;()</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00225">gauge_field_order.h:225</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_e___o_r18e8f8cc0cf320665821408416e0c3d7_html_a191d03a97ee50649e83ce1719fb0c078"><div class="ttname"><a href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_e___o_r18e8f8cc0cf320665821408416e0c3d7.html#a191d03a97ee50649e83ce1719fb0c078">quda::gauge::Accessor&lt; Float, nColor, QUDA_QDP_GAUGE_ORDER, storeFloat, use_tex &gt;::Accessor</a></div><div class="ttdeci">Accessor(const GaugeField &amp;U, void *gauge_=0, void **ghost_=0)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00379">gauge_field_order.h:379</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1abs___3_01_float_00_01char_01_4_html_aa2fd82400e0d70ac88a2e6a33384f352"><div class="ttname"><a href="structquda_1_1gauge_1_1abs___3_01_float_00_01char_01_4.html#aa2fd82400e0d70ac88a2e6a33384f352">quda::gauge::abs_&lt; Float, char &gt;::abs_</a></div><div class="ttdeci">abs_(const Float scale)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00199">gauge_field_order.h:199</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_2b6e6ca5a27266b35ef9c885a15f8294_html_ad71603c5408da6df03363a8728086737"><div class="ttname"><a href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_2b6e6ca5a27266b35ef9c885a15f8294.html#ad71603c5408da6df03363a8728086737">quda::gauge::GhostAccessor&lt; Float, nColor, QUDA_FLOAT2_GAUGE_ORDER, native_ghost, storeFloat, use_tex &gt;::operator()</a></div><div class="ttdeci">__device__ __host__ fieldorder_wrapper&lt; Float, storeFloat &gt; operator()(int d, int parity, int x_cb, int row, int col)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00871">gauge_field_order.h:871</a></div></div>
<div class="ttc" id="structquda_1_1_tex_vector_type_html"><div class="ttname"><a href="structquda_1_1_tex_vector_type.html">quda::TexVectorType</a></div><div class="ttdef"><b>Definition:</b> <a href="register__traits_8h_source.html#l00390">register_traits.h:390</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_m_i_l_c_site_order_html"><div class="ttname"><a href="structquda_1_1gauge_1_1_m_i_l_c_site_order.html">quda::gauge::MILCSiteOrder</a></div><div class="ttdoc">struct to define gauge fields packed into an opaque MILC site struct: </div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02426">gauge_field_order.h:2426</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g_e___ob3f8ab569f1b01e2fe1b1e99b6b90783_html_a21448ccb9031637f542cb95583247978"><div class="ttname"><a href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g_e___ob3f8ab569f1b01e2fe1b1e99b6b90783.html#a21448ccb9031637f542cb95583247978">quda::gauge::Accessor&lt; Float, nColor, QUDA_MILC_GAUGE_ORDER, storeFloat, use_tex &gt;::scale</a></div><div class="ttdeci">Float scale</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00526">gauge_field_order.h:526</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_float_n_order_html_a5dc7d06b470d4f9da02036ccae2bb714"><div class="ttname"><a href="structquda_1_1gauge_1_1_float_n_order.html#a5dc7d06b470d4f9da02036ccae2bb714">quda::gauge::FloatNOrder::ghostExchange</a></div><div class="ttdeci">QudaGhostExchange ghostExchange</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01711">gauge_field_order.h:1711</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_2b6e6ca5a27266b35ef9c885a15f8294_html_afcb587f9dfcfcadb559e817a0c42e5d1"><div class="ttname"><a href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_2b6e6ca5a27266b35ef9c885a15f8294.html#afcb587f9dfcfcadb559e817a0c42e5d1">quda::gauge::GhostAccessor&lt; Float, nColor, QUDA_FLOAT2_GAUGE_ORDER, native_ghost, storeFloat, use_tex &gt;::GhostAccessor</a></div><div class="ttdeci">GhostAccessor(const GaugeField &amp;U, void *gauge_, void **ghost_=0)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00826">gauge_field_order.h:826</a></div></div>
<div class="ttc" id="atomic_8cuh_html_a5723b0bba0d65bedce0e1bb329366d8c"><div class="ttname"><a href="atomic_8cuh.html#a5723b0bba0d65bedce0e1bb329366d8c">atomicAdd</a></div><div class="ttdeci">static __device__ double2 atomicAdd(double2 *addr, double2 val)</div><div class="ttdoc">Implementation of double2 atomic addition using two double-precision additions. </div><div class="ttdef"><b>Definition:</b> <a href="atomic_8cuh_source.html#l00051">atomic.cuh:51</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_field_order_html_a7240f324d6e16b49a91087647afd5f67"><div class="ttname"><a href="structquda_1_1gauge_1_1_field_order.html#a7240f324d6e16b49a91087647afd5f67">quda::gauge::FieldOrder::FieldOrder</a></div><div class="ttdeci">FieldOrder(GaugeField &amp;U, void *gauge_=0, void **ghost_=0)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00912">gauge_field_order.h:912</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_field_order_html"><div class="ttname"><a href="structquda_1_1gauge_1_1_field_order.html">quda::gauge::FieldOrder</a></div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00896">gauge_field_order.h:896</a></div></div>
<div class="ttc" id="classquda_1_1_gauge_field_html_ab655802370bde3461711f30a2da68bb7"><div class="ttname"><a href="classquda_1_1_gauge_field.html#ab655802370bde3461711f30a2da68bb7">quda::GaugeField::Ncolor</a></div><div class="ttdeci">int Ncolor() const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field_8h_source.html#l00249">gauge_field.h:249</a></div></div>
<div class="ttc" id="enum__quda_8h_html_a5cc304be12bc9174274636e1e7863841af1832705631a3fa4a26b9de29d1e4e70"><div class="ttname"><a href="enum__quda_8h.html#a5cc304be12bc9174274636e1e7863841af1832705631a3fa4a26b9de29d1e4e70">QUDA_RECONSTRUCT_9</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00070">enum_quda.h:70</a></div></div>
<div class="ttc" id="classquda_1_1_lattice_field_html_a96eccffaa1381a45cd03db7bdc4af2f1"><div class="ttname"><a href="classquda_1_1_lattice_field.html#a96eccffaa1381a45cd03db7bdc4af2f1">quda::LatticeField::R</a></div><div class="ttdeci">const int * R() const</div><div class="ttdef"><b>Definition:</b> <a href="lattice__field_8h_source.html#l00536">lattice_field.h:536</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_float_n_order_html_a3133394862f8eb24dfc412c588eb55ad"><div class="ttname"><a href="structquda_1_1gauge_1_1_float_n_order.html#a3133394862f8eb24dfc412c588eb55ad">quda::gauge::FloatNOrder::geometry</a></div><div class="ttdeci">const int geometry</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01718">gauge_field_order.h:1718</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_m_i_l_c_site_order_html_ab821ae99dac5dea429783a9bea629356"><div class="ttname"><a href="structquda_1_1gauge_1_1_m_i_l_c_site_order.html#ab821ae99dac5dea429783a9bea629356">quda::gauge::MILCSiteOrder::gauge</a></div><div class="ttdeci">Float * gauge</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02430">gauge_field_order.h:2430</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_b_q_c_d_order_html_ab29db910f2804102a95f51d8ac6c3378"><div class="ttname"><a href="structquda_1_1gauge_1_1_b_q_c_d_order.html#ab29db910f2804102a95f51d8ac6c3378">quda::gauge::BQCDOrder::BQCDOrder</a></div><div class="ttdeci">BQCDOrder(const GaugeField &amp;u, Float *gauge_=0, Float **ghost_=0)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02650">gauge_field_order.h:2650</a></div></div>
<div class="ttc" id="enum__quda_8h_html_a93131cceecad27ce4b964cb184e8d47aa31e2396004ebee77471a7efacb6cde4e"><div class="ttname"><a href="enum__quda_8h.html#a93131cceecad27ce4b964cb184e8d47aa31e2396004ebee77471a7efacb6cde4e">QUDA_GHOST_EXCHANGE_EXTENDED</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00484">enum_quda.h:484</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_m_i_l_c_order_html_a01cba00cb5cc6fa0bb7588950b96f18d"><div class="ttname"><a href="structquda_1_1gauge_1_1_m_i_l_c_order.html#a01cba00cb5cc6fa0bb7588950b96f18d">quda::gauge::MILCOrder::MILCOrder</a></div><div class="ttdeci">MILCOrder(const MILCOrder &amp;order)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02342">gauge_field_order.h:2342</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_float_n_order_html_a126e265e8de53c8164f399d9d5df2832"><div class="ttname"><a href="structquda_1_1gauge_1_1_float_n_order.html#a126e265e8de53c8164f399d9d5df2832">quda::gauge::FloatNOrder::saveGhost</a></div><div class="ttdeci">__device__ __host__ void saveGhost(const complex v[length/2], int x, int dir, int parity)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01894">gauge_field_order.h:1894</a></div></div>
<div class="ttc" id="structquda_1_1gauge__mapper_3_01double_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__8_00_01_n_00_01sta727838eb2b4770a9aa7a352b2a1c79a5_html_a65d87b307241347039136997b68b3e34"><div class="ttname"><a href="structquda_1_1gauge__mapper_3_01double_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__8_00_01_n_00_01sta727838eb2b4770a9aa7a352b2a1c79a5.html#a65d87b307241347039136997b68b3e34">quda::gauge_mapper&lt; double, QUDA_RECONSTRUCT_8, N, stag, huge_alloc, ghostExchange, use_inphase &gt;::type</a></div><div class="ttdeci">gauge::FloatNOrder&lt; double, N, 2, 8, stag, huge_alloc, ghostExchange, use_inphase &gt; type</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l03038">gauge_field_order.h:3038</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_t_i_f_r_padded_order_html_ad88b168d332b1e9c19fb8642ab9abe19"><div class="ttname"><a href="structquda_1_1gauge_1_1_t_i_f_r_padded_order.html#ad88b168d332b1e9c19fb8642ab9abe19">quda::gauge::TIFRPaddedOrder::operator()</a></div><div class="ttdeci">__device__ __host__ gauge_wrapper&lt; real, Accessor &gt; operator()(int dim, int x_cb, int parity)</div><div class="ttdoc">This accessor routine returns a gauge_wrapper to this object, allowing us to overload various operato...</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02959">gauge_field_order.h:2959</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_q_d_p_order_html"><div class="ttname"><a href="structquda_1_1gauge_1_1_q_d_p_order.html">quda::gauge::QDPOrder</a></div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02184">gauge_field_order.h:2184</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_3_019_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4_html_a600a01a5d4996e1f3678e1a051c00999"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct_3_019_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a600a01a5d4996e1f3678e1a051c00999">quda::gauge::Reconstruct&lt; 9, Float, ghostExchange_, stag_phase &gt;::Pack</a></div><div class="ttdeci">__device__ __host__ void Pack(real out[8], const complex in[9], int idx) const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01624">gauge_field_order.h:1624</a></div></div>
<div class="ttc" id="structquda_1_1gauge__mapper_3_01char_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__8_00_01_n_00_01stag_df8ff27d21ab7fa4e74225ab113828c2_html_ad44c829405231609b9053849eb905e42"><div class="ttname"><a href="structquda_1_1gauge__mapper_3_01char_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__8_00_01_n_00_01stag_df8ff27d21ab7fa4e74225ab113828c2.html#ad44c829405231609b9053849eb905e42">quda::gauge_mapper&lt; char, QUDA_RECONSTRUCT_8, N, stag, huge_alloc, ghostExchange, use_inphase &gt;::type</a></div><div class="ttdeci">gauge::FloatNOrder&lt; char, N, 4, 8, stag, huge_alloc, ghostExchange, use_inphase &gt; type</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l03116">gauge_field_order.h:3116</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_float_n_order_html_a5c15129d2e5a16b6f09bd5b8bd95c539"><div class="ttname"><a href="structquda_1_1gauge_1_1_float_n_order.html#a5c15129d2e5a16b6f09bd5b8bd95c539">quda::gauge::FloatNOrder::offset</a></div><div class="ttdeci">const AllocInt offset</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01704">gauge_field_order.h:1704</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_m_i_l_c_order_html_a6db06e6868d9c2b32838a0882cafd35e"><div class="ttname"><a href="structquda_1_1gauge_1_1_m_i_l_c_order.html#a6db06e6868d9c2b32838a0882cafd35e">quda::gauge::MILCOrder::volumeCB</a></div><div class="ttdeci">const int volumeCB</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02337">gauge_field_order.h:2337</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_float_n_order_html_ad6140ba547968a3dcb9cab8aa56152fd"><div class="ttname"><a href="structquda_1_1gauge_1_1_float_n_order.html#ad6140ba547968a3dcb9cab8aa56152fd">quda::gauge::FloatNOrder::ghost</a></div><div class="ttdeci">Float * ghost[4]</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01710">gauge_field_order.h:1710</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_edba98cba7f194488e42e7a830abb1e97_html_a5a358771e83d917f101d8335948e9972"><div class="ttname"><a href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_edba98cba7f194488e42e7a830abb1e97.html#a5a358771e83d917f101d8335948e9972">quda::gauge::GhostAccessor&lt; Float, nColor, QUDA_QDP_GAUGE_ORDER, native_ghost, storeFloat, use_tex &gt;::operator()</a></div><div class="ttdeci">__device__ __host__ complex&lt; Float &gt; operator()(int d, int parity, int x, int row, int col) const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00506">gauge_field_order.h:506</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_field_order_html_af2427674e6e3dfb58946bd10a3da3d50"><div class="ttname"><a href="structquda_1_1gauge_1_1_field_order.html#af2427674e6e3dfb58946bd10a3da3d50">quda::gauge::FieldOrder::Ndim</a></div><div class="ttdeci">__device__ __host__ int Ndim() const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01053">gauge_field_order.h:1053</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g_e___ob3f8ab569f1b01e2fe1b1e99b6b90783_html_a6b966f5c8b3fd4bd18e02965cc72df43"><div class="ttname"><a href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g_e___ob3f8ab569f1b01e2fe1b1e99b6b90783.html#a6b966f5c8b3fd4bd18e02965cc72df43">quda::gauge::Accessor&lt; Float, nColor, QUDA_MILC_GAUGE_ORDER, storeFloat, use_tex &gt;::geometry</a></div><div class="ttdeci">const int geometry</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00525">gauge_field_order.h:525</a></div></div>
<div class="ttc" id="structquda_1_1gauge__wrapper_html_a5f5a9203b093855e28232b94ac0f8f17"><div class="ttname"><a href="structquda_1_1gauge__wrapper.html#a5f5a9203b093855e28232b94ac0f8f17">quda::gauge_wrapper::parity</a></div><div class="ttdeci">const int parity</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00047">gauge_field_order.h:47</a></div></div>
<div class="ttc" id="enum__quda_8h_html_a5cc304be12bc9174274636e1e7863841a75dea1bc5914c39d84665ee0fc7b2432"><div class="ttname"><a href="enum__quda_8h.html#a5cc304be12bc9174274636e1e7863841a75dea1bc5914c39d84665ee0fc7b2432">QUDA_RECONSTRUCT_12</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00068">enum_quda.h:68</a></div></div>
<div class="ttc" id="structquda_1_1complex_3_01int_01_4_html"><div class="ttname"><a href="structquda_1_1complex_3_01int_01_4.html">quda::complex&lt; int &gt;</a></div><div class="ttdef"><b>Definition:</b> <a href="complex__quda_8h_source.html#l00803">complex_quda.h:803</a></div></div>
<div class="ttc" id="comm__quda_8h_html_aadfcf98463bceb3dc953a0b0d815179a"><div class="ttname"><a href="comm__quda_8h.html#aadfcf98463bceb3dc953a0b0d815179a">comm_allreduce_min</a></div><div class="ttdeci">void comm_allreduce_min(double *data)</div><div class="ttdef"><b>Definition:</b> <a href="comm__mpi_8cpp_source.html#l00265">comm_mpi.cpp:265</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_ghost_accessor_html_ac99bddfe8d81b397460c400f9de778a1"><div class="ttname"><a href="structquda_1_1gauge_1_1_ghost_accessor.html#ac99bddfe8d81b397460c400f9de778a1">quda::gauge::GhostAccessor::resetScale</a></div><div class="ttdeci">void resetScale(Float dummy)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00362">gauge_field_order.h:362</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4_html_a56488c48c4dff8853bbba14585b6168b"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4.html#a56488c48c4dff8853bbba14585b6168b">quda::gauge::Reconstruct&lt; 12, Float, ghostExchange_ &gt;::firstTimeSliceBound</a></div><div class="ttdeci">const int firstTimeSliceBound</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01235">gauge_field_order.h:1235</a></div></div>
<div class="ttc" id="structquda_1_1_vector_type_html"><div class="ttname"><a href="structquda_1_1_vector_type.html">quda::VectorType</a></div><div class="ttdef"><b>Definition:</b> <a href="register__traits_8h_source.html#l00367">register_traits.h:367</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_e___o_r18e8f8cc0cf320665821408416e0c3d7_html_afcd90e23f09cb4b69b9c75bc1d213eb5"><div class="ttname"><a href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_e___o_r18e8f8cc0cf320665821408416e0c3d7.html#afcd90e23f09cb4b69b9c75bc1d213eb5">quda::gauge::Accessor&lt; Float, nColor, QUDA_QDP_GAUGE_ORDER, storeFloat, use_tex &gt;::volumeCB</a></div><div class="ttdeci">const int volumeCB</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00372">gauge_field_order.h:372</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_field_order_html_a342cfe197aee7d43e06d82700e7a101f"><div class="ttname"><a href="structquda_1_1gauge_1_1_field_order.html#a342cfe197aee7d43e06d82700e7a101f">quda::gauge::FieldOrder::abs_min</a></div><div class="ttdeci">__host__ double abs_min(int dim=-1, bool global=true) const</div><div class="ttdoc">Returns the minimum absolute value of the field. </div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01105">gauge_field_order.h:1105</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_q_d_p_order_html_a650891d0d1f90bf9a447db9bb957173f"><div class="ttname"><a href="structquda_1_1gauge_1_1_q_d_p_order.html#a650891d0d1f90bf9a447db9bb957173f">quda::gauge::QDPOrder::QDPOrder</a></div><div class="ttdeci">QDPOrder(const GaugeField &amp;u, Float *gauge_=0, Float **ghost_=0)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02190">gauge_field_order.h:2190</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_field_order_html_a5ea3a0e76116f1bf59e13f3a6cc9d088"><div class="ttname"><a href="structquda_1_1gauge_1_1_field_order.html#a5ea3a0e76116f1bf59e13f3a6cc9d088">quda::gauge::FieldOrder::NcolorCoarse</a></div><div class="ttdeci">__device__ __host__ int NcolorCoarse() const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01062">gauge_field_order.h:1062</a></div></div>
<div class="ttc" id="structquda_1_1gauge__order__mapper_3_01_t_00_01_q_u_d_a___q_d_p___g_a_u_g_e___o_r_d_e_r_00_01_nc_01_4_html_add59e7e5d9b274d7b03a2f8559ac2a67"><div class="ttname"><a href="structquda_1_1gauge__order__mapper_3_01_t_00_01_q_u_d_a___q_d_p___g_a_u_g_e___o_r_d_e_r_00_01_nc_01_4.html#add59e7e5d9b274d7b03a2f8559ac2a67">quda::gauge_order_mapper&lt; T, QUDA_QDP_GAUGE_ORDER, Nc &gt;::type</a></div><div class="ttdeci">gauge::QDPOrder&lt; T, 2 *Nc *Nc &gt; type</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l03120">gauge_field_order.h:3120</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1fieldorder__wrapper_html_a8481a3e0b6670a33818206802171d657"><div class="ttname"><a href="structquda_1_1gauge_1_1fieldorder__wrapper.html#a8481a3e0b6670a33818206802171d657">quda::gauge::fieldorder_wrapper::real</a></div><div class="ttdeci">__device__ __host__ Float real() const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00249">gauge_field_order.h:249</a></div></div>
<div class="ttc" id="enum__quda_8h_html_a66bcb3446804c792fbe18f0301a3a56e"><div class="ttname"><a href="enum__quda_8h.html#a66bcb3446804c792fbe18f0301a3a56e">QudaStaggeredPhase</a></div><div class="ttdeci">enum QudaStaggeredPhase_s QudaStaggeredPhase</div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_3_0113_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4_html_a531fa87473a6a9c738e37720963e0276"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct_3_0113_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a531fa87473a6a9c738e37720963e0276">quda::gauge::Reconstruct&lt; 13, Float, ghostExchange_, stag_phase &gt;::real</a></div><div class="ttdeci">typename mapper&lt; Float &gt;::type real</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01363">gauge_field_order.h:1363</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1fieldorder__wrapper_html_a11a664c89044348978942364fc030000"><div class="ttname"><a href="structquda_1_1gauge_1_1fieldorder__wrapper.html#a11a664c89044348978942364fc030000">quda::gauge::fieldorder_wrapper::idx</a></div><div class="ttdeci">const int idx</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00237">gauge_field_order.h:237</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_q_d_p_order_html_aab1d4ebc76b9c6302b6f2d461377d323"><div class="ttname"><a href="structquda_1_1gauge_1_1_q_d_p_order.html#aab1d4ebc76b9c6302b6f2d461377d323">quda::gauge::QDPOrder::Bytes</a></div><div class="ttdeci">size_t Bytes() const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02259">gauge_field_order.h:2259</a></div></div>
<div class="ttc" id="structquda_1_1gauge__mapper_3_01short_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__13_00_01_n_00_01sta3fb5c8e95e4124ae0bd62f1be5b3d821_html_a2c2ee705f55133601bcd1ce7442018f3"><div class="ttname"><a href="structquda_1_1gauge__mapper_3_01short_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__13_00_01_n_00_01sta3fb5c8e95e4124ae0bd62f1be5b3d821.html#a2c2ee705f55133601bcd1ce7442018f3">quda::gauge_mapper&lt; short, QUDA_RECONSTRUCT_13, N, stag, huge_alloc, ghostExchange, use_inphase &gt;::type</a></div><div class="ttdeci">gauge::FloatNOrder&lt; short, N, 4, 13, stag, huge_alloc, ghostExchange, use_inphase &gt; type</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l03074">gauge_field_order.h:3074</a></div></div>
<div class="ttc" id="covdev__test_8cpp_html_a8534bf561fd4d68d79107757d9cbac65"><div class="ttname"><a href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a></div><div class="ttdeci">const int nColor</div><div class="ttdef"><b>Definition:</b> <a href="covdev__test_8cpp_source.html#l00075">covdev_test.cpp:75</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_accessor_html_a1851487551035d00f0e9ac0f7eb63aaf"><div class="ttname"><a href="structquda_1_1gauge_1_1_accessor.html#a1851487551035d00f0e9ac0f7eb63aaf">quda::gauge::Accessor::resetScale</a></div><div class="ttdeci">void resetScale(Float dummy)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00348">gauge_field_order.h:348</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_b_q_c_d_order_html_ad2e917299fd0915aa0d76f1a6af36068"><div class="ttname"><a href="structquda_1_1gauge_1_1_b_q_c_d_order.html#ad2e917299fd0915aa0d76f1a6af36068">quda::gauge::BQCDOrder::volumeCB</a></div><div class="ttdeci">const int volumeCB</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02647">gauge_field_order.h:2647</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_m_i_l_c_order_html_acc84b16e69b70b30d9bbc339fbee63b1"><div class="ttname"><a href="structquda_1_1gauge_1_1_m_i_l_c_order.html#acc84b16e69b70b30d9bbc339fbee63b1">quda::gauge::MILCOrder::MILCOrder</a></div><div class="ttdeci">MILCOrder(const GaugeField &amp;u, Float *gauge_=0, Float **ghost_=0)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02339">gauge_field_order.h:2339</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_c_p_s_order_html_a589c566e6c857c4eabf4795fa836afc2"><div class="ttname"><a href="structquda_1_1gauge_1_1_c_p_s_order.html#a589c566e6c857c4eabf4795fa836afc2">quda::gauge::CPSOrder::operator()</a></div><div class="ttdeci">__device__ __host__ gauge_wrapper&lt; real, Accessor &gt; operator()(int dim, int x_cb, int parity)</div><div class="ttdoc">This accessor routine returns a gauge_wrapper to this object, allowing us to overload various operato...</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02612">gauge_field_order.h:2612</a></div></div>
<div class="ttc" id="structquda_1_1gauge__mapper_3_01char_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__9_00_01_n_00_01stag_ccb9fbed9e009d8660b4b9d3e7a9e56b_html_ab3ee29fa036600a684b4245515cee573"><div class="ttname"><a href="structquda_1_1gauge__mapper_3_01char_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__9_00_01_n_00_01stag_ccb9fbed9e009d8660b4b9d3e7a9e56b.html#ab3ee29fa036600a684b4245515cee573">quda::gauge_mapper&lt; char, QUDA_RECONSTRUCT_9, N, stag, huge_alloc, ghostExchange, use_inphase &gt;::type</a></div><div class="ttdeci">gauge::FloatNOrder&lt; char, N, 4, 9, stag, huge_alloc, ghostExchange, use_inphase &gt; type</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l03112">gauge_field_order.h:3112</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_3_0111_00_01_float_00_01ghost_exchange___01_4_html_a1a8bc564241b3503bdd1b7097fa45c1d"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct_3_0111_00_01_float_00_01ghost_exchange___01_4.html#a1a8bc564241b3503bdd1b7097fa45c1d">quda::gauge::Reconstruct&lt; 11, Float, ghostExchange_ &gt;::Pack</a></div><div class="ttdeci">__device__ __host__ void Pack(real out[10], const complex in[9], int idx) const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01320">gauge_field_order.h:1320</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_m_i_l_c_site_order_html_a05255de0b2cde2f4749a59ce19251bbf"><div class="ttname"><a href="structquda_1_1gauge_1_1_m_i_l_c_site_order.html#a05255de0b2cde2f4749a59ce19251bbf">quda::gauge::MILCSiteOrder::size</a></div><div class="ttdeci">const size_t size</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02434">gauge_field_order.h:2434</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_m_i_l_c_site_order_html_a49c7abef30fa492a5158b29e45dd02cd"><div class="ttname"><a href="structquda_1_1gauge_1_1_m_i_l_c_site_order.html#a49c7abef30fa492a5158b29e45dd02cd">quda::gauge::MILCSiteOrder::load</a></div><div class="ttdeci">__device__ __host__ void load(complex v[length/2], int x, int dir, int parity, real inphase=1.0) const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02456">gauge_field_order.h:2456</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e_0851bfc944ce664513b027bdb1e7938b_html_a45bd07b635565ca44633621567c7d0e0"><div class="ttname"><a href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e_0851bfc944ce664513b027bdb1e7938b.html#a45bd07b635565ca44633621567c7d0e0">quda::gauge::Accessor&lt; Float, nColor, QUDA_FLOAT2_GAUGE_ORDER, storeFloat, use_tex &gt;::scale_inv</a></div><div class="ttdeci">Float scale_inv</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00695">gauge_field_order.h:695</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4_html_a420afc0023304fad223cb2936560fae6"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4.html#a420afc0023304fad223cb2936560fae6">quda::gauge::Reconstruct&lt; 12, Float, ghostExchange_ &gt;::Pack</a></div><div class="ttdeci">__device__ __host__ void Pack(real out[12], const complex in[9], int idx) const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01263">gauge_field_order.h:1263</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_e___o_r18e8f8cc0cf320665821408416e0c3d7_html_a4e1439061ab2dd08a990780fede480a3"><div class="ttname"><a href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_e___o_r18e8f8cc0cf320665821408416e0c3d7.html#a4e1439061ab2dd08a990780fede480a3">quda::gauge::Accessor&lt; Float, nColor, QUDA_QDP_GAUGE_ORDER, storeFloat, use_tex &gt;::atomic_add</a></div><div class="ttdeci">__device__ __host__ void atomic_add(int dim, int parity, int x_cb, int row, int col, const complex&lt; theirFloat &gt; &amp;val) const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00418">gauge_field_order.h:418</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_3_019_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4_html_a10b1b47d242c6cb1a7f2418b93f4ea8d"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct_3_019_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a10b1b47d242c6cb1a7f2418b93f4ea8d">quda::gauge::Reconstruct&lt; 9, Float, ghostExchange_, stag_phase &gt;::Unpack</a></div><div class="ttdeci">__device__ __host__ void Unpack(complex out[9], const real in[8], int idx, int dir, real phase, const I *X, const int *R) const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01644">gauge_field_order.h:1644</a></div></div>
<div class="ttc" id="structquda_1_1complex_3_01int_01_4_html_a962d1decb933422bad3525967e066907"><div class="ttname"><a href="structquda_1_1complex_3_01int_01_4.html#a962d1decb933422bad3525967e066907">quda::complex&lt; int &gt;::imag</a></div><div class="ttdeci">__host__ __device__ int imag() const volatile</div><div class="ttdef"><b>Definition:</b> <a href="complex__quda_8h_source.html#l00833">complex_quda.h:833</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_b_q_c_d_order_html"><div class="ttname"><a href="structquda_1_1gauge_1_1_b_q_c_d_order.html">quda::gauge::BQCDOrder</a></div><div class="ttdoc">struct to define BQCD ordered gauge fields: </div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02642">gauge_field_order.h:2642</a></div></div>
<div class="ttc" id="enum__quda_8h_html_acb61fdc14d6b12e8c6177b6d966bd863adb1a4116b2cbd52bd33641d7400f0989"><div class="ttname"><a href="enum__quda_8h.html#acb61fdc14d6b12e8c6177b6d966bd863adb1a4116b2cbd52bd33641d7400f0989">QUDA_MILC_GAUGE_ORDER</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00044">enum_quda.h:44</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1abs___3_01_float_00_01char_01_4_html_a201f282c74ae6ad173a789928b024c39"><div class="ttname"><a href="structquda_1_1gauge_1_1abs___3_01_float_00_01char_01_4.html#a201f282c74ae6ad173a789928b024c39">quda::gauge::abs_&lt; Float, char &gt;::operator()</a></div><div class="ttdeci">__host__ __device__ Float operator()(const quda::complex&lt; char &gt; &amp;x)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00200">gauge_field_order.h:200</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1abs___3_01_float_00_01char_01_4_html_a433a53d51297921073932479fc389526"><div class="ttname"><a href="structquda_1_1gauge_1_1abs___3_01_float_00_01char_01_4.html#a433a53d51297921073932479fc389526">quda::gauge::abs_&lt; Float, char &gt;::scale</a></div><div class="ttdeci">Float scale</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00198">gauge_field_order.h:198</a></div></div>
<div class="ttc" id="structquda_1_1complex_3_01int_01_4_html_ae01bd432beeb8df71da19b69555ee7e4"><div class="ttname"><a href="structquda_1_1complex_3_01int_01_4.html#ae01bd432beeb8df71da19b69555ee7e4">quda::complex&lt; int &gt;::real</a></div><div class="ttdeci">__host__ __device__ int real() const volatile</div><div class="ttdef"><b>Definition:</b> <a href="complex__quda_8h_source.html#l00832">complex_quda.h:832</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_float_n_order_html_a231bc6fbb3842003f423778ed750386a"><div class="ttname"><a href="structquda_1_1gauge_1_1_float_n_order.html#a231bc6fbb3842003f423778ed750386a">quda::gauge::FloatNOrder::save</a></div><div class="ttdeci">__device__ __host__ void save(const complex v[length/2], int x, int dir, int parity)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01808">gauge_field_order.h:1808</a></div></div>
<div class="ttc" id="staggered__invert__test_8cpp_html_af61ff6c9724eb687e3057b6a1a977487"><div class="ttname"><a href="staggered__invert__test_8cpp.html#af61ff6c9724eb687e3057b6a1a977487">in</a></div><div class="ttdeci">cpuColorSpinorField * in</div><div class="ttdef"><b>Definition:</b> <a href="staggered__invert__test_8cpp_source.html#l00098">staggered_invert_test.cpp:98</a></div></div>
<div class="ttc" id="enum__quda_8h_html_a744e553dee90a2671fe00aba878c315b"><div class="ttname"><a href="enum__quda_8h.html#a744e553dee90a2671fe00aba878c315b">QudaGhostExchange</a></div><div class="ttdeci">enum QudaGhostExchange_s QudaGhostExchange</div></div>
<div class="ttc" id="namespacequda_html_aaeda4e4f5aabf19dae35f28e4c8802b7"><div class="ttname"><a href="namespacequda.html#aaeda4e4f5aabf19dae35f28e4c8802b7">quda::vector_store</a></div><div class="ttdeci">__device__ __host__ void vector_store(void *ptr, int idx, const VectorType &amp;value)</div><div class="ttdef"><b>Definition:</b> <a href="register__traits_8h_source.html#l00422">register_traits.h:422</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_html"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct.html">quda::gauge::Reconstruct</a></div><div class="ttdoc">Generic reconstruction helper with no reconstruction. </div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01125">gauge_field_order.h:1125</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g656a684b71192f463c0c771174ee66f3_html"><div class="ttname"><a href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g656a684b71192f463c0c771174ee66f3.html">quda::gauge::GhostAccessor&lt; Float, nColor, QUDA_MILC_GAUGE_ORDER, native_ghost, storeFloat, use_tex &gt;</a></div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00619">gauge_field_order.h:619</a></div></div>
<div class="ttc" id="namespacequda_1_1gauge_html_a19e13125b751c0010b4e483f9b2030b9"><div class="ttname"><a href="namespacequda_1_1gauge.html#a19e13125b751c0010b4e483f9b2030b9">quda::gauge::static_phase</a></div><div class="ttdeci">__host__ __device__ bool static_phase()</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01679">gauge_field_order.h:1679</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_m_i_l_c_site_order_html_a794222a839fbf1b0976f7be33109450d"><div class="ttname"><a href="structquda_1_1gauge_1_1_m_i_l_c_site_order.html#a794222a839fbf1b0976f7be33109450d">quda::gauge::MILCSiteOrder::MILCSiteOrder</a></div><div class="ttdeci">MILCSiteOrder(const MILCSiteOrder &amp;order)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02446">gauge_field_order.h:2446</a></div></div>
<div class="ttc" id="namespacequda_1_1gauge_html_a90278ad9b2340af4be893205e339b7e2"><div class="ttname"><a href="namespacequda_1_1gauge.html#a90278ad9b2340af4be893205e339b7e2">quda::gauge::fixed_point&lt; float, char &gt;</a></div><div class="ttdeci">__host__ __device__ constexpr bool fixed_point&lt; float, char &gt;()</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00219">gauge_field_order.h:219</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_float_n_order_html_a8c273a958c0835a1935920c93089afa6"><div class="ttname"><a href="structquda_1_1gauge_1_1_float_n_order.html#a8c273a958c0835a1935920c93089afa6">quda::gauge::FloatNOrder::loadGhostEx</a></div><div class="ttdeci">__device__ __host__ void loadGhostEx(complex v[length/2], int buff_idx, int extended_idx, int dir, int dim, int g, int parity, const int R[]) const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01953">gauge_field_order.h:1953</a></div></div>
<div class="ttc" id="structquda_1_1gauge__mapper_3_01double_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t___n_o_00_01_n_00_01d04ce04d89bedac01bd2a9a29b8fc9ef_html_a1c3f887aa4f119bb080b604ab7bf570d"><div class="ttname"><a href="structquda_1_1gauge__mapper_3_01double_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t___n_o_00_01_n_00_01d04ce04d89bedac01bd2a9a29b8fc9ef.html#a1c3f887aa4f119bb080b604ab7bf570d">quda::gauge_mapper&lt; double, QUDA_RECONSTRUCT_NO, N, stag, huge_alloc, ghostExchange, use_inphase &gt;::type</a></div><div class="ttdeci">gauge::FloatNOrder&lt; double, N, 2, N, stag, huge_alloc, ghostExchange, use_inphase &gt; type</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l03018">gauge_field_order.h:3018</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_3_0113_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4_html_a958e93a930512f1729501e2fa896efb3"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct_3_0113_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a958e93a930512f1729501e2fa896efb3">quda::gauge::Reconstruct&lt; 13, Float, ghostExchange_, stag_phase &gt;::scale</a></div><div class="ttdeci">const real scale</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01366">gauge_field_order.h:1366</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4_html_afe71729cdf3575b099efc6c058cec93e"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4.html#afe71729cdf3575b099efc6c058cec93e">quda::gauge::Reconstruct&lt; 12, Float, ghostExchange_ &gt;::getPhase</a></div><div class="ttdeci">__device__ __host__ real getPhase(const complex in[9])</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01300">gauge_field_order.h:1300</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_b_q_c_d_order_html_afe746011348c256043ccd6d451d20e56"><div class="ttname"><a href="structquda_1_1gauge_1_1_b_q_c_d_order.html#afe746011348c256043ccd6d451d20e56">quda::gauge::BQCDOrder::save</a></div><div class="ttdeci">__device__ __host__ void save(const complex v[9], int x, int dir, int parity)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02684">gauge_field_order.h:2684</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_float_n_order_html_aa4b32734977faad44c29b86f7367eec5"><div class="ttname"><a href="structquda_1_1gauge_1_1_float_n_order.html#aa4b32734977faad44c29b86f7367eec5">quda::gauge::FloatNOrder::saveGhostEx</a></div><div class="ttdeci">__device__ __host__ void saveGhostEx(const complex v[length/2], int buff_idx, int extended_idx, int dir, int dim, int g, int parity, const int R[])</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01978">gauge_field_order.h:1978</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_float_n_order_html_a714541bb8db859517a8c014473c997ae"><div class="ttname"><a href="structquda_1_1gauge_1_1_float_n_order.html#a714541bb8db859517a8c014473c997ae">quda::gauge::FloatNOrder::save</a></div><div class="ttdeci">void save()</div><div class="ttdoc">Backup the field to the host when tuning. </div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02007">gauge_field_order.h:2007</a></div></div>
<div class="ttc" id="structquda_1_1complex_3_01short_01_4_html_aa203635a627c53a8978aeee859a49c7c"><div class="ttname"><a href="structquda_1_1complex_3_01short_01_4.html#aa203635a627c53a8978aeee859a49c7c">quda::complex&lt; short &gt;::imag</a></div><div class="ttdeci">__host__ __device__ short imag() const volatile</div><div class="ttdef"><b>Definition:</b> <a href="complex__quda_8h_source.html#l00787">complex_quda.h:787</a></div></div>
<div class="ttc" id="structquda_1_1gauge__ghost__wrapper_html"><div class="ttname"><a href="structquda_1_1gauge__ghost__wrapper.html">quda::gauge_ghost_wrapper</a></div><div class="ttdoc">gauge_ghost_wrapper is an internal class that is used to wrap instances of gauge ghost accessors...</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00109">gauge_field_order.h:109</a></div></div>
<div class="ttc" id="structquda_1_1gauge__mapper_3_01short_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t___n_o_00_01_n_00_01s8d62358dfffba98a1ac205290ef41137_html_a3f88aa5b7b78d31c63d68af34a443840"><div class="ttname"><a href="structquda_1_1gauge__mapper_3_01short_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t___n_o_00_01_n_00_01s8d62358dfffba98a1ac205290ef41137.html#a3f88aa5b7b78d31c63d68af34a443840">quda::gauge_mapper&lt; short, QUDA_RECONSTRUCT_NO, N, stag, huge_alloc, ghostExchange, use_inphase &gt;::type</a></div><div class="ttdeci">gauge::FloatNOrder&lt; short, N, 2, N, stag, huge_alloc, ghostExchange, use_inphase &gt; type</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l03070">gauge_field_order.h:3070</a></div></div>
<div class="ttc" id="structquda_1_1gauge__wrapper_html_a74e48d66e79a75aa5b890a214e27028e"><div class="ttname"><a href="structquda_1_1gauge__wrapper.html#a74e48d66e79a75aa5b890a214e27028e">quda::gauge_wrapper::gauge</a></div><div class="ttdeci">T &amp; gauge</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00049">gauge_field_order.h:49</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4_html_aabfff951b1c0665b279c06d9ba0768ad"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#aabfff951b1c0665b279c06d9ba0768ad">quda::gauge::Reconstruct&lt; 8, Float, ghostExchange_ &gt;::getPhase</a></div><div class="ttdeci">__device__ __host__ real getPhase(const complex in[9])</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01574">gauge_field_order.h:1574</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_t_i_f_r_padded_order_html_a1d69528680ef7c1fc7f75d816d14e975"><div class="ttname"><a href="structquda_1_1gauge_1_1_t_i_f_r_padded_order.html#a1d69528680ef7c1fc7f75d816d14e975">quda::gauge::TIFRPaddedOrder::dim</a></div><div class="ttdeci">const int dim[4]</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02859">gauge_field_order.h:2859</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_m_i_l_c_order_html_acfc75ce93d116aa0f1270819c1cefc9c"><div class="ttname"><a href="structquda_1_1gauge_1_1_m_i_l_c_order.html#acfc75ce93d116aa0f1270819c1cefc9c">quda::gauge::MILCOrder::save</a></div><div class="ttdeci">__device__ __host__ void save(const complex v[length/2], int x, int dir, int parity)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02358">gauge_field_order.h:2358</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_t_i_f_r_padded_order_html_abdc4313ad33edf1ac73bf63fce932e75"><div class="ttname"><a href="structquda_1_1gauge_1_1_t_i_f_r_padded_order.html#abdc4313ad33edf1ac73bf63fce932e75">quda::gauge::TIFRPaddedOrder::real</a></div><div class="ttdeci">typename mapper&lt; Float &gt;::type real</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02851">gauge_field_order.h:2851</a></div></div>
<div class="ttc" id="namespacequda_1_1gauge_html_a78c4d08410925a7cf57a044ae74ee95b"><div class="ttname"><a href="namespacequda_1_1gauge.html#a78c4d08410925a7cf57a044ae74ee95b">quda::gauge::match&lt; int, int &gt;</a></div><div class="ttdeci">__host__ __device__ constexpr bool match&lt; int, int &gt;()</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00224">gauge_field_order.h:224</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_field_order_html_a4f0b72d616f59624b2701360dffee3b7"><div class="ttname"><a href="structquda_1_1gauge_1_1_field_order.html#a4f0b72d616f59624b2701360dffee3b7">quda::gauge::FieldOrder::Bytes</a></div><div class="ttdeci">size_t Bytes() const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01113">gauge_field_order.h:1113</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_s_html_a33ae720c2c7eb345742b69f34fdeeb74"><div class="ttname"><a href="structquda_1_1gauge_1_1_s.html#a33ae720c2c7eb345742b69f34fdeeb74">quda::gauge::S::operator[]</a></div><div class="ttdeci">__host__ __device__ real &amp; operator[](int i)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02036">gauge_field_order.h:2036</a></div></div>
<div class="ttc" id="structquda_1_1gauge__mapper_3_01char_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__12_00_01_n_00_01stag0fc2ea3a3777b69e201179ebb538c566_html_ae7127323096cf2d2c287507f36ee3404"><div class="ttname"><a href="structquda_1_1gauge__mapper_3_01char_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__12_00_01_n_00_01stag0fc2ea3a3777b69e201179ebb538c566.html#ae7127323096cf2d2c287507f36ee3404">quda::gauge_mapper&lt; char, QUDA_RECONSTRUCT_12, N, stag, huge_alloc, ghostExchange, use_inphase &gt;::type</a></div><div class="ttdeci">gauge::FloatNOrder&lt; char, N, 4, 12, stag, huge_alloc, ghostExchange, use_inphase &gt; type</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l03104">gauge_field_order.h:3104</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_e___o_r18e8f8cc0cf320665821408416e0c3d7_html_a1c8e5fb8e0a4d94879899b3dc92aebb1"><div class="ttname"><a href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_e___o_r18e8f8cc0cf320665821408416e0c3d7.html#a1c8e5fb8e0a4d94879899b3dc92aebb1">quda::gauge::Accessor&lt; Float, nColor, QUDA_QDP_GAUGE_ORDER, storeFloat, use_tex &gt;::scale</a></div><div class="ttdeci">Float scale</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00375">gauge_field_order.h:375</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_c_p_s_order_html_af2ee6441bd5066fe36064cc4fbef8b1c"><div class="ttname"><a href="structquda_1_1gauge_1_1_c_p_s_order.html#af2ee6441bd5066fe36064cc4fbef8b1c">quda::gauge::CPSOrder::gauge</a></div><div class="ttdeci">Float * gauge</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02535">gauge_field_order.h:2535</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_field_order_html_a0cbe7ee6466c5f11475b54b3ef6114a7"><div class="ttname"><a href="structquda_1_1gauge_1_1_field_order.html#a0cbe7ee6466c5f11475b54b3ef6114a7">quda::gauge::FieldOrder::Ghost</a></div><div class="ttdeci">__device__ __host__ fieldorder_wrapper&lt; Float, storeFloat &gt; Ghost(int d, int parity, int x, int row, int col)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00974">gauge_field_order.h:974</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1fieldorder__wrapper_html_aa496f194271d518008d6c88b75d407a2"><div class="ttname"><a href="structquda_1_1gauge_1_1fieldorder__wrapper.html#aa496f194271d518008d6c88b75d407a2">quda::gauge::fieldorder_wrapper::imag</a></div><div class="ttdeci">__device__ __host__ Float imag() const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00257">gauge_field_order.h:257</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_c_p_s_order_html_aeb6ffcf1219a375c62cad5ac00afa404"><div class="ttname"><a href="structquda_1_1gauge_1_1_c_p_s_order.html#aeb6ffcf1219a375c62cad5ac00afa404">quda::gauge::CPSOrder::CPSOrder</a></div><div class="ttdeci">CPSOrder(const GaugeField &amp;u, Float *gauge_=0, Float **ghost_=0)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02541">gauge_field_order.h:2541</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_3_0113_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4_html"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct_3_0113_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html">quda::gauge::Reconstruct&lt; 13, Float, ghostExchange_, stag_phase &gt;</a></div><div class="ttdoc">Gauge reconstruct 13 helper where we reconstruct the third row from the cross product of the first tw...</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01362">gauge_field_order.h:1362</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_html_a9edb9b70ed2cd0efb83d7bb62376475d"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct.html#a9edb9b70ed2cd0efb83d7bb62376475d">quda::gauge::Reconstruct::getPhase</a></div><div class="ttdeci">__device__ __host__ real getPhase(const complex in[N/2]) const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01164">gauge_field_order.h:1164</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e_0851bfc944ce664513b027bdb1e7938b_html_ae37a53b215b98335fea28dfce9674af3"><div class="ttname"><a href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e_0851bfc944ce664513b027bdb1e7938b.html#ae37a53b215b98335fea28dfce9674af3">quda::gauge::Accessor&lt; Float, nColor, QUDA_FLOAT2_GAUGE_ORDER, storeFloat, use_tex &gt;::Accessor</a></div><div class="ttdeci">Accessor(const Accessor&lt; Float, nColor, QUDA_FLOAT2_GAUGE_ORDER, storeFloat, use_tex &gt; &amp;a)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00717">gauge_field_order.h:717</a></div></div>
<div class="ttc" id="enum__quda_8h_html_a93131cceecad27ce4b964cb184e8d47aa505f87642177d56c25870c8a3a82c76e"><div class="ttname"><a href="enum__quda_8h.html#a93131cceecad27ce4b964cb184e8d47aa505f87642177d56c25870c8a3a82c76e">QUDA_GHOST_EXCHANGE_NO</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00482">enum_quda.h:482</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4_html_a68c4d900e0c10e653892f0722fcf46b7"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4.html#a68c4d900e0c10e653892f0722fcf46b7">quda::gauge::Reconstruct&lt; 12, Float, ghostExchange_ &gt;::Reconstruct</a></div><div class="ttdeci">Reconstruct(const GaugeField &amp;u)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01241">gauge_field_order.h:1241</a></div></div>
<div class="ttc" id="classquda_1_1_gauge_field_html_aedfa91e714c61b8e11caec9d2703dcfa"><div class="ttname"><a href="classquda_1_1_gauge_field.html#aedfa91e714c61b8e11caec9d2703dcfa">quda::GaugeField::Ghost</a></div><div class="ttdeci">const void ** Ghost() const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field_8h_source.html#l00323">gauge_field.h:323</a></div></div>
<div class="ttc" id="enum__quda_8h_html_a5e790fc01ee46c70ab9a83d1fff88d4c"><div class="ttname"><a href="enum__quda_8h.html#a5e790fc01ee46c70ab9a83d1fff88d4c">QudaGaugeFieldOrder</a></div><div class="ttdeci">enum QudaGaugeFieldOrder_s QudaGaugeFieldOrder</div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_3_0113_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4_html_acd0e54904e9e4fb7b18eeaf2eb027da6"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct_3_0113_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#acd0e54904e9e4fb7b18eeaf2eb027da6">quda::gauge::Reconstruct&lt; 13, Float, ghostExchange_, stag_phase &gt;::getPhase</a></div><div class="ttdeci">__device__ __host__ real getPhase(const complex in[9]) const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01416">gauge_field_order.h:1416</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_html_ada6ef90c3eab849b350209967719dee2"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct.html#ada6ef90c3eab849b350209967719dee2">quda::gauge::Reconstruct::scale_inv</a></div><div class="ttdeci">real scale_inv</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01129">gauge_field_order.h:1129</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_3_0111_00_01_float_00_01ghost_exchange___01_4_html_a4cef3ff2f952dec4fea1092412cb3b5a"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct_3_0111_00_01_float_00_01ghost_exchange___01_4.html#a4cef3ff2f952dec4fea1092412cb3b5a">quda::gauge::Reconstruct&lt; 11, Float, ghostExchange_ &gt;::complex</a></div><div class="ttdeci">complex&lt; real &gt; complex</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01315">gauge_field_order.h:1315</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_q_d_p_order_html_ad477b1247e176c6e95caa99039110367"><div class="ttname"><a href="structquda_1_1gauge_1_1_q_d_p_order.html#ad477b1247e176c6e95caa99039110367">quda::gauge::QDPOrder::gauge</a></div><div class="ttdeci">Float * gauge[QUDA_MAX_DIM]</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02188">gauge_field_order.h:2188</a></div></div>
<div class="ttc" id="register__traits_8h_html"><div class="ttname"><a href="register__traits_8h.html">register_traits.h</a></div><div class="ttdoc">Provides precision abstractions and defines the register precision given the storage precision using ...</div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_t_i_f_r_order_html_af259239519e5e22f04264934df0b51be"><div class="ttname"><a href="structquda_1_1gauge_1_1_t_i_f_r_order.html#af259239519e5e22f04264934df0b51be">quda::gauge::TIFROrder::Bytes</a></div><div class="ttdeci">size_t Bytes() const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02842">gauge_field_order.h:2842</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_3_0111_00_01_float_00_01ghost_exchange___01_4_html_ab007f1f3c3fea36358929bbc9cf3088e"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct_3_0111_00_01_float_00_01ghost_exchange___01_4.html#ab007f1f3c3fea36358929bbc9cf3088e">quda::gauge::Reconstruct&lt; 11, Float, ghostExchange_ &gt;::getPhase</a></div><div class="ttdeci">__device__ __host__ real getPhase(const complex in[9])</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01350">gauge_field_order.h:1350</a></div></div>
<div class="ttc" id="covdev__test_8cpp_html_a7facd8f2fefe0ccaea751dff2592badb"><div class="ttname"><a href="covdev__test_8cpp.html#a7facd8f2fefe0ccaea751dff2592badb">X</a></div><div class="ttdeci">int X[4]</div><div class="ttdef"><b>Definition:</b> <a href="covdev__test_8cpp_source.html#l00070">covdev_test.cpp:70</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_field_order_html_a13e953a77696e16216f7762d770d8503"><div class="ttname"><a href="structquda_1_1gauge_1_1_field_order.html#a13e953a77696e16216f7762d770d8503">quda::gauge::FieldOrder::ghostAccessor</a></div><div class="ttdeci">GhostAccessor&lt; Float, nColor, order, native_ghost, storeFloat, use_tex &gt; ghostAccessor</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00906">gauge_field_order.h:906</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_legacy_order_html_a6389bc5655dad026b644dae7a0cee278"><div class="ttname"><a href="structquda_1_1gauge_1_1_legacy_order.html#a6389bc5655dad026b644dae7a0cee278">quda::gauge::LegacyOrder::loadGhostEx</a></div><div class="ttdeci">__device__ __host__ void loadGhostEx(complex v[length/2], int x, int dummy, int dir, int dim, int g, int parity, const int R[]) const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02145">gauge_field_order.h:2145</a></div></div>
<div class="ttc" id="namespacequda_1_1gauge_html_abb125d7ac186898c774ab769d43ce280"><div class="ttname"><a href="namespacequda_1_1gauge.html#abb125d7ac186898c774ab769d43ce280">quda::gauge::fixed_point&lt; float, int &gt;</a></div><div class="ttdeci">__host__ __device__ constexpr bool fixed_point&lt; float, int &gt;()</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00221">gauge_field_order.h:221</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_q_d_p_order_html_a421625328d7fe9a772c71727c899b952"><div class="ttname"><a href="structquda_1_1gauge_1_1_q_d_p_order.html#a421625328d7fe9a772c71727c899b952">quda::gauge::QDPOrder::load</a></div><div class="ttdeci">__device__ __host__ void load(complex v[length/2], int x, int dir, int parity, real inphase=1.0) const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02197">gauge_field_order.h:2197</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_t_i_f_r_padded_order_html_a6a65fe758adab6acf1aa84ca969aa96e"><div class="ttname"><a href="structquda_1_1gauge_1_1_t_i_f_r_padded_order.html#a6a65fe758adab6acf1aa84ca969aa96e">quda::gauge::TIFRPaddedOrder::TIFRPaddedOrder</a></div><div class="ttdeci">TIFRPaddedOrder(const GaugeField &amp;u, Float *gauge_=0, Float **ghost_=0)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02861">gauge_field_order.h:2861</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_ghost_accessor_html_a42bf4e43d364bd1399692cf10177b1a5"><div class="ttname"><a href="structquda_1_1gauge_1_1_ghost_accessor.html#a42bf4e43d364bd1399692cf10177b1a5">quda::gauge::GhostAccessor::dummy</a></div><div class="ttdeci">complex&lt; Float &gt; dummy</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00357">gauge_field_order.h:357</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_c_p_s_order_html_a0b6c0e60042fb6a1baded8dbdda03870"><div class="ttname"><a href="structquda_1_1gauge_1_1_c_p_s_order.html#a0b6c0e60042fb6a1baded8dbdda03870">quda::gauge::CPSOrder::volumeCB</a></div><div class="ttdeci">const int volumeCB</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02536">gauge_field_order.h:2536</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4_html_a0074e54be2603260fa5d04ebe5dddcf6"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4.html#a0074e54be2603260fa5d04ebe5dddcf6">quda::gauge::Reconstruct&lt; 12, Float, ghostExchange_ &gt;::tBoundary</a></div><div class="ttdeci">const real tBoundary</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01234">gauge_field_order.h:1234</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4_html_ad06b6fa935ec8cf6139bf00bb9c3ee6d"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4.html#ad06b6fa935ec8cf6139bf00bb9c3ee6d">quda::gauge::Reconstruct&lt; 12, Float, ghostExchange_ &gt;::isFirstTimeSlice</a></div><div class="ttdeci">const bool isFirstTimeSlice</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01237">gauge_field_order.h:1237</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g_e___ob3f8ab569f1b01e2fe1b1e99b6b90783_html_ad6dff02852e021909caeb934881d37bb"><div class="ttname"><a href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g_e___ob3f8ab569f1b01e2fe1b1e99b6b90783.html#ad6dff02852e021909caeb934881d37bb">quda::gauge::Accessor&lt; Float, nColor, QUDA_MILC_GAUGE_ORDER, storeFloat, use_tex &gt;::atomic_add</a></div><div class="ttdeci">__device__ __host__ void atomic_add(int dim, int parity, int x_cb, int row, int col, const complex&lt; theirFloat &gt; &amp;val) const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00564">gauge_field_order.h:564</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_3_019_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4_html_a846a8dbe5e9594fbbfcd82d72e0db209"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct_3_019_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a846a8dbe5e9594fbbfcd82d72e0db209">quda::gauge::Reconstruct&lt; 9, Float, ghostExchange_, stag_phase &gt;::getPhase</a></div><div class="ttdeci">__device__ __host__ real getPhase(const complex in[9]) const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01602">gauge_field_order.h:1602</a></div></div>
<div class="ttc" id="namespacequda_1_1cublas_html_ac642c2c4f9dd3abfe528cc1581e5bf76"><div class="ttname"><a href="namespacequda_1_1cublas.html#ac642c2c4f9dd3abfe528cc1581e5bf76">quda::cublas::init</a></div><div class="ttdeci">void init()</div><div class="ttdoc">Create the CUBLAS context. </div><div class="ttdef"><b>Definition:</b> <a href="blas__cublas_8cu_source.html#l00031">blas_cublas.cu:31</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_legacy_order_html_a27fd815a8bcf9c26feb5d0c2fe397896"><div class="ttname"><a href="structquda_1_1gauge_1_1_legacy_order.html#a27fd815a8bcf9c26feb5d0c2fe397896">quda::gauge::LegacyOrder::Ghost</a></div><div class="ttdeci">__device__ __host__ const gauge_ghost_wrapper&lt; real, Accessor &gt; Ghost(int dim, int ghost_idx, int parity, real phase=1.0) const</div><div class="ttdoc">This accessor routine returns a const gauge_ghost_wrapper to this object, allowing us to overload var...</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02139">gauge_field_order.h:2139</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g656a684b71192f463c0c771174ee66f3_html_a51f356d75603e8422f943acf3eae5501"><div class="ttname"><a href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g656a684b71192f463c0c771174ee66f3.html#a51f356d75603e8422f943acf3eae5501">quda::gauge::GhostAccessor&lt; Float, nColor, QUDA_MILC_GAUGE_ORDER, native_ghost, storeFloat, use_tex &gt;::resetScale</a></div><div class="ttdeci">void resetScale(Float max)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00650">gauge_field_order.h:650</a></div></div>
<div class="ttc" id="structquda_1_1complex_3_01short_01_4_html_a9240d517dba02ea9c9f28d0045468d21"><div class="ttname"><a href="structquda_1_1complex_3_01short_01_4.html#a9240d517dba02ea9c9f28d0045468d21">quda::complex&lt; short &gt;::real</a></div><div class="ttdeci">__host__ __device__ short real() const volatile</div><div class="ttdef"><b>Definition:</b> <a href="complex__quda_8h_source.html#l00786">complex_quda.h:786</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_m_i_l_c_order_html_a2df3d286e0ad7cda68c209b5d549c8ad"><div class="ttname"><a href="structquda_1_1gauge_1_1_m_i_l_c_order.html#a2df3d286e0ad7cda68c209b5d549c8ad">quda::gauge::MILCOrder::geometry</a></div><div class="ttdeci">const int geometry</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02338">gauge_field_order.h:2338</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_q_d_p_j_i_t_order_html_a94f3bb60a5aeb2d8f7e18c2dafaccc6b"><div class="ttname"><a href="structquda_1_1gauge_1_1_q_d_p_j_i_t_order.html#a94f3bb60a5aeb2d8f7e18c2dafaccc6b">quda::gauge::QDPJITOrder::volumeCB</a></div><div class="ttdeci">const int volumeCB</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02271">gauge_field_order.h:2271</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_c_p_s_order_html_a9fdb177eb208c86b096fab5d74698429"><div class="ttname"><a href="structquda_1_1gauge_1_1_c_p_s_order.html#a9fdb177eb208c86b096fab5d74698429">quda::gauge::CPSOrder::geometry</a></div><div class="ttdeci">const int geometry</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02540">gauge_field_order.h:2540</a></div></div>
<div class="ttc" id="structquda_1_1gauge__wrapper_html_a5261c5f7423edd78086a027390e11983"><div class="ttname"><a href="structquda_1_1gauge__wrapper.html#a5261c5f7423edd78086a027390e11983">quda::gauge_wrapper::x_cb</a></div><div class="ttdeci">const int x_cb</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00046">gauge_field_order.h:46</a></div></div>
<div class="ttc" id="structquda_1_1gauge__ghost__wrapper_html_a8ec61c40527b2a2d94d3cf511e97034f"><div class="ttname"><a href="structquda_1_1gauge__ghost__wrapper.html#a8ec61c40527b2a2d94d3cf511e97034f">quda::gauge_ghost_wrapper::parity</a></div><div class="ttdeci">const int parity</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00112">gauge_field_order.h:112</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e_0851bfc944ce664513b027bdb1e7938b_html_a755409bb96206d814e9b2025961a9cfc"><div class="ttname"><a href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e_0851bfc944ce664513b027bdb1e7938b.html#a755409bb96206d814e9b2025961a9cfc">quda::gauge::Accessor&lt; Float, nColor, QUDA_FLOAT2_GAUGE_ORDER, storeFloat, use_tex &gt;::operator()</a></div><div class="ttdeci">__device__ __host__ fieldorder_wrapper&lt; Float, storeFloat &gt; operator()(int dim, int parity, int x_cb, int row, int col)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00755">gauge_field_order.h:755</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_t_i_f_r_order_html_a0a067282a203366c05124f3589c4e8b8"><div class="ttname"><a href="structquda_1_1gauge_1_1_t_i_f_r_order.html#a0a067282a203366c05124f3589c4e8b8">quda::gauge::TIFROrder::scale</a></div><div class="ttdeci">const real scale</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02751">gauge_field_order.h:2751</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_2b6e6ca5a27266b35ef9c885a15f8294_html"><div class="ttname"><a href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_2b6e6ca5a27266b35ef9c885a15f8294.html">quda::gauge::GhostAccessor&lt; Float, nColor, QUDA_FLOAT2_GAUGE_ORDER, native_ghost, storeFloat, use_tex &gt;</a></div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00817">gauge_field_order.h:817</a></div></div>
<div class="ttc" id="structquda_1_1gauge__mapper_3_01short_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__8_00_01_n_00_01stagf6d13b3f3009dd8eae09254d0b962822_html_a2dafbcdef82d5038b5cb70330f90fb4c"><div class="ttname"><a href="structquda_1_1gauge__mapper_3_01short_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__8_00_01_n_00_01stagf6d13b3f3009dd8eae09254d0b962822.html#a2dafbcdef82d5038b5cb70330f90fb4c">quda::gauge_mapper&lt; short, QUDA_RECONSTRUCT_8, N, stag, huge_alloc, ghostExchange, use_inphase &gt;::type</a></div><div class="ttdeci">gauge::FloatNOrder&lt; short, N, 4, 8, stag, huge_alloc, ghostExchange, use_inphase &gt; type</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l03090">gauge_field_order.h:3090</a></div></div>
<div class="ttc" id="trove__helper_8cuh_html"><div class="ttname"><a href="trove__helper_8cuh.html">trove_helper.cuh</a></div></div>
<div class="ttc" id="malloc__quda_8h_html_a45d92b2c2231b848192b3086283d05b6"><div class="ttname"><a href="malloc__quda_8h.html#a45d92b2c2231b848192b3086283d05b6">safe_malloc</a></div><div class="ttdeci">#define safe_malloc(size)</div><div class="ttdef"><b>Definition:</b> <a href="malloc__quda_8h_source.html#l00066">malloc_quda.h:66</a></div></div>
<div class="ttc" id="enum__quda_8h_html_a2f13fac18d6933e9e21bc1cf2737b21aa9bd154ebe1a472f43b8b448fe832b3d7"><div class="ttname"><a href="enum__quda_8h.html#a2f13fac18d6933e9e21bc1cf2737b21aa9bd154ebe1a472f43b8b448fe832b3d7">QUDA_STAGGERED_PHASE_CPS</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00491">enum_quda.h:491</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e_0851bfc944ce664513b027bdb1e7938b_html_a022df6630cc60bde40bf21eaabb840eb"><div class="ttname"><a href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e_0851bfc944ce664513b027bdb1e7938b.html#a022df6630cc60bde40bf21eaabb840eb">quda::gauge::Accessor&lt; Float, nColor, QUDA_FLOAT2_GAUGE_ORDER, storeFloat, use_tex &gt;::offset_cb</a></div><div class="ttdeci">const int offset_cb</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00685">gauge_field_order.h:685</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_accessor_html_a897edbafac524e14ca64c32de0fa10d2"><div class="ttname"><a href="structquda_1_1gauge_1_1_accessor.html#a897edbafac524e14ca64c32de0fa10d2">quda::gauge::Accessor::operator()</a></div><div class="ttdeci">__device__ __host__ complex&lt; Float &gt; &amp; operator()(int d, int parity, int x, int row, int col) const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00350">gauge_field_order.h:350</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4_html_ae54e5ddde4d5d39e65bbd4232fb380ba"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#ae54e5ddde4d5d39e65bbd4232fb380ba">quda::gauge::Reconstruct&lt; 8, Float, ghostExchange_ &gt;::isFirstTimeSlice</a></div><div class="ttdeci">const bool isFirstTimeSlice</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01452">gauge_field_order.h:1452</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g_e___ob3f8ab569f1b01e2fe1b1e99b6b90783_html_a999469e15e4586cdf5af7b1f00b3db14"><div class="ttname"><a href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g_e___ob3f8ab569f1b01e2fe1b1e99b6b90783.html#a999469e15e4586cdf5af7b1f00b3db14">quda::gauge::Accessor&lt; Float, nColor, QUDA_MILC_GAUGE_ORDER, storeFloat, use_tex &gt;::transform_reduce</a></div><div class="ttdeci">__host__ double transform_reduce(QudaFieldLocation location, int dim, helper h, reducer r, double init) const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00591">gauge_field_order.h:591</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1abs___html_a5f21c54d6532202a3cd9695a0b34c7a1"><div class="ttname"><a href="structquda_1_1gauge_1_1abs__.html#a5f21c54d6532202a3cd9695a0b34c7a1">quda::gauge::abs_::operator()</a></div><div class="ttdeci">__host__ __device__ Float operator()(const quda::complex&lt; storeFloat &gt; &amp;x)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00194">gauge_field_order.h:194</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_q_d_p_order_html_a2e8c9fd778f4b80c302d5832d977fd15"><div class="ttname"><a href="structquda_1_1gauge_1_1_q_d_p_order.html#a2e8c9fd778f4b80c302d5832d977fd15">quda::gauge::QDPOrder::operator()</a></div><div class="ttdeci">__device__ __host__ const gauge_wrapper&lt; real, Accessor &gt; operator()(int dim, int x_cb, int parity) const</div><div class="ttdoc">This accessor routine returns a const gauge_wrapper to this object, allowing us to overload various o...</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02254">gauge_field_order.h:2254</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_float_n_order_html_a2a4a28c18e9ed010f17133086cbda5dc"><div class="ttname"><a href="structquda_1_1gauge_1_1_float_n_order.html#a2a4a28c18e9ed010f17133086cbda5dc">quda::gauge::FloatNOrder::phaseOffset</a></div><div class="ttdeci">const AllocInt phaseOffset</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01719">gauge_field_order.h:1719</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_float_n_order_html_ac79546fdf132f89630f3ffabcac9924a"><div class="ttname"><a href="structquda_1_1gauge_1_1_float_n_order.html#ac79546fdf132f89630f3ffabcac9924a">quda::gauge::FloatNOrder::operator()</a></div><div class="ttdeci">__device__ __host__ const gauge_wrapper&lt; real, Accessor &gt; operator()(int dim, int x_cb, int parity, real phase=1.0) const</div><div class="ttdoc">This accessor routine returns a const gauge_wrapper to this object, allowing us to overload various o...</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01855">gauge_field_order.h:1855</a></div></div>
<div class="ttc" id="namespacequda_1_1gauge_html_ae5f0419c82921aea2f705d4caf7fde57"><div class="ttname"><a href="namespacequda_1_1gauge.html#ae5f0419c82921aea2f705d4caf7fde57">quda::gauge::match</a></div><div class="ttdeci">__host__ __device__ constexpr bool match()</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00223">gauge_field_order.h:223</a></div></div>
<div class="ttc" id="structquda_1_1gauge__ghost__wrapper_html_af95ecc0d2c7cfb0277ddd666c23dfe8f"><div class="ttname"><a href="structquda_1_1gauge__ghost__wrapper.html#af95ecc0d2c7cfb0277ddd666c23dfe8f">quda::gauge_ghost_wrapper::phase</a></div><div class="ttdeci">const Float phase</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00113">gauge_field_order.h:113</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_2b6e6ca5a27266b35ef9c885a15f8294_html_a8c42976dae197feb0a6b8bd1bf5923ed"><div class="ttname"><a href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_2b6e6ca5a27266b35ef9c885a15f8294.html#a8c42976dae197feb0a6b8bd1bf5923ed">quda::gauge::GhostAccessor&lt; Float, nColor, QUDA_FLOAT2_GAUGE_ORDER, native_ghost, storeFloat, use_tex &gt;::resetScale</a></div><div class="ttdeci">void resetScale(Float max)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00849">gauge_field_order.h:849</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_t_i_f_r_padded_order_html_af3b12b99f8643201034124af23afe979"><div class="ttname"><a href="structquda_1_1gauge_1_1_t_i_f_r_padded_order.html#af3b12b99f8643201034124af23afe979">quda::gauge::TIFRPaddedOrder::volumeCB</a></div><div class="ttdeci">const int volumeCB</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02854">gauge_field_order.h:2854</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_c_p_s_order_html_a3e0cac228ff44cffae9f481ea77767b2"><div class="ttname"><a href="structquda_1_1gauge_1_1_c_p_s_order.html#a3e0cac228ff44cffae9f481ea77767b2">quda::gauge::CPSOrder::save</a></div><div class="ttdeci">__device__ __host__ void save(const complex v[9], int x, int dir, int parity)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02579">gauge_field_order.h:2579</a></div></div>
<div class="ttc" id="enum__quda_8h_html_acb61fdc14d6b12e8c6177b6d966bd863a4ba8fd46dcb8d319a6632eebbe2da32b"><div class="ttname"><a href="enum__quda_8h.html#acb61fdc14d6b12e8c6177b6d966bd863a4ba8fd46dcb8d319a6632eebbe2da32b">QUDA_TIFR_GAUGE_ORDER</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00047">enum_quda.h:47</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_q_d_p_j_i_t_order_html_a1f6aea06e7f3b74ea251d5979ef4bed0"><div class="ttname"><a href="structquda_1_1gauge_1_1_q_d_p_j_i_t_order.html#a1f6aea06e7f3b74ea251d5979ef4bed0">quda::gauge::QDPJITOrder::Bytes</a></div><div class="ttdeci">size_t Bytes() const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02325">gauge_field_order.h:2325</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_m_i_l_c_site_order_html_aa7833e2076587b80d3154fd60bc8dbb3"><div class="ttname"><a href="structquda_1_1gauge_1_1_m_i_l_c_site_order.html#aa7833e2076587b80d3154fd60bc8dbb3">quda::gauge::MILCSiteOrder::operator()</a></div><div class="ttdeci">__device__ __host__ gauge_wrapper&lt; real, Accessor &gt; operator()(int dim, int x_cb, int parity)</div><div class="ttdoc">This accessor routine returns a gauge_wrapper to this object, allowing us to overload various operato...</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02503">gauge_field_order.h:2503</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_field_order_html_a0834f59ac8a421ac7959b3a395183923"><div class="ttname"><a href="structquda_1_1gauge_1_1_field_order.html#a0834f59ac8a421ac7959b3a395183923">quda::gauge::FieldOrder::norm1</a></div><div class="ttdeci">__host__ double norm1(int dim=-1, bool global=true) const</div><div class="ttdoc">Returns the L1 norm of the field in a given dimension. </div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01069">gauge_field_order.h:1069</a></div></div>
<div class="ttc" id="structquda_1_1gauge__mapper_3_01float_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__9_00_01_n_00_01stag7e92965b2032902f71786a0b5036e623_html_acf515d453afc6ecf459989eba9762391"><div class="ttname"><a href="structquda_1_1gauge__mapper_3_01float_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__9_00_01_n_00_01stag7e92965b2032902f71786a0b5036e623.html#acf515d453afc6ecf459989eba9762391">quda::gauge_mapper&lt; float, QUDA_RECONSTRUCT_9, N, stag, huge_alloc, ghostExchange, use_inphase &gt;::type</a></div><div class="ttdeci">gauge::FloatNOrder&lt; float, N, 4, 9, stag, huge_alloc, ghostExchange, use_inphase &gt; type</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l03060">gauge_field_order.h:3060</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1abs___3_01_float_00_01int_01_4_html_a00116b96fe619e00716d1695c6f1a055"><div class="ttname"><a href="structquda_1_1gauge_1_1abs___3_01_float_00_01int_01_4.html#a00116b96fe619e00716d1695c6f1a055">quda::gauge::abs_&lt; Float, int &gt;::operator()</a></div><div class="ttdeci">__host__ __device__ Float operator()(const quda::complex&lt; int &gt; &amp;x)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00214">gauge_field_order.h:214</a></div></div>
<div class="ttc" id="namespacequda_html_a070af9181985dd8169b9b5c9eebe65bf"><div class="ttname"><a href="namespacequda.html#a070af9181985dd8169b9b5c9eebe65bf">quda::cmul</a></div><div class="ttdeci">__host__ __device__ complex&lt; real &gt; cmul(const complex&lt; real &gt; &amp;x, const complex&lt; real &gt; &amp;y)</div><div class="ttdef"><b>Definition:</b> <a href="complex__quda_8h_source.html#l01361">complex_quda.h:1361</a></div></div>
<div class="ttc" id="classquda_1_1_lattice_field_html_a644c9306ed8f513cdb2c88c755e305d8"><div class="ttname"><a href="classquda_1_1_lattice_field.html#a644c9306ed8f513cdb2c88c755e305d8">quda::LatticeField::Location</a></div><div class="ttdeci">QudaFieldLocation Location() const</div><div class="ttdef"><b>Definition:</b> <a href="lattice__field_8cpp_source.html#l00660">lattice_field.cpp:660</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_legacy_order_html_afd5abf19c6706a4b8f1e940b4bad491b"><div class="ttname"><a href="structquda_1_1gauge_1_1_legacy_order.html#afd5abf19c6706a4b8f1e940b4bad491b">quda::gauge::LegacyOrder::LegacyOrder</a></div><div class="ttdeci">LegacyOrder(const GaugeField &amp;u, Float **ghost_)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02054">gauge_field_order.h:2054</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_legacy_order_html"><div class="ttname"><a href="structquda_1_1gauge_1_1_legacy_order.html">quda::gauge::LegacyOrder</a></div><div class="ttdoc">The LegacyOrder defines the ghost zone storage and ordering for all cpuGaugeFields, which use the same ghost zone storage. </div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02043">gauge_field_order.h:2043</a></div></div>
<div class="ttc" id="structquda_1_1gauge__wrapper_html_a33ab2df64bb0f2ec610bd35b4fccf1f3"><div class="ttname"><a href="structquda_1_1gauge__wrapper.html#a33ab2df64bb0f2ec610bd35b4fccf1f3">quda::gauge_wrapper::dim</a></div><div class="ttdeci">const int dim</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00045">gauge_field_order.h:45</a></div></div>
<div class="ttc" id="structquda_1_1gauge__mapper_3_01short_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__12_00_01_n_00_01sta68ba267ce7fdb075b65222ebaa0558ed_html_a2cec2cb6ab207f633b554cfdcfccded8"><div class="ttname"><a href="structquda_1_1gauge__mapper_3_01short_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__12_00_01_n_00_01sta68ba267ce7fdb075b65222ebaa0558ed.html#a2cec2cb6ab207f633b554cfdcfccded8">quda::gauge_mapper&lt; short, QUDA_RECONSTRUCT_12, N, stag, huge_alloc, ghostExchange, use_inphase &gt;::type</a></div><div class="ttdeci">gauge::FloatNOrder&lt; short, N, 4, 12, stag, huge_alloc, ghostExchange, use_inphase &gt; type</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l03078">gauge_field_order.h:3078</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_float_n_order_html_a6351fb6fa9f56d2777e35c172db1f233"><div class="ttname"><a href="structquda_1_1gauge_1_1_float_n_order.html#a6351fb6fa9f56d2777e35c172db1f233">quda::gauge::FloatNOrder::FloatNOrder</a></div><div class="ttdeci">FloatNOrder(const GaugeField &amp;u, Float *gauge_=0, Float **ghost_=0, bool override=false)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01723">gauge_field_order.h:1723</a></div></div>
<div class="ttc" id="enum__quda_8h_html_a5cc304be12bc9174274636e1e7863841aad305d7711f78203e925196a6d92bc7b"><div class="ttname"><a href="enum__quda_8h.html#a5cc304be12bc9174274636e1e7863841aad305d7711f78203e925196a6d92bc7b">QUDA_RECONSTRUCT_8</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00069">enum_quda.h:69</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_field_order_html_ad309ae448854ae83522584bcd04bf79f"><div class="ttname"><a href="structquda_1_1gauge_1_1_field_order.html#ad309ae448854ae83522584bcd04bf79f">quda::gauge::FieldOrder::Ghost</a></div><div class="ttdeci">__device__ __host__ complex&lt; Float &gt; Ghost(int d, int parity, int x, int s_row, int s_col, int c_row, int c_col) const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01017">gauge_field_order.h:1017</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1square___3_01_reduce_type_00_01int_01_4_html_a0673da2a17293bfa08f73f188db78ff8"><div class="ttname"><a href="structquda_1_1gauge_1_1square___3_01_reduce_type_00_01int_01_4.html#a0673da2a17293bfa08f73f188db78ff8">quda::gauge::square_&lt; ReduceType, int &gt;::operator()</a></div><div class="ttdeci">__host__ __device__ ReduceType operator()(const quda::complex&lt; int &gt; &amp;x)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00188">gauge_field_order.h:188</a></div></div>
<div class="ttc" id="comm__common_8cpp_html_a9050542b1bb11f6418bae82e3ef4c192"><div class="ttname"><a href="comm__common_8cpp.html#a9050542b1bb11f6418bae82e3ef4c192">index</a></div><div class="ttdeci">static int index(int ndim, const int *dims, const int *x)</div><div class="ttdef"><b>Definition:</b> <a href="comm__common_8cpp_source.html#l00032">comm_common.cpp:32</a></div></div>
<div class="ttc" id="structquda_1_1gauge__order__mapper_3_01_t_00_01_q_u_d_a___m_i_l_c___g_a_u_g_e___o_r_d_e_r_00_01_nc_01_4_html_a21cfb170d60f63fd1ac6f22194cb597f"><div class="ttname"><a href="structquda_1_1gauge__order__mapper_3_01_t_00_01_q_u_d_a___m_i_l_c___g_a_u_g_e___o_r_d_e_r_00_01_nc_01_4.html#a21cfb170d60f63fd1ac6f22194cb597f">quda::gauge_order_mapper&lt; T, QUDA_MILC_GAUGE_ORDER, Nc &gt;::type</a></div><div class="ttdeci">gauge::MILCOrder&lt; T, 2 *Nc *Nc &gt; type</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l03122">gauge_field_order.h:3122</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_html_adb17cb7fb63831b2d88e784be6f9c30f"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct.html#adb17cb7fb63831b2d88e784be6f9c30f">quda::gauge::Reconstruct::Pack</a></div><div class="ttdeci">__device__ __host__ void Pack(real out[N], const complex in[N/2], int idx) const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01135">gauge_field_order.h:1135</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g656a684b71192f463c0c771174ee66f3_html_adb76f7afde16a18a6184b7612bc0cde8"><div class="ttname"><a href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g656a684b71192f463c0c771174ee66f3.html#adb76f7afde16a18a6184b7612bc0cde8">quda::gauge::GhostAccessor&lt; Float, nColor, QUDA_MILC_GAUGE_ORDER, native_ghost, storeFloat, use_tex &gt;::operator()</a></div><div class="ttdeci">__device__ __host__ complex&lt; Float &gt; operator()(int d, int parity, int x, int row, int col) const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00657">gauge_field_order.h:657</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_q_d_p_j_i_t_order_html_a65fa1c01c65f133fed67d54038a148f2"><div class="ttname"><a href="structquda_1_1gauge_1_1_q_d_p_j_i_t_order.html#a65fa1c01c65f133fed67d54038a148f2">quda::gauge::QDPJITOrder::operator()</a></div><div class="ttdeci">__device__ __host__ const gauge_wrapper&lt; real, Accessor &gt; operator()(int dim, int x_cb, int parity) const</div><div class="ttdoc">This accessor routine returns a const gauge_wrapper to this object, allowing us to overload various o...</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02320">gauge_field_order.h:2320</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_edba98cba7f194488e42e7a830abb1e97_html_a36b586e2960b6da3e8b7ec321e7512f3"><div class="ttname"><a href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_edba98cba7f194488e42e7a830abb1e97.html#a36b586e2960b6da3e8b7ec321e7512f3">quda::gauge::GhostAccessor&lt; Float, nColor, QUDA_QDP_GAUGE_ORDER, native_ghost, storeFloat, use_tex &gt;::ghostOffset</a></div><div class="ttdeci">int ghostOffset[8]</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00470">gauge_field_order.h:470</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e_0851bfc944ce664513b027bdb1e7938b_html_a70058aa340a3f815a40b346f01b72cf2"><div class="ttname"><a href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e_0851bfc944ce664513b027bdb1e7938b.html#a70058aa340a3f815a40b346f01b72cf2">quda::gauge::Accessor&lt; Float, nColor, QUDA_FLOAT2_GAUGE_ORDER, storeFloat, use_tex &gt;::operator()</a></div><div class="ttdeci">__device__ __host__ const complex&lt; Float &gt; operator()(int dim, int parity, int x_cb, int row, int col) const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00733">gauge_field_order.h:733</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_q_d_p_j_i_t_order_html_aa787d2389aeded95c0e097edc2421259"><div class="ttname"><a href="structquda_1_1gauge_1_1_q_d_p_j_i_t_order.html#aa787d2389aeded95c0e097edc2421259">quda::gauge::QDPJITOrder::gauge</a></div><div class="ttdeci">Float * gauge[QUDA_MAX_DIM]</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02270">gauge_field_order.h:2270</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4_html_a2eabfa36a5c974452f51a6d1b4199649"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#a2eabfa36a5c974452f51a6d1b4199649">quda::gauge::Reconstruct&lt; 8, Float, ghostExchange_ &gt;::Unpack</a></div><div class="ttdeci">__device__ __host__ void Unpack(complex out[9], const real in[8], int idx, int dir, real phase, const I *X, const int *R, const complex scale, const complex u) const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01491">gauge_field_order.h:1491</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4_html_addf40187cfe25214cd310c836ba93406"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4.html#addf40187cfe25214cd310c836ba93406">quda::gauge::Reconstruct&lt; 12, Float, ghostExchange_ &gt;::ghostExchange</a></div><div class="ttdeci">QudaGhostExchange ghostExchange</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01239">gauge_field_order.h:1239</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_float_n_order_html_a31c0e2c4fd5a86b78793669c28143b3f"><div class="ttname"><a href="structquda_1_1gauge_1_1_float_n_order.html#a31c0e2c4fd5a86b78793669c28143b3f">quda::gauge::FloatNOrder::bytes</a></div><div class="ttdeci">size_t bytes</div><div class="ttdoc">host memory for backing up the field when tuning </div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01721">gauge_field_order.h:1721</a></div></div>
<div class="ttc" id="quda__matrix_8h_html"><div class="ttname"><a href="quda__matrix_8h.html">quda_matrix.h</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4_html_a513cee707f5e19c80a4c066a96573e1b"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#a513cee707f5e19c80a4c066a96573e1b">quda::gauge::Reconstruct&lt; 8, Float, ghostExchange_ &gt;::Reconstruct</a></div><div class="ttdeci">Reconstruct(const Reconstruct&lt; 8, Float, ghostExchange_ &gt; &amp;recon)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01468">gauge_field_order.h:1468</a></div></div>
<div class="ttc" id="enum__quda_8h_html_a7e07bc0f2e37ab1df05cd3c87017ff33"><div class="ttname"><a href="enum__quda_8h.html#a7e07bc0f2e37ab1df05cd3c87017ff33">QudaFieldLocation</a></div><div class="ttdeci">enum QudaFieldLocation_s QudaFieldLocation</div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_accessor_html"><div class="ttname"><a href="structquda_1_1gauge_1_1_accessor.html">quda::gauge::Accessor</a></div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00342">gauge_field_order.h:342</a></div></div>
<div class="ttc" id="structquda_1_1is_fixed_html"><div class="ttname"><a href="structquda_1_1is_fixed.html">quda::isFixed</a></div><div class="ttdef"><b>Definition:</b> <a href="register__traits_8h_source.html#l00144">register_traits.h:144</a></div></div>
<div class="ttc" id="index__helper_8cuh_html"><div class="ttname"><a href="index__helper_8cuh.html">index_helper.cuh</a></div></div>
<div class="ttc" id="structquda_1_1complex_3_01float_01_4_html_aa16dbca5ee984cd8edf468303374d8a3"><div class="ttname"><a href="structquda_1_1complex_3_01float_01_4.html#aa16dbca5ee984cd8edf468303374d8a3">quda::complex&lt; float &gt;::operator=</a></div><div class="ttdeci">__host__ __device__ volatile complex&lt; float &gt; &amp; operator=(const complex&lt; T &gt; z) volatile</div><div class="ttdef"><b>Definition:</b> <a href="complex__quda_8h_source.html#l00491">complex_quda.h:491</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_legacy_order_html_a345cb1bedd8061a2e2fb2790024f4ea3"><div class="ttname"><a href="structquda_1_1gauge_1_1_legacy_order.html#a345cb1bedd8061a2e2fb2790024f4ea3">quda::gauge::LegacyOrder::faceVolumeCB</a></div><div class="ttdeci">int faceVolumeCB[QUDA_MAX_DIM]</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02048">gauge_field_order.h:2048</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_2b6e6ca5a27266b35ef9c885a15f8294_html_a259b3e76e5a7da33afff80b81a8c138e"><div class="ttname"><a href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_2b6e6ca5a27266b35ef9c885a15f8294.html#a259b3e76e5a7da33afff80b81a8c138e">quda::gauge::GhostAccessor&lt; Float, nColor, QUDA_FLOAT2_GAUGE_ORDER, native_ghost, storeFloat, use_tex &gt;::volumeCB</a></div><div class="ttdeci">const int volumeCB</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00819">gauge_field_order.h:819</a></div></div>
<div class="ttc" id="staggered__invert__test_8cpp_html_af3806a0fd9f2d8dd7a627e9571984d33"><div class="ttname"><a href="staggered__invert__test_8cpp.html#af3806a0fd9f2d8dd7a627e9571984d33">out</a></div><div class="ttdeci">cpuColorSpinorField * out</div><div class="ttdef"><b>Definition:</b> <a href="staggered__invert__test_8cpp_source.html#l00099">staggered_invert_test.cpp:99</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_3_0113_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4_html_a2d8ebea8d3240a6f044d8cf0d81283a1"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct_3_0113_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a2d8ebea8d3240a6f044d8cf0d81283a1">quda::gauge::Reconstruct&lt; 13, Float, ghostExchange_, stag_phase &gt;::scale_inv</a></div><div class="ttdeci">const real scale_inv</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01367">gauge_field_order.h:1367</a></div></div>
<div class="ttc" id="atomic_8cuh_html"><div class="ttname"><a href="atomic_8cuh.html">atomic.cuh</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_b_q_c_d_order_html_ac8835f13d5c6a60d0708176ff549806f"><div class="ttname"><a href="structquda_1_1gauge_1_1_b_q_c_d_order.html#ac8835f13d5c6a60d0708176ff549806f">quda::gauge::BQCDOrder::BQCDOrder</a></div><div class="ttdeci">BQCDOrder(const BQCDOrder &amp;order)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02660">gauge_field_order.h:2660</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_3_0113_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4_html_a4f0e2bdac011b25978743b522dc4f5a1"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct_3_0113_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a4f0e2bdac011b25978743b522dc4f5a1">quda::gauge::Reconstruct&lt; 13, Float, ghostExchange_, stag_phase &gt;::reconstruct_12</a></div><div class="ttdeci">const Reconstruct&lt; 12, Float, ghostExchange_ &gt; reconstruct_12</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01365">gauge_field_order.h:1365</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_3_0111_00_01_float_00_01ghost_exchange___01_4_html_af4aae736c3ca00f5398a0f1fe475f9a3"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct_3_0111_00_01_float_00_01ghost_exchange___01_4.html#af4aae736c3ca00f5398a0f1fe475f9a3">quda::gauge::Reconstruct&lt; 11, Float, ghostExchange_ &gt;::Reconstruct</a></div><div class="ttdeci">Reconstruct(const GaugeField &amp;u)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01317">gauge_field_order.h:1317</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4_html_af34ae991d49d251efb5884712e6b5906"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#af34ae991d49d251efb5884712e6b5906">quda::gauge::Reconstruct&lt; 8, Float, ghostExchange_ &gt;::lastTimeSliceBound</a></div><div class="ttdeci">const int lastTimeSliceBound</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01451">gauge_field_order.h:1451</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4_html_ae0365c6690ab9549435991d8473cf4be"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4.html#ae0365c6690ab9549435991d8473cf4be">quda::gauge::Reconstruct&lt; 12, Float, ghostExchange_ &gt;::complex</a></div><div class="ttdeci">complex&lt; real &gt; complex</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01232">gauge_field_order.h:1232</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_float_n_order_html_afb469c92c368773342cbbed0c33a72b7"><div class="ttname"><a href="structquda_1_1gauge_1_1_float_n_order.html#afb469c92c368773342cbbed0c33a72b7">quda::gauge::FloatNOrder::Vector</a></div><div class="ttdeci">VectorType&lt; Float, N &gt;::type Vector</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01698">gauge_field_order.h:1698</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_3_019_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4_html_ac46126e8b4a9441eb4f828f56e5fa27a"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct_3_019_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#ac46126e8b4a9441eb4f828f56e5fa27a">quda::gauge::Reconstruct&lt; 9, Float, ghostExchange_, stag_phase &gt;::real</a></div><div class="ttdeci">typename mapper&lt; Float &gt;::type real</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01587">gauge_field_order.h:1587</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_2b6e6ca5a27266b35ef9c885a15f8294_html_a918d1b8895a4c608b803ae642ba5e9b0"><div class="ttname"><a href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_2b6e6ca5a27266b35ef9c885a15f8294.html#a918d1b8895a4c608b803ae642ba5e9b0">quda::gauge::GhostAccessor&lt; Float, nColor, QUDA_FLOAT2_GAUGE_ORDER, native_ghost, storeFloat, use_tex &gt;::scale_inv</a></div><div class="ttdeci">Float scale_inv</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00822">gauge_field_order.h:822</a></div></div>
<div class="ttc" id="namespacequda_1_1gauge_html_af89ff4791ae99da9af05ebc95b2ec1b4"><div class="ttname"><a href="namespacequda_1_1gauge.html#af89ff4791ae99da9af05ebc95b2ec1b4">quda::gauge::fixed_point</a></div><div class="ttdeci">__host__ __device__ constexpr bool fixed_point()</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00218">gauge_field_order.h:218</a></div></div>
<div class="ttc" id="structquda_1_1complex_3_01char_01_4_html_a97ebd156203c91b2f6d127f19b2faf6a"><div class="ttname"><a href="structquda_1_1complex_3_01char_01_4.html#a97ebd156203c91b2f6d127f19b2faf6a">quda::complex&lt; char &gt;::imag</a></div><div class="ttdeci">__host__ __device__ char imag() const volatile</div><div class="ttdef"><b>Definition:</b> <a href="complex__quda_8h_source.html#l00740">complex_quda.h:740</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g_e___ob3f8ab569f1b01e2fe1b1e99b6b90783_html"><div class="ttname"><a href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g_e___ob3f8ab569f1b01e2fe1b1e99b6b90783.html">quda::gauge::Accessor&lt; Float, nColor, QUDA_MILC_GAUGE_ORDER, storeFloat, use_tex &gt;</a></div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00522">gauge_field_order.h:522</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_float_n_order_html_ae0d16430a371cf6fbbe60e131f1f9959"><div class="ttname"><a href="structquda_1_1gauge_1_1_float_n_order.html#ae0d16430a371cf6fbbe60e131f1f9959">quda::gauge::FloatNOrder::faceVolumeCB</a></div><div class="ttdeci">int faceVolumeCB[4]</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01716">gauge_field_order.h:1716</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_legacy_order_html_a74cb938c3e9438d4100efb0bd755c142"><div class="ttname"><a href="structquda_1_1gauge_1_1_legacy_order.html#a74cb938c3e9438d4100efb0bd755c142">quda::gauge::LegacyOrder::real</a></div><div class="ttdeci">typename mapper&lt; Float &gt;::type real</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02045">gauge_field_order.h:2045</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4_html_ac260178de19871519ee484bb4250f9e5"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#ac260178de19871519ee484bb4250f9e5">quda::gauge::Reconstruct&lt; 8, Float, ghostExchange_ &gt;::firstTimeSliceBound</a></div><div class="ttdeci">const int firstTimeSliceBound</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01450">gauge_field_order.h:1450</a></div></div>
<div class="ttc" id="structquda_1_1mapper_html"><div class="ttname"><a href="structquda_1_1mapper.html">quda::mapper</a></div><div class="ttdef"><b>Definition:</b> <a href="register__traits_8h_source.html#l00043">register_traits.h:43</a></div></div>
<div class="ttc" id="enum__quda_8h_html_a829ee8aa93bd9465811ae1ef9e0eedcc"><div class="ttname"><a href="enum__quda_8h.html#a829ee8aa93bd9465811ae1ef9e0eedcc">QudaReconstructType</a></div><div class="ttdeci">enum QudaReconstructType_s QudaReconstructType</div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_3_0111_00_01_float_00_01ghost_exchange___01_4_html_a357662aa85267630e34d08dbb0d00d30"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct_3_0111_00_01_float_00_01ghost_exchange___01_4.html#a357662aa85267630e34d08dbb0d00d30">quda::gauge::Reconstruct&lt; 11, Float, ghostExchange_ &gt;::Reconstruct</a></div><div class="ttdeci">Reconstruct(const Reconstruct&lt; 11, Float, ghostExchange_ &gt; &amp;recon)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01318">gauge_field_order.h:1318</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_m_i_l_c_site_order_html_adc5f47968b10333baf254379f57a7d42"><div class="ttname"><a href="structquda_1_1gauge_1_1_m_i_l_c_site_order.html#adc5f47968b10333baf254379f57a7d42">quda::gauge::MILCSiteOrder::geometry</a></div><div class="ttdeci">const int geometry</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02432">gauge_field_order.h:2432</a></div></div>
<div class="ttc" id="namespacequda_html_a9cc47efb0ccd91ab0c136e82537e8450"><div class="ttname"><a href="namespacequda.html#a9cc47efb0ccd91ab0c136e82537e8450">quda::operator+</a></div><div class="ttdeci">__device__ __host__ ColorSpinor&lt; Float, Nc, Ns &gt; operator+(const ColorSpinor&lt; Float, Nc, Ns &gt; &amp;x, const ColorSpinor&lt; Float, Nc, Ns &gt; &amp;y)</div><div class="ttdoc">ColorSpinor addition operator. </div><div class="ttdef"><b>Definition:</b> <a href="color__spinor_8h_source.html#l01023">color_spinor.h:1023</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_2b6e6ca5a27266b35ef9c885a15f8294_html_a90b6b5bd42dfd2106e6c1d0489dce777"><div class="ttname"><a href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_2b6e6ca5a27266b35ef9c885a15f8294.html#a90b6b5bd42dfd2106e6c1d0489dce777">quda::gauge::GhostAccessor&lt; Float, nColor, QUDA_FLOAT2_GAUGE_ORDER, native_ghost, storeFloat, use_tex &gt;::scale</a></div><div class="ttdeci">Float scale</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00821">gauge_field_order.h:821</a></div></div>
<div class="ttc" id="structquda_1_1_real_type_html"><div class="ttname"><a href="structquda_1_1_real_type.html">quda::RealType</a></div><div class="ttdef"><b>Definition:</b> <a href="float__vector_8h_source.html#l00312">float_vector.h:312</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_html_aa79bdab5a60b084dfd2c9d0856956bad"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct.html#aa79bdab5a60b084dfd2c9d0856956bad">quda::gauge::Reconstruct::Unpack</a></div><div class="ttdeci">__device__ __host__ void Unpack(complex out[N/2], const real in[N], int idx, int dir, real phase, const I *X, const int *R) const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01153">gauge_field_order.h:1153</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_float_n_order_html_acebff5cb90da9c2082179b1d0e55ca00"><div class="ttname"><a href="structquda_1_1gauge_1_1_float_n_order.html#acebff5cb90da9c2082179b1d0e55ca00">quda::gauge::FloatNOrder::operator()</a></div><div class="ttdeci">__device__ __host__ gauge_wrapper&lt; real, Accessor &gt; operator()(int dim, int x_cb, int parity, real phase=1.0)</div><div class="ttdoc">This accessor routine returns a gauge_wrapper to this object, allowing us to overload various operato...</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01840">gauge_field_order.h:1840</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g656a684b71192f463c0c771174ee66f3_html_ad3bd419947b7028251150a41df91e3b7"><div class="ttname"><a href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g656a684b71192f463c0c771174ee66f3.html#ad3bd419947b7028251150a41df91e3b7">quda::gauge::GhostAccessor&lt; Float, nColor, QUDA_MILC_GAUGE_ORDER, native_ghost, storeFloat, use_tex &gt;::operator()</a></div><div class="ttdeci">__device__ __host__ fieldorder_wrapper&lt; Float, storeFloat &gt; operator()(int d, int parity, int x, int row, int col)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00667">gauge_field_order.h:667</a></div></div>
<div class="ttc" id="structquda_1_1gauge__mapper_html"><div class="ttname"><a href="structquda_1_1gauge__mapper.html">quda::gauge_mapper</a></div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l03012">gauge_field_order.h:3012</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_field_order_html_a6bf3d91a966b6d7e5ea97f99e4776b6b"><div class="ttname"><a href="structquda_1_1gauge_1_1_field_order.html#a6bf3d91a966b6d7e5ea97f99e4776b6b">quda::gauge::FieldOrder::nDim</a></div><div class="ttdeci">const int nDim</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00900">gauge_field_order.h:900</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_float_n_order_html_a073d8b12b5cfc55cbd06311cda5b5581"><div class="ttname"><a href="structquda_1_1gauge_1_1_float_n_order.html#a073d8b12b5cfc55cbd06311cda5b5581">quda::gauge::FloatNOrder::Ghost</a></div><div class="ttdeci">__device__ __host__ gauge_ghost_wrapper&lt; real, Accessor &gt; Ghost(int dim, int ghost_idx, int parity, real phase=1.0)</div><div class="ttdoc">This accessor routine returns a gauge_ghost_wrapper to this object, allowing us to overload various o...</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01931">gauge_field_order.h:1931</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_field_order_html_a62e60a688a5ede4e961eb88d8c9f9367"><div class="ttname"><a href="structquda_1_1gauge_1_1_field_order.html#a62e60a688a5ede4e961eb88d8c9f9367">quda::gauge::FieldOrder::Ghost</a></div><div class="ttdeci">__device__ __host__ fieldorder_wrapper&lt; Float, storeFloat &gt; Ghost(int d, int parity, int x, int s_row, int s_col, int c_row, int c_col)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01033">gauge_field_order.h:1033</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_3_019_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4_html"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct_3_019_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html">quda::gauge::Reconstruct&lt; 9, Float, ghostExchange_, stag_phase &gt;</a></div><div class="ttdoc">Gauge reconstruct 9 helper where we reconstruct the gauge matrix from 8 packed elements (maximal comp...</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01586">gauge_field_order.h:1586</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_field_order_html_a49b862341d83841592fa206ff1875c4e"><div class="ttname"><a href="structquda_1_1gauge_1_1_field_order.html#a49b862341d83841592fa206ff1875c4e">quda::gauge::FieldOrder::geometry</a></div><div class="ttdeci">const int_fastdiv geometry</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00901">gauge_field_order.h:901</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_m_i_l_c_order_html_a94dc1f1de5a50a5f5368148d475d37be"><div class="ttname"><a href="structquda_1_1gauge_1_1_m_i_l_c_order.html#a94dc1f1de5a50a5f5368148d475d37be">quda::gauge::MILCOrder::gauge</a></div><div class="ttdeci">Float * gauge</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02336">gauge_field_order.h:2336</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1abs___3_01_float_00_01short_01_4_html_abb578d85c0d0211837fca40f12b7cc34"><div class="ttname"><a href="structquda_1_1gauge_1_1abs___3_01_float_00_01short_01_4.html#abb578d85c0d0211837fca40f12b7cc34">quda::gauge::abs_&lt; Float, short &gt;::scale</a></div><div class="ttdeci">Float scale</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00205">gauge_field_order.h:205</a></div></div>
<div class="ttc" id="quda__constants_8h_html_a9d871a1cba105d90eed0f3659e1a1766"><div class="ttname"><a href="quda__constants_8h.html#a9d871a1cba105d90eed0f3659e1a1766">QUDA_MAX_GEOMETRY</a></div><div class="ttdeci">#define QUDA_MAX_GEOMETRY</div><div class="ttdoc">Maximum geometry supported by a field. This essentially is the maximum number of dimensions supported...</div><div class="ttdef"><b>Definition:</b> <a href="quda__constants_8h_source.html#l00024">quda_constants.h:24</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1square___3_01_reduce_type_00_01int_01_4_html_a6b10b0f028f7dd86b0f2479baf509ca2"><div class="ttname"><a href="structquda_1_1gauge_1_1square___3_01_reduce_type_00_01int_01_4.html#a6b10b0f028f7dd86b0f2479baf509ca2">quda::gauge::square_&lt; ReduceType, int &gt;::scale</a></div><div class="ttdeci">const ReduceType scale</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00186">gauge_field_order.h:186</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_b_q_c_d_order_html_a5961956a4d13dbade930d81184cbf202"><div class="ttname"><a href="structquda_1_1gauge_1_1_b_q_c_d_order.html#a5961956a4d13dbade930d81184cbf202">quda::gauge::BQCDOrder::Bytes</a></div><div class="ttdeci">size_t Bytes() const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02737">gauge_field_order.h:2737</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4_html_a6f78c7e747d4ef53c41772f778ca2b57"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#a6f78c7e747d4ef53c41772f778ca2b57">quda::gauge::Reconstruct&lt; 8, Float, ghostExchange_ &gt;::real</a></div><div class="ttdeci">typename mapper&lt; Float &gt;::type real</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01446">gauge_field_order.h:1446</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_field_order_html_aae7557b006885d38dc998a105ff5a30d"><div class="ttname"><a href="structquda_1_1gauge_1_1_field_order.html#aae7557b006885d38dc998a105ff5a30d">quda::gauge::FieldOrder::operator()</a></div><div class="ttdeci">__device__ __host__ const complex&lt; Float &gt; operator()(int d, int parity, int x, int s_row, int s_col, int c_row, int c_col) const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00987">gauge_field_order.h:987</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_e___o_r18e8f8cc0cf320665821408416e0c3d7_html"><div class="ttname"><a href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_e___o_r18e8f8cc0cf320665821408416e0c3d7.html">quda::gauge::Accessor&lt; Float, nColor, QUDA_QDP_GAUGE_ORDER, storeFloat, use_tex &gt;</a></div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00370">gauge_field_order.h:370</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_t_i_f_r_order_html_a21a66a7e4408045937ee3a0fecce832d"><div class="ttname"><a href="structquda_1_1gauge_1_1_t_i_f_r_order.html#a21a66a7e4408045937ee3a0fecce832d">quda::gauge::TIFROrder::TIFROrder</a></div><div class="ttdeci">TIFROrder(const GaugeField &amp;u, Float *gauge_=0, Float **ghost_=0)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02753">gauge_field_order.h:2753</a></div></div>
<div class="ttc" id="structquda_1_1gauge__order__mapper_3_01_t_00_01_q_u_d_a___q_d_p_j_i_t___g_a_u_g_e___o_r_d_e_r_00_01_nc_01_4_html_ab398e1804330499a578535f2846b4f4f"><div class="ttname"><a href="structquda_1_1gauge__order__mapper_3_01_t_00_01_q_u_d_a___q_d_p_j_i_t___g_a_u_g_e___o_r_d_e_r_00_01_nc_01_4.html#ab398e1804330499a578535f2846b4f4f">quda::gauge_order_mapper&lt; T, QUDA_QDPJIT_GAUGE_ORDER, Nc &gt;::type</a></div><div class="ttdeci">gauge::QDPJITOrder&lt; T, 2 *Nc *Nc &gt; type</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l03121">gauge_field_order.h:3121</a></div></div>
<div class="ttc" id="enum__quda_8h_html_acb61fdc14d6b12e8c6177b6d966bd863adee3c71246633d4f99b956adbc59c076"><div class="ttname"><a href="enum__quda_8h.html#acb61fdc14d6b12e8c6177b6d966bd863adee3c71246633d4f99b956adbc59c076">QUDA_QDPJIT_GAUGE_ORDER</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00042">enum_quda.h:42</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_t_i_f_r_padded_order_html_afb18d2fa17ef78ffd859ba56b979c36e"><div class="ttname"><a href="structquda_1_1gauge_1_1_t_i_f_r_padded_order.html#afb18d2fa17ef78ffd859ba56b979c36e">quda::gauge::TIFRPaddedOrder::exVolumeCB</a></div><div class="ttdeci">int exVolumeCB</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02855">gauge_field_order.h:2855</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_t_i_f_r_order_html_a47a928e5afbf714d297f30fe09adb475"><div class="ttname"><a href="structquda_1_1gauge_1_1_t_i_f_r_order.html#a47a928e5afbf714d297f30fe09adb475">quda::gauge::TIFROrder::real</a></div><div class="ttdeci">typename mapper&lt; Float &gt;::type real</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02746">gauge_field_order.h:2746</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e_0851bfc944ce664513b027bdb1e7938b_html_aaac76f7fdae0f7d7d82d1aa2368e5d2d"><div class="ttname"><a href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e_0851bfc944ce664513b027bdb1e7938b.html#aaac76f7fdae0f7d7d82d1aa2368e5d2d">quda::gauge::Accessor&lt; Float, nColor, QUDA_FLOAT2_GAUGE_ORDER, storeFloat, use_tex &gt;::Accessor</a></div><div class="ttdeci">Accessor(const GaugeField &amp;U, void *gauge_=0, void **ghost_=0, bool override=false)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00698">gauge_field_order.h:698</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_field_order_html_a0e77b731093ae190daba2d7f534282bd"><div class="ttname"><a href="structquda_1_1gauge_1_1_field_order.html#a0e77b731093ae190daba2d7f534282bd">quda::gauge::FieldOrder::Volume</a></div><div class="ttdeci">__device__ __host__ int Volume() const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01047">gauge_field_order.h:1047</a></div></div>
<div class="ttc" id="enum__quda_8h_html_a2f13fac18d6933e9e21bc1cf2737b21aaef16001e82f5d27acc1087288a42c3ac"><div class="ttname"><a href="enum__quda_8h.html#a2f13fac18d6933e9e21bc1cf2737b21aaef16001e82f5d27acc1087288a42c3ac">QUDA_STAGGERED_PHASE_MILC</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00490">enum_quda.h:490</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4_html_a0cdbcb678c40b0e01b2e54e34e39fdfa"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#a0cdbcb678c40b0e01b2e54e34e39fdfa">quda::gauge::Reconstruct&lt; 8, Float, ghostExchange_ &gt;::ghostExchange</a></div><div class="ttdeci">QudaGhostExchange ghostExchange</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01454">gauge_field_order.h:1454</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1square___3_01_reduce_type_00_01char_01_4_html_a87726f90445cfaa6d6d363b85e273db3"><div class="ttname"><a href="structquda_1_1gauge_1_1square___3_01_reduce_type_00_01char_01_4.html#a87726f90445cfaa6d6d363b85e273db3">quda::gauge::square_&lt; ReduceType, char &gt;::scale</a></div><div class="ttdeci">const ReduceType scale</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00172">gauge_field_order.h:172</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_float_n_order_html_a461472a1690f2a8e2cb2ab78d03b2693"><div class="ttname"><a href="structquda_1_1gauge_1_1_float_n_order.html#a461472a1690f2a8e2cb2ab78d03b2693">quda::gauge::FloatNOrder::load</a></div><div class="ttdeci">__device__ __host__ void load(complex v[length/2], int x, int dir, int parity, real inphase=1.0) const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01769">gauge_field_order.h:1769</a></div></div>
<div class="ttc" id="namespacequda_html_a519e30abf575a4084224e899c730e95f"><div class="ttname"><a href="namespacequda.html#a519e30abf575a4084224e899c730e95f">quda::arg</a></div><div class="ttdeci">__host__ __device__ ValueType arg(const complex&lt; ValueType &gt; &amp;z)</div><div class="ttdoc">Returns the phase angle of z. </div><div class="ttdef"><b>Definition:</b> <a href="complex__quda_8h_source.html#l01076">complex_quda.h:1076</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_ghost_accessor_html"><div class="ttname"><a href="structquda_1_1gauge_1_1_ghost_accessor.html">quda::gauge::GhostAccessor</a></div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00356">gauge_field_order.h:356</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_t_i_f_r_padded_order_html_afffffad0c8404b29410abac78cabec27"><div class="ttname"><a href="structquda_1_1gauge_1_1_t_i_f_r_padded_order.html#afffffad0c8404b29410abac78cabec27">quda::gauge::TIFRPaddedOrder::gauge</a></div><div class="ttdeci">Float * gauge</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02853">gauge_field_order.h:2853</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_c_p_s_order_html_a890d14f24b8df508fe50db28e5cb6693"><div class="ttname"><a href="structquda_1_1gauge_1_1_c_p_s_order.html#a890d14f24b8df508fe50db28e5cb6693">quda::gauge::CPSOrder::anisotropy</a></div><div class="ttdeci">const real anisotropy</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02537">gauge_field_order.h:2537</a></div></div>
<div class="ttc" id="enum__quda_8h_html_a5cc304be12bc9174274636e1e7863841a979c49b45c3a054e53ee1aed9685bc60"><div class="ttname"><a href="enum__quda_8h.html#a5cc304be12bc9174274636e1e7863841a979c49b45c3a054e53ee1aed9685bc60">QUDA_RECONSTRUCT_13</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00071">enum_quda.h:71</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4_html_a71fbea07d9991735c8a338510ec1beb1"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct_3_0112_00_01_float_00_01ghost_exchange___01_4.html#a71fbea07d9991735c8a338510ec1beb1">quda::gauge::Reconstruct&lt; 12, Float, ghostExchange_ &gt;::anisotropy</a></div><div class="ttdeci">const real anisotropy</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01233">gauge_field_order.h:1233</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_3_0111_00_01_float_00_01ghost_exchange___01_4_html_a8ef64635ed0c708b113903b9f3c09be1"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct_3_0111_00_01_float_00_01ghost_exchange___01_4.html#a8ef64635ed0c708b113903b9f3c09be1">quda::gauge::Reconstruct&lt; 11, Float, ghostExchange_ &gt;::real</a></div><div class="ttdeci">typename mapper&lt; Float &gt;::type real</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01314">gauge_field_order.h:1314</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_field_order_html_a445fea7c209fafa7761c91c170ae69f2"><div class="ttname"><a href="structquda_1_1gauge_1_1_field_order.html#a445fea7c209fafa7761c91c170ae69f2">quda::gauge::FieldOrder::Ghost</a></div><div class="ttdeci">__device__ __host__ complex&lt; Float &gt; Ghost(int d, int parity, int x, int row, int col) const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00963">gauge_field_order.h:963</a></div></div>
<div class="ttc" id="classquda_1_1_matrix_html_a30da6eaa2554155c19f632b96bc0f11a"><div class="ttname"><a href="classquda_1_1_matrix.html#a30da6eaa2554155c19f632b96bc0f11a">quda::Matrix::Matrix</a></div><div class="ttdeci">__device__ __host__ Matrix()</div><div class="ttdef"><b>Definition:</b> <a href="quda__matrix_8h_source.html#l00076">quda_matrix.h:76</a></div></div>
<div class="ttc" id="complex__quda_8h_html"><div class="ttname"><a href="complex__quda_8h.html">complex_quda.h</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_b_q_c_d_order_html_aa58d1109e8818be4481232fce9261491"><div class="ttname"><a href="structquda_1_1gauge_1_1_b_q_c_d_order.html#aa58d1109e8818be4481232fce9261491">quda::gauge::BQCDOrder::operator()</a></div><div class="ttdeci">__device__ __host__ const gauge_wrapper&lt; real, Accessor &gt; operator()(int dim, int x_cb, int parity) const</div><div class="ttdoc">This accessor routine returns a const gauge_wrapper to this object, allowing us to overload various o...</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02732">gauge_field_order.h:2732</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_c_p_s_order_html_a1d1337c0164a536b3e6dd6145d44f79d"><div class="ttname"><a href="structquda_1_1gauge_1_1_c_p_s_order.html#a1d1337c0164a536b3e6dd6145d44f79d">quda::gauge::CPSOrder::anisotropy_inv</a></div><div class="ttdeci">const real anisotropy_inv</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02538">gauge_field_order.h:2538</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_field_order_html_a7ce3920601ef919d1cacc0e1eda38ba5"><div class="ttname"><a href="structquda_1_1gauge_1_1_field_order.html#a7ce3920601ef919d1cacc0e1eda38ba5">quda::gauge::FieldOrder::Geometry</a></div><div class="ttdeci">__device__ __host__ int Geometry() const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01056">gauge_field_order.h:1056</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_field_order_html_a6e2082ddcb470b7ee4a2f9c9be152bbe"><div class="ttname"><a href="structquda_1_1gauge_1_1_field_order.html#a6e2082ddcb470b7ee4a2f9c9be152bbe">quda::gauge::FieldOrder::resetScale</a></div><div class="ttdeci">void resetScale(double max)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00926">gauge_field_order.h:926</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_3_0113_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4_html_ad4960075a0d41836f2ac88f4ba720e8f"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct_3_0113_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#ad4960075a0d41836f2ac88f4ba720e8f">quda::gauge::Reconstruct&lt; 13, Float, ghostExchange_, stag_phase &gt;::Unpack</a></div><div class="ttdeci">__device__ __host__ void Unpack(complex out[9], const real in[12], int idx, int dir, real phase, const I *X, const int *R) const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01383">gauge_field_order.h:1383</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g_e___ob3f8ab569f1b01e2fe1b1e99b6b90783_html_ad1a50df3a514e8d1a540b12cf361a5ed"><div class="ttname"><a href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g_e___ob3f8ab569f1b01e2fe1b1e99b6b90783.html#ad1a50df3a514e8d1a540b12cf361a5ed">quda::gauge::Accessor&lt; Float, nColor, QUDA_MILC_GAUGE_ORDER, storeFloat, use_tex &gt;::operator()</a></div><div class="ttdeci">__device__ __host__ fieldorder_wrapper&lt; Float, storeFloat &gt; operator()(int d, int parity, int x, int row, int col)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00559">gauge_field_order.h:559</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_field_order_html_a951cabce05f2275a2b8d72a22ecd8223"><div class="ttname"><a href="structquda_1_1gauge_1_1_field_order.html#a951cabce05f2275a2b8d72a22ecd8223">quda::gauge::FieldOrder::volumeCB</a></div><div class="ttdeci">const int volumeCB</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00899">gauge_field_order.h:899</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_field_order_html_a3c47dab3b4b1df025e15360a74efad79"><div class="ttname"><a href="structquda_1_1gauge_1_1_field_order.html#a3c47dab3b4b1df025e15360a74efad79">quda::gauge::FieldOrder::norm2</a></div><div class="ttdeci">__host__ double norm2(int dim=-1, bool global=true) const</div><div class="ttdoc">Returns the L2 norm squared of the field in a given dimension. </div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01081">gauge_field_order.h:1081</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_t_i_f_r_padded_order_html_a26b85515eb39eb5d5f9f26f3deaadfa7"><div class="ttname"><a href="structquda_1_1gauge_1_1_t_i_f_r_padded_order.html#a26b85515eb39eb5d5f9f26f3deaadfa7">quda::gauge::TIFRPaddedOrder::TIFRPaddedOrder</a></div><div class="ttdeci">TIFRPaddedOrder(const TIFRPaddedOrder &amp;order)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02878">gauge_field_order.h:2878</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_q_d_p_j_i_t_order_html_af4cf567ef342fdf088e58da8b75c7ef6"><div class="ttname"><a href="structquda_1_1gauge_1_1_q_d_p_j_i_t_order.html#af4cf567ef342fdf088e58da8b75c7ef6">quda::gauge::QDPJITOrder::QDPJITOrder</a></div><div class="ttdeci">QDPJITOrder(const GaugeField &amp;u, Float *gauge_=0, Float **ghost_=0)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02272">gauge_field_order.h:2272</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_t_i_f_r_padded_order_html_aea5cb071eb8c078550d6c1380984dca6"><div class="ttname"><a href="structquda_1_1gauge_1_1_t_i_f_r_padded_order.html#aea5cb071eb8c078550d6c1380984dca6">quda::gauge::TIFRPaddedOrder::load</a></div><div class="ttdeci">__device__ __host__ void load(complex v[9], int x, int dir, int parity, real inphase=1.0) const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02906">gauge_field_order.h:2906</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_field_order_html_a22c0550dd86878879a57995d425d3293"><div class="ttname"><a href="structquda_1_1gauge_1_1_field_order.html#a22c0550dd86878879a57995d425d3293">quda::gauge::FieldOrder::VolumeCB</a></div><div class="ttdeci">__device__ __host__ int VolumeCB() const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01050">gauge_field_order.h:1050</a></div></div>
<div class="ttc" id="classquda_1_1_gauge_field_html_afdd2f0de51c876a311001738329083c6"><div class="ttname"><a href="classquda_1_1_gauge_field.html#afdd2f0de51c876a311001738329083c6">quda::GaugeField::Reconstruct</a></div><div class="ttdeci">QudaReconstructType Reconstruct() const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field_8h_source.html#l00250">gauge_field.h:250</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_m_i_l_c_site_order_html_a02b54a0759ccb9e37c2e8461ac70ada5"><div class="ttname"><a href="structquda_1_1gauge_1_1_m_i_l_c_site_order.html#a02b54a0759ccb9e37c2e8461ac70ada5">quda::gauge::MILCSiteOrder::volumeCB</a></div><div class="ttdeci">const int volumeCB</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02431">gauge_field_order.h:2431</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_e___o_r18e8f8cc0cf320665821408416e0c3d7_html_a71b0fcb6caca719b2653998e21aab0eb"><div class="ttname"><a href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_e___o_r18e8f8cc0cf320665821408416e0c3d7.html#a71b0fcb6caca719b2653998e21aab0eb">quda::gauge::Accessor&lt; Float, nColor, QUDA_QDP_GAUGE_ORDER, storeFloat, use_tex &gt;::Accessor</a></div><div class="ttdeci">Accessor(const Accessor&lt; Float, nColor, QUDA_QDP_GAUGE_ORDER, storeFloat, use_tex &gt; &amp;a)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00389">gauge_field_order.h:389</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_e___o_r18e8f8cc0cf320665821408416e0c3d7_html_af1265ded29db9df86f67ee7b3ba19b83"><div class="ttname"><a href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_e___o_r18e8f8cc0cf320665821408416e0c3d7.html#af1265ded29db9df86f67ee7b3ba19b83">quda::gauge::Accessor&lt; Float, nColor, QUDA_QDP_GAUGE_ORDER, storeFloat, use_tex &gt;::cb_offset</a></div><div class="ttdeci">const int cb_offset</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00374">gauge_field_order.h:374</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4_html_a9b95dd23a6e219fef893d9e428a2805e"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#a9b95dd23a6e219fef893d9e428a2805e">quda::gauge::Reconstruct&lt; 8, Float, ghostExchange_ &gt;::isLastTimeSlice</a></div><div class="ttdeci">const bool isLastTimeSlice</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01453">gauge_field_order.h:1453</a></div></div>
<div class="ttc" id="namespacequda_html_afc8f979be274d625e247ce913db49805"><div class="ttname"><a href="namespacequda.html#afc8f979be274d625e247ce913db49805">quda::abs</a></div><div class="ttdeci">__host__ __device__ ValueType abs(ValueType x)</div><div class="ttdef"><b>Definition:</b> <a href="complex__quda_8h_source.html#l00125">complex_quda.h:125</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_float_n_order_html_a269ea1b61fcf1a289f0b726617b0f4cb"><div class="ttname"><a href="structquda_1_1gauge_1_1_float_n_order.html#a269ea1b61fcf1a289f0b726617b0f4cb">quda::gauge::FloatNOrder::volumeCB</a></div><div class="ttdeci">const int volumeCB</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01715">gauge_field_order.h:1715</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e_0851bfc944ce664513b027bdb1e7938b_html"><div class="ttname"><a href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e_0851bfc944ce664513b027bdb1e7938b.html">quda::gauge::Accessor&lt; Float, nColor, QUDA_FLOAT2_GAUGE_ORDER, storeFloat, use_tex &gt;</a></div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00683">gauge_field_order.h:683</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1square___3_01_reduce_type_00_01int_01_4_html_a544f02a2294656e2dd69ad64d788896e"><div class="ttname"><a href="structquda_1_1gauge_1_1square___3_01_reduce_type_00_01int_01_4.html#a544f02a2294656e2dd69ad64d788896e">quda::gauge::square_&lt; ReduceType, int &gt;::square_</a></div><div class="ttdeci">square_(const ReduceType scale)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00187">gauge_field_order.h:187</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_3_0113_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4_html_a4e72a04128c0af01b5c67a993a18dafb"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct_3_0113_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a4e72a04128c0af01b5c67a993a18dafb">quda::gauge::Reconstruct&lt; 13, Float, ghostExchange_, stag_phase &gt;::Reconstruct</a></div><div class="ttdeci">Reconstruct(const GaugeField &amp;u)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01369">gauge_field_order.h:1369</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_edba98cba7f194488e42e7a830abb1e97_html_a02ccda92aacd33a8bca9ce687f53a9c4"><div class="ttname"><a href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_edba98cba7f194488e42e7a830abb1e97.html#a02ccda92aacd33a8bca9ce687f53a9c4">quda::gauge::GhostAccessor&lt; Float, nColor, QUDA_QDP_GAUGE_ORDER, native_ghost, storeFloat, use_tex &gt;::scale_inv</a></div><div class="ttdeci">Float scale_inv</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00472">gauge_field_order.h:472</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1square___3_01_reduce_type_00_01short_01_4_html_a241d168bdfc224376fb5bcedf36147d4"><div class="ttname"><a href="structquda_1_1gauge_1_1square___3_01_reduce_type_00_01short_01_4.html#a241d168bdfc224376fb5bcedf36147d4">quda::gauge::square_&lt; ReduceType, short &gt;::square_</a></div><div class="ttdeci">square_(const ReduceType scale)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00180">gauge_field_order.h:180</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_float_n_order_html_a7e43649d3648abc5293fc202d43a435c"><div class="ttname"><a href="structquda_1_1gauge_1_1_float_n_order.html#a7e43649d3648abc5293fc202d43a435c">quda::gauge::FloatNOrder::Ghost</a></div><div class="ttdeci">__device__ __host__ const gauge_ghost_wrapper&lt; real, Accessor &gt; Ghost(int dim, int ghost_idx, int parity, real phase=1.0) const</div><div class="ttdoc">This accessor routine returns a const gauge_ghost_wrapper to this object, allowing us to overload var...</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01947">gauge_field_order.h:1947</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g656a684b71192f463c0c771174ee66f3_html_ab463f7622edced2ee2e14a7ad4cf7a23"><div class="ttname"><a href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___m_i_l_c___g_a_u_g656a684b71192f463c0c771174ee66f3.html#ab463f7622edced2ee2e14a7ad4cf7a23">quda::gauge::GhostAccessor&lt; Float, nColor, QUDA_MILC_GAUGE_ORDER, native_ghost, storeFloat, use_tex &gt;::scale</a></div><div class="ttdeci">Float scale</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00622">gauge_field_order.h:622</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1square___3_01_reduce_type_00_01char_01_4_html_a08f5cd5a402e179961e858f346b73f04"><div class="ttname"><a href="structquda_1_1gauge_1_1square___3_01_reduce_type_00_01char_01_4.html#a08f5cd5a402e179961e858f346b73f04">quda::gauge::square_&lt; ReduceType, char &gt;::operator()</a></div><div class="ttdeci">__host__ __device__ ReduceType operator()(const quda::complex&lt; char &gt; &amp;x)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00174">gauge_field_order.h:174</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_legacy_order_html_a044d74ff62c69d3c261b14d6f1bb7a41"><div class="ttname"><a href="structquda_1_1gauge_1_1_legacy_order.html#a044d74ff62c69d3c261b14d6f1bb7a41">quda::gauge::LegacyOrder::saveGhost</a></div><div class="ttdeci">__device__ __host__ void saveGhost(const complex v[length/2], int x, int dir, int parity)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02093">gauge_field_order.h:2093</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_b_q_c_d_order_html_a0415eaf9f614299d0f35033a7a37da5d"><div class="ttname"><a href="structquda_1_1gauge_1_1_b_q_c_d_order.html#a0415eaf9f614299d0f35033a7a37da5d">quda::gauge::BQCDOrder::load</a></div><div class="ttdeci">__device__ __host__ void load(complex v[9], int x, int dir, int parity, real inphase=1.0) const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02670">gauge_field_order.h:2670</a></div></div>
<div class="ttc" id="enum__quda_8h_html_a7589b295019a40887f1c10c76555feeaadc1a5ef802228fe4edd42346172c7605"><div class="ttname"><a href="enum__quda_8h.html#a7589b295019a40887f1c10c76555feeaadc1a5ef802228fe4edd42346172c7605">QUDA_COARSE_GEOMETRY</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00477">enum_quda.h:477</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_ghost_accessor_html_aaab87f9ce7a526322bf2c147b8301ecb"><div class="ttname"><a href="structquda_1_1gauge_1_1_ghost_accessor.html#aaab87f9ce7a526322bf2c147b8301ecb">quda::gauge::GhostAccessor::GhostAccessor</a></div><div class="ttdeci">GhostAccessor(const GaugeField &amp;, void *gauge_=0, void **ghost_=0)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00358">gauge_field_order.h:358</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1fieldorder__wrapper_html_a6d65a3629349ab662d11c10caf709ad8"><div class="ttname"><a href="structquda_1_1gauge_1_1fieldorder__wrapper.html#a6d65a3629349ab662d11c10caf709ad8">quda::gauge::fieldorder_wrapper::operator=</a></div><div class="ttdeci">__device__ __host__ void operator=(const complex&lt; theirFloat &gt; &amp;a)</div><div class="ttdoc">Assignment operator with complex number instance as input. </div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00286">gauge_field_order.h:286</a></div></div>
<div class="ttc" id="namespacequda_1_1gauge_html_aff68c08526ea52e23cc12f9c23298eff"><div class="ttname"><a href="namespacequda_1_1gauge.html#aff68c08526ea52e23cc12f9c23298eff">quda::gauge::milcStaggeredPhase</a></div><div class="ttdeci">__device__ __host__ Float milcStaggeredPhase(int dim, const int x[], const I R[])</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01212">gauge_field_order.h:1212</a></div></div>
<div class="ttc" id="classquda_1_1_gauge_field_html_ab875db966189cb025989e43275f78830"><div class="ttname"><a href="classquda_1_1_gauge_field.html#ab875db966189cb025989e43275f78830">quda::GaugeField::Gauge_p</a></div><div class="ttdeci">virtual void * Gauge_p()</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field_8h_source.html#l00315">gauge_field.h:315</a></div></div>
<div class="ttc" id="namespacequda_html_a2d204fdcd6f07297d2822a24ce82d224"><div class="ttname"><a href="namespacequda.html#a2d204fdcd6f07297d2822a24ce82d224">quda::operator*</a></div><div class="ttdeci">__device__ __host__ ColorSpinor&lt; Float, Nc, Ns &gt; operator*(const S &amp;a, const ColorSpinor&lt; Float, Nc, Ns &gt; &amp;x)</div><div class="ttdoc">Compute the scalar-vector product y = a * x. </div><div class="ttdef"><b>Definition:</b> <a href="color__spinor_8h_source.html#l01067">color_spinor.h:1067</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_e___o_r18e8f8cc0cf320665821408416e0c3d7_html_a52825077351d924adbf0fa43ae3d189c"><div class="ttname"><a href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_e___o_r18e8f8cc0cf320665821408416e0c3d7.html#a52825077351d924adbf0fa43ae3d189c">quda::gauge::Accessor&lt; Float, nColor, QUDA_QDP_GAUGE_ORDER, storeFloat, use_tex &gt;::scale_inv</a></div><div class="ttdeci">Float scale_inv</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00376">gauge_field_order.h:376</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_b_q_c_d_order_html_a75d3612142f9aafc49cf59ddc7f0e1f5"><div class="ttname"><a href="structquda_1_1gauge_1_1_b_q_c_d_order.html#a75d3612142f9aafc49cf59ddc7f0e1f5">quda::gauge::BQCDOrder::exVolumeCB</a></div><div class="ttdeci">int exVolumeCB</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02648">gauge_field_order.h:2648</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_q_d_p_j_i_t_order_html_a845da87a81a9d897ba6e27bfd62c78d5"><div class="ttname"><a href="structquda_1_1gauge_1_1_q_d_p_j_i_t_order.html#a845da87a81a9d897ba6e27bfd62c78d5">quda::gauge::QDPJITOrder::load</a></div><div class="ttdeci">__device__ __host__ void load(complex v[length/2], int x, int dir, int parity, real inphase=1.0) const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02279">gauge_field_order.h:2279</a></div></div>
<div class="ttc" id="quda__constants_8h_html_aa69925e50554e0ea81dd89fdcb572bbc"><div class="ttname"><a href="quda__constants_8h.html#aa69925e50554e0ea81dd89fdcb572bbc">QUDA_MAX_DIM</a></div><div class="ttdeci">#define QUDA_MAX_DIM</div><div class="ttdoc">Maximum number of dimensions supported by QUDA. In practice, no routines make use of more than 5...</div><div class="ttdef"><b>Definition:</b> <a href="quda__constants_8h_source.html#l00017">quda_constants.h:17</a></div></div>
<div class="ttc" id="enum__quda_8h_html_a93131cceecad27ce4b964cb184e8d47aa8ce4a4e003d703610a08578f413760c6"><div class="ttname"><a href="enum__quda_8h.html#a93131cceecad27ce4b964cb184e8d47aa8ce4a4e003d703610a08578f413760c6">QUDA_GHOST_EXCHANGE_INVALID</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00485">enum_quda.h:485</a></div></div>
<div class="ttc" id="face__gauge_8cpp_html_aef2e90455f2a9cbc0eae8c4c96cd159b"><div class="ttname"><a href="face__gauge_8cpp.html#aef2e90455f2a9cbc0eae8c4c96cd159b">volumeCB</a></div><div class="ttdeci">static int volumeCB</div><div class="ttdef"><b>Definition:</b> <a href="face__gauge_8cpp_source.html#l00043">face_gauge.cpp:43</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_field_order_html_adaeb3f73aa1115028b87be8185adde80"><div class="ttname"><a href="structquda_1_1gauge_1_1_field_order.html#adaeb3f73aa1115028b87be8185adde80">quda::gauge::FieldOrder::Ncolor</a></div><div class="ttdeci">__device__ __host__ int Ncolor() const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01044">gauge_field_order.h:1044</a></div></div>
<div class="ttc" id="util__quda_8h_html_a7668e6580e0f57b0db3112fae4959e34"><div class="ttname"><a href="util__quda_8h.html#a7668e6580e0f57b0db3112fae4959e34">checkCudaError</a></div><div class="ttdeci">#define checkCudaError()</div><div class="ttdef"><b>Definition:</b> <a href="util__quda_8h_source.html#l00161">util_quda.h:161</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_c_p_s_order_html_ab44c81ff05fc7277c467d7d5742abe91"><div class="ttname"><a href="structquda_1_1gauge_1_1_c_p_s_order.html#ab44c81ff05fc7277c467d7d5742abe91">quda::gauge::CPSOrder::CPSOrder</a></div><div class="ttdeci">CPSOrder(const CPSOrder &amp;order)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02551">gauge_field_order.h:2551</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_ghost_accessor_html_a2cb286f35cfa4b3774a3c21e1416c65d"><div class="ttname"><a href="structquda_1_1gauge_1_1_ghost_accessor.html#a2cb286f35cfa4b3774a3c21e1416c65d">quda::gauge::GhostAccessor::operator()</a></div><div class="ttdeci">__device__ __host__ complex&lt; Float &gt; &amp; operator()(int d, int parity, int x, int row, int col) const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00364">gauge_field_order.h:364</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_m_i_l_c_site_order_html_a89c729da893d8a3f4ae0e38bb4266c34"><div class="ttname"><a href="structquda_1_1gauge_1_1_m_i_l_c_site_order.html#a89c729da893d8a3f4ae0e38bb4266c34">quda::gauge::MILCSiteOrder::save</a></div><div class="ttdeci">__device__ __host__ void save(const complex v[length/2], int x, int dir, int parity)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02471">gauge_field_order.h:2471</a></div></div>
<div class="ttc" id="comm__quda_8h_html_ad219441b0cdddb8ddf27cf958557713e"><div class="ttname"><a href="comm__quda_8h.html#ad219441b0cdddb8ddf27cf958557713e">comm_allreduce</a></div><div class="ttdeci">void comm_allreduce(double *data)</div><div class="ttdef"><b>Definition:</b> <a href="comm__mpi_8cpp_source.html#l00242">comm_mpi.cpp:242</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_t_i_f_r_padded_order_html_a65ed051b6e31fc0b1270c8419aa16237"><div class="ttname"><a href="structquda_1_1gauge_1_1_t_i_f_r_padded_order.html#a65ed051b6e31fc0b1270c8419aa16237">quda::gauge::TIFRPaddedOrder::operator()</a></div><div class="ttdeci">__device__ __host__ const gauge_wrapper&lt; real, Accessor &gt; operator()(int dim, int x_cb, int parity) const</div><div class="ttdoc">This accessor routine returns a const gauge_wrapper to this object, allowing us to overload various o...</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02974">gauge_field_order.h:2974</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_e___o_r18e8f8cc0cf320665821408416e0c3d7_html_af19e27579fd98c18d5f582f9351b6232"><div class="ttname"><a href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_e___o_r18e8f8cc0cf320665821408416e0c3d7.html#af19e27579fd98c18d5f582f9351b6232">quda::gauge::Accessor&lt; Float, nColor, QUDA_QDP_GAUGE_ORDER, storeFloat, use_tex &gt;::operator()</a></div><div class="ttdeci">__device__ __host__ complex&lt; Float &gt; operator()(int d, int parity, int x, int row, int col) const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00402">gauge_field_order.h:402</a></div></div>
<div class="ttc" id="namespacequda_html_aa2770ef66427e1e0861d7685d363907a"><div class="ttname"><a href="namespacequda.html#aa2770ef66427e1e0861d7685d363907a">quda::getDeterminant</a></div><div class="ttdeci">__device__ __host__ T getDeterminant(const Mat&lt; T, 3 &gt; &amp;a)</div><div class="ttdef"><b>Definition:</b> <a href="quda__matrix_8h_source.html#l00422">quda_matrix.h:422</a></div></div>
<div class="ttc" id="namespacequda_html_a043738f16cdeb082fa1a5158fbad36b3"><div class="ttname"><a href="namespacequda.html#a043738f16cdeb082fa1a5158fbad36b3">quda::conj</a></div><div class="ttdeci">__host__ __device__ ValueType conj(ValueType x)</div><div class="ttdef"><b>Definition:</b> <a href="complex__quda_8h_source.html#l00130">complex_quda.h:130</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_b_q_c_d_order_html_a6335a3b2fb5a85183f0e0d418b8e17d6"><div class="ttname"><a href="structquda_1_1gauge_1_1_b_q_c_d_order.html#a6335a3b2fb5a85183f0e0d418b8e17d6">quda::gauge::BQCDOrder::gauge</a></div><div class="ttdeci">Float * gauge</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02646">gauge_field_order.h:2646</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_float_n_order_html_acfd9926ab02488c5423aec99b407bdfc"><div class="ttname"><a href="structquda_1_1gauge_1_1_float_n_order.html#acfd9926ab02488c5423aec99b407bdfc">quda::gauge::FloatNOrder::stride</a></div><div class="ttdeci">const int stride</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01717">gauge_field_order.h:1717</a></div></div>
<div class="ttc" id="structquda_1_1gauge__mapper_3_01char_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t___n_o_00_01_n_00_01stc8a71736ea66c08a424ee6c3abbe78cc_html_a299481837b140204a38c90cce84e214d"><div class="ttname"><a href="structquda_1_1gauge__mapper_3_01char_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t___n_o_00_01_n_00_01stc8a71736ea66c08a424ee6c3abbe78cc.html#a299481837b140204a38c90cce84e214d">quda::gauge_mapper&lt; char, QUDA_RECONSTRUCT_NO, N, stag, huge_alloc, ghostExchange, use_inphase &gt;::type</a></div><div class="ttdeci">gauge::FloatNOrder&lt; char, N, 2, N, stag, huge_alloc, ghostExchange, use_inphase &gt; type</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l03096">gauge_field_order.h:3096</a></div></div>
<div class="ttc" id="structquda_1_1gauge__ghost__wrapper_html_a31f15cc207949569d9fb3da630bb479a"><div class="ttname"><a href="structquda_1_1gauge__ghost__wrapper.html#a31f15cc207949569d9fb3da630bb479a">quda::gauge_ghost_wrapper::dim</a></div><div class="ttdeci">const int dim</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00110">gauge_field_order.h:110</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_c_p_s_order_html_a26a252a3e172faccdd81f27952c136f2"><div class="ttname"><a href="structquda_1_1gauge_1_1_c_p_s_order.html#a26a252a3e172faccdd81f27952c136f2">quda::gauge::CPSOrder::operator()</a></div><div class="ttdeci">__device__ __host__ const gauge_wrapper&lt; real, Accessor &gt; operator()(int dim, int x_cb, int parity) const</div><div class="ttdoc">This accessor routine returns a const gauge_wrapper to this object, allowing us to overload various o...</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02627">gauge_field_order.h:2627</a></div></div>
<div class="ttc" id="namespacequda_1_1gauge_html_ac38d7c2bb9ea52de39575dcaf73a3d0f"><div class="ttname"><a href="namespacequda_1_1gauge.html#ac38d7c2bb9ea52de39575dcaf73a3d0f">quda::gauge::indexFloatN</a></div><div class="ttdeci">__device__ __host__ int indexFloatN(int dim, int parity, int x_cb, int row, int col, int stride, int offset_cb)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00673">gauge_field_order.h:673</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_e___o_r18e8f8cc0cf320665821408416e0c3d7_html_a1022f349394e12d809344d83c99b3b80"><div class="ttname"><a href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_e___o_r18e8f8cc0cf320665821408416e0c3d7.html#a1022f349394e12d809344d83c99b3b80">quda::gauge::Accessor&lt; Float, nColor, QUDA_QDP_GAUGE_ORDER, storeFloat, use_tex &gt;::geometry</a></div><div class="ttdeci">const int geometry</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00373">gauge_field_order.h:373</a></div></div>
<div class="ttc" id="comm__quda_8h_html_abdf7d13f471c3c6b39e142c09fb130b4"><div class="ttname"><a href="comm__quda_8h.html#abdf7d13f471c3c6b39e142c09fb130b4">comm_allreduce_max</a></div><div class="ttdeci">void comm_allreduce_max(double *data)</div><div class="ttdef"><b>Definition:</b> <a href="comm__mpi_8cpp_source.html#l00258">comm_mpi.cpp:258</a></div></div>
<div class="ttc" id="structquda_1_1gauge__order__mapper_3_01_t_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e___o_r_d_e_r_00_01_nc_01_4_html_a5de8c462db71c01ba6fb589fa89833c1"><div class="ttname"><a href="structquda_1_1gauge__order__mapper_3_01_t_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e___o_r_d_e_r_00_01_nc_01_4.html#a5de8c462db71c01ba6fb589fa89833c1">quda::gauge_order_mapper&lt; T, QUDA_FLOAT2_GAUGE_ORDER, Nc &gt;::type</a></div><div class="ttdeci">gauge::FloatNOrder&lt; T, 2 *Nc *Nc, 2, 2 *Nc *Nc &gt; type</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l03126">gauge_field_order.h:3126</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4_html_ab6185def211352cc8c3a4a41b32252e3"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#ab6185def211352cc8c3a4a41b32252e3">quda::gauge::Reconstruct&lt; 8, Float, ghostExchange_ &gt;::tBoundary</a></div><div class="ttdeci">const complex tBoundary</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01449">gauge_field_order.h:1449</a></div></div>
<div class="ttc" id="enum__quda_8h_html_a93131cceecad27ce4b964cb184e8d47aaab94b36fc680dd39f976636dac350e53"><div class="ttname"><a href="enum__quda_8h.html#a93131cceecad27ce4b964cb184e8d47aaab94b36fc680dd39f976636dac350e53">QUDA_GHOST_EXCHANGE_PAD</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00483">enum_quda.h:483</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_edba98cba7f194488e42e7a830abb1e97_html_aea102e27316f8c91d3df053976644919"><div class="ttname"><a href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_edba98cba7f194488e42e7a830abb1e97.html#aea102e27316f8c91d3df053976644919">quda::gauge::GhostAccessor&lt; Float, nColor, QUDA_QDP_GAUGE_ORDER, native_ghost, storeFloat, use_tex &gt;::GhostAccessor</a></div><div class="ttdeci">GhostAccessor(const GaugeField &amp;U, void *gauge_=0, void **ghost_=0)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00475">gauge_field_order.h:475</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_field_order_html_a23f8a30efa911802a1ca0baa648e359d"><div class="ttname"><a href="structquda_1_1gauge_1_1_field_order.html#a23f8a30efa911802a1ca0baa648e359d">quda::gauge::FieldOrder::fixedPoint</a></div><div class="ttdeci">static constexpr bool fixedPoint()</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00931">gauge_field_order.h:931</a></div></div>
<div class="ttc" id="structquda_1_1_alloc_type_html"><div class="ttname"><a href="structquda_1_1_alloc_type.html">quda::AllocType</a></div><div class="ttdef"><b>Definition:</b> <a href="register__traits_8h_source.html#l00493">register_traits.h:493</a></div></div>
<div class="ttc" id="classthrust__allocator_html"><div class="ttname"><a href="classthrust__allocator.html">thrust_allocator</a></div><div class="ttdef"><b>Definition:</b> <a href="thrust__helper_8cuh_source.html#l00027">thrust_helper.cuh:27</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_2b6e6ca5a27266b35ef9c885a15f8294_html_a4bc085efd93e90209b7d12a6c7c0566f"><div class="ttname"><a href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_2b6e6ca5a27266b35ef9c885a15f8294.html#a4bc085efd93e90209b7d12a6c7c0566f">quda::gauge::GhostAccessor&lt; Float, nColor, QUDA_FLOAT2_GAUGE_ORDER, native_ghost, storeFloat, use_tex &gt;::operator()</a></div><div class="ttdeci">__device__ __host__ const complex&lt; Float &gt; operator()(int d, int parity, int x_cb, int row, int col) const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00857">gauge_field_order.h:857</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e_0851bfc944ce664513b027bdb1e7938b_html_ac66fe95f0115b3bd9bd22328057d37ad"><div class="ttname"><a href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e_0851bfc944ce664513b027bdb1e7938b.html#ac66fe95f0115b3bd9bd22328057d37ad">quda::gauge::Accessor&lt; Float, nColor, QUDA_FLOAT2_GAUGE_ORDER, storeFloat, use_tex &gt;::transform_reduce</a></div><div class="ttdeci">__host__ double transform_reduce(QudaFieldLocation location, int dim, helper h, reducer r, double init) const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00789">gauge_field_order.h:789</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1abs___3_01_float_00_01short_01_4_html_a8da4900f3a724a29a1af2543d66208d1"><div class="ttname"><a href="structquda_1_1gauge_1_1abs___3_01_float_00_01short_01_4.html#a8da4900f3a724a29a1af2543d66208d1">quda::gauge::abs_&lt; Float, short &gt;::operator()</a></div><div class="ttdeci">__host__ __device__ Float operator()(const quda::complex&lt; short &gt; &amp;x)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00207">gauge_field_order.h:207</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_t_i_f_r_padded_order_html_a762d40435c317bb75b5e4074bfdb5de3"><div class="ttname"><a href="structquda_1_1gauge_1_1_t_i_f_r_padded_order.html#a762d40435c317bb75b5e4074bfdb5de3">quda::gauge::TIFRPaddedOrder::getPaddedIndex</a></div><div class="ttdeci">__device__ __host__ int getPaddedIndex(int x_cb, int parity) const</div><div class="ttdoc">Compute the index into the padded field. Assumes that parity doesn&amp;#39;t change from unpadded to padded...</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02895">gauge_field_order.h:2895</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_m_i_l_c_site_order_html_a7e096af236f85d166e4668cce20e2bf6"><div class="ttname"><a href="structquda_1_1gauge_1_1_m_i_l_c_site_order.html#a7e096af236f85d166e4668cce20e2bf6">quda::gauge::MILCSiteOrder::operator()</a></div><div class="ttdeci">__device__ __host__ const gauge_wrapper&lt; real, Accessor &gt; operator()(int dim, int x_cb, int parity) const</div><div class="ttdoc">This accessor routine returns a const gauge_wrapper to this object, allowing us to overload various o...</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02518">gauge_field_order.h:2518</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_float_n_order_html_ac1448858b69d6ec508d76be27f51477e"><div class="ttname"><a href="structquda_1_1gauge_1_1_float_n_order.html#ac1448858b69d6ec508d76be27f51477e">quda::gauge::FloatNOrder::gauge</a></div><div class="ttdeci">Float * gauge</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01703">gauge_field_order.h:1703</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_m_i_l_c_site_order_html_aad27cf3b921d7d47c8928cb15c3c9097"><div class="ttname"><a href="structquda_1_1gauge_1_1_m_i_l_c_site_order.html#aad27cf3b921d7d47c8928cb15c3c9097">quda::gauge::MILCSiteOrder::Bytes</a></div><div class="ttdeci">size_t Bytes() const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02523">gauge_field_order.h:2523</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1square___3_01_reduce_type_00_01short_01_4_html_a4394a7e232118c0e0ee29b65fb53ebe2"><div class="ttname"><a href="structquda_1_1gauge_1_1square___3_01_reduce_type_00_01short_01_4.html#a4394a7e232118c0e0ee29b65fb53ebe2">quda::gauge::square_&lt; ReduceType, short &gt;::scale</a></div><div class="ttdeci">const ReduceType scale</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00179">gauge_field_order.h:179</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4_html_a0205d96983e6cdce21bf8a21cb3289f3"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#a0205d96983e6cdce21bf8a21cb3289f3">quda::gauge::Reconstruct&lt; 8, Float, ghostExchange_ &gt;::complex</a></div><div class="ttdeci">complex&lt; real &gt; complex</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01447">gauge_field_order.h:1447</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1abs___html_adcb117f80b1bfcc2c0ea249a1a99f008"><div class="ttname"><a href="structquda_1_1gauge_1_1abs__.html#adcb117f80b1bfcc2c0ea249a1a99f008">quda::gauge::abs_::abs_</a></div><div class="ttdeci">abs_(const Float scale)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00193">gauge_field_order.h:193</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_legacy_order_html_ae7a243d99fec1375a0679aa843812198"><div class="ttname"><a href="structquda_1_1gauge_1_1_legacy_order.html#ae7a243d99fec1375a0679aa843812198">quda::gauge::LegacyOrder::saveGhostEx</a></div><div class="ttdeci">__device__ __host__ void saveGhostEx(const complex v[length/2], int x, int dummy, int dir, int dim, int g, int parity, const int R[])</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02158">gauge_field_order.h:2158</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4_html_ab9916ee97e30fe7e3b482458aa124f3a"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html#ab9916ee97e30fe7e3b482458aa124f3a">quda::gauge::Reconstruct&lt; 8, Float, ghostExchange_ &gt;::Pack</a></div><div class="ttdeci">__device__ __host__ void Pack(real out[8], const complex in[9], int idx) const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01479">gauge_field_order.h:1479</a></div></div>
<div class="ttc" id="gauge__field_8h_html"><div class="ttname"><a href="gauge__field_8h.html">gauge_field.h</a></div></div>
<div class="ttc" id="classquda_1_1_matrix_html"><div class="ttname"><a href="classquda_1_1_matrix.html">quda::Matrix</a></div><div class="ttdef"><b>Definition:</b> <a href="quda__matrix_8h_source.html#l00064">quda_matrix.h:64</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_field_order_html_a0ab665e186f045bda17335a40452c119"><div class="ttname"><a href="structquda_1_1gauge_1_1_field_order.html#a0ab665e186f045bda17335a40452c119">quda::gauge::FieldOrder::FieldOrder</a></div><div class="ttdeci">FieldOrder(const FieldOrder &amp;o)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00921">gauge_field_order.h:921</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_float_n_order_html"><div class="ttname"><a href="structquda_1_1gauge_1_1_float_n_order.html">quda::gauge::FloatNOrder</a></div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01692">gauge_field_order.h:1692</a></div></div>
<div class="ttc" id="structquda_1_1complex_3_01double_01_4_html_a415edb68e98c50ed9eacdbcf28781efa"><div class="ttname"><a href="structquda_1_1complex_3_01double_01_4.html#a415edb68e98c50ed9eacdbcf28781efa">quda::complex&lt; double &gt;::operator=</a></div><div class="ttdeci">__host__ __device__ volatile complex&lt; double &gt; &amp; operator=(const complex&lt; T &gt; z) volatile</div><div class="ttdef"><b>Definition:</b> <a href="complex__quda_8h_source.html#l00613">complex_quda.h:613</a></div></div>
<div class="ttc" id="enum__quda_8h_html_a2f13fac18d6933e9e21bc1cf2737b21aa3ddefa2065127060bce7d178208c51e0"><div class="ttname"><a href="enum__quda_8h.html#a2f13fac18d6933e9e21bc1cf2737b21aa3ddefa2065127060bce7d178208c51e0">QUDA_STAGGERED_PHASE_NO</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00489">enum_quda.h:489</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_3_0113_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4_html_a791759925f2884dc48fef16c9d25bc62"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct_3_0113_00_01_float_00_01ghost_exchange___00_01stag__phase_01_4.html#a791759925f2884dc48fef16c9d25bc62">quda::gauge::Reconstruct&lt; 13, Float, ghostExchange_, stag_phase &gt;::Reconstruct</a></div><div class="ttdeci">Reconstruct(const Reconstruct&lt; 13, Float, ghostExchange_, stag_phase &gt; &amp;recon)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01370">gauge_field_order.h:1370</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_edba98cba7f194488e42e7a830abb1e97_html_a596d10a2571358e5ebf2a5f2ddc11b29"><div class="ttname"><a href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_edba98cba7f194488e42e7a830abb1e97.html#a596d10a2571358e5ebf2a5f2ddc11b29">quda::gauge::GhostAccessor&lt; Float, nColor, QUDA_QDP_GAUGE_ORDER, native_ghost, storeFloat, use_tex &gt;::resetScale</a></div><div class="ttdeci">void resetScale(Float max)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00499">gauge_field_order.h:499</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_2b6e6ca5a27266b35ef9c885a15f8294_html_ad024c8b0f0b4d81eb9c16fcfbebbcf17"><div class="ttname"><a href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_2b6e6ca5a27266b35ef9c885a15f8294.html#ad024c8b0f0b4d81eb9c16fcfbebbcf17">quda::gauge::GhostAccessor&lt; Float, nColor, QUDA_FLOAT2_GAUGE_ORDER, native_ghost, storeFloat, use_tex &gt;::ghost</a></div><div class="ttdeci">complex&lt; storeFloat &gt; * ghost[8]</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00818">gauge_field_order.h:818</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1square___html_ac36b98bc253f8cb5ea2f18e8bcf7efa7"><div class="ttname"><a href="structquda_1_1gauge_1_1square__.html#ac36b98bc253f8cb5ea2f18e8bcf7efa7">quda::gauge::square_::operator()</a></div><div class="ttdeci">__host__ __device__ ReduceType operator()(const quda::complex&lt; Float &gt; &amp;x)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00167">gauge_field_order.h:167</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_field_order_html_ab3fa59bcc362fc84f2cbf16c4a285a3f"><div class="ttname"><a href="structquda_1_1gauge_1_1_field_order.html#ab3fa59bcc362fc84f2cbf16c4a285a3f">quda::gauge::FieldOrder::NspinCoarse</a></div><div class="ttdeci">__device__ __host__ int NspinCoarse() const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01059">gauge_field_order.h:1059</a></div></div>
<div class="ttc" id="structquda_1_1gauge__mapper_3_01char_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__13_00_01_n_00_01stagea58f59eb11dcedb2557bbcc931c95b0_html_a947153d2d79bdfe67ed3616e3d1bea92"><div class="ttname"><a href="structquda_1_1gauge__mapper_3_01char_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__13_00_01_n_00_01stagea58f59eb11dcedb2557bbcc931c95b0.html#a947153d2d79bdfe67ed3616e3d1bea92">quda::gauge_mapper&lt; char, QUDA_RECONSTRUCT_13, N, stag, huge_alloc, ghostExchange, use_inphase &gt;::type</a></div><div class="ttdeci">gauge::FloatNOrder&lt; char, N, 4, 13, stag, huge_alloc, ghostExchange, use_inphase &gt; type</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l03100">gauge_field_order.h:3100</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e_0851bfc944ce664513b027bdb1e7938b_html_ad33d12657f2f4c8ee7155d1060268531"><div class="ttname"><a href="structquda_1_1gauge_1_1_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___f_l_o_a_t2___g_a_u_g_e_0851bfc944ce664513b027bdb1e7938b.html#ad33d12657f2f4c8ee7155d1060268531">quda::gauge::Accessor&lt; Float, nColor, QUDA_FLOAT2_GAUGE_ORDER, storeFloat, use_tex &gt;::geometry</a></div><div class="ttdeci">const int geometry</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00692">gauge_field_order.h:692</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_float_n_order_html_a3d75054bbf71b2bfbce6176f0a9c6a9b"><div class="ttname"><a href="structquda_1_1gauge_1_1_float_n_order.html#a3d75054bbf71b2bfbce6176f0a9c6a9b">quda::gauge::FloatNOrder::FloatNOrder</a></div><div class="ttdeci">FloatNOrder(const FloatNOrder &amp;order)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01752">gauge_field_order.h:1752</a></div></div>
<div class="ttc" id="structquda_1_1complex_3_01float_01_4_html_a6ece55234b752478b121323da96b48d0"><div class="ttname"><a href="structquda_1_1complex_3_01float_01_4.html#a6ece55234b752478b121323da96b48d0">quda::complex&lt; float &gt;::complex</a></div><div class="ttdeci">__host__ __device__ complex()</div><div class="ttdef"><b>Definition:</b> <a href="complex__quda_8h_source.html#l00463">complex_quda.h:463</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_edba98cba7f194488e42e7a830abb1e97_html_aa3372cab2321bb3b804225b6bc3a37be"><div class="ttname"><a href="structquda_1_1gauge_1_1_ghost_accessor_3_01_float_00_01n_color_00_01_q_u_d_a___q_d_p___g_a_u_g_edba98cba7f194488e42e7a830abb1e97.html#aa3372cab2321bb3b804225b6bc3a37be">quda::gauge::GhostAccessor&lt; Float, nColor, QUDA_QDP_GAUGE_ORDER, native_ghost, storeFloat, use_tex &gt;::ghost</a></div><div class="ttdeci">complex&lt; storeFloat &gt; * ghost[8]</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00469">gauge_field_order.h:469</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_field_order_html_a9d0b6e1900d1144a7344c8c7a10aa932"><div class="ttname"><a href="structquda_1_1gauge_1_1_field_order.html#a9d0b6e1900d1144a7344c8c7a10aa932">quda::gauge::FieldOrder::location</a></div><div class="ttdeci">const QudaFieldLocation location</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00902">gauge_field_order.h:902</a></div></div>
<div class="ttc" id="namespacequda_html_a416e52d2ea7f201272f902122f06668d"><div class="ttname"><a href="namespacequda.html#a416e52d2ea7f201272f902122f06668d">quda::getCoords</a></div><div class="ttdeci">__host__ __device__ int getCoords(int coord[], const Arg &amp;arg, int &amp;idx, int parity, int &amp;dim)</div><div class="ttdoc">Compute the space-time coordinates we are at. </div><div class="ttdef"><b>Definition:</b> <a href="dslash__helper_8cuh_source.html#l00088">dslash_helper.cuh:88</a></div></div>
<div class="ttc" id="structquda_1_1gauge__order__mapper_3_01_t_00_01_q_u_d_a___t_i_f_r___p_a_d_d_e_d___g_a_u_g_e___o_r_d_e_r_00_01_nc_01_4_html_a69d6b3c692fea1b364b53826d85c7f66"><div class="ttname"><a href="structquda_1_1gauge__order__mapper_3_01_t_00_01_q_u_d_a___t_i_f_r___p_a_d_d_e_d___g_a_u_g_e___o_r_d_e_r_00_01_nc_01_4.html#a69d6b3c692fea1b364b53826d85c7f66">quda::gauge_order_mapper&lt; T, QUDA_TIFR_PADDED_GAUGE_ORDER, Nc &gt;::type</a></div><div class="ttdeci">gauge::TIFRPaddedOrder&lt; T, 2 *Nc *Nc &gt; type</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l03125">gauge_field_order.h:3125</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_s_html"><div class="ttname"><a href="structquda_1_1gauge_1_1_s.html">quda::gauge::S</a></div><div class="ttdoc">This is just a dummy structure we use for trove to define the required structure size. </div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02033">gauge_field_order.h:2033</a></div></div>
<div class="ttc" id="classquda_1_1_lattice_field_html_a96f46542c595993b72818d3d031cd72f"><div class="ttname"><a href="classquda_1_1_lattice_field.html#a96f46542c595993b72818d3d031cd72f">quda::LatticeField::X</a></div><div class="ttdeci">const int * X() const</div><div class="ttdef"><b>Definition:</b> <a href="lattice__field_8h_source.html#l00499">lattice_field.h:499</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1abs___html"><div class="ttname"><a href="structquda_1_1gauge_1_1abs__.html">quda::gauge::abs_</a></div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00192">gauge_field_order.h:192</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_m_i_l_c_order_html_aee0c1127f4b9e818dbedda2d0d0a2cbe"><div class="ttname"><a href="structquda_1_1gauge_1_1_m_i_l_c_order.html#aee0c1127f4b9e818dbedda2d0d0a2cbe">quda::gauge::MILCOrder::operator()</a></div><div class="ttdeci">__device__ __host__ const gauge_wrapper&lt; real, Accessor &gt; operator()(int dim, int x_cb, int parity) const</div><div class="ttdoc">This accessor routine returns a const gauge_wrapper to this object, allowing us to overload various o...</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02403">gauge_field_order.h:2403</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_field_order_html_ae24e9e0d8b961ed6823131612b3505d8"><div class="ttname"><a href="structquda_1_1gauge_1_1_field_order.html#ae24e9e0d8b961ed6823131612b3505d8">quda::gauge::FieldOrder::atomicAdd</a></div><div class="ttdeci">__device__ __host__ void atomicAdd(int d, int parity, int x, int s_row, int s_col, int c_row, int c_col, const complex&lt; theirFloat &gt; &amp;val)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01038">gauge_field_order.h:1038</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_q_d_p_j_i_t_order_html_a13939966a4277a232ed6c3155e7dfe3d"><div class="ttname"><a href="structquda_1_1gauge_1_1_q_d_p_j_i_t_order.html#a13939966a4277a232ed6c3155e7dfe3d">quda::gauge::QDPJITOrder::save</a></div><div class="ttdeci">__device__ __host__ void save(const complex v[length/2], int x, int dir, int parity)</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l02287">gauge_field_order.h:2287</a></div></div>
<div class="ttc" id="classquda_1_1_gauge_field_html"><div class="ttname"><a href="classquda_1_1_gauge_field.html">quda::GaugeField</a></div><div class="ttdef"><b>Definition:</b> <a href="gauge__field_8h_source.html#l00164">gauge_field.h:164</a></div></div>
<div class="ttc" id="structquda_1_1_trig_html"><div class="ttname"><a href="structquda_1_1_trig.html">quda::Trig</a></div><div class="ttdef"><b>Definition:</b> <a href="register__traits_8h_source.html#l00293">register_traits.h:293</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4_html"><div class="ttname"><a href="structquda_1_1gauge_1_1_reconstruct_3_018_00_01_float_00_01ghost_exchange___01_4.html">quda::gauge::Reconstruct&lt; 8, Float, ghostExchange_ &gt;</a></div><div class="ttdoc">Gauge reconstruct 8 helper where we reconstruct the gauge matrix from 8 packed elements (maximal comp...</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01445">gauge_field_order.h:1445</a></div></div>
<div class="ttc" id="structquda_1_1gauge__mapper_3_01float_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__8_00_01_n_00_01stagcd53a91849eda926634b4b11907ab37d_html_a19793701891e8a3fa0689c7454cd9b7c"><div class="ttname"><a href="structquda_1_1gauge__mapper_3_01float_00_01_q_u_d_a___r_e_c_o_n_s_t_r_u_c_t__8_00_01_n_00_01stagcd53a91849eda926634b4b11907ab37d.html#a19793701891e8a3fa0689c7454cd9b7c">quda::gauge_mapper&lt; float, QUDA_RECONSTRUCT_8, N, stag, huge_alloc, ghostExchange, use_inphase &gt;::type</a></div><div class="ttdeci">gauge::FloatNOrder&lt; float, N, 4, 8, stag, huge_alloc, ghostExchange, use_inphase &gt; type</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l03064">gauge_field_order.h:3064</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_float_n_order_html_a0bf0b4220ecf3916c186f61539fffffa"><div class="ttname"><a href="structquda_1_1gauge_1_1_float_n_order.html#a0bf0b4220ecf3916c186f61539fffffa">quda::gauge::FloatNOrder::loadGhost</a></div><div class="ttdeci">__device__ __host__ void loadGhost(complex v[length/2], int x, int dir, int parity, real inphase=1.0) const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l01861">gauge_field_order.h:1861</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
