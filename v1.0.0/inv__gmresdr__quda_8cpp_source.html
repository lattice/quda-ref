<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>QUDA: lib/inv_gmresdr_quda.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">QUDA
   &#160;<span id="projectnumber">1.0.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">inv_gmresdr_quda.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="inv__gmresdr__quda_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &lt;stdio.h&gt;</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#include &lt;stdlib.h&gt;</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &lt;math.h&gt;</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &lt;string.h&gt;</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="quda__internal_8h.html">quda_internal.h</a>&gt;</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="color__spinor__field_8h.html">color_spinor_field.h</a>&gt;</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="blas__quda_8h.html">blas_quda.h</a>&gt;</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="dslash__quda_8h.html">dslash_quda.h</a>&gt;</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="invert__quda_8h.html">invert_quda.h</a>&gt;</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="util__quda_8h.html">util_quda.h</a>&gt;</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#ifdef MAGMA_LIB</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="blas__magma_8h.html">blas_magma.h</a>&gt;</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &lt;memory&gt;</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &lt;Eigen/Dense&gt;</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &lt;Eigen/Eigenvalues&gt;</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">GMRES-DR algorithm:</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">R. B. Morgan, &quot;GMRES with deflated restarting&quot;, SIAM J. Sci. Comput. 24 (2002) p. 20-37</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">See also: A.Frommer et al, &quot;Deflation and Flexible SAP-Preconditioning of GMRES in Lattice QCD simulations&quot; ArXiv hep-lat/1204.5463</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacequda.html">quda</a> {</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="keyword">using namespace </span>blas;</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="keyword">using namespace </span><a class="code" href="namespacestd.html">std</a>;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="keyword">using namespace </span><a class="code" href="namespace_eigen.html">Eigen</a>;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="keyword">using</span> <a class="code" href="namespacequda.html#ab9bad7eeabf43337acf0cb22f4b189cb">DynamicStride</a>   = Stride&lt;Dynamic, Dynamic&gt;;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="keyword">using</span> <a class="code" href="namespacequda.html#a048501d184bc5c0d1e4462e80a80bb1a">DenseMatrix</a>     = MatrixXcd;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="keyword">using</span> <a class="code" href="namespacequda.html#a2f233a7e56c94294c14499a3039419bd">VectorSet</a>       = MatrixXcd;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="keyword">using</span> <a class="code" href="namespacequda.html#a4e54927fc030027c7892b4bff973aaaa">Vector</a>          = VectorXcd;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">//special types needed for compatibility with QUDA blas:</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="keyword">using</span> <a class="code" href="namespacequda.html#a5b73964657f76b68a4e7c926c803ad58">RowMajorDenseMatrix</a> = <a class="code" href="class_matrix.html">Matrix&lt;Complex, Dynamic, Dynamic, RowMajor&gt;</a>;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div><div class="line"><a name="l00047"></a><span class="lineno"><a class="line" href="structquda_1_1_sorted_evals.html">   47</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structquda_1_1_sorted_evals.html">SortedEvals</a>{</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div><div class="line"><a name="l00049"></a><span class="lineno"><a class="line" href="structquda_1_1_sorted_evals.html#a97324c6196b3afa663e47303f7f26269">   49</a></span>&#160;      <span class="keywordtype">double</span> <a class="code" href="structquda_1_1_sorted_evals.html#a97324c6196b3afa663e47303f7f26269">_val</a>;</div><div class="line"><a name="l00050"></a><span class="lineno"><a class="line" href="structquda_1_1_sorted_evals.html#a41a17a5dea3ac709236b4c60c2bd211a">   50</a></span>&#160;      <span class="keywordtype">int</span>    <a class="code" href="structquda_1_1_sorted_evals.html#a41a17a5dea3ac709236b4c60c2bd211a">_idx</a>;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div><div class="line"><a name="l00052"></a><span class="lineno"><a class="line" href="structquda_1_1_sorted_evals.html#ab545faf36551872de772116e00b4b317">   52</a></span>&#160;      <a class="code" href="structquda_1_1_sorted_evals.html#ab545faf36551872de772116e00b4b317">SortedEvals</a>(<span class="keywordtype">double</span> val, <span class="keywordtype">int</span> idx) : _val(val), _idx(idx) {};</div><div class="line"><a name="l00053"></a><span class="lineno"><a class="line" href="structquda_1_1_sorted_evals.html#ac5bfe99a7c0e428dd9c2bcde0986758b">   53</a></span>&#160;      <span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="structquda_1_1_sorted_evals.html#ac5bfe99a7c0e428dd9c2bcde0986758b">SelectSmall</a> (<a class="code" href="structquda_1_1_sorted_evals.html">SortedEvals</a> v1, <a class="code" href="structquda_1_1_sorted_evals.html">SortedEvals</a> v2) { <span class="keywordflow">return</span> (v1.<a class="code" href="structquda_1_1_sorted_evals.html#a97324c6196b3afa663e47303f7f26269">_val</a> &lt; v2.<a class="code" href="structquda_1_1_sorted_evals.html#a97324c6196b3afa663e47303f7f26269">_val</a>);}</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    };</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div><div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="namespacequda.html#abe598ea1308b5f23670eaab8662949a0">   57</a></span>&#160;    <span class="keyword">enum class</span> <a class="code" href="namespacequda.html#abe598ea1308b5f23670eaab8662949a0">libtype</a> {<a class="code" href="namespacequda.html#abe598ea1308b5f23670eaab8662949a0a74c060da36f859167ad519744d73dedb">eigen_lib</a>, <a class="code" href="namespacequda.html#abe598ea1308b5f23670eaab8662949a0a805866538e898502a465cec41121e6b9">magma_lib</a>, <a class="code" href="namespacequda.html#abe598ea1308b5f23670eaab8662949a0a5405143d5482ed0cb7f59cd6d4d459d0">lapack_lib</a>, <a class="code" href="namespacequda.html#abe598ea1308b5f23670eaab8662949a0aeb918fcb0e14b0812bb403fe1ec05c82">mkl_lib</a>};</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div><div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="classquda_1_1_g_m_res_d_r_args.html">   59</a></span>&#160;    <span class="keyword">class </span><a class="code" href="classquda_1_1_g_m_res_d_r_args.html">GMResDRArgs</a>{</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      <span class="keyword">public</span>:</div><div class="line"><a name="l00062"></a><span class="lineno"><a class="line" href="classquda_1_1_g_m_res_d_r_args.html#a45955676da5461a45e9d4ab8177f94fc">   62</a></span>&#160;       <a class="code" href="namespacequda.html#a2f233a7e56c94294c14499a3039419bd">VectorSet</a>   <a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a45955676da5461a45e9d4ab8177f94fc">ritzVecs</a>;</div><div class="line"><a name="l00063"></a><span class="lineno"><a class="line" href="classquda_1_1_g_m_res_d_r_args.html#a52d0d00864b81e0ffbaa539c22c5d70c">   63</a></span>&#160;       <a class="code" href="namespacequda.html#a048501d184bc5c0d1e4462e80a80bb1a">DenseMatrix</a> <a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a52d0d00864b81e0ffbaa539c22c5d70c">H</a>;</div><div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="classquda_1_1_g_m_res_d_r_args.html#a18d2f271e259e35d3da1057a09db2552">   64</a></span>&#160;       <a class="code" href="namespacequda.html#a4e54927fc030027c7892b4bff973aaaa">Vector</a>      <a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a18d2f271e259e35d3da1057a09db2552">eta</a>;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div><div class="line"><a name="l00066"></a><span class="lineno"><a class="line" href="classquda_1_1_g_m_res_d_r_args.html#a5b6c28bfdbba046e8ab1fc9ffdcf9631">   66</a></span>&#160;       <span class="keywordtype">int</span> <a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a5b6c28bfdbba046e8ab1fc9ffdcf9631">m</a>;</div><div class="line"><a name="l00067"></a><span class="lineno"><a class="line" href="classquda_1_1_g_m_res_d_r_args.html#acc78f80e6b026bdc3b01b4e10ef3384b">   67</a></span>&#160;       <span class="keywordtype">int</span> <a class="code" href="classquda_1_1_g_m_res_d_r_args.html#acc78f80e6b026bdc3b01b4e10ef3384b">k</a>;</div><div class="line"><a name="l00068"></a><span class="lineno"><a class="line" href="classquda_1_1_g_m_res_d_r_args.html#a0ea7d2a0b9fb510d937a9c8d0b02c829">   68</a></span>&#160;       <span class="keywordtype">int</span> <a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a0ea7d2a0b9fb510d937a9c8d0b02c829">restarts</a>;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div><div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="classquda_1_1_g_m_res_d_r_args.html#a0a3ccd86622475e405b063e5984971df">   70</a></span>&#160;       <a class="code" href="namespacequda.html#a61eb8e0789e8a2021032ee12761d924e">Complex</a>      *<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a0a3ccd86622475e405b063e5984971df">c</a>;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div><div class="line"><a name="l00072"></a><span class="lineno"><a class="line" href="classquda_1_1_g_m_res_d_r_args.html#a6cab2bf187e516e1f75278efbf30c953">   72</a></span>&#160;       <a class="code" href="classquda_1_1_color_spinor_field.html">ColorSpinorFieldSet</a> *<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a6cab2bf187e516e1f75278efbf30c953">Vkp1</a>;<span class="comment">//high-precision accumulation array</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div><div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="classquda_1_1_g_m_res_d_r_args.html#a4782da16f0c7a813d77d982ddf769678">   74</a></span>&#160;       <a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a4782da16f0c7a813d77d982ddf769678">GMResDRArgs</a>(<span class="keywordtype">int</span> m, <span class="keywordtype">int</span> <a class="code" href="deflated__invert__test_8cpp.html#a015e64d999600a1ac5f5bdb700cd17b6">nev</a>) : ritzVecs(<a class="code" href="namespacequda.html#a2f233a7e56c94294c14499a3039419bd">VectorSet</a>::<a class="code" href="structquda_1_1_zero.html">Zero</a>(m+1,nev+1)), H(<a class="code" href="namespacequda.html#a048501d184bc5c0d1e4462e80a80bb1a">DenseMatrix</a>::<a class="code" href="structquda_1_1_zero.html">Zero</a>(m+1,m)),</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;       eta(<a class="code" href="namespacequda.html#a4e54927fc030027c7892b4bff973aaaa">Vector</a>::<a class="code" href="structquda_1_1_zero.html">Zero</a>(m)), m(m), k(nev), restarts(0), Vkp1(nullptr) { c = <span class="keyword">static_cast&lt;</span><a class="code" href="namespacequda.html#a61eb8e0789e8a2021032ee12761d924e">Complex</a>*<span class="keyword">&gt;</span> (ritzVecs.col(k).data()); }</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div><div class="line"><a name="l00077"></a><span class="lineno"><a class="line" href="classquda_1_1_g_m_res_d_r_args.html#a21af185e4244a593a559cd7daadf18d2">   77</a></span>&#160;       <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a21af185e4244a593a559cd7daadf18d2">ResetArgs</a>() {</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;         ritzVecs.setZero();</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;         H.setZero();</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;         eta.setZero();</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;       }</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div><div class="line"><a name="l00083"></a><span class="lineno"><a class="line" href="classquda_1_1_g_m_res_d_r_args.html#ad0c8d7fe7c408edb6d6bb1ca7c4009bb">   83</a></span>&#160;       <a class="code" href="classquda_1_1_g_m_res_d_r_args.html#ad0c8d7fe7c408edb6d6bb1ca7c4009bb">~GMResDRArgs</a>(){</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;          <span class="keywordflow">if</span>(Vkp1) <span class="keyword">delete</span> Vkp1;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;       }</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;   };</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div><div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="namespacequda.html#a41fcafde8faebbd48a2335dae94c0f2e">   88</a></span>&#160;   <span class="keyword">template</span>&lt;libtype which_lib&gt; <span class="keywordtype">void</span> <a class="code" href="namespacequda.html#a41fcafde8faebbd48a2335dae94c0f2e">ComputeHarmonicRitz</a>(<a class="code" href="classquda_1_1_g_m_res_d_r_args.html">GMResDRArgs</a> &amp;args) {<a class="code" href="util__quda_8h.html#af3bddfd9d113d50e8e0bbf58a35c5aac">errorQuda</a>(<span class="stringliteral">&quot;\nUnknown library type.\n&quot;</span>);}</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div><div class="line"><a name="l00090"></a><span class="lineno"><a class="line" href="namespacequda.html#a70335f89785e7fec8596640185e70900">   90</a></span>&#160;   <span class="keyword">template</span> &lt;&gt; <span class="keywordtype">void</span> ComputeHarmonicRitz&lt;libtype::magma_lib&gt;(<a class="code" href="classquda_1_1_g_m_res_d_r_args.html">GMResDRArgs</a> &amp;args)</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;   {</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="preprocessor">#ifdef MAGMA_LIB</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;     <a class="code" href="namespacequda.html#a048501d184bc5c0d1e4462e80a80bb1a">DenseMatrix</a> cH = args.H.block(0, 0, args.m, args.m).adjoint();</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;     <a class="code" href="namespacequda.html#a048501d184bc5c0d1e4462e80a80bb1a">DenseMatrix</a> Gk = args.H.block(0, 0, args.m, args.m);</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;     <a class="code" href="namespacequda.html#a2f233a7e56c94294c14499a3039419bd">VectorSet</a>  harVecs = MatrixXcd::Zero(args.m, args.m);</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;     <a class="code" href="namespacequda.html#a4e54927fc030027c7892b4bff973aaaa">Vector</a>     harVals = VectorXcd::Zero(args.m);</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;     <a class="code" href="namespacequda.html#a4e54927fc030027c7892b4bff973aaaa">Vector</a> em = VectorXcd::Zero(args.m);</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;     em(args.m-1) = <a class="code" href="namespacequda.html#abeed8b3819eb6b18921f208412fe40d1">norm</a>( args.H(args.m, args.m-1) );</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;     cudaHostRegister(static_cast&lt;void *&gt;(cH.data()), args.m*args.m*<span class="keyword">sizeof</span>(<a class="code" href="namespacequda.html#a61eb8e0789e8a2021032ee12761d924e">Complex</a>), cudaHostRegisterDefault);</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;     <a class="code" href="blas__magma_8h.html#a83177cddacc20617163e82b33b49f89d">magma_Xgesv</a>(static_cast&lt;void*&gt;(em.data()), args.m, args.m, static_cast&lt;void*&gt;(cH.data()), args.m, <span class="keyword">sizeof</span>(<a class="code" href="namespacequda.html#a61eb8e0789e8a2021032ee12761d924e">Complex</a>));</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;     cudaHostUnregister(cH.data());</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;     Gk.col(args.m-1) += em;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;     cudaHostRegister(static_cast&lt;void *&gt;(Gk.data()), args.m*args.m*<span class="keyword">sizeof</span>(<a class="code" href="namespacequda.html#a61eb8e0789e8a2021032ee12761d924e">Complex</a>), cudaHostRegisterDefault);</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;     <a class="code" href="blas__magma_8h.html#a9323e7558ddc6e85dfa71e723f54d5d0">magma_Xgeev</a>(static_cast&lt;void*&gt;(Gk.data()), args.m, args.m, static_cast&lt;void*&gt;(harVecs.data()), static_cast&lt;void*&gt;(harVals.data()), args.m, <span class="keyword">sizeof</span>(<a class="code" href="namespacequda.html#a61eb8e0789e8a2021032ee12761d924e">Complex</a>));</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;     cudaHostUnregister(Gk.data());</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;     std::vector&lt;SortedEvals&gt; sorted_evals;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;     sorted_evals.reserve(args.m);</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> e = 0; e &lt; args.m; e++) sorted_evals.push_back( <a class="code" href="structquda_1_1_sorted_evals.html">SortedEvals</a>( <a class="code" href="namespacequda.html#afc8f979be274d625e247ce913db49805">abs</a>(harVals.data()[e]), e ));</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;     std::stable_sort(sorted_evals.begin(), sorted_evals.end(), <a class="code" href="structquda_1_1_sorted_evals.html#ac5bfe99a7c0e428dd9c2bcde0986758b">SortedEvals::SelectSmall</a>);</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> e = 0; e &lt; args.k; e++) memcpy(args.ritzVecs.col(e).data(), harVecs.col(sorted_evals[e]._idx).data(), (args.m)*<span class="keyword">sizeof</span>(<a class="code" href="namespacequda.html#a61eb8e0789e8a2021032ee12761d924e">Complex</a>));</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <a class="code" href="util__quda_8h.html#af3bddfd9d113d50e8e0bbf58a35c5aac">errorQuda</a>(<span class="stringliteral">&quot;Magma library was not built.\n&quot;</span>);</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;     <span class="keywordflow">return</span>;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;   }</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div><div class="line"><a name="l00127"></a><span class="lineno"><a class="line" href="namespacequda.html#ac973fcc768c8805999bf969d55d74b6f">  127</a></span>&#160;   <span class="keyword">template</span> &lt;&gt; <span class="keywordtype">void</span> ComputeHarmonicRitz&lt;libtype::eigen_lib&gt;(<a class="code" href="classquda_1_1_g_m_res_d_r_args.html">GMResDRArgs</a> &amp;args)</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;   {</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;     <a class="code" href="namespacequda.html#a048501d184bc5c0d1e4462e80a80bb1a">DenseMatrix</a> cH = args.H.block(0, 0, args.m, args.m).adjoint();</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;     <a class="code" href="namespacequda.html#a048501d184bc5c0d1e4462e80a80bb1a">DenseMatrix</a> Gk = args.H.block(0, 0, args.m, args.m);</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;     <a class="code" href="namespacequda.html#a2f233a7e56c94294c14499a3039419bd">VectorSet</a>  harVecs = MatrixXcd::Zero(args.m, args.m);</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;     <a class="code" href="namespacequda.html#a4e54927fc030027c7892b4bff973aaaa">Vector</a>     harVals = VectorXcd::Zero(args.m);</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;     <a class="code" href="namespacequda.html#a4e54927fc030027c7892b4bff973aaaa">Vector</a> em = VectorXcd::Zero(args.m);</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;     em(args.m-1) = <a class="code" href="namespacequda.html#abeed8b3819eb6b18921f208412fe40d1">norm</a>( args.H(args.m, args.m-1) );</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;     Gk.col(args.m-1) += cH.colPivHouseholderQr().solve(em);</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;     ComplexEigenSolver&lt;DenseMatrix&gt; es( Gk );</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;     harVecs = es.eigenvectors();</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;     harVals = es.eigenvalues ();     </div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;     std::vector&lt;SortedEvals&gt; sorted_evals;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;     sorted_evals.reserve(args.m);</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> e = 0; e &lt; args.m; e++) sorted_evals.push_back( <a class="code" href="structquda_1_1_sorted_evals.html">SortedEvals</a>( <a class="code" href="namespacequda.html#afc8f979be274d625e247ce913db49805">abs</a>(harVals.data()[e]), e ));</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;     std::stable_sort(sorted_evals.begin(), sorted_evals.end(), <a class="code" href="structquda_1_1_sorted_evals.html#ac5bfe99a7c0e428dd9c2bcde0986758b">SortedEvals::SelectSmall</a>);</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> e = 0; e &lt; args.k; e++) memcpy(args.ritzVecs.col(e).data(), harVecs.col(sorted_evals[e]._idx).data(), (args.m)*<span class="keyword">sizeof</span>(<a class="code" href="namespacequda.html#a61eb8e0789e8a2021032ee12761d924e">Complex</a>));</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;     <span class="keywordflow">return</span>;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;   }</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div><div class="line"><a name="l00157"></a><span class="lineno"><a class="line" href="namespacequda.html#a05209eb0f1491ae099fc3c3e287fd0e2">  157</a></span>&#160;    <span class="keyword">template</span>&lt;libtype which_lib&gt; <span class="keywordtype">void</span> <a class="code" href="namespacequda.html#a05209eb0f1491ae099fc3c3e287fd0e2">ComputeEta</a>(<a class="code" href="classquda_1_1_g_m_res_d_r_args.html">GMResDRArgs</a> &amp;args) {<a class="code" href="util__quda_8h.html#af3bddfd9d113d50e8e0bbf58a35c5aac">errorQuda</a>(<span class="stringliteral">&quot;\nUnknown library type.\n&quot;</span>);}</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div><div class="line"><a name="l00159"></a><span class="lineno"><a class="line" href="namespacequda.html#afb3199dc8e4c0947782ffcc22db3ac8f">  159</a></span>&#160;    <span class="keyword">template</span> &lt;&gt; <span class="keywordtype">void</span> ComputeEta&lt;libtype::magma_lib&gt;(<a class="code" href="classquda_1_1_g_m_res_d_r_args.html">GMResDRArgs</a> &amp;args) {</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="preprocessor">#ifdef MAGMA_LIB</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;       <a class="code" href="namespacequda.html#a048501d184bc5c0d1e4462e80a80bb1a">DenseMatrix</a> Htemp(DenseMatrix::Zero(args.m+1,args.m));</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;       Htemp = args.H; </div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;       <a class="code" href="namespacequda.html#a61eb8e0789e8a2021032ee12761d924e">Complex</a> *ctemp = <span class="keyword">static_cast&lt;</span><a class="code" href="namespacequda.html#a61eb8e0789e8a2021032ee12761d924e">Complex</a>*<span class="keyword">&gt;</span> (args.ritzVecs.col(0).data());</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;       memcpy(ctemp, args.c, (args.m+1)*<span class="keyword">sizeof</span>(<a class="code" href="namespacequda.html#a61eb8e0789e8a2021032ee12761d924e">Complex</a>));</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;       cudaHostRegister(static_cast&lt;void*&gt;(Htemp.data()), (args.m+1)*args.m*<span class="keyword">sizeof</span>(<a class="code" href="namespacequda.html#a61eb8e0789e8a2021032ee12761d924e">Complex</a>), cudaHostRegisterDefault);</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;       <a class="code" href="blas__magma_8h.html#a4c2682b088feef2f297278a95dcbe6a7">magma_Xgels</a>(static_cast&lt;void*&gt;(Htemp.data()), ctemp, args.m+1, args.m, args.m+1, <span class="keyword">sizeof</span>(<a class="code" href="namespacequda.html#a61eb8e0789e8a2021032ee12761d924e">Complex</a>));</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;       cudaHostUnregister(Htemp.data());</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;       memcpy(args.eta.data(), ctemp, args.m*<span class="keyword">sizeof</span>(<a class="code" href="namespacequda.html#a61eb8e0789e8a2021032ee12761d924e">Complex</a>));</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;       <a class="code" href="covdev__reference_8cpp.html#ace6ee45c30e71865e6eb635200379db9">memset</a>(ctemp, 0, (args.m+1)*<span class="keyword">sizeof</span>(<a class="code" href="namespacequda.html#a61eb8e0789e8a2021032ee12761d924e">Complex</a>));</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;       <a class="code" href="util__quda_8h.html#af3bddfd9d113d50e8e0bbf58a35c5aac">errorQuda</a>(<span class="stringliteral">&quot;MAGMA library was not built.\n&quot;</span>);</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;       <span class="keywordflow">return</span>;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    }</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div><div class="line"><a name="l00179"></a><span class="lineno"><a class="line" href="namespacequda.html#ac761e18015fbe1267c34a15c9451b083">  179</a></span>&#160;    <span class="keyword">template</span> &lt;&gt; <span class="keywordtype">void</span> ComputeEta&lt;libtype::eigen_lib&gt;(<a class="code" href="classquda_1_1_g_m_res_d_r_args.html">GMResDRArgs</a> &amp;args) {</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        Map&lt;VectorXcd, Unaligned&gt; c_(args.c, args.m+1);</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        args.eta = args.H.jacobiSvd(ComputeThinU | ComputeThinV).solve(c_);</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;       <span class="keywordflow">return</span>;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    }</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div><div class="line"><a name="l00187"></a><span class="lineno"><a class="line" href="namespacequda.html#aa08cbb5f3fa8e32f80d4b2cccb7a97c9">  187</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="namespacequda.html#aa08cbb5f3fa8e32f80d4b2cccb7a97c9">fillFGMResDRInnerSolveParam</a>(<a class="code" href="structquda_1_1_solver_param.html">SolverParam</a> &amp;inner, <span class="keyword">const</span> <a class="code" href="structquda_1_1_solver_param.html">SolverParam</a> &amp;outer) {</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      inner.<a class="code" href="structquda_1_1_solver_param.html#aef9355993a1de99b8bbcdc8cd5cf69b6">tol</a> = outer.<a class="code" href="structquda_1_1_solver_param.html#a3f34e76909654cf2a43caad7b6f0c4b5">tol_precondition</a>;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      inner.<a class="code" href="structquda_1_1_solver_param.html#ad5129070fdc69c6b57efd2bc750cd9c2">maxiter</a> = outer.<a class="code" href="structquda_1_1_solver_param.html#a5905cdcaa6f29c4a13711519cfe4dc8f">maxiter_precondition</a>;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      inner.<a class="code" href="structquda_1_1_solver_param.html#af18615c6397944fea5f4618d70a5a67b">delta</a> = 1e-20; </div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      inner.<a class="code" href="structquda_1_1_solver_param.html#aadec9408096650515345b41cd54449ec">inv_type</a> = outer.<a class="code" href="structquda_1_1_solver_param.html#af06b403a0da6be2ed22244f7be0e8dac">inv_type_precondition</a>;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      inner.<a class="code" href="structquda_1_1_solver_param.html#a1dd05ed86fbade30927fa96d1d99d61f">precision</a> = outer.<a class="code" href="structquda_1_1_solver_param.html#a720f806cdd39be6b6a11146c7e70f3a8">precision_precondition</a>; </div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      inner.<a class="code" href="structquda_1_1_solver_param.html#a7748ac1dc90359e2eedb0d17e6396800">precision_sloppy</a> = outer.<a class="code" href="structquda_1_1_solver_param.html#a720f806cdd39be6b6a11146c7e70f3a8">precision_precondition</a>;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      inner.<a class="code" href="structquda_1_1_solver_param.html#a04e193e0d38b2606b1a8b4e1d2256efe">iter</a> = 0;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;      inner.<a class="code" href="structquda_1_1_solver_param.html#ada170467536dd4a3ebae68f6a8388cb8">gflops</a> = 0;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      inner.<a class="code" href="structquda_1_1_solver_param.html#ad4f1d65bdfd17f5647ac1cb2f972cd18">secs</a> = 0;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      inner.<a class="code" href="structquda_1_1_solver_param.html#af06b403a0da6be2ed22244f7be0e8dac">inv_type_precondition</a> = <a class="code" href="enum__quda_8h.html#ab5e5bf7e911a8cb377a808cb7e039c1aac9cd27c68bb634ee4fc1ee2b31599a94">QUDA_INVALID_INVERTER</a>;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      inner.<a class="code" href="structquda_1_1_solver_param.html#a330eed9c8f5a8423ae94ce6008de85c7">is_preconditioner</a> = <span class="keyword">true</span>; </div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      inner.<a class="code" href="structquda_1_1_solver_param.html#afc2dcb3798a9f65cb3ee8592b9383471">global_reduction</a>  = <span class="keyword">false</span>;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      <span class="keywordflow">if</span>(inner.<a class="code" href="structquda_1_1_solver_param.html#afc2dcb3798a9f65cb3ee8592b9383471">global_reduction</a>) <a class="code" href="util__quda_8h.html#add1a8e46583c4e0149436e17535afd39">warningQuda</a>(<span class="stringliteral">&quot;Set global reduction flag for preconditioner to true.\n&quot;</span>);</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      <span class="keywordflow">if</span> (outer.<a class="code" href="structquda_1_1_solver_param.html#a7748ac1dc90359e2eedb0d17e6396800">precision_sloppy</a> != outer.<a class="code" href="structquda_1_1_solver_param.html#a720f806cdd39be6b6a11146c7e70f3a8">precision_precondition</a>)</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        inner.<a class="code" href="structquda_1_1_solver_param.html#a01fc500d029447301b218003b79d7a5a">preserve_source</a> = <a class="code" href="enum__quda_8h.html#ab6aad69f1c1b3ec370b035c2b1e34654a6e639fc6aa06dab4fa7a41533c766aa3">QUDA_PRESERVE_SOURCE_NO</a>;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      <span class="keywordflow">else</span> inner.<a class="code" href="structquda_1_1_solver_param.html#a01fc500d029447301b218003b79d7a5a">preserve_source</a> = <a class="code" href="enum__quda_8h.html#ab6aad69f1c1b3ec370b035c2b1e34654a9590c690c29023cc12276ee1fdd7d5d6">QUDA_PRESERVE_SOURCE_YES</a>;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    }</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div><div class="line"><a name="l00211"></a><span class="lineno"><a class="line" href="classquda_1_1_g_m_res_d_r.html#ad0519a6febb874283214a327679acc90">  211</a></span>&#160; <a class="code" href="classquda_1_1_g_m_res_d_r.html#ad0519a6febb874283214a327679acc90">GMResDR::GMResDR</a>(<a class="code" href="classquda_1_1_dirac_matrix.html">DiracMatrix</a> &amp;<a class="code" href="covdev__reference_8cpp.html#ab0f599f28b95625a5325f690bfba3341">mat</a>, <a class="code" href="classquda_1_1_dirac_matrix.html">DiracMatrix</a> &amp;matSloppy, <a class="code" href="classquda_1_1_dirac_matrix.html">DiracMatrix</a> &amp;matPrecon, <a class="code" href="structquda_1_1_solver_param.html">SolverParam</a> &amp;<a class="code" href="pack__test_8cpp.html#aba126262dff054e28bac5c0d901769c8">param</a>, <a class="code" href="classquda_1_1_time_profile.html">TimeProfile</a> &amp;profile) :</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <a class="code" href="classquda_1_1_solver.html">Solver</a>(param, profile), mat(mat), matSloppy(matSloppy), matPrecon(matPrecon), K(nullptr), Kparam(param),</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    Vm(nullptr), Zm(nullptr), profile(profile), gmresdr_args(nullptr), <a class="code" href="namespacequda_1_1blas.html#a2f7aa9affb07827bc351c97272c8d5cb">init</a>(false)</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160; {</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;     <a class="code" href="namespacequda.html#aa08cbb5f3fa8e32f80d4b2cccb7a97c9">fillFGMResDRInnerSolveParam</a>(<a class="code" href="classquda_1_1_g_m_res_d_r.html#a927e8615258699ec3f104e6b3e94f026">Kparam</a>, param);</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;     <span class="keywordflow">if</span> (param.<a class="code" href="structquda_1_1_solver_param.html#af06b403a0da6be2ed22244f7be0e8dac">inv_type_precondition</a> == <a class="code" href="enum__quda_8h.html#ab5e5bf7e911a8cb377a808cb7e039c1aaa914b36d059d33cc2b0aaa0998713305">QUDA_CG_INVERTER</a>) </div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;       <a class="code" href="classquda_1_1_g_m_res_d_r.html#a2b6057a867c61df1c5b6891729b2296d">K</a> = <span class="keyword">new</span> <a class="code" href="classquda_1_1_c_g.html">CG</a>(matPrecon, matPrecon, <a class="code" href="classquda_1_1_g_m_res_d_r.html#a927e8615258699ec3f104e6b3e94f026">Kparam</a>, profile);</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (param.<a class="code" href="structquda_1_1_solver_param.html#af06b403a0da6be2ed22244f7be0e8dac">inv_type_precondition</a> == <a class="code" href="enum__quda_8h.html#ab5e5bf7e911a8cb377a808cb7e039c1aae3a4e0ccd59067afb3097aee327ff104">QUDA_BICGSTAB_INVERTER</a>) </div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;       <a class="code" href="classquda_1_1_g_m_res_d_r.html#a2b6057a867c61df1c5b6891729b2296d">K</a> = <span class="keyword">new</span> <a class="code" href="classquda_1_1_bi_c_gstab.html">BiCGstab</a>(matPrecon, matPrecon, matPrecon, <a class="code" href="classquda_1_1_g_m_res_d_r.html#a927e8615258699ec3f104e6b3e94f026">Kparam</a>, profile);</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (param.<a class="code" href="structquda_1_1_solver_param.html#af06b403a0da6be2ed22244f7be0e8dac">inv_type_precondition</a> == <a class="code" href="enum__quda_8h.html#ab5e5bf7e911a8cb377a808cb7e039c1aa2bcaf9358e1031be726e7c1d96ebd0ed">QUDA_MR_INVERTER</a>) </div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;       <a class="code" href="classquda_1_1_g_m_res_d_r.html#a2b6057a867c61df1c5b6891729b2296d">K</a> = <span class="keyword">new</span> <a class="code" href="classquda_1_1_m_r.html">MR</a>(matPrecon, matPrecon, <a class="code" href="classquda_1_1_g_m_res_d_r.html#a927e8615258699ec3f104e6b3e94f026">Kparam</a>, profile);</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (param.<a class="code" href="structquda_1_1_solver_param.html#af06b403a0da6be2ed22244f7be0e8dac">inv_type_precondition</a> == <a class="code" href="enum__quda_8h.html#ab5e5bf7e911a8cb377a808cb7e039c1aa938c70e5610785120c610c0795642f90">QUDA_SD_INVERTER</a>) </div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;       <a class="code" href="classquda_1_1_g_m_res_d_r.html#a2b6057a867c61df1c5b6891729b2296d">K</a> = <span class="keyword">new</span> <a class="code" href="classquda_1_1_s_d.html">SD</a>(matPrecon, <a class="code" href="classquda_1_1_g_m_res_d_r.html#a927e8615258699ec3f104e6b3e94f026">Kparam</a>, profile);</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (param.<a class="code" href="structquda_1_1_solver_param.html#af06b403a0da6be2ed22244f7be0e8dac">inv_type_precondition</a> == <a class="code" href="enum__quda_8h.html#ab5e5bf7e911a8cb377a808cb7e039c1aac9cd27c68bb634ee4fc1ee2b31599a94">QUDA_INVALID_INVERTER</a>) </div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;       <a class="code" href="classquda_1_1_g_m_res_d_r.html#a2b6057a867c61df1c5b6891729b2296d">K</a> = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;     <span class="keywordflow">else</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;       <a class="code" href="util__quda_8h.html#af3bddfd9d113d50e8e0bbf58a35c5aac">errorQuda</a>(<span class="stringliteral">&quot;Unsupported preconditioner %d\n&quot;</span>, param.<a class="code" href="structquda_1_1_solver_param.html#af06b403a0da6be2ed22244f7be0e8dac">inv_type_precondition</a>);</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;     <span class="keywordflow">return</span>;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160; }</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div><div class="line"><a name="l00234"></a><span class="lineno"><a class="line" href="classquda_1_1_g_m_res_d_r.html#a941dd2a5df13a19f3bad7b8ca1ff58e6">  234</a></span>&#160; <a class="code" href="classquda_1_1_g_m_res_d_r.html#ad0519a6febb874283214a327679acc90">GMResDR::GMResDR</a>(<a class="code" href="classquda_1_1_dirac_matrix.html">DiracMatrix</a> &amp;<a class="code" href="classquda_1_1_g_m_res_d_r.html#acfa1984fd2a84206e9fd88b73030a477">mat</a>, <a class="code" href="classquda_1_1_solver.html">Solver</a> &amp;<a class="code" href="classquda_1_1_g_m_res_d_r.html#a2b6057a867c61df1c5b6891729b2296d">K</a>, <a class="code" href="classquda_1_1_dirac_matrix.html">DiracMatrix</a> &amp;<a class="code" href="classquda_1_1_g_m_res_d_r.html#add765917232ad6d8c4536ea480fd157c">matSloppy</a>, <a class="code" href="classquda_1_1_dirac_matrix.html">DiracMatrix</a> &amp;<a class="code" href="classquda_1_1_g_m_res_d_r.html#ad71f1c06889adcbbe03631605062868c">matPrecon</a>, <a class="code" href="structquda_1_1_solver_param.html">SolverParam</a> &amp;<a class="code" href="classquda_1_1_solver.html#a9c3ee5319f85ec0cf5aa24d76894c398">param</a>, <a class="code" href="classquda_1_1_time_profile.html">TimeProfile</a> &amp;<a class="code" href="classquda_1_1_g_m_res_d_r.html#a82df151bcb020cda83a85173075d195d">profile</a>) :</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <a class="code" href="classquda_1_1_solver.html">Solver</a>(param, profile), mat(mat), matSloppy(matSloppy), matPrecon(matPrecon), K(&amp;K), <a class="code" href="classquda_1_1_g_m_res_d_r.html#a927e8615258699ec3f104e6b3e94f026">Kparam</a>(param),</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <a class="code" href="classquda_1_1_g_m_res_d_r.html#a58e6efaac94a868c161a37041a04e4a4">Vm</a>(nullptr), <a class="code" href="classquda_1_1_g_m_res_d_r.html#aa356e09c2bc1434569cdeeece24c206c">Zm</a>(nullptr), profile(profile), <a class="code" href="classquda_1_1_g_m_res_d_r.html#ae01b44d79309567db5f9b526415b847c">gmresdr_args</a>(nullptr), <a class="code" href="classquda_1_1_g_m_res_d_r.html#acde25806853722112cbb742f2a38f5e1">init</a>(false) { }</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;</div><div class="line"><a name="l00239"></a><span class="lineno"><a class="line" href="classquda_1_1_g_m_res_d_r.html#a53e3a4ceb32f2dcffaeab3499104b39d">  239</a></span>&#160; <a class="code" href="classquda_1_1_g_m_res_d_r.html#a53e3a4ceb32f2dcffaeab3499104b39d">GMResDR::~GMResDR</a>() {</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <a class="code" href="classquda_1_1_g_m_res_d_r.html#a82df151bcb020cda83a85173075d195d">profile</a>.TPSTART(<a class="code" href="namespacequda.html#a8ad4f224c5228606d725a5f9a96c3f23abf06d3d3c0e941387d6662448f761c08">QUDA_PROFILE_FREE</a>);</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classquda_1_1_g_m_res_d_r.html#acde25806853722112cbb742f2a38f5e1">init</a>)</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    {</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      <span class="keyword">delete</span> <a class="code" href="classquda_1_1_g_m_res_d_r.html#a58e6efaac94a868c161a37041a04e4a4">Vm</a>;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      <a class="code" href="classquda_1_1_g_m_res_d_r.html#a58e6efaac94a868c161a37041a04e4a4">Vm</a> = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      <span class="keyword">delete</span> <a class="code" href="classquda_1_1_g_m_res_d_r.html#a3c6b4a95ec42fc1b99b7eea4439d9ed2">r_sloppy</a>;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="classquda_1_1_g_m_res_d_r.html#a2b6057a867c61df1c5b6891729b2296d">K</a> &amp;&amp; (<a class="code" href="classquda_1_1_solver.html#a9c3ee5319f85ec0cf5aa24d76894c398">param</a>.<a class="code" href="structquda_1_1_solver_param.html#a720f806cdd39be6b6a11146c7e70f3a8">precision_precondition</a> != <a class="code" href="classquda_1_1_solver.html#a9c3ee5319f85ec0cf5aa24d76894c398">param</a>.<a class="code" href="structquda_1_1_solver_param.html#a7748ac1dc90359e2eedb0d17e6396800">precision_sloppy</a>))</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;      {</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        <span class="keyword">delete</span> <a class="code" href="classquda_1_1_g_m_res_d_r.html#a49c5b1e0af32ef91d4c817dd0a5ff6f9">r_pre</a>;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        <span class="keyword">delete</span> <a class="code" href="classquda_1_1_g_m_res_d_r.html#ad7148d82c10b8450b407f3fb359fafb7">p_pre</a>;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;      }</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="classquda_1_1_g_m_res_d_r.html#a2b6057a867c61df1c5b6891729b2296d">K</a>) {</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        <span class="keyword">delete</span> <a class="code" href="classquda_1_1_g_m_res_d_r.html#aa356e09c2bc1434569cdeeece24c206c">Zm</a>;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        <span class="keyword">delete</span> <a class="code" href="classquda_1_1_g_m_res_d_r.html#a2b6057a867c61df1c5b6891729b2296d">K</a>;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      }</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      <span class="keyword">delete</span> <a class="code" href="classquda_1_1_g_m_res_d_r.html#ad4433f6c83710e695edbbe61223fb475">tmpp</a>;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;      <span class="keyword">delete</span> <a class="code" href="classquda_1_1_g_m_res_d_r.html#aaccc968217a0503d56ed3850796f9f25">yp</a>;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;      <span class="keyword">delete</span> <a class="code" href="classquda_1_1_g_m_res_d_r.html#a7da349796380d408e58d928b8f9f5935">rp</a>;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;      <span class="keyword">delete</span> <a class="code" href="classquda_1_1_g_m_res_d_r.html#ae01b44d79309567db5f9b526415b847c">gmresdr_args</a>;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    }</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;   <a class="code" href="classquda_1_1_g_m_res_d_r.html#a82df151bcb020cda83a85173075d195d">profile</a>.TPSTOP(<a class="code" href="namespacequda.html#a8ad4f224c5228606d725a5f9a96c3f23abf06d3d3c0e941387d6662448f761c08">QUDA_PROFILE_FREE</a>);</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160; }</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;</div><div class="line"><a name="l00271"></a><span class="lineno"><a class="line" href="classquda_1_1_g_m_res_d_r.html#a80f9173c2c04c21db51934fa85521e4e">  271</a></span>&#160; <span class="keywordtype">void</span> <a class="code" href="classquda_1_1_g_m_res_d_r.html#a80f9173c2c04c21db51934fa85521e4e">GMResDR::UpdateSolution</a>(<a class="code" href="classquda_1_1_color_spinor_field.html">ColorSpinorField</a> *x, <a class="code" href="classquda_1_1_color_spinor_field.html">ColorSpinorField</a> *r, <span class="keywordtype">bool</span> do_gels)</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160; {</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;   <a class="code" href="classquda_1_1_g_m_res_d_r_args.html">GMResDRArgs</a> &amp;args = *<a class="code" href="classquda_1_1_g_m_res_d_r.html#ae01b44d79309567db5f9b526415b847c">gmresdr_args</a>;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;   <span class="keywordflow">if</span>(do_gels) {</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;     <span class="keywordflow">if</span> (  <a class="code" href="classquda_1_1_solver.html#a9c3ee5319f85ec0cf5aa24d76894c398">param</a>.<a class="code" href="structquda_1_1_solver_param.html#a4f5f41719adba83da90880163117fe4c">extlib_type</a> == <a class="code" href="enum__quda_8h.html#acedff361cdcb3099a97d8ccf632f74e4a3d7c76525d6d9d78bc280271ff861b92">QUDA_MAGMA_EXTLIB</a> ) { </div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;       ComputeEta&lt;libtype::magma_lib&gt;(args);</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (  <a class="code" href="classquda_1_1_solver.html#a9c3ee5319f85ec0cf5aa24d76894c398">param</a>.<a class="code" href="structquda_1_1_solver_param.html#a4f5f41719adba83da90880163117fe4c">extlib_type</a> == <a class="code" href="enum__quda_8h.html#acedff361cdcb3099a97d8ccf632f74e4a2fbbc2c4c6359a721cde5036ee850306">QUDA_EIGEN_EXTLIB</a> ) {</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;       ComputeEta&lt;libtype::eigen_lib&gt;(args);</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;     } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;       <a class="code" href="util__quda_8h.html#af3bddfd9d113d50e8e0bbf58a35c5aac">errorQuda</a>(<span class="stringliteral">&quot;Library type %d is currently not supported.\n&quot;</span>, <a class="code" href="classquda_1_1_solver.html#a9c3ee5319f85ec0cf5aa24d76894c398">param</a>.<a class="code" href="structquda_1_1_solver_param.html#a4f5f41719adba83da90880163117fe4c">extlib_type</a>);</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;     }</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;   }</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;   std::vector&lt;ColorSpinorField*&gt; Z_(<a class="code" href="classquda_1_1_g_m_res_d_r.html#aa356e09c2bc1434569cdeeece24c206c">Zm</a>-&gt;<a class="code" href="classquda_1_1_color_spinor_field.html#a59441fb61d11540d7d02de34e9ce4c6b">Components</a>().begin(),<a class="code" href="classquda_1_1_g_m_res_d_r.html#aa356e09c2bc1434569cdeeece24c206c">Zm</a>-&gt;<a class="code" href="classquda_1_1_color_spinor_field.html#a59441fb61d11540d7d02de34e9ce4c6b">Components</a>().begin()+args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a5b6c28bfdbba046e8ab1fc9ffdcf9631">m</a>);</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;   std::vector&lt;ColorSpinorField*&gt; V_(<a class="code" href="classquda_1_1_g_m_res_d_r.html#a58e6efaac94a868c161a37041a04e4a4">Vm</a>-&gt;<a class="code" href="classquda_1_1_color_spinor_field.html#a59441fb61d11540d7d02de34e9ce4c6b">Components</a>());</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;   std::vector&lt;ColorSpinorField*&gt; x_, r_;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;   x_.push_back(x), r_.push_back(r);</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;   <a class="code" href="namespacequda_1_1blas.html#ae3e5e69d87a6db7678c8fb7dc14daca7">blas::caxpy</a>( static_cast&lt;Complex*&gt; ( args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a18d2f271e259e35d3da1057a09db2552">eta</a>.data()), Z_, x_);</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;   VectorXcd minusHeta = - (args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a52d0d00864b81e0ffbaa539c22c5d70c">H</a> * args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a18d2f271e259e35d3da1057a09db2552">eta</a>);</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;   Map&lt;VectorXcd, Unaligned&gt; c_(args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a0a3ccd86622475e405b063e5984971df">c</a>, args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a5b6c28bfdbba046e8ab1fc9ffdcf9631">m</a>+1);</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;   c_ += minusHeta;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;   <a class="code" href="namespacequda_1_1blas.html#ae3e5e69d87a6db7678c8fb7dc14daca7">blas::caxpy</a>(static_cast&lt;Complex*&gt;(minusHeta.data()), V_, r_);</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;   <span class="keywordflow">return</span>;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160; }</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div><div class="line"><a name="l00302"></a><span class="lineno"><a class="line" href="classquda_1_1_g_m_res_d_r.html#a02994b126eca34ff3741341042242ec7">  302</a></span>&#160; <span class="keywordtype">void</span> <a class="code" href="classquda_1_1_g_m_res_d_r.html#a02994b126eca34ff3741341042242ec7">GMResDR::RestartVZH</a>()</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160; {</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;   <a class="code" href="classquda_1_1_g_m_res_d_r_args.html">GMResDRArgs</a> &amp;args = *<a class="code" href="classquda_1_1_g_m_res_d_r.html#ae01b44d79309567db5f9b526415b847c">gmresdr_args</a>;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;   <span class="keywordflow">if</span> ( <a class="code" href="classquda_1_1_solver.html#a9c3ee5319f85ec0cf5aa24d76894c398">param</a>.<a class="code" href="structquda_1_1_solver_param.html#a4f5f41719adba83da90880163117fe4c">extlib_type</a> == <a class="code" href="enum__quda_8h.html#acedff361cdcb3099a97d8ccf632f74e4a3d7c76525d6d9d78bc280271ff861b92">QUDA_MAGMA_EXTLIB</a> ) { </div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;     ComputeHarmonicRitz&lt;libtype::magma_lib&gt;(args);</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="classquda_1_1_solver.html#a9c3ee5319f85ec0cf5aa24d76894c398">param</a>.<a class="code" href="structquda_1_1_solver_param.html#a4f5f41719adba83da90880163117fe4c">extlib_type</a> == <a class="code" href="enum__quda_8h.html#acedff361cdcb3099a97d8ccf632f74e4a2fbbc2c4c6359a721cde5036ee850306">QUDA_EIGEN_EXTLIB</a>) {</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;     ComputeHarmonicRitz&lt;libtype::eigen_lib&gt;(args);</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;     <a class="code" href="util__quda_8h.html#af3bddfd9d113d50e8e0bbf58a35c5aac">errorQuda</a>(<span class="stringliteral">&quot;Library type %d is currently not supported.\n&quot;</span>, <a class="code" href="classquda_1_1_solver.html#a9c3ee5319f85ec0cf5aa24d76894c398">param</a>.<a class="code" href="structquda_1_1_solver_param.html#a4f5f41719adba83da90880163117fe4c">extlib_type</a>);</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;   }</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;   <a class="code" href="namespacequda.html#a048501d184bc5c0d1e4462e80a80bb1a">DenseMatrix</a> Qkp1(MatrixXcd::Identity((args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a5b6c28bfdbba046e8ab1fc9ffdcf9631">m</a>+1), (args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#acc78f80e6b026bdc3b01b4e10ef3384b">k</a>+1)));</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;   HouseholderQR&lt;MatrixXcd&gt; qr(args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a45955676da5461a45e9d4ab8177f94fc">ritzVecs</a>);</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;   Qkp1.applyOnTheLeft( qr.householderQ());</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;   <a class="code" href="namespacequda.html#a048501d184bc5c0d1e4462e80a80bb1a">DenseMatrix</a> Res = Qkp1.adjoint()*args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a52d0d00864b81e0ffbaa539c22c5d70c">H</a>*Qkp1.topLeftCorner(args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a5b6c28bfdbba046e8ab1fc9ffdcf9631">m</a>, args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#acc78f80e6b026bdc3b01b4e10ef3384b">k</a>);</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;   args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a52d0d00864b81e0ffbaa539c22c5d70c">H</a>.setZero();</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;   args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a52d0d00864b81e0ffbaa539c22c5d70c">H</a>.topLeftCorner(args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#acc78f80e6b026bdc3b01b4e10ef3384b">k</a>+1, args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#acc78f80e6b026bdc3b01b4e10ef3384b">k</a>) = Res;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;   <a class="code" href="namespacequda_1_1blas.html#ab738546293a39098f5c9bdb3c1ea6876">blas::zero</a>( *args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a6cab2bf187e516e1f75278efbf30c953">Vkp1</a> );</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;   std::vector&lt;ColorSpinorField*&gt; vkp1(args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a6cab2bf187e516e1f75278efbf30c953">Vkp1</a>-&gt;<a class="code" href="classquda_1_1_color_spinor_field.html#a59441fb61d11540d7d02de34e9ce4c6b">Components</a>());</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;   std::vector&lt;ColorSpinorField*&gt; vm  (<a class="code" href="classquda_1_1_g_m_res_d_r.html#a58e6efaac94a868c161a37041a04e4a4">Vm</a>-&gt;<a class="code" href="classquda_1_1_color_spinor_field.html#a59441fb61d11540d7d02de34e9ce4c6b">Components</a>());</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;   <a class="code" href="classquda_1_1_matrix.html">RowMajorDenseMatrix</a> Alpha(Qkp1);<span class="comment">//convert Qkp1 to Row-major format first  </span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;   <a class="code" href="namespacequda_1_1blas.html#ae3e5e69d87a6db7678c8fb7dc14daca7">blas::caxpy</a>(static_cast&lt;Complex*&gt;(Alpha.data()), vm , vkp1); </div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; (args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a5b6c28bfdbba046e8ab1fc9ffdcf9631">m</a>+1); i++)</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;   {</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;     <span class="keywordflow">if</span>(i &lt; (args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#acc78f80e6b026bdc3b01b4e10ef3384b">k</a>+1) )</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;     {</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;       <a class="code" href="namespacequda_1_1blas.html#aee938c63ad4eaa9d0ccc7d50013a5618">blas::copy</a>(<a class="code" href="classquda_1_1_g_m_res_d_r.html#a58e6efaac94a868c161a37041a04e4a4">Vm</a>-&gt;<a class="code" href="classquda_1_1_color_spinor_field.html#ae0819f9471411d51352d86d5b12ef830">Component</a>(i), args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a6cab2bf187e516e1f75278efbf30c953">Vkp1</a>-&gt;<a class="code" href="classquda_1_1_color_spinor_field.html#ae0819f9471411d51352d86d5b12ef830">Component</a>(i));</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;       <a class="code" href="namespacequda_1_1blas.html#ab738546293a39098f5c9bdb3c1ea6876">blas::zero</a>(args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a6cab2bf187e516e1f75278efbf30c953">Vkp1</a>-&gt;<a class="code" href="classquda_1_1_color_spinor_field.html#ae0819f9471411d51352d86d5b12ef830">Component</a>(i));</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;     }</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;     <span class="keywordflow">else</span> <a class="code" href="namespacequda_1_1blas.html#ab738546293a39098f5c9bdb3c1ea6876">blas::zero</a>(<a class="code" href="classquda_1_1_g_m_res_d_r.html#a58e6efaac94a868c161a37041a04e4a4">Vm</a>-&gt;<a class="code" href="classquda_1_1_color_spinor_field.html#ae0819f9471411d51352d86d5b12ef830">Component</a>(i));</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;   }</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;   <span class="keywordflow">if</span>( <a class="code" href="classquda_1_1_g_m_res_d_r.html#aa356e09c2bc1434569cdeeece24c206c">Zm</a>-&gt;<a class="code" href="classquda_1_1_color_spinor_field.html#abce013c01320309ed37e5ce64f6d42a0">V</a>() != <a class="code" href="classquda_1_1_g_m_res_d_r.html#a58e6efaac94a868c161a37041a04e4a4">Vm</a>-&gt;<a class="code" href="classquda_1_1_color_spinor_field.html#abce013c01320309ed37e5ce64f6d42a0">V</a>() )</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;   {</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;     std::vector&lt;ColorSpinorField*&gt; z (<a class="code" href="classquda_1_1_g_m_res_d_r.html#aa356e09c2bc1434569cdeeece24c206c">Zm</a>-&gt;<a class="code" href="classquda_1_1_color_spinor_field.html#a59441fb61d11540d7d02de34e9ce4c6b">Components</a>());</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;     std::vector&lt;ColorSpinorField*&gt; vk(args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a6cab2bf187e516e1f75278efbf30c953">Vkp1</a>-&gt;<a class="code" href="classquda_1_1_color_spinor_field.html#a59441fb61d11540d7d02de34e9ce4c6b">Components</a>().begin(),args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a6cab2bf187e516e1f75278efbf30c953">Vkp1</a>-&gt;<a class="code" href="classquda_1_1_color_spinor_field.html#a59441fb61d11540d7d02de34e9ce4c6b">Components</a>().begin()+args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#acc78f80e6b026bdc3b01b4e10ef3384b">k</a>);</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;     <a class="code" href="classquda_1_1_matrix.html">RowMajorDenseMatrix</a> Beta(Qkp1.topLeftCorner(args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a5b6c28bfdbba046e8ab1fc9ffdcf9631">m</a>,args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#acc78f80e6b026bdc3b01b4e10ef3384b">k</a>));</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;     <a class="code" href="namespacequda_1_1blas.html#ae3e5e69d87a6db7678c8fb7dc14daca7">blas::caxpy</a>(static_cast&lt;Complex*&gt;(Beta.data()), z , vk);</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; (args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a5b6c28bfdbba046e8ab1fc9ffdcf9631">m</a>); i++)</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;     {</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;       <span class="keywordflow">if</span>( i &lt; (args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#acc78f80e6b026bdc3b01b4e10ef3384b">k</a>) ) <a class="code" href="namespacequda_1_1blas.html#aee938c63ad4eaa9d0ccc7d50013a5618">blas::copy</a>(<a class="code" href="classquda_1_1_g_m_res_d_r.html#aa356e09c2bc1434569cdeeece24c206c">Zm</a>-&gt;<a class="code" href="classquda_1_1_color_spinor_field.html#ae0819f9471411d51352d86d5b12ef830">Component</a>(i), args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a6cab2bf187e516e1f75278efbf30c953">Vkp1</a>-&gt;<a class="code" href="classquda_1_1_color_spinor_field.html#ae0819f9471411d51352d86d5b12ef830">Component</a>(i));</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;       <span class="keywordflow">else</span>               <a class="code" href="namespacequda_1_1blas.html#ab738546293a39098f5c9bdb3c1ea6876">blas::zero</a>(<a class="code" href="classquda_1_1_g_m_res_d_r.html#aa356e09c2bc1434569cdeeece24c206c">Zm</a>-&gt;<a class="code" href="classquda_1_1_color_spinor_field.html#ae0819f9471411d51352d86d5b12ef830">Component</a>(i));</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;     }</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;   }</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;   <a class="code" href="util__quda_8h.html#a7668e6580e0f57b0db3112fae4959e34">checkCudaError</a>();</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#acc78f80e6b026bdc3b01b4e10ef3384b">k</a>; j++)</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;   {</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;     <a class="code" href="namespacequda.html#a61eb8e0789e8a2021032ee12761d924e">Complex</a> alpha = <a class="code" href="namespacequda_1_1blas.html#af3cffbae4092951f3b76c26f842d1db3">cDotProduct</a>(<a class="code" href="classquda_1_1_g_m_res_d_r.html#a58e6efaac94a868c161a37041a04e4a4">Vm</a>-&gt;<a class="code" href="classquda_1_1_color_spinor_field.html#ae0819f9471411d51352d86d5b12ef830">Component</a>(j), <a class="code" href="classquda_1_1_g_m_res_d_r.html#a58e6efaac94a868c161a37041a04e4a4">Vm</a>-&gt;<a class="code" href="classquda_1_1_color_spinor_field.html#ae0819f9471411d51352d86d5b12ef830">Component</a>(args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#acc78f80e6b026bdc3b01b4e10ef3384b">k</a>));</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;     <a class="code" href="namespacequda.html#aaffbb8136180ff3fc91d20933dc1e1a3">caxpy</a>(-alpha, <a class="code" href="classquda_1_1_g_m_res_d_r.html#a58e6efaac94a868c161a37041a04e4a4">Vm</a>-&gt;<a class="code" href="classquda_1_1_color_spinor_field.html#ae0819f9471411d51352d86d5b12ef830">Component</a>(j), <a class="code" href="classquda_1_1_g_m_res_d_r.html#a58e6efaac94a868c161a37041a04e4a4">Vm</a>-&gt;<a class="code" href="classquda_1_1_color_spinor_field.html#ae0819f9471411d51352d86d5b12ef830">Component</a>(args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#acc78f80e6b026bdc3b01b4e10ef3384b">k</a>));</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;   }</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;   <a class="code" href="namespacequda_1_1blas.html#a9a001f8e31cfe48d8b3b67db4b14dd92">blas::ax</a>(1.0/ <a class="code" href="namespacequda.html#a6a71833ed525c0d7a4c0d7bfaf48a6d2">sqrt</a>(<a class="code" href="namespacequda_1_1blas.html#ab8b470443eb61a4c95b5f996ff485e15">blas::norm2</a>(<a class="code" href="classquda_1_1_g_m_res_d_r.html#a58e6efaac94a868c161a37041a04e4a4">Vm</a>-&gt;<a class="code" href="classquda_1_1_color_spinor_field.html#ae0819f9471411d51352d86d5b12ef830">Component</a>(args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#acc78f80e6b026bdc3b01b4e10ef3384b">k</a>))), <a class="code" href="classquda_1_1_g_m_res_d_r.html#a58e6efaac94a868c161a37041a04e4a4">Vm</a>-&gt;<a class="code" href="classquda_1_1_color_spinor_field.html#ae0819f9471411d51352d86d5b12ef830">Component</a>(args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#acc78f80e6b026bdc3b01b4e10ef3384b">k</a>));</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;   args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a45955676da5461a45e9d4ab8177f94fc">ritzVecs</a>.setZero();</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;   <span class="keywordflow">return</span>;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160; }</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;</div><div class="line"><a name="l00371"></a><span class="lineno"><a class="line" href="classquda_1_1_g_m_res_d_r.html#aa869a115446b88110dcbf22c55e8d9b7">  371</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classquda_1_1_g_m_res_d_r.html#aa869a115446b88110dcbf22c55e8d9b7">GMResDR::FlexArnoldiProcedure</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> start_idx, <span class="keyword">const</span> <span class="keywordtype">bool</span> do_givens = <span class="keyword">false</span>)</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160; {</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;   <span class="keywordtype">int</span> j = start_idx;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;   <a class="code" href="classquda_1_1_g_m_res_d_r_args.html">GMResDRArgs</a> &amp;args = *<a class="code" href="classquda_1_1_g_m_res_d_r.html#ae01b44d79309567db5f9b526415b847c">gmresdr_args</a>;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;   <a class="code" href="classquda_1_1_color_spinor_field.html">ColorSpinorField</a> &amp;<a class="code" href="covdev__test_8cpp.html#a788da19b1cbae7d08eb18da226046dd7">tmp</a> = *<a class="code" href="classquda_1_1_g_m_res_d_r.html#ad4433f6c83710e695edbbe61223fb475">tmpp</a>;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;   std::unique_ptr&lt;Complex[] &gt; givensH((do_givens) ? <span class="keyword">new</span> <a class="code" href="namespacequda.html#a61eb8e0789e8a2021032ee12761d924e">Complex</a>[(args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a5b6c28bfdbba046e8ab1fc9ffdcf9631">m</a>+1)*args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a5b6c28bfdbba046e8ab1fc9ffdcf9631">m</a>] : <span class="keyword">nullptr</span>);</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;   std::unique_ptr&lt;Complex[] &gt; cn((do_givens) ? <span class="keyword">new</span> <a class="code" href="namespacequda.html#a61eb8e0789e8a2021032ee12761d924e">Complex</a>[args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a5b6c28bfdbba046e8ab1fc9ffdcf9631">m</a>] : <span class="keyword">nullptr</span>);</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;   std::unique_ptr&lt;double[]  &gt; sn((do_givens) ? <span class="keyword">new</span> <span class="keywordtype">double</span>[args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a5b6c28bfdbba046e8ab1fc9ffdcf9631">m</a>] : <span class="keyword">nullptr</span>);</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;   Complex c0 = args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a0a3ccd86622475e405b063e5984971df">c</a>[0];</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;   <span class="keywordflow">while</span>( j &lt; args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a5b6c28bfdbba046e8ab1fc9ffdcf9631">m</a> ) </div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;   {</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;     <span class="keywordflow">if</span>(<a class="code" href="classquda_1_1_g_m_res_d_r.html#a2b6057a867c61df1c5b6891729b2296d">K</a>) {</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;       <a class="code" href="classquda_1_1_color_spinor_field.html">ColorSpinorField</a> &amp;inPre  = (<a class="code" href="classquda_1_1_solver.html#a9c3ee5319f85ec0cf5aa24d76894c398">param</a>.<a class="code" href="structquda_1_1_solver_param.html#a720f806cdd39be6b6a11146c7e70f3a8">precision_precondition</a> != <a class="code" href="classquda_1_1_solver.html#a9c3ee5319f85ec0cf5aa24d76894c398">param</a>.<a class="code" href="structquda_1_1_solver_param.html#a7748ac1dc90359e2eedb0d17e6396800">precision_sloppy</a>) ? *<a class="code" href="classquda_1_1_g_m_res_d_r.html#a49c5b1e0af32ef91d4c817dd0a5ff6f9">r_pre</a> : <a class="code" href="classquda_1_1_g_m_res_d_r.html#a58e6efaac94a868c161a37041a04e4a4">Vm</a>-&gt;<a class="code" href="classquda_1_1_color_spinor_field.html#ae0819f9471411d51352d86d5b12ef830">Component</a>(j);</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;       <a class="code" href="classquda_1_1_color_spinor_field.html">ColorSpinorField</a> &amp;outPre = (<a class="code" href="classquda_1_1_solver.html#a9c3ee5319f85ec0cf5aa24d76894c398">param</a>.<a class="code" href="structquda_1_1_solver_param.html#a720f806cdd39be6b6a11146c7e70f3a8">precision_precondition</a> != <a class="code" href="classquda_1_1_solver.html#a9c3ee5319f85ec0cf5aa24d76894c398">param</a>.<a class="code" href="structquda_1_1_solver_param.html#a7748ac1dc90359e2eedb0d17e6396800">precision_sloppy</a>) ? *<a class="code" href="classquda_1_1_g_m_res_d_r.html#ad7148d82c10b8450b407f3fb359fafb7">p_pre</a> : <a class="code" href="classquda_1_1_g_m_res_d_r.html#aa356e09c2bc1434569cdeeece24c206c">Zm</a>-&gt;<a class="code" href="classquda_1_1_color_spinor_field.html#ae0819f9471411d51352d86d5b12ef830">Component</a>(j);</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;       <span class="keywordflow">if</span>(<a class="code" href="classquda_1_1_solver.html#a9c3ee5319f85ec0cf5aa24d76894c398">param</a>.<a class="code" href="structquda_1_1_solver_param.html#a720f806cdd39be6b6a11146c7e70f3a8">precision_precondition</a> != <a class="code" href="classquda_1_1_solver.html#a9c3ee5319f85ec0cf5aa24d76894c398">param</a>.<a class="code" href="structquda_1_1_solver_param.html#a7748ac1dc90359e2eedb0d17e6396800">precision_sloppy</a>) inPre = <a class="code" href="classquda_1_1_g_m_res_d_r.html#a58e6efaac94a868c161a37041a04e4a4">Vm</a>-&gt;<a class="code" href="classquda_1_1_color_spinor_field.html#ae0819f9471411d51352d86d5b12ef830">Component</a>(j);</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;       <a class="code" href="namespacequda.html#afdd60a37d49f6d12f8472e2a910e80c6">zero</a>(outPre);</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;       <a class="code" href="util__quda_8h.html#a13b05722eea48a935ab172483b89f3c7">pushVerbosity</a>(<a class="code" href="classquda_1_1_solver.html#a9c3ee5319f85ec0cf5aa24d76894c398">param</a>.<a class="code" href="structquda_1_1_solver_param.html#ab1e73c1c651b6f2277069ca289044f18">verbosity_precondition</a>);</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;       (*K)( outPre ,inPre );</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;       <a class="code" href="util__quda_8h.html#a7efc6647d04d720d7ec040e8348ef483">popVerbosity</a>();</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;       <span class="keywordflow">if</span>(<a class="code" href="classquda_1_1_solver.html#a9c3ee5319f85ec0cf5aa24d76894c398">param</a>.<a class="code" href="structquda_1_1_solver_param.html#a720f806cdd39be6b6a11146c7e70f3a8">precision_precondition</a> != <a class="code" href="classquda_1_1_solver.html#a9c3ee5319f85ec0cf5aa24d76894c398">param</a>.<a class="code" href="structquda_1_1_solver_param.html#a7748ac1dc90359e2eedb0d17e6396800">precision_sloppy</a>) <a class="code" href="classquda_1_1_g_m_res_d_r.html#aa356e09c2bc1434569cdeeece24c206c">Zm</a>-&gt;<a class="code" href="classquda_1_1_color_spinor_field.html#ae0819f9471411d51352d86d5b12ef830">Component</a>(j) = outPre;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;     }</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;     <a class="code" href="classquda_1_1_g_m_res_d_r.html#add765917232ad6d8c4536ea480fd157c">matSloppy</a>(<a class="code" href="classquda_1_1_g_m_res_d_r.html#a58e6efaac94a868c161a37041a04e4a4">Vm</a>-&gt;<a class="code" href="classquda_1_1_color_spinor_field.html#ae0819f9471411d51352d86d5b12ef830">Component</a>(j+1), <a class="code" href="classquda_1_1_g_m_res_d_r.html#aa356e09c2bc1434569cdeeece24c206c">Zm</a>-&gt;<a class="code" href="classquda_1_1_color_spinor_field.html#ae0819f9471411d51352d86d5b12ef830">Component</a>(j), <a class="code" href="covdev__test_8cpp.html#a788da19b1cbae7d08eb18da226046dd7">tmp</a>);</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;     args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a52d0d00864b81e0ffbaa539c22c5d70c">H</a>(0, j) = <a class="code" href="namespacequda_1_1blas.html#af3cffbae4092951f3b76c26f842d1db3">cDotProduct</a>(<a class="code" href="classquda_1_1_g_m_res_d_r.html#a58e6efaac94a868c161a37041a04e4a4">Vm</a>-&gt;<a class="code" href="classquda_1_1_color_spinor_field.html#ae0819f9471411d51352d86d5b12ef830">Component</a>(0), <a class="code" href="classquda_1_1_g_m_res_d_r.html#a58e6efaac94a868c161a37041a04e4a4">Vm</a>-&gt;<a class="code" href="classquda_1_1_color_spinor_field.html#ae0819f9471411d51352d86d5b12ef830">Component</a>(j+1));</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;     <a class="code" href="namespacequda.html#aaffbb8136180ff3fc91d20933dc1e1a3">caxpy</a>(-args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a52d0d00864b81e0ffbaa539c22c5d70c">H</a>(0, j), <a class="code" href="classquda_1_1_g_m_res_d_r.html#a58e6efaac94a868c161a37041a04e4a4">Vm</a>-&gt;<a class="code" href="classquda_1_1_color_spinor_field.html#ae0819f9471411d51352d86d5b12ef830">Component</a>(0), <a class="code" href="classquda_1_1_g_m_res_d_r.html#a58e6efaac94a868c161a37041a04e4a4">Vm</a>-&gt;<a class="code" href="classquda_1_1_color_spinor_field.html#ae0819f9471411d51352d86d5b12ef830">Component</a>(j+1));</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;     Complex h0 = do_givens ? args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a52d0d00864b81e0ffbaa539c22c5d70c">H</a>(0, j) : 0.0;</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 1; i &lt;= j; i++)</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;     {</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a52d0d00864b81e0ffbaa539c22c5d70c">H</a>(i, j) = <a class="code" href="namespacequda_1_1blas.html#af3cffbae4092951f3b76c26f842d1db3">cDotProduct</a>(<a class="code" href="classquda_1_1_g_m_res_d_r.html#a58e6efaac94a868c161a37041a04e4a4">Vm</a>-&gt;<a class="code" href="classquda_1_1_color_spinor_field.html#ae0819f9471411d51352d86d5b12ef830">Component</a>(i), <a class="code" href="classquda_1_1_g_m_res_d_r.html#a58e6efaac94a868c161a37041a04e4a4">Vm</a>-&gt;<a class="code" href="classquda_1_1_color_spinor_field.html#ae0819f9471411d51352d86d5b12ef830">Component</a>(j+1));</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        <a class="code" href="namespacequda.html#aaffbb8136180ff3fc91d20933dc1e1a3">caxpy</a>(-args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a52d0d00864b81e0ffbaa539c22c5d70c">H</a>(i, j), <a class="code" href="classquda_1_1_g_m_res_d_r.html#a58e6efaac94a868c161a37041a04e4a4">Vm</a>-&gt;<a class="code" href="classquda_1_1_color_spinor_field.html#ae0819f9471411d51352d86d5b12ef830">Component</a>(i), <a class="code" href="classquda_1_1_g_m_res_d_r.html#a58e6efaac94a868c161a37041a04e4a4">Vm</a>-&gt;<a class="code" href="classquda_1_1_color_spinor_field.html#ae0819f9471411d51352d86d5b12ef830">Component</a>(j+1));</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        <span class="keywordflow">if</span>(do_givens) {</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;           givensH[(args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a5b6c28bfdbba046e8ab1fc9ffdcf9631">m</a>+1)*j+(i-1)] = <a class="code" href="namespacequda.html#a043738f16cdeb082fa1a5158fbad36b3">conj</a>(cn[i-1])*h0 + sn[i-1]*args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a52d0d00864b81e0ffbaa539c22c5d70c">H</a>(i,j);</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;           h0 = -sn[i-1]*h0 + cn[i-1]*args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a52d0d00864b81e0ffbaa539c22c5d70c">H</a>(i,j);</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;        }</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;     }</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;     args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a52d0d00864b81e0ffbaa539c22c5d70c">H</a>(j+1, j) = <a class="code" href="namespacequda.html#a61eb8e0789e8a2021032ee12761d924e">Complex</a>(<a class="code" href="namespacequda.html#a6a71833ed525c0d7a4c0d7bfaf48a6d2">sqrt</a>(<a class="code" href="namespacequda.html#a3174ee67c7fa7d35dbdf37b13064e8b0">norm2</a>(<a class="code" href="classquda_1_1_g_m_res_d_r.html#a58e6efaac94a868c161a37041a04e4a4">Vm</a>-&gt;<a class="code" href="classquda_1_1_color_spinor_field.html#ae0819f9471411d51352d86d5b12ef830">Component</a>(j+1))), 0.0);</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;     <a class="code" href="namespacequda_1_1blas.html#a9a001f8e31cfe48d8b3b67db4b14dd92">blas::ax</a>( 1.0 / args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a52d0d00864b81e0ffbaa539c22c5d70c">H</a>(j+1, j).real(), <a class="code" href="classquda_1_1_g_m_res_d_r.html#a58e6efaac94a868c161a37041a04e4a4">Vm</a>-&gt;<a class="code" href="classquda_1_1_color_spinor_field.html#ae0819f9471411d51352d86d5b12ef830">Component</a>(j+1));</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;     <span class="keywordflow">if</span>(do_givens)</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;     {</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;       <span class="keywordtype">double</span> inv_denom = 1.0 / <a class="code" href="namespacequda.html#a6a71833ed525c0d7a4c0d7bfaf48a6d2">sqrt</a>(<a class="code" href="namespacequda.html#abeed8b3819eb6b18921f208412fe40d1">norm</a>(h0)+<a class="code" href="namespacequda.html#abeed8b3819eb6b18921f208412fe40d1">norm</a>(args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a52d0d00864b81e0ffbaa539c22c5d70c">H</a>(j+1,j)));</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;       cn[j] = h0 * inv_denom;</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;       sn[j] = args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a52d0d00864b81e0ffbaa539c22c5d70c">H</a>(j+1,j).real() * inv_denom;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;       givensH[j*(args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a5b6c28bfdbba046e8ab1fc9ffdcf9631">m</a>+1)+j] = <a class="code" href="namespacequda.html#a043738f16cdeb082fa1a5158fbad36b3">conj</a>(cn[j])*h0 + sn[j]*args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a52d0d00864b81e0ffbaa539c22c5d70c">H</a>(j+1,j);</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;       args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a0a3ccd86622475e405b063e5984971df">c</a>[j+1] = -sn[j]*args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a0a3ccd86622475e405b063e5984971df">c</a>[j];</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;       args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a0a3ccd86622475e405b063e5984971df">c</a>[j]  *= <a class="code" href="namespacequda.html#a043738f16cdeb082fa1a5158fbad36b3">conj</a>(cn[j]);</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;     }</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;     j += 1;</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;   }</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;   <span class="keywordflow">if</span>(do_givens)</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;   {</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;     Map&lt;MatrixXcd, Unaligned, DynamicStride&gt; givensH_(givensH.get(), args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a5b6c28bfdbba046e8ab1fc9ffdcf9631">m</a>, args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a5b6c28bfdbba046e8ab1fc9ffdcf9631">m</a>, <a class="code" href="namespacequda.html#ab9bad7eeabf43337acf0cb22f4b189cb">DynamicStride</a>(args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a5b6c28bfdbba046e8ab1fc9ffdcf9631">m</a>+1,1) );</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;     memcpy(args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a18d2f271e259e35d3da1057a09db2552">eta</a>.data(),  args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a0a3ccd86622475e405b063e5984971df">c</a>, args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a5b6c28bfdbba046e8ab1fc9ffdcf9631">m</a>*<span class="keyword">sizeof</span>(<a class="code" href="namespacequda.html#a61eb8e0789e8a2021032ee12761d924e">Complex</a>));</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;     <a class="code" href="covdev__reference_8cpp.html#ace6ee45c30e71865e6eb635200379db9">memset</a>((<span class="keywordtype">void</span>*)args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a0a3ccd86622475e405b063e5984971df">c</a>, 0, (args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a5b6c28bfdbba046e8ab1fc9ffdcf9631">m</a>+1)*<span class="keyword">sizeof</span>(Complex));</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;     args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a0a3ccd86622475e405b063e5984971df">c</a>[0] = c0;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;     givensH_.triangularView&lt;Upper&gt;().solveInPlace&lt;OnTheLeft&gt;(args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a18d2f271e259e35d3da1057a09db2552">eta</a>);</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;     <a class="code" href="covdev__reference_8cpp.html#ace6ee45c30e71865e6eb635200379db9">memset</a>((<span class="keywordtype">void</span>*)args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a0a3ccd86622475e405b063e5984971df">c</a>, 0, (args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a5b6c28bfdbba046e8ab1fc9ffdcf9631">m</a>+1)*<span class="keyword">sizeof</span>(Complex));</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;     std::vector&lt;ColorSpinorField*&gt; v_(<a class="code" href="classquda_1_1_g_m_res_d_r.html#a58e6efaac94a868c161a37041a04e4a4">Vm</a>-&gt;<a class="code" href="classquda_1_1_color_spinor_field.html#a59441fb61d11540d7d02de34e9ce4c6b">Components</a>().begin(), <a class="code" href="classquda_1_1_g_m_res_d_r.html#a58e6efaac94a868c161a37041a04e4a4">Vm</a>-&gt;<a class="code" href="classquda_1_1_color_spinor_field.html#a59441fb61d11540d7d02de34e9ce4c6b">Components</a>().begin()+args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#acc78f80e6b026bdc3b01b4e10ef3384b">k</a>+1);</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;     std::vector&lt;ColorSpinorField*&gt; r_;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;     r_.push_back(static_cast&lt;ColorSpinorField*&gt;(<a class="code" href="classquda_1_1_g_m_res_d_r.html#a3c6b4a95ec42fc1b99b7eea4439d9ed2">r_sloppy</a>));</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;     <a class="code" href="namespacequda_1_1blas.html#af3cffbae4092951f3b76c26f842d1db3">blas::cDotProduct</a>(args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a0a3ccd86622475e405b063e5984971df">c</a>, v_, r_);</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;   }</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;   <span class="keywordflow">return</span> (j-start_idx);</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160; }</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;</div><div class="line"><a name="l00453"></a><span class="lineno"><a class="line" href="classquda_1_1_g_m_res_d_r.html#af005990d3f1e771a151af3a28f79e74d">  453</a></span>&#160; <span class="keywordtype">void</span> <a class="code" href="classquda_1_1_g_m_res_d_r.html#af005990d3f1e771a151af3a28f79e74d">GMResDR::operator()</a>(<a class="code" href="classquda_1_1_color_spinor_field.html">ColorSpinorField</a> &amp;x, <a class="code" href="classquda_1_1_color_spinor_field.html">ColorSpinorField</a> &amp;b)</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160; {</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <a class="code" href="classquda_1_1_g_m_res_d_r.html#a82df151bcb020cda83a85173075d195d">profile</a>.TPSTART(<a class="code" href="namespacequda.html#a8ad4f224c5228606d725a5f9a96c3f23a0709c9c1b7a8915651844380b231e3a6">QUDA_PROFILE_INIT</a>);</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> tol_threshold     = 1.2;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> det_max_deviation = 0.4;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <a class="code" href="classquda_1_1_color_spinor_field.html">ColorSpinorField</a> *ep = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classquda_1_1_g_m_res_d_r.html#acde25806853722112cbb742f2a38f5e1">init</a>) {</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;      <a class="code" href="classquda_1_1_g_m_res_d_r.html#ae01b44d79309567db5f9b526415b847c">gmresdr_args</a> = <span class="keyword">new</span> <a class="code" href="classquda_1_1_g_m_res_d_r_args.html">GMResDRArgs</a>(<a class="code" href="classquda_1_1_solver.html#a9c3ee5319f85ec0cf5aa24d76894c398">param</a>.<a class="code" href="structquda_1_1_solver_param.html#a1ca3579b5841d10802ef3fdf68473464">m</a>, <a class="code" href="classquda_1_1_solver.html#a9c3ee5319f85ec0cf5aa24d76894c398">param</a>.<a class="code" href="structquda_1_1_solver_param.html#a7b2b4ca09716ad407e1d360286e730eb">nev</a>);</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;      <a class="code" href="classquda_1_1_color_spinor_param.html">ColorSpinorParam</a> <a class="code" href="pack__test_8cpp.html#a526a592aff1010115b86c419f227f725">csParam</a>(b);</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;      csParam.<a class="code" href="classquda_1_1_color_spinor_param.html#ae3198baa87ba088010b5933225c12df0">create</a> = <a class="code" href="enum__quda_8h.html#ae3c3f9e9961c64a4a34f144d8f87f805a0a7b5b5ebe4058a465669eee83915158">QUDA_ZERO_FIELD_CREATE</a>;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;      <a class="code" href="classquda_1_1_g_m_res_d_r.html#a7da349796380d408e58d928b8f9f5935">rp</a> = <a class="code" href="classquda_1_1_color_spinor_field.html#aa0d2e38c03e2f97e358194a272b358dd">ColorSpinorField::Create</a>(csParam);</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;      <a class="code" href="classquda_1_1_g_m_res_d_r.html#aaccc968217a0503d56ed3850796f9f25">yp</a> = <a class="code" href="classquda_1_1_color_spinor_field.html#aa0d2e38c03e2f97e358194a272b358dd">ColorSpinorField::Create</a>(csParam); </div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;      ep = <a class="code" href="classquda_1_1_color_spinor_field.html#aa0d2e38c03e2f97e358194a272b358dd">ColorSpinorField::Create</a>(csParam); </div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;      csParam.<a class="code" href="classquda_1_1_color_spinor_param.html#a4d7b41b67de91dd1cd2ea6bc8cc5a33f">setPrecision</a>(<a class="code" href="classquda_1_1_solver.html#a9c3ee5319f85ec0cf5aa24d76894c398">param</a>.<a class="code" href="structquda_1_1_solver_param.html#a7748ac1dc90359e2eedb0d17e6396800">precision_sloppy</a>);</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;      <a class="code" href="classquda_1_1_g_m_res_d_r.html#ad4433f6c83710e695edbbe61223fb475">tmpp</a>     = <a class="code" href="classquda_1_1_color_spinor_field.html#aa0d2e38c03e2f97e358194a272b358dd">ColorSpinorField::Create</a>(csParam);</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;      <a class="code" href="classquda_1_1_g_m_res_d_r.html#a3c6b4a95ec42fc1b99b7eea4439d9ed2">r_sloppy</a> = <a class="code" href="classquda_1_1_color_spinor_field.html#aa0d2e38c03e2f97e358194a272b358dd">ColorSpinorField::Create</a>(csParam);</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;      <span class="keywordflow">if</span> ( <a class="code" href="classquda_1_1_g_m_res_d_r.html#a2b6057a867c61df1c5b6891729b2296d">K</a> &amp;&amp; (<a class="code" href="classquda_1_1_solver.html#a9c3ee5319f85ec0cf5aa24d76894c398">param</a>.<a class="code" href="structquda_1_1_solver_param.html#a720f806cdd39be6b6a11146c7e70f3a8">precision_precondition</a> != <a class="code" href="classquda_1_1_solver.html#a9c3ee5319f85ec0cf5aa24d76894c398">param</a>.<a class="code" href="structquda_1_1_solver_param.html#a7748ac1dc90359e2eedb0d17e6396800">precision_sloppy</a>) ) {</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        csParam.<a class="code" href="classquda_1_1_color_spinor_param.html#a4d7b41b67de91dd1cd2ea6bc8cc5a33f">setPrecision</a>(<a class="code" href="classquda_1_1_solver.html#a9c3ee5319f85ec0cf5aa24d76894c398">param</a>.<a class="code" href="structquda_1_1_solver_param.html#a720f806cdd39be6b6a11146c7e70f3a8">precision_precondition</a>);</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        <a class="code" href="classquda_1_1_g_m_res_d_r.html#ad7148d82c10b8450b407f3fb359fafb7">p_pre</a> = <a class="code" href="classquda_1_1_color_spinor_field.html#aa0d2e38c03e2f97e358194a272b358dd">ColorSpinorField::Create</a>(csParam);</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        <a class="code" href="classquda_1_1_g_m_res_d_r.html#a49c5b1e0af32ef91d4c817dd0a5ff6f9">r_pre</a> = <a class="code" href="classquda_1_1_color_spinor_field.html#aa0d2e38c03e2f97e358194a272b358dd">ColorSpinorField::Create</a>(csParam);</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;      }</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;      csParam.<a class="code" href="classquda_1_1_color_spinor_param.html#a4d7b41b67de91dd1cd2ea6bc8cc5a33f">setPrecision</a>(<a class="code" href="classquda_1_1_solver.html#a9c3ee5319f85ec0cf5aa24d76894c398">param</a>.<a class="code" href="structquda_1_1_solver_param.html#a7748ac1dc90359e2eedb0d17e6396800">precision_sloppy</a>);</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;      csParam.<a class="code" href="classquda_1_1_color_spinor_param.html#a8481f261317a60b786d56c2b839d76d6">is_composite</a>  = <span class="keyword">true</span>;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;      csParam.<a class="code" href="classquda_1_1_color_spinor_param.html#a72430d56161c1ffe69aaf5d685f714e6">composite_dim</a> = <a class="code" href="classquda_1_1_solver.html#a9c3ee5319f85ec0cf5aa24d76894c398">param</a>.<a class="code" href="structquda_1_1_solver_param.html#a1ca3579b5841d10802ef3fdf68473464">m</a>+1;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;      <a class="code" href="classquda_1_1_g_m_res_d_r.html#a58e6efaac94a868c161a37041a04e4a4">Vm</a>   = <a class="code" href="classquda_1_1_color_spinor_field.html#aa0d2e38c03e2f97e358194a272b358dd">ColorSpinorFieldSet::Create</a>(csParam); </div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;      csParam.<a class="code" href="classquda_1_1_color_spinor_param.html#a72430d56161c1ffe69aaf5d685f714e6">composite_dim</a> = <a class="code" href="classquda_1_1_solver.html#a9c3ee5319f85ec0cf5aa24d76894c398">param</a>.<a class="code" href="structquda_1_1_solver_param.html#a1ca3579b5841d10802ef3fdf68473464">m</a>;</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;      <a class="code" href="classquda_1_1_g_m_res_d_r.html#aa356e09c2bc1434569cdeeece24c206c">Zm</a> = <a class="code" href="classquda_1_1_g_m_res_d_r.html#a2b6057a867c61df1c5b6891729b2296d">K</a> ? <a class="code" href="classquda_1_1_color_spinor_field.html#aa0d2e38c03e2f97e358194a272b358dd">ColorSpinorFieldSet::Create</a>(csParam) : <a class="code" href="classquda_1_1_g_m_res_d_r.html#a58e6efaac94a868c161a37041a04e4a4">Vm</a>;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;      csParam.<a class="code" href="classquda_1_1_color_spinor_param.html#a72430d56161c1ffe69aaf5d685f714e6">composite_dim</a> = (<a class="code" href="classquda_1_1_solver.html#a9c3ee5319f85ec0cf5aa24d76894c398">param</a>.<a class="code" href="structquda_1_1_solver_param.html#a7b2b4ca09716ad407e1d360286e730eb">nev</a>+1);</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;      csParam.<a class="code" href="classquda_1_1_color_spinor_param.html#a4d7b41b67de91dd1cd2ea6bc8cc5a33f">setPrecision</a>(<a class="code" href="enum__quda_8h.html#ac166c47d6ef16f830c164fefe6c8ab90a6288ca4c9d3166592676284c7d886972">QUDA_DOUBLE_PRECISION</a>);</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;      <a class="code" href="classquda_1_1_g_m_res_d_r.html#ae01b44d79309567db5f9b526415b847c">gmresdr_args</a>-&gt;<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a6cab2bf187e516e1f75278efbf30c953">Vkp1</a> = <a class="code" href="classquda_1_1_color_spinor_field.html#aa0d2e38c03e2f97e358194a272b358dd">ColorSpinorFieldSet::Create</a>(csParam);</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;      <a class="code" href="classquda_1_1_g_m_res_d_r.html#acde25806853722112cbb742f2a38f5e1">init</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    }</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <a class="code" href="classquda_1_1_g_m_res_d_r_args.html">GMResDRArgs</a> &amp;args = *<a class="code" href="classquda_1_1_g_m_res_d_r.html#ae01b44d79309567db5f9b526415b847c">gmresdr_args</a>;</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <a class="code" href="classquda_1_1_color_spinor_field.html">ColorSpinorField</a> &amp;r   = *<a class="code" href="classquda_1_1_g_m_res_d_r.html#a7da349796380d408e58d928b8f9f5935">rp</a>;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <a class="code" href="classquda_1_1_color_spinor_field.html">ColorSpinorField</a> &amp;y   = *<a class="code" href="classquda_1_1_g_m_res_d_r.html#aaccc968217a0503d56ed3850796f9f25">yp</a>;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <a class="code" href="classquda_1_1_color_spinor_field.html">ColorSpinorField</a> &amp;e   = *ep;</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <a class="code" href="classquda_1_1_color_spinor_field.html">ColorSpinorField</a> &amp;rSloppy = *<a class="code" href="classquda_1_1_g_m_res_d_r.html#a3c6b4a95ec42fc1b99b7eea4439d9ed2">r_sloppy</a>;</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <a class="code" href="classquda_1_1_g_m_res_d_r.html#a82df151bcb020cda83a85173075d195d">profile</a>.TPSTOP(<a class="code" href="namespacequda.html#a8ad4f224c5228606d725a5f9a96c3f23a0709c9c1b7a8915651844380b231e3a6">QUDA_PROFILE_INIT</a>);</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <a class="code" href="classquda_1_1_g_m_res_d_r.html#a82df151bcb020cda83a85173075d195d">profile</a>.TPSTART(<a class="code" href="namespacequda.html#a8ad4f224c5228606d725a5f9a96c3f23ac3997ab139d55a10abd9f79ea2aa09ad">QUDA_PROFILE_PREAMBLE</a>);</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <span class="keywordtype">int</span> tot_iters = 0;</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    <span class="keywordtype">double</span> normb = <a class="code" href="namespacequda.html#a3174ee67c7fa7d35dbdf37b13064e8b0">norm2</a>( b );</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    <span class="keywordtype">double</span> stop  = <a class="code" href="classquda_1_1_solver.html#a9c3ee5319f85ec0cf5aa24d76894c398">param</a>.<a class="code" href="structquda_1_1_solver_param.html#aef9355993a1de99b8bbcdc8cd5cf69b6">tol</a>*<a class="code" href="classquda_1_1_solver.html#a9c3ee5319f85ec0cf5aa24d76894c398">param</a>.<a class="code" href="structquda_1_1_solver_param.html#aef9355993a1de99b8bbcdc8cd5cf69b6">tol</a>* normb;  </div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <a class="code" href="classquda_1_1_g_m_res_d_r.html#acfa1984fd2a84206e9fd88b73030a477">mat</a>(r, x);</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    </div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    <span class="keywordtype">double</span> r2 = <a class="code" href="namespacequda_1_1blas.html#a53d7fb8e21b813343450b14c6ba7e631">xmyNorm</a>(b, r);</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <span class="keywordtype">double</span> b2 = r2;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a0a3ccd86622475e405b063e5984971df">c</a>[0] = <a class="code" href="namespacequda.html#a61eb8e0789e8a2021032ee12761d924e">Complex</a>(<a class="code" href="namespacequda.html#a6a71833ed525c0d7a4c0d7bfaf48a6d2">sqrt</a>(r2), 0.0);</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <a class="code" href="util__quda_8h.html#a35882d3606e4edaa96d082d239d0e7a0">printfQuda</a>(<span class="stringliteral">&quot;\nInitial residual squared: %1.16e, source %1.16e, tolerance %1.16e\n&quot;</span>, r2, <a class="code" href="namespacequda.html#a6a71833ed525c0d7a4c0d7bfaf48a6d2">sqrt</a>(normb), <a class="code" href="classquda_1_1_solver.html#a9c3ee5319f85ec0cf5aa24d76894c398">param</a>.<a class="code" href="structquda_1_1_solver_param.html#aef9355993a1de99b8bbcdc8cd5cf69b6">tol</a>);</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    rSloppy = r;</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classquda_1_1_solver.html#a9c3ee5319f85ec0cf5aa24d76894c398">param</a>.<a class="code" href="structquda_1_1_solver_param.html#a7748ac1dc90359e2eedb0d17e6396800">precision_sloppy</a> != <a class="code" href="classquda_1_1_solver.html#a9c3ee5319f85ec0cf5aa24d76894c398">param</a>.<a class="code" href="structquda_1_1_solver_param.html#a1dd05ed86fbade30927fa96d1d99d61f">precision</a>) {</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;      <a class="code" href="namespacequda_1_1blas.html#aca6d0abadc46cf0048397a98c7e64316">blas::axpy</a>(1.0 / args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a0a3ccd86622475e405b063e5984971df">c</a>[0].real(), r, y);</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;      <a class="code" href="classquda_1_1_g_m_res_d_r.html#a58e6efaac94a868c161a37041a04e4a4">Vm</a>-&gt;<a class="code" href="classquda_1_1_color_spinor_field.html#ae0819f9471411d51352d86d5b12ef830">Component</a>(0) = y;</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;      <a class="code" href="namespacequda_1_1blas.html#ab738546293a39098f5c9bdb3c1ea6876">blas::zero</a>(y);</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;      <a class="code" href="namespacequda_1_1blas.html#aca6d0abadc46cf0048397a98c7e64316">blas::axpy</a>(1.0 / args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a0a3ccd86622475e405b063e5984971df">c</a>[0].real(), r, <a class="code" href="classquda_1_1_g_m_res_d_r.html#a58e6efaac94a868c161a37041a04e4a4">Vm</a>-&gt;<a class="code" href="classquda_1_1_color_spinor_field.html#ae0819f9471411d51352d86d5b12ef830">Component</a>(0));   </div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    }</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <a class="code" href="classquda_1_1_g_m_res_d_r.html#a82df151bcb020cda83a85173075d195d">profile</a>.TPSTOP(<a class="code" href="namespacequda.html#a8ad4f224c5228606d725a5f9a96c3f23ac3997ab139d55a10abd9f79ea2aa09ad">QUDA_PROFILE_PREAMBLE</a>);</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <a class="code" href="classquda_1_1_g_m_res_d_r.html#a82df151bcb020cda83a85173075d195d">profile</a>.TPSTART(<a class="code" href="namespacequda.html#a8ad4f224c5228606d725a5f9a96c3f23a83aaea7b7a870743ae8b13ecc51245ef">QUDA_PROFILE_COMPUTE</a>);</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <a class="code" href="namespacequda_1_1blas.html#a74096281fea1853bd9ab0f16ecb92b31">blas::flops</a> = 0;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> use_heavy_quark_res = (<a class="code" href="classquda_1_1_solver.html#a9c3ee5319f85ec0cf5aa24d76894c398">param</a>.<a class="code" href="structquda_1_1_solver_param.html#a4c67d3240a333f0f96f9f0c7748c484b">residual_type</a> &amp; <a class="code" href="enum__quda_8h.html#a7518a0b4f519bd7aa860415c861c05b0a43ee9033af9de2a03eca62b22c42357c">QUDA_HEAVY_QUARK_RESIDUAL</a>) ? <span class="keyword">true</span> : <span class="keyword">false</span>;</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <span class="keywordtype">double</span> heavy_quark_res = 0.0;  </div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    <span class="keywordflow">if</span> (use_heavy_quark_res)  heavy_quark_res = <a class="code" href="namespacequda.html#a6a71833ed525c0d7a4c0d7bfaf48a6d2">sqrt</a>(<a class="code" href="namespacequda_1_1blas.html#a46268afb6cc8f820c3b37ff6607e6954">blas::HeavyQuarkResidualNorm</a>(x, r).z);</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <span class="keywordtype">int</span> restart_idx = 0, j = 0, check_interval = 4;</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    <a class="code" href="namespacequda.html#a048501d184bc5c0d1e4462e80a80bb1a">DenseMatrix</a> Gm = DenseMatrix::Zero(args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#acc78f80e6b026bdc3b01b4e10ef3384b">k</a>+1, args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#acc78f80e6b026bdc3b01b4e10ef3384b">k</a>+1);</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <span class="keywordflow">while</span>(restart_idx &lt; <a class="code" href="classquda_1_1_solver.html#a9c3ee5319f85ec0cf5aa24d76894c398">param</a>.<a class="code" href="structquda_1_1_solver_param.html#a232008d9c68aa120993a129941f041e8">deflation_grid</a> &amp;&amp; !(<a class="code" href="classquda_1_1_solver.html#a6567b6addff40d5212f1a1bfd878cd29">convergence</a>(r2, heavy_quark_res, stop, <a class="code" href="classquda_1_1_solver.html#a9c3ee5319f85ec0cf5aa24d76894c398">param</a>.<a class="code" href="structquda_1_1_solver_param.html#ad866c767750c633ccca233281d10b1c9">tol_hq</a>) || !(r2 &gt; stop)))</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    {</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;      tot_iters += <a class="code" href="classquda_1_1_g_m_res_d_r.html#aa869a115446b88110dcbf22c55e8d9b7">FlexArnoldiProcedure</a>(j, (j == 0));</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;      <a class="code" href="classquda_1_1_g_m_res_d_r.html#a80f9173c2c04c21db51934fa85521e4e">UpdateSolution</a>(&amp;e, <a class="code" href="classquda_1_1_g_m_res_d_r.html#a3c6b4a95ec42fc1b99b7eea4439d9ed2">r_sloppy</a>, !(j == 0));</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;      r2 = <a class="code" href="namespacequda.html#a3174ee67c7fa7d35dbdf37b13064e8b0">norm2</a>(rSloppy);</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;      <span class="keywordtype">bool</span>   do_clean_restart = <span class="keyword">false</span>;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;      <span class="keywordtype">double</span> ext_r2 = 1.0;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;      <span class="keywordflow">if</span>((restart_idx+1) % check_interval) {</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        <a class="code" href="classquda_1_1_g_m_res_d_r.html#acfa1984fd2a84206e9fd88b73030a477">mat</a>(y, e);</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;        ext_r2 = <a class="code" href="namespacequda_1_1blas.html#a53d7fb8e21b813343450b14c6ba7e631">xmyNorm</a>(r, y);</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;  <span class="comment">// can this be done as a single 2-d reduction?</span></div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> l = 0; l &lt; args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#acc78f80e6b026bdc3b01b4e10ef3384b">k</a>+1; l++) {</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;          <a class="code" href="namespacequda.html#a61eb8e0789e8a2021032ee12761d924e">Complex</a> *col = Gm.col(l).data();</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    std::vector&lt;ColorSpinorField*&gt; v1_(<a class="code" href="classquda_1_1_g_m_res_d_r.html#a58e6efaac94a868c161a37041a04e4a4">Vm</a>-&gt;<a class="code" href="classquda_1_1_color_spinor_field.html#a59441fb61d11540d7d02de34e9ce4c6b">Components</a>().begin(), <a class="code" href="classquda_1_1_g_m_res_d_r.html#a58e6efaac94a868c161a37041a04e4a4">Vm</a>-&gt;<a class="code" href="classquda_1_1_color_spinor_field.html#a59441fb61d11540d7d02de34e9ce4c6b">Components</a>().begin()+args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#acc78f80e6b026bdc3b01b4e10ef3384b">k</a>+1);</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    std::vector&lt;ColorSpinorField*&gt; v2_;</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    v2_.push_back(static_cast&lt;ColorSpinorField*&gt;(&amp;<a class="code" href="classquda_1_1_g_m_res_d_r.html#a58e6efaac94a868c161a37041a04e4a4">Vm</a>-&gt;<a class="code" href="classquda_1_1_color_spinor_field.html#ae0819f9471411d51352d86d5b12ef830">Component</a>(l)));</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    <a class="code" href="namespacequda_1_1blas.html#af3cffbae4092951f3b76c26f842d1db3">blas::cDotProduct</a>(col, v1_, v2_);</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;  }<span class="comment">//end l-loop</span></div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;  <a class="code" href="namespacequda.html#a61eb8e0789e8a2021032ee12761d924e">Complex</a> detGm = Gm.determinant();</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;  <a class="code" href="classquda_1_1_solver.html#acdece7f94464de0325bcbd97104dca4a">PrintStats</a>(<span class="stringliteral">&quot;FGMResDR:&quot;</span>, tot_iters, r2, b2, heavy_quark_res);</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;  <a class="code" href="util__quda_8h.html#a35882d3606e4edaa96d082d239d0e7a0">printfQuda</a>(<span class="stringliteral">&quot;\nCheck cycle %d, true residual squared %1.15e, Gramm det : (%le, %le)\n&quot;</span>, restart_idx, ext_r2, detGm.real(), detGm.imag());</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;  Gm.setZero();</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;  do_clean_restart = ((<a class="code" href="namespacequda.html#a6a71833ed525c0d7a4c0d7bfaf48a6d2">sqrt</a>(ext_r2) / <a class="code" href="namespacequda.html#a6a71833ed525c0d7a4c0d7bfaf48a6d2">sqrt</a>(r2)) &gt; tol_threshold) || fabs(1.0 - (<a class="code" href="namespacequda.html#abeed8b3819eb6b18921f208412fe40d1">norm</a>(detGm)) &gt; det_max_deviation);</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;      }</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;      <span class="keywordflow">if</span>( ((restart_idx != <a class="code" href="classquda_1_1_solver.html#a9c3ee5319f85ec0cf5aa24d76894c398">param</a>.<a class="code" href="structquda_1_1_solver_param.html#a232008d9c68aa120993a129941f041e8">deflation_grid</a>-1) &amp;&amp; !do_clean_restart) ) {</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;  <a class="code" href="classquda_1_1_g_m_res_d_r.html#a02994b126eca34ff3741341042242ec7">RestartVZH</a>();</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;  j = args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#acc78f80e6b026bdc3b01b4e10ef3384b">k</a>;</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;       <a class="code" href="util__quda_8h.html#a35882d3606e4edaa96d082d239d0e7a0">printfQuda</a>(<span class="stringliteral">&quot;\nClean restart for cycle %d, true residual squared %1.15e\n&quot;</span>, restart_idx, ext_r2);</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;       args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a21af185e4244a593a559cd7daadf18d2">ResetArgs</a>();</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;       <span class="comment">//update solution:</span></div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;       <a class="code" href="namespacequda_1_1blas.html#ae823e2784a147b1ef92f13b2a6f6941c">xpy</a>(e, x);</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;       r = y;</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;       <a class="code" href="namespacequda.html#afdd60a37d49f6d12f8472e2a910e80c6">zero</a>(e);</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;       args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a0a3ccd86622475e405b063e5984971df">c</a>[0] = <a class="code" href="namespacequda.html#a61eb8e0789e8a2021032ee12761d924e">Complex</a>(<a class="code" href="namespacequda.html#a6a71833ed525c0d7a4c0d7bfaf48a6d2">sqrt</a>(ext_r2), 0.0);</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;       <a class="code" href="namespacequda_1_1blas.html#ab738546293a39098f5c9bdb3c1ea6876">blas::zero</a>(<a class="code" href="classquda_1_1_g_m_res_d_r.html#a58e6efaac94a868c161a37041a04e4a4">Vm</a>-&gt;<a class="code" href="classquda_1_1_color_spinor_field.html#ae0819f9471411d51352d86d5b12ef830">Component</a>(0));</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;       <a class="code" href="namespacequda_1_1blas.html#aca6d0abadc46cf0048397a98c7e64316">blas::axpy</a>(1.0 / args.<a class="code" href="classquda_1_1_g_m_res_d_r_args.html#a0a3ccd86622475e405b063e5984971df">c</a>[0].real(), rSloppy, <a class="code" href="classquda_1_1_g_m_res_d_r.html#a58e6efaac94a868c161a37041a04e4a4">Vm</a>-&gt;<a class="code" href="classquda_1_1_color_spinor_field.html#ae0819f9471411d51352d86d5b12ef830">Component</a>(0));</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;       j = 0;</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;     }</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;     restart_idx += 1;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;   }</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;   <span class="comment">//final solution:</span></div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;   <a class="code" href="namespacequda_1_1blas.html#ae823e2784a147b1ef92f13b2a6f6941c">xpy</a>(e, x);</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;   <a class="code" href="classquda_1_1_g_m_res_d_r.html#a82df151bcb020cda83a85173075d195d">profile</a>.TPSTOP(<a class="code" href="namespacequda.html#a8ad4f224c5228606d725a5f9a96c3f23a83aaea7b7a870743ae8b13ecc51245ef">QUDA_PROFILE_COMPUTE</a>);</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;   <a class="code" href="classquda_1_1_g_m_res_d_r.html#a82df151bcb020cda83a85173075d195d">profile</a>.TPSTART(<a class="code" href="namespacequda.html#a8ad4f224c5228606d725a5f9a96c3f23a3adbe92803403a6088ad514690cf28ea">QUDA_PROFILE_EPILOGUE</a>);</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;   <a class="code" href="classquda_1_1_solver.html#a9c3ee5319f85ec0cf5aa24d76894c398">param</a>.<a class="code" href="structquda_1_1_solver_param.html#ad4f1d65bdfd17f5647ac1cb2f972cd18">secs</a> = <a class="code" href="classquda_1_1_g_m_res_d_r.html#a82df151bcb020cda83a85173075d195d">profile</a>.<a class="code" href="classquda_1_1_time_profile.html#a6b6019dff862e546af7693a702ff69d0">Last</a>(<a class="code" href="namespacequda.html#a8ad4f224c5228606d725a5f9a96c3f23a83aaea7b7a870743ae8b13ecc51245ef">QUDA_PROFILE_COMPUTE</a>);</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;   <span class="keywordtype">double</span> gflops = (<a class="code" href="namespacequda_1_1blas.html#a74096281fea1853bd9ab0f16ecb92b31">blas::flops</a> + <a class="code" href="classquda_1_1_g_m_res_d_r.html#acfa1984fd2a84206e9fd88b73030a477">mat</a>.<a class="code" href="classquda_1_1_dirac_matrix.html#a70fd2aa9efa763e92789b478badb02b0">flops</a>())*1e-9;</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;   <a class="code" href="classquda_1_1_solver.html#a9c3ee5319f85ec0cf5aa24d76894c398">param</a>.<a class="code" href="structquda_1_1_solver_param.html#ada170467536dd4a3ebae68f6a8388cb8">gflops</a> = gflops;</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;   <a class="code" href="classquda_1_1_solver.html#a9c3ee5319f85ec0cf5aa24d76894c398">param</a>.<a class="code" href="structquda_1_1_solver_param.html#a04e193e0d38b2606b1a8b4e1d2256efe">iter</a> += tot_iters;</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;   <a class="code" href="classquda_1_1_g_m_res_d_r.html#acfa1984fd2a84206e9fd88b73030a477">mat</a>(r, x);</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;   <a class="code" href="classquda_1_1_solver.html#a9c3ee5319f85ec0cf5aa24d76894c398">param</a>.<a class="code" href="structquda_1_1_solver_param.html#a3216915ee7c00cad34888cb76ead8fae">true_res</a> = <a class="code" href="namespacequda.html#a6a71833ed525c0d7a4c0d7bfaf48a6d2">sqrt</a>(<a class="code" href="namespacequda_1_1blas.html#a53d7fb8e21b813343450b14c6ba7e631">xmyNorm</a>(b, r) / b2);</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;   <a class="code" href="classquda_1_1_solver.html#a8db54e989f46e8edf99a9a344f22f77d">PrintSummary</a>(<span class="stringliteral">&quot;FGMResDR:&quot;</span>, tot_iters, r2, b2, stop, <a class="code" href="classquda_1_1_solver.html#a9c3ee5319f85ec0cf5aa24d76894c398">param</a>.<a class="code" href="structquda_1_1_solver_param.html#ad866c767750c633ccca233281d10b1c9">tol_hq</a>);</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;   <a class="code" href="namespacequda_1_1blas.html#a74096281fea1853bd9ab0f16ecb92b31">blas::flops</a> = 0;</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;   <a class="code" href="classquda_1_1_g_m_res_d_r.html#acfa1984fd2a84206e9fd88b73030a477">mat</a>.<a class="code" href="classquda_1_1_dirac_matrix.html#a70fd2aa9efa763e92789b478badb02b0">flops</a>();</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;   <a class="code" href="classquda_1_1_g_m_res_d_r.html#a82df151bcb020cda83a85173075d195d">profile</a>.TPSTOP(<a class="code" href="namespacequda.html#a8ad4f224c5228606d725a5f9a96c3f23a3adbe92803403a6088ad514690cf28ea">QUDA_PROFILE_EPILOGUE</a>);</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;   <a class="code" href="classquda_1_1_solver.html#a9c3ee5319f85ec0cf5aa24d76894c398">param</a>.<a class="code" href="structquda_1_1_solver_param.html#adff751221be4d565b2079d22a4d487be">rhs_idx</a> += 1;</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;   <span class="keywordflow">if</span>(ep) <span class="keyword">delete</span> ep;</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;   <span class="keywordflow">return</span>;</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160; }</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;} <span class="comment">// namespace quda</span></div><div class="ttc" id="invert__quda_8h_html"><div class="ttname"><a href="invert__quda_8h.html">invert_quda.h</a></div></div>
<div class="ttc" id="classquda_1_1_g_m_res_d_r_args_html_a45955676da5461a45e9d4ab8177f94fc"><div class="ttname"><a href="classquda_1_1_g_m_res_d_r_args.html#a45955676da5461a45e9d4ab8177f94fc">quda::GMResDRArgs::ritzVecs</a></div><div class="ttdeci">VectorSet ritzVecs</div><div class="ttdef"><b>Definition:</b> <a href="inv__gmresdr__quda_8cpp_source.html#l00062">inv_gmresdr_quda.cpp:62</a></div></div>
<div class="ttc" id="namespacequda_html_abe598ea1308b5f23670eaab8662949a0a805866538e898502a465cec41121e6b9"><div class="ttname"><a href="namespacequda.html#abe598ea1308b5f23670eaab8662949a0a805866538e898502a465cec41121e6b9">quda::libtype::magma_lib</a></div></div>
<div class="ttc" id="namespacequda_1_1blas_html_a9a001f8e31cfe48d8b3b67db4b14dd92"><div class="ttname"><a href="namespacequda_1_1blas.html#a9a001f8e31cfe48d8b3b67db4b14dd92">quda::blas::ax</a></div><div class="ttdeci">void ax(double a, ColorSpinorField &amp;x)</div><div class="ttdef"><b>Definition:</b> <a href="blas__quda_8cu_source.html#l00508">blas_quda.cu:508</a></div></div>
<div class="ttc" id="structquda_1_1_solver_param_html_afc2dcb3798a9f65cb3ee8592b9383471"><div class="ttname"><a href="structquda_1_1_solver_param.html#afc2dcb3798a9f65cb3ee8592b9383471">quda::SolverParam::global_reduction</a></div><div class="ttdeci">bool global_reduction</div><div class="ttdoc">whether the solver acting as a preconditioner for another solver </div><div class="ttdef"><b>Definition:</b> <a href="invert__quda_8h_source.html#l00243">invert_quda.h:243</a></div></div>
<div class="ttc" id="structquda_1_1_solver_param_html_a7b2b4ca09716ad407e1d360286e730eb"><div class="ttname"><a href="structquda_1_1_solver_param.html#a7b2b4ca09716ad407e1d360286e730eb">quda::SolverParam::nev</a></div><div class="ttdeci">int nev</div><div class="ttdef"><b>Definition:</b> <a href="invert__quda_8h_source.html#l00229">invert_quda.h:229</a></div></div>
<div class="ttc" id="structquda_1_1_solver_param_html_a5905cdcaa6f29c4a13711519cfe4dc8f"><div class="ttname"><a href="structquda_1_1_solver_param.html#a5905cdcaa6f29c4a13711519cfe4dc8f">quda::SolverParam::maxiter_precondition</a></div><div class="ttdeci">int maxiter_precondition</div><div class="ttdef"><b>Definition:</b> <a href="invert__quda_8h_source.html#l00202">invert_quda.h:202</a></div></div>
<div class="ttc" id="structquda_1_1_zero_html"><div class="ttname"><a href="structquda_1_1_zero.html">quda::Zero</a></div><div class="ttdef"><b>Definition:</b> <a href="quda__matrix_8h_source.html#l00016">quda_matrix.h:16</a></div></div>
<div class="ttc" id="classquda_1_1_color_spinor_param_html_a4d7b41b67de91dd1cd2ea6bc8cc5a33f"><div class="ttname"><a href="classquda_1_1_color_spinor_param.html#a4d7b41b67de91dd1cd2ea6bc8cc5a33f">quda::ColorSpinorParam::setPrecision</a></div><div class="ttdeci">void setPrecision(QudaPrecision precision, QudaPrecision ghost_precision=QUDA_INVALID_PRECISION, bool force_native=false)</div><div class="ttdef"><b>Definition:</b> <a href="color__spinor__field_8h_source.html#l00231">color_spinor_field.h:231</a></div></div>
<div class="ttc" id="structquda_1_1_solver_param_html_ab1e73c1c651b6f2277069ca289044f18"><div class="ttname"><a href="structquda_1_1_solver_param.html#ab1e73c1c651b6f2277069ca289044f18">quda::SolverParam::verbosity_precondition</a></div><div class="ttdeci">QudaVerbosity verbosity_precondition</div><div class="ttdef"><b>Definition:</b> <a href="invert__quda_8h_source.html#l00239">invert_quda.h:239</a></div></div>
<div class="ttc" id="blas__magma_8h_html_a9323e7558ddc6e85dfa71e723f54d5d0"><div class="ttname"><a href="blas__magma_8h.html#a9323e7558ddc6e85dfa71e723f54d5d0">magma_Xgeev</a></div><div class="ttdeci">void magma_Xgeev(void *Mat, const int n, const int ldm, void *vr, void *evalues, const int ldv, const int prec)</div><div class="ttdef"><b>Definition:</b> <a href="blas__magma_8cu_source.html#l00275">blas_magma.cu:275</a></div></div>
<div class="ttc" id="structquda_1_1_solver_param_html_af18615c6397944fea5f4618d70a5a67b"><div class="ttname"><a href="structquda_1_1_solver_param.html#af18615c6397944fea5f4618d70a5a67b">quda::SolverParam::delta</a></div><div class="ttdeci">double delta</div><div class="ttdef"><b>Definition:</b> <a href="invert__quda_8h_source.html#l00070">invert_quda.h:70</a></div></div>
<div class="ttc" id="classquda_1_1_color_spinor_field_html"><div class="ttname"><a href="classquda_1_1_color_spinor_field.html">quda::ColorSpinorField</a></div><div class="ttdef"><b>Definition:</b> <a href="color__spinor__field_8h_source.html#l00311">color_spinor_field.h:311</a></div></div>
<div class="ttc" id="classquda_1_1_g_m_res_d_r_html_acde25806853722112cbb742f2a38f5e1"><div class="ttname"><a href="classquda_1_1_g_m_res_d_r.html#acde25806853722112cbb742f2a38f5e1">quda::GMResDR::init</a></div><div class="ttdeci">bool init</div><div class="ttdef"><b>Definition:</b> <a href="invert__quda_8h_source.html#l01302">invert_quda.h:1302</a></div></div>
<div class="ttc" id="classquda_1_1_g_m_res_d_r_args_html_a0ea7d2a0b9fb510d937a9c8d0b02c829"><div class="ttname"><a href="classquda_1_1_g_m_res_d_r_args.html#a0ea7d2a0b9fb510d937a9c8d0b02c829">quda::GMResDRArgs::restarts</a></div><div class="ttdeci">int restarts</div><div class="ttdef"><b>Definition:</b> <a href="inv__gmresdr__quda_8cpp_source.html#l00068">inv_gmresdr_quda.cpp:68</a></div></div>
<div class="ttc" id="enum__quda_8h_html_ab6aad69f1c1b3ec370b035c2b1e34654a9590c690c29023cc12276ee1fdd7d5d6"><div class="ttname"><a href="enum__quda_8h.html#ab6aad69f1c1b3ec370b035c2b1e34654a9590c690c29023cc12276ee1fdd7d5d6">QUDA_PRESERVE_SOURCE_YES</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00237">enum_quda.h:237</a></div></div>
<div class="ttc" id="namespacequda_html_abeed8b3819eb6b18921f208412fe40d1"><div class="ttname"><a href="namespacequda.html#abeed8b3819eb6b18921f208412fe40d1">quda::norm</a></div><div class="ttdeci">__host__ __device__ ValueType norm(const complex&lt; ValueType &gt; &amp;z)</div><div class="ttdoc">Returns the magnitude of z squared. </div><div class="ttdef"><b>Definition:</b> <a href="complex__quda_8h_source.html#l01092">complex_quda.h:1092</a></div></div>
<div class="ttc" id="classquda_1_1_g_m_res_d_r_args_html_a5b6c28bfdbba046e8ab1fc9ffdcf9631"><div class="ttname"><a href="classquda_1_1_g_m_res_d_r_args.html#a5b6c28bfdbba046e8ab1fc9ffdcf9631">quda::GMResDRArgs::m</a></div><div class="ttdeci">int m</div><div class="ttdef"><b>Definition:</b> <a href="inv__gmresdr__quda_8cpp_source.html#l00066">inv_gmresdr_quda.cpp:66</a></div></div>
<div class="ttc" id="classquda_1_1_bi_c_gstab_html"><div class="ttname"><a href="classquda_1_1_bi_c_gstab.html">quda::BiCGstab</a></div><div class="ttdef"><b>Definition:</b> <a href="invert__quda_8h_source.html#l00707">invert_quda.h:707</a></div></div>
<div class="ttc" id="structquda_1_1_solver_param_html_aadec9408096650515345b41cd54449ec"><div class="ttname"><a href="structquda_1_1_solver_param.html#aadec9408096650515345b41cd54449ec">quda::SolverParam::inv_type</a></div><div class="ttdeci">QudaInverterType inv_type</div><div class="ttdef"><b>Definition:</b> <a href="invert__quda_8h_source.html#l00022">invert_quda.h:22</a></div></div>
<div class="ttc" id="classquda_1_1_g_m_res_d_r_html_a02994b126eca34ff3741341042242ec7"><div class="ttname"><a href="classquda_1_1_g_m_res_d_r.html#a02994b126eca34ff3741341042242ec7">quda::GMResDR::RestartVZH</a></div><div class="ttdeci">void RestartVZH()</div><div class="ttdef"><b>Definition:</b> <a href="inv__gmresdr__quda_8cpp_source.html#l00302">inv_gmresdr_quda.cpp:302</a></div></div>
<div class="ttc" id="structquda_1_1_solver_param_html_adff751221be4d565b2079d22a4d487be"><div class="ttname"><a href="structquda_1_1_solver_param.html#adff751221be4d565b2079d22a4d487be">quda::SolverParam::rhs_idx</a></div><div class="ttdeci">int rhs_idx</div><div class="ttdef"><b>Definition:</b> <a href="invert__quda_8h_source.html#l00232">invert_quda.h:232</a></div></div>
<div class="ttc" id="namespacequda_html_a8ad4f224c5228606d725a5f9a96c3f23abf06d3d3c0e941387d6662448f761c08"><div class="ttname"><a href="namespacequda.html#a8ad4f224c5228606d725a5f9a96c3f23abf06d3d3c0e941387d6662448f761c08">quda::QUDA_PROFILE_FREE</a></div><div class="ttdef"><b>Definition:</b> <a href="timer_8h_source.html#l00111">timer.h:111</a></div></div>
<div class="ttc" id="util__quda_8h_html_af3bddfd9d113d50e8e0bbf58a35c5aac"><div class="ttname"><a href="util__quda_8h.html#af3bddfd9d113d50e8e0bbf58a35c5aac">errorQuda</a></div><div class="ttdeci">#define errorQuda(...)</div><div class="ttdef"><b>Definition:</b> <a href="util__quda_8h_source.html#l00121">util_quda.h:121</a></div></div>
<div class="ttc" id="namespacequda_1_1blas_html_ab8b470443eb61a4c95b5f996ff485e15"><div class="ttname"><a href="namespacequda_1_1blas.html#ab8b470443eb61a4c95b5f996ff485e15">quda::blas::norm2</a></div><div class="ttdeci">double norm2(const ColorSpinorField &amp;a)</div><div class="ttdef"><b>Definition:</b> <a href="reduce__quda_8cu_source.html#l00721">reduce_quda.cu:721</a></div></div>
<div class="ttc" id="color__spinor__field_8h_html"><div class="ttname"><a href="color__spinor__field_8h.html">color_spinor_field.h</a></div></div>
<div class="ttc" id="namespacequda_1_1blas_html_a2f7aa9affb07827bc351c97272c8d5cb"><div class="ttname"><a href="namespacequda_1_1blas.html#a2f7aa9affb07827bc351c97272c8d5cb">quda::blas::init</a></div><div class="ttdeci">void init()</div><div class="ttdef"><b>Definition:</b> <a href="blas__quda_8cu_source.html#l00483">blas_quda.cu:483</a></div></div>
<div class="ttc" id="structquda_1_1_solver_param_html_ad4f1d65bdfd17f5647ac1cb2f972cd18"><div class="ttname"><a href="structquda_1_1_solver_param.html#ad4f1d65bdfd17f5647ac1cb2f972cd18">quda::SolverParam::secs</a></div><div class="ttdeci">double secs</div><div class="ttdef"><b>Definition:</b> <a href="invert__quda_8h_source.html#l00220">invert_quda.h:220</a></div></div>
<div class="ttc" id="enum__quda_8h_html_ab5e5bf7e911a8cb377a808cb7e039c1aa2bcaf9358e1031be726e7c1d96ebd0ed"><div class="ttname"><a href="enum__quda_8h.html#ab5e5bf7e911a8cb377a808cb7e039c1aa2bcaf9358e1031be726e7c1d96ebd0ed">QUDA_MR_INVERTER</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00105">enum_quda.h:105</a></div></div>
<div class="ttc" id="classquda_1_1_g_m_res_d_r_html_aa869a115446b88110dcbf22c55e8d9b7"><div class="ttname"><a href="classquda_1_1_g_m_res_d_r.html#aa869a115446b88110dcbf22c55e8d9b7">quda::GMResDR::FlexArnoldiProcedure</a></div><div class="ttdeci">int FlexArnoldiProcedure(const int start_idx, const bool do_givens)</div><div class="ttdef"><b>Definition:</b> <a href="inv__gmresdr__quda_8cpp_source.html#l00371">inv_gmresdr_quda.cpp:371</a></div></div>
<div class="ttc" id="classquda_1_1_g_m_res_d_r_args_html"><div class="ttname"><a href="classquda_1_1_g_m_res_d_r_args.html">quda::GMResDRArgs</a></div><div class="ttdef"><b>Definition:</b> <a href="inv__gmresdr__quda_8cpp_source.html#l00059">inv_gmresdr_quda.cpp:59</a></div></div>
<div class="ttc" id="namespacequda_html_a6a71833ed525c0d7a4c0d7bfaf48a6d2"><div class="ttname"><a href="namespacequda.html#a6a71833ed525c0d7a4c0d7bfaf48a6d2">quda::sqrt</a></div><div class="ttdeci">__host__ __device__ ValueType sqrt(ValueType x)</div><div class="ttdef"><b>Definition:</b> <a href="complex__quda_8h_source.html#l00120">complex_quda.h:120</a></div></div>
<div class="ttc" id="namespacequda_1_1blas_html_af3cffbae4092951f3b76c26f842d1db3"><div class="ttname"><a href="namespacequda_1_1blas.html#af3cffbae4092951f3b76c26f842d1db3">quda::blas::cDotProduct</a></div><div class="ttdeci">Complex cDotProduct(ColorSpinorField &amp;, ColorSpinorField &amp;)</div><div class="ttdef"><b>Definition:</b> <a href="reduce__quda_8cu_source.html#l00764">reduce_quda.cu:764</a></div></div>
<div class="ttc" id="structquda_1_1_sorted_evals_html_ac5bfe99a7c0e428dd9c2bcde0986758b"><div class="ttname"><a href="structquda_1_1_sorted_evals.html#ac5bfe99a7c0e428dd9c2bcde0986758b">quda::SortedEvals::SelectSmall</a></div><div class="ttdeci">static bool SelectSmall(SortedEvals v1, SortedEvals v2)</div><div class="ttdef"><b>Definition:</b> <a href="inv__gmresdr__quda_8cpp_source.html#l00053">inv_gmresdr_quda.cpp:53</a></div></div>
<div class="ttc" id="classquda_1_1_g_m_res_d_r_html_a7da349796380d408e58d928b8f9f5935"><div class="ttname"><a href="classquda_1_1_g_m_res_d_r.html#a7da349796380d408e58d928b8f9f5935">quda::GMResDR::rp</a></div><div class="ttdeci">ColorSpinorField * rp</div><div class="ttdef"><b>Definition:</b> <a href="invert__quda_8h_source.html#l01291">invert_quda.h:1291</a></div></div>
<div class="ttc" id="classquda_1_1_g_m_res_d_r_html_a82df151bcb020cda83a85173075d195d"><div class="ttname"><a href="classquda_1_1_g_m_res_d_r.html#a82df151bcb020cda83a85173075d195d">quda::GMResDR::profile</a></div><div class="ttdeci">TimeProfile &amp; profile</div><div class="ttdoc">preconditioner result </div><div class="ttdef"><b>Definition:</b> <a href="invert__quda_8h_source.html#l01298">invert_quda.h:1298</a></div></div>
<div class="ttc" id="classquda_1_1_solver_html_acdece7f94464de0325bcbd97104dca4a"><div class="ttname"><a href="classquda_1_1_solver.html#acdece7f94464de0325bcbd97104dca4a">quda::Solver::PrintStats</a></div><div class="ttdeci">void PrintStats(const char *name, int k, double r2, double b2, double hq2)</div><div class="ttdoc">Prints out the running statistics of the solver (requires a verbosity of QUDA_VERBOSE) ...</div><div class="ttdef"><b>Definition:</b> <a href="solver_8cpp_source.html#l00256">solver.cpp:256</a></div></div>
<div class="ttc" id="covdev__test_8cpp_html_a788da19b1cbae7d08eb18da226046dd7"><div class="ttname"><a href="covdev__test_8cpp.html#a788da19b1cbae7d08eb18da226046dd7">tmp</a></div><div class="ttdeci">cudaColorSpinorField * tmp</div><div class="ttdef"><b>Definition:</b> <a href="covdev__test_8cpp_source.html#l00044">covdev_test.cpp:44</a></div></div>
<div class="ttc" id="classquda_1_1_color_spinor_field_html_a59441fb61d11540d7d02de34e9ce4c6b"><div class="ttname"><a href="classquda_1_1_color_spinor_field.html#a59441fb61d11540d7d02de34e9ce4c6b">quda::ColorSpinorField::Components</a></div><div class="ttdeci">CompositeColorSpinorField &amp; Components()</div><div class="ttdef"><b>Definition:</b> <a href="color__spinor__field_8h_source.html#l00517">color_spinor_field.h:517</a></div></div>
<div class="ttc" id="classquda_1_1_color_spinor_field_html_aa0d2e38c03e2f97e358194a272b358dd"><div class="ttname"><a href="classquda_1_1_color_spinor_field.html#aa0d2e38c03e2f97e358194a272b358dd">quda::ColorSpinorField::Create</a></div><div class="ttdeci">static ColorSpinorField * Create(const ColorSpinorParam &amp;param)</div><div class="ttdef"><b>Definition:</b> <a href="color__spinor__field_8cpp_source.html#l00752">color_spinor_field.cpp:752</a></div></div>
<div class="ttc" id="classquda_1_1_solver_html_a6567b6addff40d5212f1a1bfd878cd29"><div class="ttname"><a href="classquda_1_1_solver.html#a6567b6addff40d5212f1a1bfd878cd29">quda::Solver::convergence</a></div><div class="ttdeci">bool convergence(double r2, double hq2, double r2_tol, double hq_tol)</div><div class="ttdef"><b>Definition:</b> <a href="solver_8cpp_source.html#l00223">solver.cpp:223</a></div></div>
<div class="ttc" id="structquda_1_1_sorted_evals_html_ab545faf36551872de772116e00b4b317"><div class="ttname"><a href="structquda_1_1_sorted_evals.html#ab545faf36551872de772116e00b4b317">quda::SortedEvals::SortedEvals</a></div><div class="ttdeci">SortedEvals(double val, int idx)</div><div class="ttdef"><b>Definition:</b> <a href="inv__gmresdr__quda_8cpp_source.html#l00052">inv_gmresdr_quda.cpp:52</a></div></div>
<div class="ttc" id="classquda_1_1_g_m_res_d_r_args_html_a6cab2bf187e516e1f75278efbf30c953"><div class="ttname"><a href="classquda_1_1_g_m_res_d_r_args.html#a6cab2bf187e516e1f75278efbf30c953">quda::GMResDRArgs::Vkp1</a></div><div class="ttdeci">ColorSpinorFieldSet * Vkp1</div><div class="ttdef"><b>Definition:</b> <a href="inv__gmresdr__quda_8cpp_source.html#l00072">inv_gmresdr_quda.cpp:72</a></div></div>
<div class="ttc" id="classquda_1_1_g_m_res_d_r_args_html_a4782da16f0c7a813d77d982ddf769678"><div class="ttname"><a href="classquda_1_1_g_m_res_d_r_args.html#a4782da16f0c7a813d77d982ddf769678">quda::GMResDRArgs::GMResDRArgs</a></div><div class="ttdeci">GMResDRArgs(int m, int nev)</div><div class="ttdef"><b>Definition:</b> <a href="inv__gmresdr__quda_8cpp_source.html#l00074">inv_gmresdr_quda.cpp:74</a></div></div>
<div class="ttc" id="namespacequda_1_1blas_html_aee938c63ad4eaa9d0ccc7d50013a5618"><div class="ttname"><a href="namespacequda_1_1blas.html#aee938c63ad4eaa9d0ccc7d50013a5618">quda::blas::copy</a></div><div class="ttdeci">void copy(ColorSpinorField &amp;dst, const ColorSpinorField &amp;src)</div><div class="ttdef"><b>Definition:</b> <a href="copy__quda_8cu_source.html#l00355">copy_quda.cu:355</a></div></div>
<div class="ttc" id="classquda_1_1_g_m_res_d_r_html_a58e6efaac94a868c161a37041a04e4a4"><div class="ttname"><a href="classquda_1_1_g_m_res_d_r.html#a58e6efaac94a868c161a37041a04e4a4">quda::GMResDR::Vm</a></div><div class="ttdeci">ColorSpinorFieldSet * Vm</div><div class="ttdef"><b>Definition:</b> <a href="invert__quda_8h_source.html#l01288">invert_quda.h:1288</a></div></div>
<div class="ttc" id="namespacestd_html"><div class="ttname"><a href="namespacestd.html">std</a></div><div class="ttdoc">STL namespace. </div></div>
<div class="ttc" id="classquda_1_1_m_r_html"><div class="ttname"><a href="classquda_1_1_m_r.html">quda::MR</a></div><div class="ttdef"><b>Definition:</b> <a href="invert__quda_8h_source.html#l00863">invert_quda.h:863</a></div></div>
<div class="ttc" id="enum__quda_8h_html_ab5e5bf7e911a8cb377a808cb7e039c1aaa914b36d059d33cc2b0aaa0998713305"><div class="ttname"><a href="enum__quda_8h.html#ab5e5bf7e911a8cb377a808cb7e039c1aaa914b36d059d33cc2b0aaa0998713305">QUDA_CG_INVERTER</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00102">enum_quda.h:102</a></div></div>
<div class="ttc" id="classquda_1_1_color_spinor_field_html_ae0819f9471411d51352d86d5b12ef830"><div class="ttname"><a href="classquda_1_1_color_spinor_field.html#ae0819f9471411d51352d86d5b12ef830">quda::ColorSpinorField::Component</a></div><div class="ttdeci">ColorSpinorField &amp; Component(const int idx) const</div><div class="ttdef"><b>Definition:</b> <a href="color__spinor__field_8cpp_source.html#l00653">color_spinor_field.cpp:653</a></div></div>
<div class="ttc" id="namespacequda_1_1blas_html_a53d7fb8e21b813343450b14c6ba7e631"><div class="ttname"><a href="namespacequda_1_1blas.html#a53d7fb8e21b813343450b14c6ba7e631">quda::blas::xmyNorm</a></div><div class="ttdeci">double xmyNorm(ColorSpinorField &amp;x, ColorSpinorField &amp;y)</div><div class="ttdef"><b>Definition:</b> <a href="blas__quda_8h_source.html#l00075">blas_quda.h:75</a></div></div>
<div class="ttc" id="classquda_1_1_g_m_res_d_r_html_ad0519a6febb874283214a327679acc90"><div class="ttname"><a href="classquda_1_1_g_m_res_d_r.html#ad0519a6febb874283214a327679acc90">quda::GMResDR::GMResDR</a></div><div class="ttdeci">GMResDR(DiracMatrix &amp;mat, DiracMatrix &amp;matSloppy, DiracMatrix &amp;matPrecon, SolverParam &amp;param, TimeProfile &amp;profile)</div><div class="ttdef"><b>Definition:</b> <a href="inv__gmresdr__quda_8cpp_source.html#l00211">inv_gmresdr_quda.cpp:211</a></div></div>
<div class="ttc" id="structquda_1_1_solver_param_html_af06b403a0da6be2ed22244f7be0e8dac"><div class="ttname"><a href="structquda_1_1_solver_param.html#af06b403a0da6be2ed22244f7be0e8dac">quda::SolverParam::inv_type_precondition</a></div><div class="ttdeci">QudaInverterType inv_type_precondition</div><div class="ttdef"><b>Definition:</b> <a href="invert__quda_8h_source.html#l00028">invert_quda.h:28</a></div></div>
<div class="ttc" id="util__quda_8h_html"><div class="ttname"><a href="util__quda_8h.html">util_quda.h</a></div></div>
<div class="ttc" id="structquda_1_1_solver_param_html_a01fc500d029447301b218003b79d7a5a"><div class="ttname"><a href="structquda_1_1_solver_param.html#a01fc500d029447301b218003b79d7a5a">quda::SolverParam::preserve_source</a></div><div class="ttdeci">QudaPreserveSource preserve_source</div><div class="ttdef"><b>Definition:</b> <a href="invert__quda_8h_source.html#l00154">invert_quda.h:154</a></div></div>
<div class="ttc" id="structquda_1_1_solver_param_html_a04e193e0d38b2606b1a8b4e1d2256efe"><div class="ttname"><a href="structquda_1_1_solver_param.html#a04e193e0d38b2606b1a8b4e1d2256efe">quda::SolverParam::iter</a></div><div class="ttdeci">int iter</div><div class="ttdef"><b>Definition:</b> <a href="invert__quda_8h_source.html#l00139">invert_quda.h:139</a></div></div>
<div class="ttc" id="enum__quda_8h_html_acedff361cdcb3099a97d8ccf632f74e4a2fbbc2c4c6359a721cde5036ee850306"><div class="ttname"><a href="enum__quda_8h.html#acedff361cdcb3099a97d8ccf632f74e4a2fbbc2c4c6359a721cde5036ee850306">QUDA_EIGEN_EXTLIB</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00525">enum_quda.h:525</a></div></div>
<div class="ttc" id="namespacequda_html_a5b73964657f76b68a4e7c926c803ad58"><div class="ttname"><a href="namespacequda.html#a5b73964657f76b68a4e7c926c803ad58">quda::RowMajorDenseMatrix</a></div><div class="ttdeci">Matrix&lt; Complex, Dynamic, Dynamic, RowMajor &gt; RowMajorDenseMatrix</div><div class="ttdef"><b>Definition:</b> <a href="inv__eigcg__quda_8cpp_source.html#l00042">inv_eigcg_quda.cpp:42</a></div></div>
<div class="ttc" id="namespacequda_html"><div class="ttname"><a href="namespacequda.html">quda</a></div><div class="ttdef"><b>Definition:</b> <a href="blas__cublas_8h_source.html#l00005">blas_cublas.h:5</a></div></div>
<div class="ttc" id="blas__magma_8h_html"><div class="ttname"><a href="blas__magma_8h.html">blas_magma.h</a></div></div>
<div class="ttc" id="namespacequda_html_a3174ee67c7fa7d35dbdf37b13064e8b0"><div class="ttname"><a href="namespacequda.html#a3174ee67c7fa7d35dbdf37b13064e8b0">quda::norm2</a></div><div class="ttdeci">double norm2(const CloverField &amp;a, bool inverse=false)</div><div class="ttdef"><b>Definition:</b> <a href="clover__field_8cpp_source.html#l00470">clover_field.cpp:470</a></div></div>
<div class="ttc" id="namespace_eigen_html"><div class="ttname"><a href="namespace_eigen.html">Eigen</a></div></div>
<div class="ttc" id="structquda_1_1_sorted_evals_html_a41a17a5dea3ac709236b4c60c2bd211a"><div class="ttname"><a href="structquda_1_1_sorted_evals.html#a41a17a5dea3ac709236b4c60c2bd211a">quda::SortedEvals::_idx</a></div><div class="ttdeci">int _idx</div><div class="ttdef"><b>Definition:</b> <a href="inv__gmresdr__quda_8cpp_source.html#l00050">inv_gmresdr_quda.cpp:50</a></div></div>
<div class="ttc" id="classquda_1_1_g_m_res_d_r_html_aaccc968217a0503d56ed3850796f9f25"><div class="ttname"><a href="classquda_1_1_g_m_res_d_r.html#aaccc968217a0503d56ed3850796f9f25">quda::GMResDR::yp</a></div><div class="ttdeci">ColorSpinorField * yp</div><div class="ttdoc">residual vector </div><div class="ttdef"><b>Definition:</b> <a href="invert__quda_8h_source.html#l01292">invert_quda.h:1292</a></div></div>
<div class="ttc" id="pack__test_8cpp_html_aba126262dff054e28bac5c0d901769c8"><div class="ttname"><a href="pack__test_8cpp.html#aba126262dff054e28bac5c0d901769c8">param</a></div><div class="ttdeci">QudaGaugeParam param</div><div class="ttdef"><b>Definition:</b> <a href="pack__test_8cpp_source.html#l00017">pack_test.cpp:17</a></div></div>
<div class="ttc" id="classquda_1_1_g_m_res_d_r_html_ae01b44d79309567db5f9b526415b847c"><div class="ttname"><a href="classquda_1_1_g_m_res_d_r.html#ae01b44d79309567db5f9b526415b847c">quda::GMResDR::gmresdr_args</a></div><div class="ttdeci">GMResDRArgs * gmresdr_args</div><div class="ttdef"><b>Definition:</b> <a href="invert__quda_8h_source.html#l01300">invert_quda.h:1300</a></div></div>
<div class="ttc" id="structquda_1_1_sorted_evals_html_a97324c6196b3afa663e47303f7f26269"><div class="ttname"><a href="structquda_1_1_sorted_evals.html#a97324c6196b3afa663e47303f7f26269">quda::SortedEvals::_val</a></div><div class="ttdeci">double _val</div><div class="ttdef"><b>Definition:</b> <a href="inv__gmresdr__quda_8cpp_source.html#l00049">inv_gmresdr_quda.cpp:49</a></div></div>
<div class="ttc" id="classquda_1_1_color_spinor_param_html_a8481f261317a60b786d56c2b839d76d6"><div class="ttname"><a href="classquda_1_1_color_spinor_param.html#a8481f261317a60b786d56c2b839d76d6">quda::ColorSpinorParam::is_composite</a></div><div class="ttdeci">bool is_composite</div><div class="ttdoc">for deflation solvers: </div><div class="ttdef"><b>Definition:</b> <a href="color__spinor__field_8h_source.html#l00103">color_spinor_field.h:103</a></div></div>
<div class="ttc" id="classquda_1_1_time_profile_html_a6b6019dff862e546af7693a702ff69d0"><div class="ttname"><a href="classquda_1_1_time_profile.html#a6b6019dff862e546af7693a702ff69d0">quda::TimeProfile::Last</a></div><div class="ttdeci">double Last(QudaProfileType idx)</div><div class="ttdef"><b>Definition:</b> <a href="timer_8h_source.html#l00251">timer.h:251</a></div></div>
<div class="ttc" id="classquda_1_1_color_spinor_param_html_a72430d56161c1ffe69aaf5d685f714e6"><div class="ttname"><a href="classquda_1_1_color_spinor_param.html#a72430d56161c1ffe69aaf5d685f714e6">quda::ColorSpinorParam::composite_dim</a></div><div class="ttdeci">int composite_dim</div><div class="ttdef"><b>Definition:</b> <a href="color__spinor__field_8h_source.html#l00104">color_spinor_field.h:104</a></div></div>
<div class="ttc" id="classquda_1_1_g_m_res_d_r_html_a2b6057a867c61df1c5b6891729b2296d"><div class="ttname"><a href="classquda_1_1_g_m_res_d_r.html#a2b6057a867c61df1c5b6891729b2296d">quda::GMResDR::K</a></div><div class="ttdeci">Solver * K</div><div class="ttdef"><b>Definition:</b> <a href="invert__quda_8h_source.html#l01285">invert_quda.h:1285</a></div></div>
<div class="ttc" id="classquda_1_1_g_m_res_d_r_args_html_a21af185e4244a593a559cd7daadf18d2"><div class="ttname"><a href="classquda_1_1_g_m_res_d_r_args.html#a21af185e4244a593a559cd7daadf18d2">quda::GMResDRArgs::ResetArgs</a></div><div class="ttdeci">void ResetArgs()</div><div class="ttdef"><b>Definition:</b> <a href="inv__gmresdr__quda_8cpp_source.html#l00077">inv_gmresdr_quda.cpp:77</a></div></div>
<div class="ttc" id="namespacequda_html_aaffbb8136180ff3fc91d20933dc1e1a3"><div class="ttname"><a href="namespacequda.html#aaffbb8136180ff3fc91d20933dc1e1a3">quda::caxpy</a></div><div class="ttdeci">__device__ __host__ void caxpy(const complex&lt; Float &gt; &amp;a, const complex&lt; Float &gt; &amp;x, complex&lt; Float &gt; &amp;y)</div><div class="ttdef"><b>Definition:</b> <a href="coarse__op__kernel_8cuh_source.html#l00117">coarse_op_kernel.cuh:117</a></div></div>
<div class="ttc" id="structquda_1_1_solver_param_html_ada170467536dd4a3ebae68f6a8388cb8"><div class="ttname"><a href="structquda_1_1_solver_param.html#ada170467536dd4a3ebae68f6a8388cb8">quda::SolverParam::gflops</a></div><div class="ttdeci">double gflops</div><div class="ttdef"><b>Definition:</b> <a href="invert__quda_8h_source.html#l00223">invert_quda.h:223</a></div></div>
<div class="ttc" id="structquda_1_1_solver_param_html_a4c67d3240a333f0f96f9f0c7748c484b"><div class="ttname"><a href="structquda_1_1_solver_param.html#a4c67d3240a333f0f96f9f0c7748c484b">quda::SolverParam::residual_type</a></div><div class="ttdeci">QudaResidualType residual_type</div><div class="ttdef"><b>Definition:</b> <a href="invert__quda_8h_source.html#l00049">invert_quda.h:49</a></div></div>
<div class="ttc" id="namespacequda_html_aa08cbb5f3fa8e32f80d4b2cccb7a97c9"><div class="ttname"><a href="namespacequda.html#aa08cbb5f3fa8e32f80d4b2cccb7a97c9">quda::fillFGMResDRInnerSolveParam</a></div><div class="ttdeci">void fillFGMResDRInnerSolveParam(SolverParam &amp;inner, const SolverParam &amp;outer)</div><div class="ttdef"><b>Definition:</b> <a href="inv__gmresdr__quda_8cpp_source.html#l00187">inv_gmresdr_quda.cpp:187</a></div></div>
<div class="ttc" id="enum__quda_8h_html_ab6aad69f1c1b3ec370b035c2b1e34654a6e639fc6aa06dab4fa7a41533c766aa3"><div class="ttname"><a href="enum__quda_8h.html#ab6aad69f1c1b3ec370b035c2b1e34654a6e639fc6aa06dab4fa7a41533c766aa3">QUDA_PRESERVE_SOURCE_NO</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00236">enum_quda.h:236</a></div></div>
<div class="ttc" id="classquda_1_1_g_m_res_d_r_html_a927e8615258699ec3f104e6b3e94f026"><div class="ttname"><a href="classquda_1_1_g_m_res_d_r.html#a927e8615258699ec3f104e6b3e94f026">quda::GMResDR::Kparam</a></div><div class="ttdeci">SolverParam Kparam</div><div class="ttdef"><b>Definition:</b> <a href="invert__quda_8h_source.html#l01286">invert_quda.h:1286</a></div></div>
<div class="ttc" id="namespacequda_html_ab9bad7eeabf43337acf0cb22f4b189cb"><div class="ttname"><a href="namespacequda.html#ab9bad7eeabf43337acf0cb22f4b189cb">quda::DynamicStride</a></div><div class="ttdeci">Stride&lt; Dynamic, Dynamic &gt; DynamicStride</div><div class="ttdef"><b>Definition:</b> <a href="deflation_8cpp_source.html#l00018">deflation.cpp:18</a></div></div>
<div class="ttc" id="namespacequda_html_a8ad4f224c5228606d725a5f9a96c3f23a3adbe92803403a6088ad514690cf28ea"><div class="ttname"><a href="namespacequda.html#a8ad4f224c5228606d725a5f9a96c3f23a3adbe92803403a6088ad514690cf28ea">quda::QUDA_PROFILE_EPILOGUE</a></div><div class="ttdef"><b>Definition:</b> <a href="timer_8h_source.html#l00110">timer.h:110</a></div></div>
<div class="ttc" id="structquda_1_1_solver_param_html_ad5129070fdc69c6b57efd2bc750cd9c2"><div class="ttname"><a href="structquda_1_1_solver_param.html#ad5129070fdc69c6b57efd2bc750cd9c2">quda::SolverParam::maxiter</a></div><div class="ttdeci">int maxiter</div><div class="ttdef"><b>Definition:</b> <a href="invert__quda_8h_source.html#l00136">invert_quda.h:136</a></div></div>
<div class="ttc" id="pack__test_8cpp_html_a526a592aff1010115b86c419f227f725"><div class="ttname"><a href="pack__test_8cpp.html#a526a592aff1010115b86c419f227f725">csParam</a></div><div class="ttdeci">ColorSpinorParam csParam</div><div class="ttdef"><b>Definition:</b> <a href="pack__test_8cpp_source.html#l00024">pack_test.cpp:24</a></div></div>
<div class="ttc" id="namespacequda_html_abe598ea1308b5f23670eaab8662949a0a74c060da36f859167ad519744d73dedb"><div class="ttname"><a href="namespacequda.html#abe598ea1308b5f23670eaab8662949a0a74c060da36f859167ad519744d73dedb">quda::libtype::eigen_lib</a></div></div>
<div class="ttc" id="enum__quda_8h_html_acedff361cdcb3099a97d8ccf632f74e4a3d7c76525d6d9d78bc280271ff861b92"><div class="ttname"><a href="enum__quda_8h.html#acedff361cdcb3099a97d8ccf632f74e4a3d7c76525d6d9d78bc280271ff861b92">QUDA_MAGMA_EXTLIB</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00526">enum_quda.h:526</a></div></div>
<div class="ttc" id="namespacequda_1_1blas_html_aca6d0abadc46cf0048397a98c7e64316"><div class="ttname"><a href="namespacequda_1_1blas.html#aca6d0abadc46cf0048397a98c7e64316">quda::blas::axpy</a></div><div class="ttdeci">void axpy(double a, ColorSpinorField &amp;x, ColorSpinorField &amp;y)</div><div class="ttdef"><b>Definition:</b> <a href="blas__quda_8h_source.html#l00035">blas_quda.h:35</a></div></div>
<div class="ttc" id="namespacequda_html_a8ad4f224c5228606d725a5f9a96c3f23a83aaea7b7a870743ae8b13ecc51245ef"><div class="ttname"><a href="namespacequda.html#a8ad4f224c5228606d725a5f9a96c3f23a83aaea7b7a870743ae8b13ecc51245ef">quda::QUDA_PROFILE_COMPUTE</a></div><div class="ttdef"><b>Definition:</b> <a href="timer_8h_source.html#l00108">timer.h:108</a></div></div>
<div class="ttc" id="classquda_1_1_g_m_res_d_r_html_ad71f1c06889adcbbe03631605062868c"><div class="ttname"><a href="classquda_1_1_g_m_res_d_r.html#ad71f1c06889adcbbe03631605062868c">quda::GMResDR::matPrecon</a></div><div class="ttdeci">DiracMatrix &amp; matPrecon</div><div class="ttdef"><b>Definition:</b> <a href="invert__quda_8h_source.html#l01283">invert_quda.h:1283</a></div></div>
<div class="ttc" id="util__quda_8h_html_add1a8e46583c4e0149436e17535afd39"><div class="ttname"><a href="util__quda_8h.html#add1a8e46583c4e0149436e17535afd39">warningQuda</a></div><div class="ttdeci">#define warningQuda(...)</div><div class="ttdef"><b>Definition:</b> <a href="util__quda_8h_source.html#l00133">util_quda.h:133</a></div></div>
<div class="ttc" id="structquda_1_1_solver_param_html_a330eed9c8f5a8423ae94ce6008de85c7"><div class="ttname"><a href="structquda_1_1_solver_param.html#a330eed9c8f5a8423ae94ce6008de85c7">quda::SolverParam::is_preconditioner</a></div><div class="ttdeci">bool is_preconditioner</div><div class="ttdoc">verbosity to use for preconditioner </div><div class="ttdef"><b>Definition:</b> <a href="invert__quda_8h_source.html#l00241">invert_quda.h:241</a></div></div>
<div class="ttc" id="namespacequda_html_abe598ea1308b5f23670eaab8662949a0"><div class="ttname"><a href="namespacequda.html#abe598ea1308b5f23670eaab8662949a0">quda::libtype</a></div><div class="ttdeci">libtype</div><div class="ttdef"><b>Definition:</b> <a href="inv__eigcg__quda_8cpp_source.html#l00047">inv_eigcg_quda.cpp:47</a></div></div>
<div class="ttc" id="structquda_1_1_solver_param_html_ad866c767750c633ccca233281d10b1c9"><div class="ttname"><a href="structquda_1_1_solver_param.html#ad866c767750c633ccca233281d10b1c9">quda::SolverParam::tol_hq</a></div><div class="ttdeci">double tol_hq</div><div class="ttdef"><b>Definition:</b> <a href="invert__quda_8h_source.html#l00121">invert_quda.h:121</a></div></div>
<div class="ttc" id="structquda_1_1_solver_param_html_a232008d9c68aa120993a129941f041e8"><div class="ttname"><a href="structquda_1_1_solver_param.html#a232008d9c68aa120993a129941f041e8">quda::SolverParam::deflation_grid</a></div><div class="ttdeci">int deflation_grid</div><div class="ttdef"><b>Definition:</b> <a href="invert__quda_8h_source.html#l00231">invert_quda.h:231</a></div></div>
<div class="ttc" id="namespacequda_1_1blas_html_a46268afb6cc8f820c3b37ff6607e6954"><div class="ttname"><a href="namespacequda_1_1blas.html#a46268afb6cc8f820c3b37ff6607e6954">quda::blas::HeavyQuarkResidualNorm</a></div><div class="ttdeci">double3 HeavyQuarkResidualNorm(ColorSpinorField &amp;x, ColorSpinorField &amp;r)</div><div class="ttdef"><b>Definition:</b> <a href="reduce__quda_8cu_source.html#l00809">reduce_quda.cu:809</a></div></div>
<div class="ttc" id="namespacequda_html_a8ad4f224c5228606d725a5f9a96c3f23ac3997ab139d55a10abd9f79ea2aa09ad"><div class="ttname"><a href="namespacequda.html#a8ad4f224c5228606d725a5f9a96c3f23ac3997ab139d55a10abd9f79ea2aa09ad">quda::QUDA_PROFILE_PREAMBLE</a></div><div class="ttdef"><b>Definition:</b> <a href="timer_8h_source.html#l00107">timer.h:107</a></div></div>
<div class="ttc" id="classquda_1_1_g_m_res_d_r_html_af005990d3f1e771a151af3a28f79e74d"><div class="ttname"><a href="classquda_1_1_g_m_res_d_r.html#af005990d3f1e771a151af3a28f79e74d">quda::GMResDR::operator()</a></div><div class="ttdeci">void operator()(ColorSpinorField &amp;out, ColorSpinorField &amp;in)</div><div class="ttdef"><b>Definition:</b> <a href="inv__gmresdr__quda_8cpp_source.html#l00453">inv_gmresdr_quda.cpp:453</a></div></div>
<div class="ttc" id="namespacequda_html_a61eb8e0789e8a2021032ee12761d924e"><div class="ttname"><a href="namespacequda.html#a61eb8e0789e8a2021032ee12761d924e">quda::Complex</a></div><div class="ttdeci">std::complex&lt; double &gt; Complex</div><div class="ttdef"><b>Definition:</b> <a href="quda__internal_8h_source.html#l00046">quda_internal.h:46</a></div></div>
<div class="ttc" id="classquda_1_1_g_m_res_d_r_args_html_acc78f80e6b026bdc3b01b4e10ef3384b"><div class="ttname"><a href="classquda_1_1_g_m_res_d_r_args.html#acc78f80e6b026bdc3b01b4e10ef3384b">quda::GMResDRArgs::k</a></div><div class="ttdeci">int k</div><div class="ttdef"><b>Definition:</b> <a href="inv__gmresdr__quda_8cpp_source.html#l00067">inv_gmresdr_quda.cpp:67</a></div></div>
<div class="ttc" id="enum__quda_8h_html_a7518a0b4f519bd7aa860415c861c05b0a43ee9033af9de2a03eca62b22c42357c"><div class="ttname"><a href="enum__quda_8h.html#a7518a0b4f519bd7aa860415c861c05b0a43ee9033af9de2a03eca62b22c42357c">QUDA_HEAVY_QUARK_RESIDUAL</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00189">enum_quda.h:189</a></div></div>
<div class="ttc" id="namespacequda_1_1blas_html_ae3e5e69d87a6db7678c8fb7dc14daca7"><div class="ttname"><a href="namespacequda_1_1blas.html#ae3e5e69d87a6db7678c8fb7dc14daca7">quda::blas::caxpy</a></div><div class="ttdeci">void caxpy(const Complex &amp;a, ColorSpinorField &amp;x, ColorSpinorField &amp;y)</div><div class="ttdef"><b>Definition:</b> <a href="blas__quda_8cu_source.html#l00512">blas_quda.cu:512</a></div></div>
<div class="ttc" id="classquda_1_1_g_m_res_d_r_args_html_a52d0d00864b81e0ffbaa539c22c5d70c"><div class="ttname"><a href="classquda_1_1_g_m_res_d_r_args.html#a52d0d00864b81e0ffbaa539c22c5d70c">quda::GMResDRArgs::H</a></div><div class="ttdeci">DenseMatrix H</div><div class="ttdef"><b>Definition:</b> <a href="inv__gmresdr__quda_8cpp_source.html#l00063">inv_gmresdr_quda.cpp:63</a></div></div>
<div class="ttc" id="structquda_1_1_solver_param_html_a3f34e76909654cf2a43caad7b6f0c4b5"><div class="ttname"><a href="structquda_1_1_solver_param.html#a3f34e76909654cf2a43caad7b6f0c4b5">quda::SolverParam::tol_precondition</a></div><div class="ttdeci">double tol_precondition</div><div class="ttdef"><b>Definition:</b> <a href="invert__quda_8h_source.html#l00199">invert_quda.h:199</a></div></div>
<div class="ttc" id="enum__quda_8h_html_ab5e5bf7e911a8cb377a808cb7e039c1aae3a4e0ccd59067afb3097aee327ff104"><div class="ttname"><a href="enum__quda_8h.html#ab5e5bf7e911a8cb377a808cb7e039c1aae3a4e0ccd59067afb3097aee327ff104">QUDA_BICGSTAB_INVERTER</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00103">enum_quda.h:103</a></div></div>
<div class="ttc" id="structquda_1_1_solver_param_html_a4f5f41719adba83da90880163117fe4c"><div class="ttname"><a href="structquda_1_1_solver_param.html#a4f5f41719adba83da90880163117fe4c">quda::SolverParam::extlib_type</a></div><div class="ttdeci">QudaExtLibType extlib_type</div><div class="ttdef"><b>Definition:</b> <a href="invert__quda_8h_source.html#l00251">invert_quda.h:251</a></div></div>
<div class="ttc" id="enum__quda_8h_html_ab5e5bf7e911a8cb377a808cb7e039c1aa938c70e5610785120c610c0795642f90"><div class="ttname"><a href="enum__quda_8h.html#ab5e5bf7e911a8cb377a808cb7e039c1aa938c70e5610785120c610c0795642f90">QUDA_SD_INVERTER</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00107">enum_quda.h:107</a></div></div>
<div class="ttc" id="namespacequda_1_1blas_html_ab738546293a39098f5c9bdb3c1ea6876"><div class="ttname"><a href="namespacequda_1_1blas.html#ab738546293a39098f5c9bdb3c1ea6876">quda::blas::zero</a></div><div class="ttdeci">void zero(ColorSpinorField &amp;a)</div><div class="ttdef"><b>Definition:</b> <a href="blas__quda_8cu_source.html#l00472">blas_quda.cu:472</a></div></div>
<div class="ttc" id="util__quda_8h_html_a13b05722eea48a935ab172483b89f3c7"><div class="ttname"><a href="util__quda_8h.html#a13b05722eea48a935ab172483b89f3c7">pushVerbosity</a></div><div class="ttdeci">void pushVerbosity(QudaVerbosity verbosity)</div><div class="ttdoc">Push a new verbosity onto the stack. </div><div class="ttdef"><b>Definition:</b> <a href="util__quda_8cpp_source.html#l00083">util_quda.cpp:83</a></div></div>
<div class="ttc" id="structquda_1_1_solver_param_html_a720f806cdd39be6b6a11146c7e70f3a8"><div class="ttname"><a href="structquda_1_1_solver_param.html#a720f806cdd39be6b6a11146c7e70f3a8">quda::SolverParam::precision_precondition</a></div><div class="ttdeci">QudaPrecision precision_precondition</div><div class="ttdef"><b>Definition:</b> <a href="invert__quda_8h_source.html#l00151">invert_quda.h:151</a></div></div>
<div class="ttc" id="covdev__reference_8cpp_html_ace6ee45c30e71865e6eb635200379db9"><div class="ttname"><a href="covdev__reference_8cpp.html#ace6ee45c30e71865e6eb635200379db9">memset</a></div><div class="ttdeci">void * memset(void *s, int c, size_t n)</div></div>
<div class="ttc" id="classquda_1_1_g_m_res_d_r_args_html_a18d2f271e259e35d3da1057a09db2552"><div class="ttname"><a href="classquda_1_1_g_m_res_d_r_args.html#a18d2f271e259e35d3da1057a09db2552">quda::GMResDRArgs::eta</a></div><div class="ttdeci">Vector eta</div><div class="ttdef"><b>Definition:</b> <a href="inv__gmresdr__quda_8cpp_source.html#l00064">inv_gmresdr_quda.cpp:64</a></div></div>
<div class="ttc" id="blas__magma_8h_html_a4c2682b088feef2f297278a95dcbe6a7"><div class="ttname"><a href="blas__magma_8h.html#a4c2682b088feef2f297278a95dcbe6a7">magma_Xgels</a></div><div class="ttdeci">void magma_Xgels(void *Mat, void *c, int rows, int cols, int ldm, const int prec)</div><div class="ttdef"><b>Definition:</b> <a href="blas__magma_8cu_source.html#l00286">blas_magma.cu:286</a></div></div>
<div class="ttc" id="blas__quda_8h_html"><div class="ttname"><a href="blas__quda_8h.html">blas_quda.h</a></div></div>
<div class="ttc" id="structquda_1_1_solver_param_html_a1dd05ed86fbade30927fa96d1d99d61f"><div class="ttname"><a href="structquda_1_1_solver_param.html#a1dd05ed86fbade30927fa96d1d99d61f">quda::SolverParam::precision</a></div><div class="ttdeci">QudaPrecision precision</div><div class="ttdef"><b>Definition:</b> <a href="invert__quda_8h_source.html#l00142">invert_quda.h:142</a></div></div>
<div class="ttc" id="namespacequda_html_a8ad4f224c5228606d725a5f9a96c3f23a0709c9c1b7a8915651844380b231e3a6"><div class="ttname"><a href="namespacequda.html#a8ad4f224c5228606d725a5f9a96c3f23a0709c9c1b7a8915651844380b231e3a6">quda::QUDA_PROFILE_INIT</a></div><div class="ttdef"><b>Definition:</b> <a href="timer_8h_source.html#l00106">timer.h:106</a></div></div>
<div class="ttc" id="class_matrix_html"><div class="ttname"><a href="class_matrix.html">Matrix</a></div><div class="ttdef"><b>Definition:</b> <a href="hisq__force__reference2_8cpp_source.html#l00131">hisq_force_reference2.cpp:131</a></div></div>
<div class="ttc" id="structquda_1_1_solver_param_html_a3216915ee7c00cad34888cb76ead8fae"><div class="ttname"><a href="structquda_1_1_solver_param.html#a3216915ee7c00cad34888cb76ead8fae">quda::SolverParam::true_res</a></div><div class="ttdeci">double true_res</div><div class="ttdef"><b>Definition:</b> <a href="invert__quda_8h_source.html#l00130">invert_quda.h:130</a></div></div>
<div class="ttc" id="classquda_1_1_solver_html"><div class="ttname"><a href="classquda_1_1_solver.html">quda::Solver</a></div><div class="ttdef"><b>Definition:</b> <a href="invert__quda_8h_source.html#l00460">invert_quda.h:460</a></div></div>
<div class="ttc" id="classquda_1_1_color_spinor_param_html"><div class="ttname"><a href="classquda_1_1_color_spinor_param.html">quda::ColorSpinorParam</a></div><div class="ttdef"><b>Definition:</b> <a href="color__spinor__field_8h_source.html#l00080">color_spinor_field.h:80</a></div></div>
<div class="ttc" id="enum__quda_8h_html_ac166c47d6ef16f830c164fefe6c8ab90a6288ca4c9d3166592676284c7d886972"><div class="ttname"><a href="enum__quda_8h.html#ac166c47d6ef16f830c164fefe6c8ab90a6288ca4c9d3166592676284c7d886972">QUDA_DOUBLE_PRECISION</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00062">enum_quda.h:62</a></div></div>
<div class="ttc" id="classquda_1_1_solver_html_a9c3ee5319f85ec0cf5aa24d76894c398"><div class="ttname"><a href="classquda_1_1_solver.html#a9c3ee5319f85ec0cf5aa24d76894c398">quda::Solver::param</a></div><div class="ttdeci">SolverParam &amp; param</div><div class="ttdef"><b>Definition:</b> <a href="invert__quda_8h_source.html#l00463">invert_quda.h:463</a></div></div>
<div class="ttc" id="classquda_1_1_g_m_res_d_r_html_aa356e09c2bc1434569cdeeece24c206c"><div class="ttname"><a href="classquda_1_1_g_m_res_d_r.html#aa356e09c2bc1434569cdeeece24c206c">quda::GMResDR::Zm</a></div><div class="ttdeci">ColorSpinorFieldSet * Zm</div><div class="ttdef"><b>Definition:</b> <a href="invert__quda_8h_source.html#l01289">invert_quda.h:1289</a></div></div>
<div class="ttc" id="classquda_1_1_g_m_res_d_r_args_html_ad0c8d7fe7c408edb6d6bb1ca7c4009bb"><div class="ttname"><a href="classquda_1_1_g_m_res_d_r_args.html#ad0c8d7fe7c408edb6d6bb1ca7c4009bb">quda::GMResDRArgs::~GMResDRArgs</a></div><div class="ttdeci">~GMResDRArgs()</div><div class="ttdef"><b>Definition:</b> <a href="inv__gmresdr__quda_8cpp_source.html#l00083">inv_gmresdr_quda.cpp:83</a></div></div>
<div class="ttc" id="structquda_1_1_solver_param_html_a1ca3579b5841d10802ef3fdf68473464"><div class="ttname"><a href="structquda_1_1_solver_param.html#a1ca3579b5841d10802ef3fdf68473464">quda::SolverParam::m</a></div><div class="ttdeci">int m</div><div class="ttdef"><b>Definition:</b> <a href="invert__quda_8h_source.html#l00230">invert_quda.h:230</a></div></div>
<div class="ttc" id="enum__quda_8h_html_ab5e5bf7e911a8cb377a808cb7e039c1aac9cd27c68bb634ee4fc1ee2b31599a94"><div class="ttname"><a href="enum__quda_8h.html#ab5e5bf7e911a8cb377a808cb7e039c1aac9cd27c68bb634ee4fc1ee2b31599a94">QUDA_INVALID_INVERTER</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00128">enum_quda.h:128</a></div></div>
<div class="ttc" id="classquda_1_1_c_g_html"><div class="ttname"><a href="classquda_1_1_c_g.html">quda::CG</a></div><div class="ttdoc">Conjugate-Gradient Solver. </div><div class="ttdef"><b>Definition:</b> <a href="invert__quda_8h_source.html#l00570">invert_quda.h:570</a></div></div>
<div class="ttc" id="classquda_1_1_g_m_res_d_r_html_add765917232ad6d8c4536ea480fd157c"><div class="ttname"><a href="classquda_1_1_g_m_res_d_r.html#add765917232ad6d8c4536ea480fd157c">quda::GMResDR::matSloppy</a></div><div class="ttdeci">DiracMatrix &amp; matSloppy</div><div class="ttdef"><b>Definition:</b> <a href="invert__quda_8h_source.html#l01282">invert_quda.h:1282</a></div></div>
<div class="ttc" id="classquda_1_1_g_m_res_d_r_html_acfa1984fd2a84206e9fd88b73030a477"><div class="ttname"><a href="classquda_1_1_g_m_res_d_r.html#acfa1984fd2a84206e9fd88b73030a477">quda::GMResDR::mat</a></div><div class="ttdeci">DiracMatrix &amp; mat</div><div class="ttdef"><b>Definition:</b> <a href="invert__quda_8h_source.html#l01281">invert_quda.h:1281</a></div></div>
<div class="ttc" id="deflated__invert__test_8cpp_html_a015e64d999600a1ac5f5bdb700cd17b6"><div class="ttname"><a href="deflated__invert__test_8cpp.html#a015e64d999600a1ac5f5bdb700cd17b6">nev</a></div><div class="ttdeci">int nev</div><div class="ttdef"><b>Definition:</b> <a href="test__util_8cpp_source.html#l01707">test_util.cpp:1707</a></div></div>
<div class="ttc" id="classquda_1_1_dirac_matrix_html_a70fd2aa9efa763e92789b478badb02b0"><div class="ttname"><a href="classquda_1_1_dirac_matrix.html#a70fd2aa9efa763e92789b478badb02b0">quda::DiracMatrix::flops</a></div><div class="ttdeci">unsigned long long flops() const</div><div class="ttdef"><b>Definition:</b> <a href="dirac__quda_8h_source.html#l01119">dirac_quda.h:1119</a></div></div>
<div class="ttc" id="classquda_1_1_dirac_matrix_html"><div class="ttname"><a href="classquda_1_1_dirac_matrix.html">quda::DiracMatrix</a></div><div class="ttdef"><b>Definition:</b> <a href="dirac__quda_8h_source.html#l01100">dirac_quda.h:1100</a></div></div>
<div class="ttc" id="namespacequda_html_a048501d184bc5c0d1e4462e80a80bb1a"><div class="ttname"><a href="namespacequda.html#a048501d184bc5c0d1e4462e80a80bb1a">quda::DenseMatrix</a></div><div class="ttdeci">MatrixXcd DenseMatrix</div><div class="ttdef"><b>Definition:</b> <a href="inv__eigcg__quda_8cpp_source.html#l00036">inv_eigcg_quda.cpp:36</a></div></div>
<div class="ttc" id="dslash__quda_8h_html"><div class="ttname"><a href="dslash__quda_8h.html">dslash_quda.h</a></div></div>
<div class="ttc" id="util__quda_8h_html_a35882d3606e4edaa96d082d239d0e7a0"><div class="ttname"><a href="util__quda_8h.html#a35882d3606e4edaa96d082d239d0e7a0">printfQuda</a></div><div class="ttdeci">#define printfQuda(...)</div><div class="ttdef"><b>Definition:</b> <a href="util__quda_8h_source.html#l00115">util_quda.h:115</a></div></div>
<div class="ttc" id="namespacequda_1_1blas_html_a74096281fea1853bd9ab0f16ecb92b31"><div class="ttname"><a href="namespacequda_1_1blas.html#a74096281fea1853bd9ab0f16ecb92b31">quda::blas::flops</a></div><div class="ttdeci">unsigned long long flops</div><div class="ttdef"><b>Definition:</b> <a href="blas__quda_8cu_source.html#l00022">blas_quda.cu:22</a></div></div>
<div class="ttc" id="structquda_1_1_sorted_evals_html"><div class="ttname"><a href="structquda_1_1_sorted_evals.html">quda::SortedEvals</a></div><div class="ttdef"><b>Definition:</b> <a href="inv__gmresdr__quda_8cpp_source.html#l00047">inv_gmresdr_quda.cpp:47</a></div></div>
<div class="ttc" id="namespacequda_1_1blas_html_ae823e2784a147b1ef92f13b2a6f6941c"><div class="ttname"><a href="namespacequda_1_1blas.html#ae823e2784a147b1ef92f13b2a6f6941c">quda::blas::xpy</a></div><div class="ttdeci">void xpy(ColorSpinorField &amp;x, ColorSpinorField &amp;y)</div><div class="ttdef"><b>Definition:</b> <a href="blas__quda_8h_source.html#l00033">blas_quda.h:33</a></div></div>
<div class="ttc" id="classquda_1_1_g_m_res_d_r_html_a53e3a4ceb32f2dcffaeab3499104b39d"><div class="ttname"><a href="classquda_1_1_g_m_res_d_r.html#a53e3a4ceb32f2dcffaeab3499104b39d">quda::GMResDR::~GMResDR</a></div><div class="ttdeci">virtual ~GMResDR()</div><div class="ttdef"><b>Definition:</b> <a href="inv__gmresdr__quda_8cpp_source.html#l00239">inv_gmresdr_quda.cpp:239</a></div></div>
<div class="ttc" id="namespacequda_html_a4e54927fc030027c7892b4bff973aaaa"><div class="ttname"><a href="namespacequda.html#a4e54927fc030027c7892b4bff973aaaa">quda::Vector</a></div><div class="ttdeci">VectorXcd Vector</div><div class="ttdef"><b>Definition:</b> <a href="inv__eigcg__quda_8cpp_source.html#l00038">inv_eigcg_quda.cpp:38</a></div></div>
<div class="ttc" id="classquda_1_1_time_profile_html"><div class="ttname"><a href="classquda_1_1_time_profile.html">quda::TimeProfile</a></div><div class="ttdef"><b>Definition:</b> <a href="timer_8h_source.html#l00171">timer.h:171</a></div></div>
<div class="ttc" id="classquda_1_1_g_m_res_d_r_html_ad7148d82c10b8450b407f3fb359fafb7"><div class="ttname"><a href="classquda_1_1_g_m_res_d_r.html#ad7148d82c10b8450b407f3fb359fafb7">quda::GMResDR::p_pre</a></div><div class="ttdeci">ColorSpinorField * p_pre</div><div class="ttdoc">residual passed to preconditioner </div><div class="ttdef"><b>Definition:</b> <a href="invert__quda_8h_source.html#l01296">invert_quda.h:1296</a></div></div>
<div class="ttc" id="namespacequda_html_afc8f979be274d625e247ce913db49805"><div class="ttname"><a href="namespacequda.html#afc8f979be274d625e247ce913db49805">quda::abs</a></div><div class="ttdeci">__host__ __device__ ValueType abs(ValueType x)</div><div class="ttdef"><b>Definition:</b> <a href="complex__quda_8h_source.html#l00125">complex_quda.h:125</a></div></div>
<div class="ttc" id="util__quda_8h_html_a7efc6647d04d720d7ec040e8348ef483"><div class="ttname"><a href="util__quda_8h.html#a7efc6647d04d720d7ec040e8348ef483">popVerbosity</a></div><div class="ttdeci">void popVerbosity()</div><div class="ttdoc">Pop the verbosity restoring the prior one on the stack. </div><div class="ttdef"><b>Definition:</b> <a href="util__quda_8cpp_source.html#l00094">util_quda.cpp:94</a></div></div>
<div class="ttc" id="namespacequda_html_abe598ea1308b5f23670eaab8662949a0aeb918fcb0e14b0812bb403fe1ec05c82"><div class="ttname"><a href="namespacequda.html#abe598ea1308b5f23670eaab8662949a0aeb918fcb0e14b0812bb403fe1ec05c82">quda::libtype::mkl_lib</a></div></div>
<div class="ttc" id="structquda_1_1_solver_param_html_a7748ac1dc90359e2eedb0d17e6396800"><div class="ttname"><a href="structquda_1_1_solver_param.html#a7748ac1dc90359e2eedb0d17e6396800">quda::SolverParam::precision_sloppy</a></div><div class="ttdeci">QudaPrecision precision_sloppy</div><div class="ttdef"><b>Definition:</b> <a href="invert__quda_8h_source.html#l00145">invert_quda.h:145</a></div></div>
<div class="ttc" id="classquda_1_1_g_m_res_d_r_html_a80f9173c2c04c21db51934fa85521e4e"><div class="ttname"><a href="classquda_1_1_g_m_res_d_r.html#a80f9173c2c04c21db51934fa85521e4e">quda::GMResDR::UpdateSolution</a></div><div class="ttdeci">void UpdateSolution(ColorSpinorField *x, ColorSpinorField *r, bool do_gels)</div><div class="ttdef"><b>Definition:</b> <a href="inv__gmresdr__quda_8cpp_source.html#l00271">inv_gmresdr_quda.cpp:271</a></div></div>
<div class="ttc" id="util__quda_8h_html_a7668e6580e0f57b0db3112fae4959e34"><div class="ttname"><a href="util__quda_8h.html#a7668e6580e0f57b0db3112fae4959e34">checkCudaError</a></div><div class="ttdeci">#define checkCudaError()</div><div class="ttdef"><b>Definition:</b> <a href="util__quda_8h_source.html#l00161">util_quda.h:161</a></div></div>
<div class="ttc" id="enum__quda_8h_html_ae3c3f9e9961c64a4a34f144d8f87f805a0a7b5b5ebe4058a465669eee83915158"><div class="ttname"><a href="enum__quda_8h.html#ae3c3f9e9961c64a4a34f144d8f87f805a0a7b5b5ebe4058a465669eee83915158">QUDA_ZERO_FIELD_CREATE</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00360">enum_quda.h:360</a></div></div>
<div class="ttc" id="classquda_1_1_g_m_res_d_r_html_ad4433f6c83710e695edbbe61223fb475"><div class="ttname"><a href="classquda_1_1_g_m_res_d_r.html#ad4433f6c83710e695edbbe61223fb475">quda::GMResDR::tmpp</a></div><div class="ttdeci">ColorSpinorField * tmpp</div><div class="ttdoc">high precision accumulator </div><div class="ttdef"><b>Definition:</b> <a href="invert__quda_8h_source.html#l01293">invert_quda.h:1293</a></div></div>
<div class="ttc" id="classquda_1_1_solver_html_a8db54e989f46e8edf99a9a344f22f77d"><div class="ttname"><a href="classquda_1_1_solver.html#a8db54e989f46e8edf99a9a344f22f77d">quda::Solver::PrintSummary</a></div><div class="ttdeci">void PrintSummary(const char *name, int k, double r2, double b2, double r2_tol, double hq_tol)</div><div class="ttdoc">Prints out the summary of the solver convergence (requires a verbosity of QUDA_SUMMARIZE). Assumes SolverParam.true_res and SolverParam.true_res_hq has been set. </div><div class="ttdef"><b>Definition:</b> <a href="solver_8cpp_source.html#l00270">solver.cpp:270</a></div></div>
<div class="ttc" id="classquda_1_1_g_m_res_d_r_args_html_a0a3ccd86622475e405b063e5984971df"><div class="ttname"><a href="classquda_1_1_g_m_res_d_r_args.html#a0a3ccd86622475e405b063e5984971df">quda::GMResDRArgs::c</a></div><div class="ttdeci">Complex * c</div><div class="ttdef"><b>Definition:</b> <a href="inv__gmresdr__quda_8cpp_source.html#l00070">inv_gmresdr_quda.cpp:70</a></div></div>
<div class="ttc" id="namespacequda_html_a41fcafde8faebbd48a2335dae94c0f2e"><div class="ttname"><a href="namespacequda.html#a41fcafde8faebbd48a2335dae94c0f2e">quda::ComputeHarmonicRitz</a></div><div class="ttdeci">void ComputeHarmonicRitz(GMResDRArgs &amp;args)</div><div class="ttdef"><b>Definition:</b> <a href="inv__gmresdr__quda_8cpp_source.html#l00088">inv_gmresdr_quda.cpp:88</a></div></div>
<div class="ttc" id="namespacequda_html_a043738f16cdeb082fa1a5158fbad36b3"><div class="ttname"><a href="namespacequda.html#a043738f16cdeb082fa1a5158fbad36b3">quda::conj</a></div><div class="ttdeci">__host__ __device__ ValueType conj(ValueType x)</div><div class="ttdef"><b>Definition:</b> <a href="complex__quda_8h_source.html#l00130">complex_quda.h:130</a></div></div>
<div class="ttc" id="classquda_1_1_color_spinor_param_html_ae3198baa87ba088010b5933225c12df0"><div class="ttname"><a href="classquda_1_1_color_spinor_param.html#ae3198baa87ba088010b5933225c12df0">quda::ColorSpinorParam::create</a></div><div class="ttdeci">QudaFieldCreate create</div><div class="ttdef"><b>Definition:</b> <a href="color__spinor__field_8h_source.html#l00095">color_spinor_field.h:95</a></div></div>
<div class="ttc" id="structquda_1_1_solver_param_html"><div class="ttname"><a href="structquda_1_1_solver_param.html">quda::SolverParam</a></div><div class="ttdef"><b>Definition:</b> <a href="invert__quda_8h_source.html#l00017">invert_quda.h:17</a></div></div>
<div class="ttc" id="covdev__reference_8cpp_html_ab0f599f28b95625a5325f690bfba3341"><div class="ttname"><a href="covdev__reference_8cpp.html#ab0f599f28b95625a5325f690bfba3341">mat</a></div><div class="ttdeci">void mat(void *out, void **link, void *in, int dagger_bit, int mu, QudaPrecision sPrecision, QudaPrecision gPrecision)</div><div class="ttdef"><b>Definition:</b> <a href="covdev__reference_8cpp_source.html#l00112">covdev_reference.cpp:112</a></div></div>
<div class="ttc" id="classquda_1_1_g_m_res_d_r_html_a49c5b1e0af32ef91d4c817dd0a5ff6f9"><div class="ttname"><a href="classquda_1_1_g_m_res_d_r.html#a49c5b1e0af32ef91d4c817dd0a5ff6f9">quda::GMResDR::r_pre</a></div><div class="ttdeci">ColorSpinorField * r_pre</div><div class="ttdoc">sloppy residual vector </div><div class="ttdef"><b>Definition:</b> <a href="invert__quda_8h_source.html#l01295">invert_quda.h:1295</a></div></div>
<div class="ttc" id="namespacequda_html_abe598ea1308b5f23670eaab8662949a0a5405143d5482ed0cb7f59cd6d4d459d0"><div class="ttname"><a href="namespacequda.html#abe598ea1308b5f23670eaab8662949a0a5405143d5482ed0cb7f59cd6d4d459d0">quda::libtype::lapack_lib</a></div></div>
<div class="ttc" id="namespacequda_html_a2f233a7e56c94294c14499a3039419bd"><div class="ttname"><a href="namespacequda.html#a2f233a7e56c94294c14499a3039419bd">quda::VectorSet</a></div><div class="ttdeci">MatrixXcd VectorSet</div><div class="ttdef"><b>Definition:</b> <a href="inv__eigcg__quda_8cpp_source.html#l00037">inv_eigcg_quda.cpp:37</a></div></div>
<div class="ttc" id="namespacequda_html_afdd60a37d49f6d12f8472e2a910e80c6"><div class="ttname"><a href="namespacequda.html#afdd60a37d49f6d12f8472e2a910e80c6">quda::zero</a></div><div class="ttdeci">__device__ __host__ void zero(vector_type&lt; scalar, n &gt; &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="cub__helper_8cuh_source.html#l00054">cub_helper.cuh:54</a></div></div>
<div class="ttc" id="structquda_1_1_solver_param_html_aef9355993a1de99b8bbcdc8cd5cf69b6"><div class="ttname"><a href="structquda_1_1_solver_param.html#aef9355993a1de99b8bbcdc8cd5cf69b6">quda::SolverParam::tol</a></div><div class="ttdeci">double tol</div><div class="ttdef"><b>Definition:</b> <a href="invert__quda_8h_source.html#l00115">invert_quda.h:115</a></div></div>
<div class="ttc" id="classquda_1_1_matrix_html"><div class="ttname"><a href="classquda_1_1_matrix.html">quda::Matrix</a></div><div class="ttdef"><b>Definition:</b> <a href="quda__matrix_8h_source.html#l00064">quda_matrix.h:64</a></div></div>
<div class="ttc" id="blas__magma_8h_html_a83177cddacc20617163e82b33b49f89d"><div class="ttname"><a href="blas__magma_8h.html#a83177cddacc20617163e82b33b49f89d">magma_Xgesv</a></div><div class="ttdeci">void magma_Xgesv(void *sol, const int ldn, const int n, void *Mat, const int ldm, const int prec)</div><div class="ttdef"><b>Definition:</b> <a href="blas__magma_8cu_source.html#l00265">blas_magma.cu:265</a></div></div>
<div class="ttc" id="namespacequda_html_a05209eb0f1491ae099fc3c3e287fd0e2"><div class="ttname"><a href="namespacequda.html#a05209eb0f1491ae099fc3c3e287fd0e2">quda::ComputeEta</a></div><div class="ttdeci">void ComputeEta(GMResDRArgs &amp;args)</div><div class="ttdef"><b>Definition:</b> <a href="inv__gmresdr__quda_8cpp_source.html#l00157">inv_gmresdr_quda.cpp:157</a></div></div>
<div class="ttc" id="classquda_1_1_color_spinor_field_html_abce013c01320309ed37e5ce64f6d42a0"><div class="ttname"><a href="classquda_1_1_color_spinor_field.html#abce013c01320309ed37e5ce64f6d42a0">quda::ColorSpinorField::V</a></div><div class="ttdeci">void * V()</div><div class="ttdef"><b>Definition:</b> <a href="color__spinor__field_8h_source.html#l00424">color_spinor_field.h:424</a></div></div>
<div class="ttc" id="quda__internal_8h_html"><div class="ttname"><a href="quda__internal_8h.html">quda_internal.h</a></div></div>
<div class="ttc" id="classquda_1_1_g_m_res_d_r_html_a3c6b4a95ec42fc1b99b7eea4439d9ed2"><div class="ttname"><a href="classquda_1_1_g_m_res_d_r.html#a3c6b4a95ec42fc1b99b7eea4439d9ed2">quda::GMResDR::r_sloppy</a></div><div class="ttdeci">ColorSpinorField * r_sloppy</div><div class="ttdoc">temporary for mat-vec </div><div class="ttdef"><b>Definition:</b> <a href="invert__quda_8h_source.html#l01294">invert_quda.h:1294</a></div></div>
<div class="ttc" id="classquda_1_1_s_d_html"><div class="ttname"><a href="classquda_1_1_s_d.html">quda::SD</a></div><div class="ttdef"><b>Definition:</b> <a href="invert__quda_8h_source.html#l01035">invert_quda.h:1035</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
