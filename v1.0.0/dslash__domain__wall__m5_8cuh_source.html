<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>QUDA: include/kernels/dslash_domain_wall_m5.cuh Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">QUDA
   &#160;<span id="projectnumber">1.0.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_f2fd8bd6424c93166d6dd5f2b70706e7.html">kernels</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">dslash_domain_wall_m5.cuh</div>  </div>
</div><!--header-->
<div class="contents">
<a href="dslash__domain__wall__m5_8cuh.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#pragma once</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="shared__memory__cache__helper_8cuh.html">shared_memory_cache_helper.cuh</a>&gt;</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="math__helper_8cuh.html">math_helper.cuh</a>&gt;</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacequda.html">quda</a></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;{</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;</div><div class="line"><a name="l00012"></a><span class="lineno"><a class="line" href="structquda_1_1coeff__5.html">   12</a></span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> real&gt; <span class="keyword">struct </span><a class="code" href="structquda_1_1coeff__5.html">coeff_5</a> {</div><div class="line"><a name="l00013"></a><span class="lineno"><a class="line" href="structquda_1_1coeff__5.html#aa05e8b921d011a604ddc97bc10a3ee3c">   13</a></span>&#160;    complex&lt;real&gt; <a class="code" href="structquda_1_1coeff__5.html#aa05e8b921d011a604ddc97bc10a3ee3c">a</a>[<a class="code" href="quda__constants_8h.html#a7f22cb708419e6cc1124433abd00a094">QUDA_MAX_DWF_LS</a>]; <span class="comment">// xpay coefficients</span></div><div class="line"><a name="l00014"></a><span class="lineno"><a class="line" href="structquda_1_1coeff__5.html#aa1cfe0469d2b49687610793d39abc171">   14</a></span>&#160;    complex&lt;real&gt; <a class="code" href="structquda_1_1coeff__5.html#aa1cfe0469d2b49687610793d39abc171">b</a>[<a class="code" href="quda__constants_8h.html#a7f22cb708419e6cc1124433abd00a094">QUDA_MAX_DWF_LS</a>];</div><div class="line"><a name="l00015"></a><span class="lineno"><a class="line" href="structquda_1_1coeff__5.html#a3660a7fa603675c375d73ca3ac9728a0">   15</a></span>&#160;    complex&lt;real&gt; <a class="code" href="structquda_1_1coeff__5.html#a3660a7fa603675c375d73ca3ac9728a0">c</a>[<a class="code" href="quda__constants_8h.html#a7f22cb708419e6cc1124433abd00a094">QUDA_MAX_DWF_LS</a>];</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;  };</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;  constexpr <span class="keywordtype">int</span> <a class="code" href="namespacequda.html#ac607b0c5fa5401f582b361eb935649fb">size</a> = 4096;</div><div class="line"><a name="l00019"></a><span class="lineno"><a class="line" href="namespacequda.html#ab9807d002fda6a71d35be71340fc7e6d">   19</a></span>&#160;  <span class="keyword">static</span> __constant__ <span class="keywordtype">char</span> <a class="code" href="namespacequda.html#ab9807d002fda6a71d35be71340fc7e6d">mobius_d</a>[<a class="code" href="namespacequda.html#ac607b0c5fa5401f582b361eb935649fb">size</a>]; <span class="comment">// buffer used for Mobius coefficients for GPU kernel</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;  <span class="comment">// helper trait for determining if we are using variable coefficients</span></div><div class="line"><a name="l00022"></a><span class="lineno"><a class="line" href="structquda_1_1is__variable.html">   22</a></span>&#160;  <span class="keyword">template</span> &lt;Dslash5Type type&gt; <span class="keyword">struct </span><a class="code" href="structquda_1_1is__variable.html">is_variable</a> {</div><div class="line"><a name="l00023"></a><span class="lineno"><a class="line" href="structquda_1_1is__variable.html#af35e2323059a0d47a8c07a8296cefe75">   23</a></span>&#160;    <span class="keyword">static</span> constexpr <span class="keywordtype">bool</span> value = <span class="keyword">false</span>;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  };</div><div class="line"><a name="l00025"></a><span class="lineno"><a class="line" href="structquda_1_1is__variable_3_01_d_s_l_a_s_h5___m_o_b_i_u_s___p_r_e_01_4.html">   25</a></span>&#160;  <span class="keyword">template</span> &lt;&gt; <span class="keyword">struct </span><a class="code" href="structquda_1_1is__variable.html">is_variable</a>&lt;<a class="code" href="namespacequda.html#aecfddb045f6f276fbad230bbbc98b1c7a506b4a61c0c8fdaf8bd2f5b7e51addf1">DSLASH5_MOBIUS_PRE</a>&gt; {</div><div class="line"><a name="l00026"></a><span class="lineno"><a class="line" href="structquda_1_1is__variable_3_01_d_s_l_a_s_h5___m_o_b_i_u_s___p_r_e_01_4.html#af4423cece9c390e9801d8300a3c2d282">   26</a></span>&#160;    <span class="keyword">static</span> constexpr <span class="keywordtype">bool</span> value = <span class="keyword">true</span>;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  };</div><div class="line"><a name="l00028"></a><span class="lineno"><a class="line" href="structquda_1_1is__variable_3_01_d_s_l_a_s_h5___m_o_b_i_u_s_01_4.html">   28</a></span>&#160;  <span class="keyword">template</span> &lt;&gt; <span class="keyword">struct </span><a class="code" href="structquda_1_1is__variable.html">is_variable</a>&lt;<a class="code" href="namespacequda.html#aecfddb045f6f276fbad230bbbc98b1c7a8a6dd4152e43a17db6ae9be3a69f5815">DSLASH5_MOBIUS</a>&gt; {</div><div class="line"><a name="l00029"></a><span class="lineno"><a class="line" href="structquda_1_1is__variable_3_01_d_s_l_a_s_h5___m_o_b_i_u_s_01_4.html#a818d3993731445840aa8a0d024c3a89d">   29</a></span>&#160;    <span class="keyword">static</span> constexpr <span class="keywordtype">bool</span> value = <span class="keyword">true</span>;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  };</div><div class="line"><a name="l00031"></a><span class="lineno"><a class="line" href="structquda_1_1is__variable_3_01_m5___i_n_v___z_m_o_b_i_u_s_01_4.html">   31</a></span>&#160;  <span class="keyword">template</span> &lt;&gt; <span class="keyword">struct </span><a class="code" href="structquda_1_1is__variable.html">is_variable</a>&lt;<a class="code" href="namespacequda.html#aecfddb045f6f276fbad230bbbc98b1c7a8f95341b535ff1d3249dedb1953bd3a0">M5_INV_ZMOBIUS</a>&gt; {</div><div class="line"><a name="l00032"></a><span class="lineno"><a class="line" href="structquda_1_1is__variable_3_01_m5___i_n_v___z_m_o_b_i_u_s_01_4.html#af5b6a2172903426f0f8e4555d96cefdc">   32</a></span>&#160;    <span class="keyword">static</span> constexpr <span class="keywordtype">bool</span> value = <span class="keyword">true</span>;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  };</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div><div class="line"><a name="l00039"></a><span class="lineno"><a class="line" href="classquda_1_1coeff__type.html">   39</a></span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> real, <span class="keywordtype">bool</span> is_variable, <span class="keyword">typename</span> Arg&gt; <span class="keyword">class </span><a class="code" href="classquda_1_1coeff__type.html">coeff_type</a></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  {</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00042"></a><span class="lineno"><a class="line" href="classquda_1_1coeff__type.html#a6736ff66306b4f12b111c92a97d8c423">   42</a></span>&#160;    <span class="keyword">const</span> <a class="code" href="structquda_1_1_arg.html">Arg</a> &amp;<a class="code" href="classquda_1_1coeff__type.html#a6736ff66306b4f12b111c92a97d8c423">arg</a>;</div><div class="line"><a name="l00043"></a><span class="lineno"><a class="line" href="classquda_1_1coeff__type.html#a7d17fd51b463fe4fcf537c9570ba1292">   43</a></span>&#160;    __device__ __host__ <a class="code" href="classquda_1_1coeff__type.html#a7d17fd51b463fe4fcf537c9570ba1292">coeff_type</a>(<span class="keyword">const</span> <a class="code" href="structquda_1_1_arg.html">Arg</a> &amp;arg) : arg(arg) {}</div><div class="line"><a name="l00044"></a><span class="lineno"><a class="line" href="classquda_1_1coeff__type.html#a2460264e7f8e11496fcf7d0f3191abff">   44</a></span>&#160;    __device__ __host__ real <a class="code" href="classquda_1_1coeff__type.html#a2460264e7f8e11496fcf7d0f3191abff">a</a>(<span class="keywordtype">int</span> <a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a>) { <span class="keywordflow">return</span> arg.a; }</div><div class="line"><a name="l00045"></a><span class="lineno"><a class="line" href="classquda_1_1coeff__type.html#ad4066c7187502f2f8c53a4fae37b0b62">   45</a></span>&#160;    __device__ __host__ real <a class="code" href="classquda_1_1coeff__type.html#ad4066c7187502f2f8c53a4fae37b0b62">b</a>(<span class="keywordtype">int</span> <a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a>) { <span class="keywordflow">return</span> arg.b; }</div><div class="line"><a name="l00046"></a><span class="lineno"><a class="line" href="classquda_1_1coeff__type.html#ad59899f3fd523feb48188b8ef4a51c61">   46</a></span>&#160;    __device__ __host__ real <a class="code" href="classquda_1_1coeff__type.html#ad59899f3fd523feb48188b8ef4a51c61">c</a>(<span class="keywordtype">int</span> <a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a>) { <span class="keywordflow">return</span> arg.c; }</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  };</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div><div class="line"><a name="l00052"></a><span class="lineno"><a class="line" href="classquda_1_1coeff__type_3_01real_00_01true_00_01_arg_01_4.html">   52</a></span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> real, <span class="keyword">typename</span> Arg&gt; <span class="keyword">class </span><a class="code" href="classquda_1_1coeff__type.html">coeff_type</a>&lt;real, true, <a class="code" href="structquda_1_1_arg.html">Arg</a>&gt;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  {</div><div class="line"><a name="l00058"></a><span class="lineno"><a class="line" href="classquda_1_1coeff__type_3_01real_00_01true_00_01_arg_01_4.html#a94027da57dedba859103ea110d79f88e">   58</a></span>&#160;    <span class="keyword">inline</span> __device__ __host__ <span class="keyword">const</span> <a class="code" href="structquda_1_1coeff__5.html">coeff_5&lt;real&gt;</a> *<a class="code" href="classquda_1_1coeff__type_3_01real_00_01true_00_01_arg_01_4.html#a94027da57dedba859103ea110d79f88e">coeff</a>()<span class="keyword"> const</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="preprocessor">#ifdef __CUDA_ARCH__</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><a class="code" href="structquda_1_1coeff__5.html">coeff_5&lt;real&gt;</a> *<span class="keyword">&gt;</span>(<a class="code" href="namespacequda.html#ab9807d002fda6a71d35be71340fc7e6d">mobius_d</a>);</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacequda.html#a519e30abf575a4084224e899c730e95f">arg</a>.mobius_h;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    }</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00068"></a><span class="lineno"><a class="line" href="classquda_1_1coeff__type_3_01real_00_01true_00_01_arg_01_4.html#af9688899bbddd38db36db7770be34a2f">   68</a></span>&#160;    <span class="keyword">const</span> <a class="code" href="structquda_1_1_arg.html">Arg</a> &amp;<a class="code" href="classquda_1_1coeff__type_3_01real_00_01true_00_01_arg_01_4.html#af9688899bbddd38db36db7770be34a2f">arg</a>;</div><div class="line"><a name="l00069"></a><span class="lineno"><a class="line" href="classquda_1_1coeff__type_3_01real_00_01true_00_01_arg_01_4.html#a4d9c789503be60c40b53c856cdf9f3b9">   69</a></span>&#160;    __device__ __host__ <span class="keyword">inline</span> <a class="code" href="classquda_1_1coeff__type_3_01real_00_01true_00_01_arg_01_4.html#a4d9c789503be60c40b53c856cdf9f3b9">coeff_type</a>(<span class="keyword">const</span> <a class="code" href="structquda_1_1_arg.html">Arg</a> &amp;arg) : arg(arg) {}</div><div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="classquda_1_1coeff__type_3_01real_00_01true_00_01_arg_01_4.html#a8a85cbf0754c7d187ba894184d7f2890">   70</a></span>&#160;    __device__ __host__ complex&lt;real&gt; <a class="code" href="classquda_1_1coeff__type_3_01real_00_01true_00_01_arg_01_4.html#a8a85cbf0754c7d187ba894184d7f2890">a</a>(<span class="keywordtype">int</span> <a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a>) { <span class="keywordflow">return</span> coeff()-&gt;a[<a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a>]; }</div><div class="line"><a name="l00071"></a><span class="lineno"><a class="line" href="classquda_1_1coeff__type_3_01real_00_01true_00_01_arg_01_4.html#a845ad553457d56d24ea29cc8c7a04c65">   71</a></span>&#160;    __device__ __host__ complex&lt;real&gt; <a class="code" href="classquda_1_1coeff__type_3_01real_00_01true_00_01_arg_01_4.html#a845ad553457d56d24ea29cc8c7a04c65">b</a>(<span class="keywordtype">int</span> <a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a>) { <span class="keywordflow">return</span> coeff()-&gt;b[<a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a>]; }</div><div class="line"><a name="l00072"></a><span class="lineno"><a class="line" href="classquda_1_1coeff__type_3_01real_00_01true_00_01_arg_01_4.html#a839b49df714b4ede00cf0633711afb74">   72</a></span>&#160;    __device__ __host__ complex&lt;real&gt; <a class="code" href="classquda_1_1coeff__type_3_01real_00_01true_00_01_arg_01_4.html#a839b49df714b4ede00cf0633711afb74">c</a>(<span class="keywordtype">int</span> <a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a>) { <span class="keywordflow">return</span> coeff()-&gt;c[<a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a>]; }</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  };</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div><div class="line"><a name="l00078"></a><span class="lineno"><a class="line" href="structquda_1_1_dslash5_arg.html">   78</a></span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Float, <span class="keywordtype">int</span> nColor&gt; <span class="keyword">struct </span><a class="code" href="structquda_1_1_dslash5_arg.html">Dslash5Arg</a> {</div><div class="line"><a name="l00079"></a><span class="lineno"><a class="line" href="structquda_1_1_dslash5_arg.html#a1ba6339ae5945f9c902bb9f7ceb80a40">   79</a></span>&#160;    <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="structquda_1_1colorspinor__mapper.html">colorspinor_mapper&lt;Float, 4, nColor&gt;::type</a> <a class="code" href="structquda_1_1_dslash5_arg.html#a1ba6339ae5945f9c902bb9f7ceb80a40">F</a>;</div><div class="line"><a name="l00080"></a><span class="lineno"><a class="line" href="structquda_1_1_dslash5_arg.html#a31f5e2e8bd7b5c86a7410eb37a4d477b">   80</a></span>&#160;    <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="structquda_1_1mapper.html">mapper&lt;Float&gt;::type</a> <a class="code" href="structquda_1_1_dslash5_arg.html#a31f5e2e8bd7b5c86a7410eb37a4d477b">real</a>;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div><div class="line"><a name="l00082"></a><span class="lineno"><a class="line" href="structquda_1_1_dslash5_arg.html#a01595e1fe4f5141d24d652f3fb67b668">   82</a></span>&#160;    F <a class="code" href="structquda_1_1_dslash5_arg.html#a01595e1fe4f5141d24d652f3fb67b668">out</a>;                  <span class="comment">// output vector field</span></div><div class="line"><a name="l00083"></a><span class="lineno"><a class="line" href="structquda_1_1_dslash5_arg.html#ab13cd9411f132f5c8d6303f8ff1c9b5d">   83</a></span>&#160;    <span class="keyword">const</span> F <a class="code" href="structquda_1_1_dslash5_arg.html#ab13cd9411f132f5c8d6303f8ff1c9b5d">in</a>;             <span class="comment">// input vector field</span></div><div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="structquda_1_1_dslash5_arg.html#a6e745fddefc6374bc5b6d9ecb3f0e7d1">   84</a></span>&#160;    <span class="keyword">const</span> F <a class="code" href="structquda_1_1_dslash5_arg.html#a6e745fddefc6374bc5b6d9ecb3f0e7d1">x</a>;              <span class="comment">// auxiliary input vector field</span></div><div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="structquda_1_1_dslash5_arg.html#a3d41d9031e55014d12e8ff656f29f00a">   85</a></span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1_dslash5_arg.html#a3d41d9031e55014d12e8ff656f29f00a">nParity</a>;      <span class="comment">// number of parities we&#39;re working on</span></div><div class="line"><a name="l00086"></a><span class="lineno"><a class="line" href="structquda_1_1_dslash5_arg.html#a54d66ff388c436e64d8e57e505ebf925">   86</a></span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1_dslash5_arg.html#a54d66ff388c436e64d8e57e505ebf925">volume_cb</a>;    <span class="comment">// checkerboarded volume</span></div><div class="line"><a name="l00087"></a><span class="lineno"><a class="line" href="structquda_1_1_dslash5_arg.html#a8801ad2a85496bd0e515a11eb933fa88">   87</a></span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1_dslash5_arg.html#a8801ad2a85496bd0e515a11eb933fa88">volume_4d_cb</a>; <span class="comment">// 4-d checkerboarded volume</span></div><div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="structquda_1_1_dslash5_arg.html#ae64c7f461478fbca984de5c0f491498f">   88</a></span>&#160;    <span class="keyword">const</span> <a class="code" href="classint__fastdiv.html">int_fastdiv</a> <a class="code" href="structquda_1_1_dslash5_arg.html#ae64c7f461478fbca984de5c0f491498f">Ls</a>;   <span class="comment">// length of 5th dimension</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div><div class="line"><a name="l00090"></a><span class="lineno"><a class="line" href="structquda_1_1_dslash5_arg.html#a35c497d5d22613ddb7883d8197bd9612">   90</a></span>&#160;    <span class="keyword">const</span> real <a class="code" href="structquda_1_1_dslash5_arg.html#a35c497d5d22613ddb7883d8197bd9612">m_f</a>; <span class="comment">// fermion mass parameter</span></div><div class="line"><a name="l00091"></a><span class="lineno"><a class="line" href="structquda_1_1_dslash5_arg.html#ac3179b0501ddf1290ac091a542b70961">   91</a></span>&#160;    <span class="keyword">const</span> real <a class="code" href="structquda_1_1_dslash5_arg.html#ac3179b0501ddf1290ac091a542b70961">m_5</a>; <span class="comment">// Wilson mass shift</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div><div class="line"><a name="l00093"></a><span class="lineno"><a class="line" href="structquda_1_1_dslash5_arg.html#ad719e58f1b5372d1c13b3477ffaef72f">   93</a></span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="structquda_1_1_dslash5_arg.html#ad719e58f1b5372d1c13b3477ffaef72f">dagger</a>; <span class="comment">// dagger</span></div><div class="line"><a name="l00094"></a><span class="lineno"><a class="line" href="structquda_1_1_dslash5_arg.html#ade544c5bbd6a69d6098fcf40ea52d976">   94</a></span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="structquda_1_1_dslash5_arg.html#ade544c5bbd6a69d6098fcf40ea52d976">xpay</a>;   <span class="comment">// whether we are doing xpay or not</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div><div class="line"><a name="l00096"></a><span class="lineno"><a class="line" href="structquda_1_1_dslash5_arg.html#abe63650a3669236759b0dbef5944252d">   96</a></span>&#160;    real <a class="code" href="structquda_1_1_dslash5_arg.html#abe63650a3669236759b0dbef5944252d">b</a>; <span class="comment">// real constant Mobius coefficient</span></div><div class="line"><a name="l00097"></a><span class="lineno"><a class="line" href="structquda_1_1_dslash5_arg.html#a2f1b75051ce95ddf7cb906ca46d34044">   97</a></span>&#160;    real <a class="code" href="structquda_1_1_dslash5_arg.html#a2f1b75051ce95ddf7cb906ca46d34044">c</a>; <span class="comment">// real constant Mobius coefficient</span></div><div class="line"><a name="l00098"></a><span class="lineno"><a class="line" href="structquda_1_1_dslash5_arg.html#ac0e47ec5de621bf35c17277d0359c73b">   98</a></span>&#160;    real <a class="code" href="structquda_1_1_dslash5_arg.html#ac0e47ec5de621bf35c17277d0359c73b">a</a>; <span class="comment">// real xpay coefficient</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div><div class="line"><a name="l00100"></a><span class="lineno"><a class="line" href="structquda_1_1_dslash5_arg.html#a004d819b0011006a3939e6f5c766022d">  100</a></span>&#160;    <a class="code" href="namespacequda.html#aecfddb045f6f276fbad230bbbc98b1c7">Dslash5Type</a> <a class="code" href="structquda_1_1_dslash5_arg.html#a004d819b0011006a3939e6f5c766022d">type</a>;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div><div class="line"><a name="l00102"></a><span class="lineno"><a class="line" href="structquda_1_1_dslash5_arg.html#afca82269d73c2fc3fa5b92325a8b0a5d">  102</a></span>&#160;    <a class="code" href="structquda_1_1coeff__5.html">coeff_5&lt;real&gt;</a> *<a class="code" href="structquda_1_1_dslash5_arg.html#afca82269d73c2fc3fa5b92325a8b0a5d">mobius_h</a>; <span class="comment">// constant buffer used for Mobius coefficients for CPU kernel</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div><div class="line"><a name="l00104"></a><span class="lineno"><a class="line" href="structquda_1_1_dslash5_arg.html#afdfbac8405ba9e7881da53608ae9a0cf">  104</a></span>&#160;    <a class="code" href="structquda_1_1_dslash5_arg.html#afdfbac8405ba9e7881da53608ae9a0cf">Dslash5Arg</a>(<a class="code" href="classquda_1_1_color_spinor_field.html">ColorSpinorField</a> &amp;out, <span class="keyword">const</span> <a class="code" href="classquda_1_1_color_spinor_field.html">ColorSpinorField</a> &amp;in, <span class="keyword">const</span> <a class="code" href="classquda_1_1_color_spinor_field.html">ColorSpinorField</a> &amp;x, <span class="keywordtype">double</span> m_f, <span class="keywordtype">double</span> m_5,</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacequda.html#a61eb8e0789e8a2021032ee12761d924e">Complex</a> *b_5_, <span class="keyword">const</span> <a class="code" href="namespacequda.html#a61eb8e0789e8a2021032ee12761d924e">Complex</a> *c_5_, <span class="keywordtype">double</span> a_, <span class="keywordtype">bool</span> dagger, <a class="code" href="namespacequda.html#aecfddb045f6f276fbad230bbbc98b1c7">Dslash5Type</a> type) :</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        out(out),</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        in(in),</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        x(x),</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        nParity(in.SiteSubset()),</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        volume_cb(in.VolumeCB()),</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        volume_4d_cb(volume_cb / in.<a class="code" href="covdev__test_8cpp.html#a7facd8f2fefe0ccaea751dff2592badb">X</a>(4)),</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        Ls(in.<a class="code" href="covdev__test_8cpp.html#a7facd8f2fefe0ccaea751dff2592badb">X</a>(4)),</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        m_f(m_f),</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        m_5(m_5),</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        a(a_),</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        dagger(dagger),</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        xpay(a_ == 0.0 ? false : true),</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        type(type)</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    {</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      <span class="keywordflow">if</span> (in.<a class="code" href="classquda_1_1_color_spinor_field.html#a6067aeefbeb02a469fadc6534ce01794">Nspin</a>() != 4) <a class="code" href="util__quda_8h.html#af3bddfd9d113d50e8e0bbf58a35c5aac">errorQuda</a>(<span class="stringliteral">&quot;nSpin = %d not support&quot;</span>, in.<a class="code" href="classquda_1_1_color_spinor_field.html#a6067aeefbeb02a469fadc6534ce01794">Nspin</a>());</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      <span class="keywordflow">if</span> (!in.<a class="code" href="classquda_1_1_color_spinor_field.html#ac324b268700ab27a4455e7d216f2e92c">isNative</a>() || !out.<a class="code" href="classquda_1_1_color_spinor_field.html#ac324b268700ab27a4455e7d216f2e92c">isNative</a>())</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        <a class="code" href="util__quda_8h.html#af3bddfd9d113d50e8e0bbf58a35c5aac">errorQuda</a>(<span class="stringliteral">&quot;Unsupported field order out=%d in=%d\n&quot;</span>, out.<a class="code" href="classquda_1_1_color_spinor_field.html#ac825bed31e6f651d73c10da2595c7acc">FieldOrder</a>(), in.<a class="code" href="classquda_1_1_color_spinor_field.html#ac825bed31e6f651d73c10da2595c7acc">FieldOrder</a>());</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">sizeof</span>(<a class="code" href="structquda_1_1coeff__5.html">coeff_5&lt;real&gt;</a>) &gt; <a class="code" href="namespacequda.html#ac607b0c5fa5401f582b361eb935649fb">size</a>) <a class="code" href="util__quda_8h.html#af3bddfd9d113d50e8e0bbf58a35c5aac">errorQuda</a>(<span class="stringliteral">&quot;Coefficient buffer too large at %lu bytes\n&quot;</span>, <span class="keyword">sizeof</span>(<a class="code" href="structquda_1_1coeff__5.html">coeff_5&lt;real&gt;</a>));</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      mobius_h = <span class="keyword">new</span> <a class="code" href="structquda_1_1coeff__5.html">coeff_5&lt;real&gt;</a>;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      <span class="keyword">auto</span> *a_5 = mobius_h-&gt;<a class="code" href="structquda_1_1coeff__5.html#aa05e8b921d011a604ddc97bc10a3ee3c">a</a>;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      <span class="keyword">auto</span> *b_5 = mobius_h-&gt;<a class="code" href="structquda_1_1coeff__5.html#aa1cfe0469d2b49687610793d39abc171">b</a>;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      <span class="keyword">auto</span> *c_5 = mobius_h-&gt;<a class="code" href="structquda_1_1coeff__5.html#a3660a7fa603675c375d73ca3ac9728a0">c</a>;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      <span class="keywordflow">switch</span> (type) {</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespacequda.html#aecfddb045f6f276fbad230bbbc98b1c7a31f01215dc722d248d68b1bd7b512ab5">DSLASH5_DWF</a>: <span class="keywordflow">break</span>;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespacequda.html#aecfddb045f6f276fbad230bbbc98b1c7a506b4a61c0c8fdaf8bd2f5b7e51addf1">DSLASH5_MOBIUS_PRE</a>:</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a> = 0; <a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a> &lt; <a class="code" href="test__util_8cpp.html#a96202c3467aa608f6feee09ded0065a5">Ls</a>; <a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a>++) {</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;          b_5[<a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a>] = b_5_[<a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a>];</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;          c_5[<a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a>] = 0.5 * c_5_[<a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a>];</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;          <span class="comment">// xpay</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;          a_5[<a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a>] = 0.5 / (b_5_[<a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a>] * (m_5 + 4.0) + 1.0);</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;          a_5[<a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a>] *= a_5[<a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a>] * <span class="keyword">static_cast&lt;</span>real<span class="keyword">&gt;</span>(<a class="code" href="structquda_1_1coeff__5.html#aa05e8b921d011a604ddc97bc10a3ee3c">a</a>);</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        }</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespacequda.html#aecfddb045f6f276fbad230bbbc98b1c7a8a6dd4152e43a17db6ae9be3a69f5815">DSLASH5_MOBIUS</a>:</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a> = 0; <a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a> &lt; <a class="code" href="test__util_8cpp.html#a96202c3467aa608f6feee09ded0065a5">Ls</a>; <a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a>++) {</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;          b_5[<a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a>] = 1.0;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;          c_5[<a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a>] = 0.5 * (c_5_[<a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a>] * (m_5 + 4.0) - 1.0) / (b_5_[<a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a>] * (m_5 + 4.0) + 1.0);</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;          <span class="comment">// axpy</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;          a_5[<a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a>] = 0.5 / (b_5_[<a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a>] * (m_5 + 4.0) + 1.0);</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;          a_5[<a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a>] *= a_5[<a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a>] * <span class="keyword">static_cast&lt;</span>real<span class="keyword">&gt;</span>(<a class="code" href="structquda_1_1coeff__5.html#aa05e8b921d011a604ddc97bc10a3ee3c">a</a>);</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        }</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespacequda.html#aecfddb045f6f276fbad230bbbc98b1c7aeaaaf4f45cc1df49e594c6f20a14af24">M5_INV_DWF</a>:</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        b = 2.0 * (0.5 / (5.0 + m_5)); <span class="comment">// 2  * kappa_5</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        c = 0.5 / (1.0 + <a class="code" href="namespacequda.html#aaa35e68beb10c3fdbf3ba1d4915fa752">std::pow</a>(b, (<span class="keywordtype">int</span>)Ls) * m_f);</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespacequda.html#aecfddb045f6f276fbad230bbbc98b1c7ad3048ef8611b5db5a88a93d65977d6c3">M5_INV_MOBIUS</a>:</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        b = -(c_5_[0].real() * (4.0 + m_5) - 1.0) / (b_5_[0].real() * (4.0 + m_5) + 1.0);</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        c = 0.5 / (1.0 + <a class="code" href="namespacequda.html#aaa35e68beb10c3fdbf3ba1d4915fa752">std::pow</a>(b, (<span class="keywordtype">int</span>)Ls) * m_f);</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        a *= <a class="code" href="namespacequda.html#aaa35e68beb10c3fdbf3ba1d4915fa752">pow</a>(0.5 / (b_5_[0].real() * (m_5 + 4.0) + 1.0), 2);</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespacequda.html#aecfddb045f6f276fbad230bbbc98b1c7a8f95341b535ff1d3249dedb1953bd3a0">M5_INV_ZMOBIUS</a>: {</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <a class="code" href="structquda_1_1complex_3_01double_01_4.html">complex&lt;double&gt;</a> k = 1.0;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a> = 0; <a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a> &lt; <a class="code" href="test__util_8cpp.html#a96202c3467aa608f6feee09ded0065a5">Ls</a>; <a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a>++) {</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;          b_5[<a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a>] = -(c_5_[<a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a>] * (4.0 + m_5) - 1.0) / (b_5_[<a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a>] * (4.0 + m_5) + 1.0);</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;          k *= b_5[<a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a>];</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        }</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        c_5[0] = 0.5 / (1.0 + k * m_f);</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a> = 0; <a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a> &lt; <a class="code" href="test__util_8cpp.html#a96202c3467aa608f6feee09ded0065a5">Ls</a>; <a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a>++) { <span class="comment">// axpy coefficients</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;          a_5[<a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a>] = 0.5 / (b_5_[<a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a>] * (m_5 + 4.0) + 1.0);</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;          a_5[<a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a>] *= a_5[<a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a>] * <span class="keyword">static_cast&lt;</span>real<span class="keyword">&gt;</span>(<a class="code" href="structquda_1_1coeff__5.html#aa05e8b921d011a604ddc97bc10a3ee3c">a</a>);</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        }</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;      } <span class="keywordflow">break</span>;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      <span class="keywordflow">default</span>: <a class="code" href="util__quda_8h.html#af3bddfd9d113d50e8e0bbf58a35c5aac">errorQuda</a>(<span class="stringliteral">&quot;Unknown Dslash5Type %d&quot;</span>, type);</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      }</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      cudaMemcpyToSymbolAsync(mobius_d, mobius_h, <span class="keyword">sizeof</span>(<a class="code" href="structquda_1_1coeff__5.html">coeff_5&lt;real&gt;</a>), 0, cudaMemcpyHostToDevice, <a class="code" href="quda__internal_8h.html#a0bf27533c025df9eb1aa7deb98a6fd02">streams</a>[<a class="code" href="namespacequda.html#a229cda99dcc1663d87f9e88b90108f36">Nstream</a> - 1]);</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    }</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;</div><div class="line"><a name="l00180"></a><span class="lineno"><a class="line" href="structquda_1_1_dslash5_arg.html#a705c5eea045b1bab516babcb8a877d33">  180</a></span>&#160;    <span class="keyword">virtual</span> <a class="code" href="structquda_1_1_dslash5_arg.html#a705c5eea045b1bab516babcb8a877d33">~Dslash5Arg</a>() { <span class="keyword">delete</span> mobius_h; }</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  };</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Float, <span class="keywordtype">int</span> nColor, <span class="keywordtype">bool</span> dagger, <span class="keywordtype">bool</span> xpay, Dslash5Type type, <span class="keyword">typename</span> Arg&gt;</div><div class="line"><a name="l00191"></a><span class="lineno"><a class="line" href="namespacequda.html#a3d6118dd05ff19613170152017ca9e20">  191</a></span>&#160;  __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespacequda.html#a3d6118dd05ff19613170152017ca9e20">dslash5</a>(<a class="code" href="structquda_1_1_arg.html">Arg</a> &amp;<a class="code" href="namespacequda.html#a519e30abf575a4084224e899c730e95f">arg</a>, <span class="keywordtype">int</span> <a class="code" href="covdev__test_8cpp.html#a5a1bb2e0fac8c62fc2ed33f5d3d3856f">parity</a>, <span class="keywordtype">int</span> x_cb, <span class="keywordtype">int</span> <a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a>)</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  {</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="structquda_1_1mapper.html">mapper&lt;Float&gt;::type</a> real;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <a class="code" href="classquda_1_1coeff__type.html">coeff_type&lt;real, is_variable&lt;type&gt;::value</a>, <a class="code" href="structquda_1_1_arg.html">Arg</a>&gt; coeff(arg);</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keyword">typedef</span> <a class="code" href="structquda_1_1_color_spinor.html">ColorSpinor&lt;real, nColor, 4&gt;</a> <a class="code" href="namespacequda.html#a4e54927fc030027c7892b4bff973aaaa">Vector</a>;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    Vector <a class="code" href="staggered__invert__test_8cpp.html#af3806a0fd9f2d8dd7a627e9571984d33">out</a>;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    { <span class="comment">// forwards direction</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> fwd_idx = ((s + 1) % arg.Ls) * arg.volume_4d_cb + x_cb;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      <span class="keyword">const</span> Vector <a class="code" href="staggered__invert__test_8cpp.html#af61ff6c9724eb687e3057b6a1a977487">in</a> = arg.in(fwd_idx, parity);</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      constexpr <span class="keywordtype">int</span> proj_dir = <a class="code" href="covdev__test_8cpp.html#a39b25c22c5fc78d683968e965f5727ba">dagger</a> ? +1 : -1;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      <span class="keywordflow">if</span> (s == arg.Ls - 1) {</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        out += (-arg.m_f * in.project(4, proj_dir)).reconstruct(4, proj_dir);</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        out += in.project(4, proj_dir).reconstruct(4, proj_dir);</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      }</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    }</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    { <span class="comment">// backwards direction</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> back_idx = ((s + arg.Ls - 1) % arg.Ls) * arg.volume_4d_cb + x_cb;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      <span class="keyword">const</span> Vector <a class="code" href="staggered__invert__test_8cpp.html#af61ff6c9724eb687e3057b6a1a977487">in</a> = arg.in(back_idx, parity);</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;      constexpr <span class="keywordtype">int</span> proj_dir = <a class="code" href="covdev__test_8cpp.html#a39b25c22c5fc78d683968e965f5727ba">dagger</a> ? -1 : +1;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;      <span class="keywordflow">if</span> (s == 0) {</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        out += (-arg.m_f * in.project(4, proj_dir)).reconstruct(4, proj_dir);</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        out += in.project(4, proj_dir).reconstruct(4, proj_dir);</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;      }</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    }</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="keywordflow">if</span> (type == <a class="code" href="namespacequda.html#aecfddb045f6f276fbad230bbbc98b1c7a31f01215dc722d248d68b1bd7b512ab5">DSLASH5_DWF</a> &amp;&amp; <a class="code" href="namespacequda_1_1blas.html#a8f3009e9e4a4bfe40b4d3f20d03c2f45">xpay</a>) {</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;      Vector x = arg.x(s * arg.volume_4d_cb + x_cb, parity);</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;      out = x + arg.a * <a class="code" href="staggered__invert__test_8cpp.html#af3806a0fd9f2d8dd7a627e9571984d33">out</a>;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type == <a class="code" href="namespacequda.html#aecfddb045f6f276fbad230bbbc98b1c7a506b4a61c0c8fdaf8bd2f5b7e51addf1">DSLASH5_MOBIUS_PRE</a>) {</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      Vector diagonal = arg.in(s * arg.volume_4d_cb + x_cb, parity);</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;      out = coeff.<a class="code" href="classquda_1_1coeff__type.html#ad59899f3fd523feb48188b8ef4a51c61">c</a>(s) * out + coeff.<a class="code" href="classquda_1_1coeff__type.html#ad4066c7187502f2f8c53a4fae37b0b62">b</a>(s) * diagonal;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacequda_1_1blas.html#a8f3009e9e4a4bfe40b4d3f20d03c2f45">xpay</a>) {</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        Vector x = arg.x(s * arg.volume_4d_cb + x_cb, parity);</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        out = x + coeff.<a class="code" href="classquda_1_1coeff__type.html#a2460264e7f8e11496fcf7d0f3191abff">a</a>(s) * <a class="code" href="staggered__invert__test_8cpp.html#af3806a0fd9f2d8dd7a627e9571984d33">out</a>;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      }</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type == <a class="code" href="namespacequda.html#aecfddb045f6f276fbad230bbbc98b1c7a8a6dd4152e43a17db6ae9be3a69f5815">DSLASH5_MOBIUS</a>) {</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      Vector diagonal = arg.in(s * arg.volume_4d_cb + x_cb, parity);</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      out = coeff.<a class="code" href="classquda_1_1coeff__type.html#ad59899f3fd523feb48188b8ef4a51c61">c</a>(s) * out + diagonal;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacequda_1_1blas.html#a8f3009e9e4a4bfe40b4d3f20d03c2f45">xpay</a>) { <span class="comment">// really axpy</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        Vector x = arg.x(s * arg.volume_4d_cb + x_cb, parity);</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        out = coeff.<a class="code" href="classquda_1_1coeff__type.html#a2460264e7f8e11496fcf7d0f3191abff">a</a>(s) * x + <a class="code" href="staggered__invert__test_8cpp.html#af3806a0fd9f2d8dd7a627e9571984d33">out</a>;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;      }</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    }</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    arg.out(s * arg.volume_4d_cb + x_cb, parity) = <a class="code" href="staggered__invert__test_8cpp.html#af3806a0fd9f2d8dd7a627e9571984d33">out</a>;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  }</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Float, <span class="keywordtype">int</span> nColor, <span class="keywordtype">bool</span> dagger, <span class="keywordtype">bool</span> xpay, Dslash5Type type, <span class="keyword">typename</span> Arg&gt;</div><div class="line"><a name="l00250"></a><span class="lineno"><a class="line" href="namespacequda.html#a85cf88fd1ab74ff933edb1da3392d41b">  250</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="namespacequda.html#a85cf88fd1ab74ff933edb1da3392d41b">dslash5CPU</a>(<a class="code" href="structquda_1_1_arg.html">Arg</a> &amp;<a class="code" href="namespacequda.html#a519e30abf575a4084224e899c730e95f">arg</a>)</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  {</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="covdev__test_8cpp.html#a5a1bb2e0fac8c62fc2ed33f5d3d3856f">parity</a> = 0; <a class="code" href="covdev__test_8cpp.html#a5a1bb2e0fac8c62fc2ed33f5d3d3856f">parity</a> &lt; arg.<a class="code" href="structquda_1_1_arg.html#a8c893cadf2b678609993f7bcef5d3e14">nParity</a>; <a class="code" href="covdev__test_8cpp.html#a5a1bb2e0fac8c62fc2ed33f5d3d3856f">parity</a>++) {</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a> = 0; <a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a> &lt; arg.Ls; <a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a>++) {</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> x_cb = 0; x_cb &lt; arg.volume_4d_cb; x_cb++) { <span class="comment">// 4-d volume</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;          dslash5&lt;Float, nColor, dagger, xpay, type&gt;(<a class="code" href="namespacequda.html#a519e30abf575a4084224e899c730e95f">arg</a>, <a class="code" href="covdev__test_8cpp.html#a5a1bb2e0fac8c62fc2ed33f5d3d3856f">parity</a>, x_cb, <a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a>);</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        } <span class="comment">// 4-d volumeCB</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      }   <span class="comment">// ls</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    }     <span class="comment">// parity</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  }</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Float, <span class="keywordtype">int</span> nColor, <span class="keywordtype">bool</span> dagger, <span class="keywordtype">bool</span> xpay, Dslash5Type type, <span class="keyword">typename</span> Arg&gt;</div><div class="line"><a name="l00266"></a><span class="lineno"><a class="line" href="namespacequda.html#a1ca789768bb250ae4267fa897384dc21">  266</a></span>&#160;  __global__ <span class="keywordtype">void</span> <a class="code" href="namespacequda.html#a1ca789768bb250ae4267fa897384dc21">dslash5GPU</a>(<a class="code" href="structquda_1_1_arg.html">Arg</a> <a class="code" href="namespacequda.html#a519e30abf575a4084224e899c730e95f">arg</a>)</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  {</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="keywordtype">int</span> x_cb = blockIdx.x * blockDim.x + threadIdx.x;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a> = blockIdx.y * blockDim.y + threadIdx.y;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="covdev__test_8cpp.html#a5a1bb2e0fac8c62fc2ed33f5d3d3856f">parity</a> = blockIdx.z * blockDim.z + threadIdx.z;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="keywordflow">if</span> (x_cb &gt;= arg.volume_4d_cb) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="keywordflow">if</span> (s &gt;= arg.Ls) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="keywordflow">if</span> (parity &gt;= arg.<a class="code" href="structquda_1_1_arg.html#a8c893cadf2b678609993f7bcef5d3e14">nParity</a>) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    dslash5&lt;Float, nColor, dagger, xpay, type&gt;(<a class="code" href="namespacequda.html#a519e30abf575a4084224e899c730e95f">arg</a>, <a class="code" href="covdev__test_8cpp.html#a5a1bb2e0fac8c62fc2ed33f5d3d3856f">parity</a>, x_cb, <a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a>);</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  }</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> real, <span class="keywordtype">int</span> nColor, <span class="keywordtype">bool</span> dagger, Dslash5Type type, <span class="keywordtype">bool</span> shared, <span class="keyword">typename</span> Vector, <span class="keyword">typename</span> Arg&gt;</div><div class="line"><a name="l00295"></a><span class="lineno"><a class="line" href="namespacequda.html#a8a923946d76979f01afbcd347a488866">  295</a></span>&#160;  __device__ __host__ <span class="keyword">inline</span> <a class="code" href="namespacequda.html#a4e54927fc030027c7892b4bff973aaaa">Vector</a> <a class="code" href="namespacequda.html#a8a923946d76979f01afbcd347a488866">constantInv</a>(<a class="code" href="structquda_1_1_arg.html">Arg</a> &amp;<a class="code" href="namespacequda.html#a519e30abf575a4084224e899c730e95f">arg</a>, <span class="keywordtype">int</span> <a class="code" href="covdev__test_8cpp.html#a5a1bb2e0fac8c62fc2ed33f5d3d3856f">parity</a>, <span class="keywordtype">int</span> x_cb, <span class="keywordtype">int</span> s_)</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  {</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> k = arg.b;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> inv = arg.c;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="comment">// if using shared-memory caching then load spinor field for my site into cache</span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <a class="code" href="classquda_1_1_vector_cache.html">VectorCache&lt;real, Vector&gt;</a> cache;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="keywordflow">if</span> (shared) {</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;      cache.<a class="code" href="classquda_1_1_vector_cache.html#ab6140bbfafb29f3028d0c00f52bbb7e0">save</a>(arg.in(s_ * arg.volume_4d_cb + x_cb, parity));</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      cache.<a class="code" href="classquda_1_1_vector_cache.html#aa3c30257feb1dee24fa797c70826d6af">sync</a>();</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    }</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <a class="code" href="namespacequda.html#a4e54927fc030027c7892b4bff973aaaa">Vector</a> <a class="code" href="staggered__invert__test_8cpp.html#af3806a0fd9f2d8dd7a627e9571984d33">out</a>;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a> = 0; <a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a> &lt; arg.Ls; <a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a>++) {</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;      <a class="code" href="namespacequda.html#a4e54927fc030027c7892b4bff973aaaa">Vector</a> <a class="code" href="staggered__invert__test_8cpp.html#af61ff6c9724eb687e3057b6a1a977487">in</a> = shared ? cache.<a class="code" href="classquda_1_1_vector_cache.html#a2c043a581f028fd1f527d262c8954da7">load</a>(threadIdx.x, <a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a>, parity) : arg.in(<a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a> * arg.volume_4d_cb + x_cb, parity);</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;      {</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="namespacequda.html#ab9b7c656cfd4121b9d553997230d76e2">exp</a> = s_ &lt; <a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a> ? arg.Ls - <a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a> + s_ : s_ - <a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a>;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        real factorR = inv * <a class="code" href="namespacequda.html#a789d64f982984a0b1a4f335b4c59a717">__fast_pow</a>(k, exp) * (s_ &lt; s ? -arg.m_f : <span class="keyword">static_cast&lt;</span>real<span class="keyword">&gt;</span>(1.0));</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        constexpr <span class="keywordtype">int</span> proj_dir = <a class="code" href="covdev__test_8cpp.html#a39b25c22c5fc78d683968e965f5727ba">dagger</a> ? -1 : +1;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        out += factorR * (in.project(4, proj_dir)).reconstruct(4, proj_dir);</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      }</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;      {</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="namespacequda.html#ab9b7c656cfd4121b9d553997230d76e2">exp</a> = s_ &gt; <a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a> ? arg.Ls - s_ + <a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a> : <a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a> - s_;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        real factorL = inv * <a class="code" href="namespacequda.html#a789d64f982984a0b1a4f335b4c59a717">__fast_pow</a>(k, exp) * (s_ &gt; <a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a> ? -arg.m_f : <span class="keyword">static_cast&lt;</span>real<span class="keyword">&gt;</span>(1.0));</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        constexpr <span class="keywordtype">int</span> proj_dir = <a class="code" href="covdev__test_8cpp.html#a39b25c22c5fc78d683968e965f5727ba">dagger</a> ? +1 : -1;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        out += factorL * (in.project(4, proj_dir)).reconstruct(4, proj_dir);</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;      }</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    }</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="staggered__invert__test_8cpp.html#af3806a0fd9f2d8dd7a627e9571984d33">out</a>;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  }</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> real, <span class="keywordtype">int</span> nColor, <span class="keywordtype">bool</span> dagger, Dslash5Type type, <span class="keywordtype">bool</span> shared, <span class="keyword">typename</span> Vector, <span class="keyword">typename</span> Arg&gt;</div><div class="line"><a name="l00352"></a><span class="lineno"><a class="line" href="namespacequda.html#a438a885d331b3193ac17cedebb545e1f">  352</a></span>&#160;  __device__ __host__ <span class="keyword">inline</span> <a class="code" href="namespacequda.html#a4e54927fc030027c7892b4bff973aaaa">Vector</a> <a class="code" href="namespacequda.html#a438a885d331b3193ac17cedebb545e1f">variableInv</a>(<a class="code" href="structquda_1_1_arg.html">Arg</a> &amp;<a class="code" href="namespacequda.html#a519e30abf575a4084224e899c730e95f">arg</a>, <span class="keywordtype">int</span> <a class="code" href="covdev__test_8cpp.html#a5a1bb2e0fac8c62fc2ed33f5d3d3856f">parity</a>, <span class="keywordtype">int</span> x_cb, <span class="keywordtype">int</span> s_)</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  {</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    constexpr <span class="keywordtype">int</span> nSpin = 4;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="keyword">typedef</span> <a class="code" href="structquda_1_1_color_spinor.html">ColorSpinor</a>&lt;real, <a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a>, nSpin / 2&gt; HalfVector;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <a class="code" href="classquda_1_1coeff__type.html">coeff_type&lt;real, is_variable&lt;type&gt;::value</a>, <a class="code" href="structquda_1_1_arg.html">Arg</a>&gt; coeff(arg);</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <a class="code" href="namespacequda.html#a4e54927fc030027c7892b4bff973aaaa">Vector</a> <a class="code" href="staggered__invert__test_8cpp.html#af61ff6c9724eb687e3057b6a1a977487">in</a> = arg.in(s_ * arg.volume_4d_cb + x_cb, parity);</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <a class="code" href="namespacequda.html#a4e54927fc030027c7892b4bff973aaaa">Vector</a> <a class="code" href="staggered__invert__test_8cpp.html#af3806a0fd9f2d8dd7a627e9571984d33">out</a>;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <a class="code" href="classquda_1_1_vector_cache.html">VectorCache&lt;real, HalfVector&gt;</a> cache;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    { <span class="comment">// first do R</span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;      constexpr <span class="keywordtype">int</span> proj_dir = <a class="code" href="covdev__test_8cpp.html#a39b25c22c5fc78d683968e965f5727ba">dagger</a> ? -1 : +1;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;      <span class="keywordflow">if</span> (shared) {</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        cache.<a class="code" href="classquda_1_1_vector_cache.html#ab6140bbfafb29f3028d0c00f52bbb7e0">save</a>(in.project(4, proj_dir));</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        cache.<a class="code" href="classquda_1_1_vector_cache.html#aa3c30257feb1dee24fa797c70826d6af">sync</a>();</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;      }</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;      <span class="keywordtype">int</span> <a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a> = s_;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;      <span class="keyword">auto</span> <a class="code" href="interface__quda_8cpp.html#a67b63ae29fb23d1a034f9ba7e0787745">R</a> = coeff.<a class="code" href="classquda_1_1coeff__type.html#ad59899f3fd523feb48188b8ef4a51c61">c</a>(0);</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;      HalfVector r;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> s_count = 0; s_count &lt; arg.Ls; s_count++) {</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        <span class="keyword">auto</span> factorR = (s_ &lt; s ? -arg.m_f * <a class="code" href="interface__quda_8cpp.html#a67b63ae29fb23d1a034f9ba7e0787745">R</a> : <a class="code" href="interface__quda_8cpp.html#a67b63ae29fb23d1a034f9ba7e0787745">R</a>);</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        <span class="keywordflow">if</span> (shared) {</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;          r += factorR * cache.<a class="code" href="classquda_1_1_vector_cache.html#a2c043a581f028fd1f527d262c8954da7">load</a>(threadIdx.x, s, parity);</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;          <a class="code" href="namespacequda.html#a4e54927fc030027c7892b4bff973aaaa">Vector</a> in = arg.in(s * arg.volume_4d_cb + x_cb, parity);</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;          r += factorR * in.project(4, proj_dir);</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        }</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        <a class="code" href="interface__quda_8cpp.html#a67b63ae29fb23d1a034f9ba7e0787745">R</a> *= coeff.<a class="code" href="classquda_1_1coeff__type.html#ad4066c7187502f2f8c53a4fae37b0b62">b</a>(s);</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        s = (s + arg.Ls - 1) % arg.Ls;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;      }</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;      out += r.reconstruct(4, proj_dir);</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    }</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    { <span class="comment">// second do L</span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;      constexpr <span class="keywordtype">int</span> proj_dir = <a class="code" href="covdev__test_8cpp.html#a39b25c22c5fc78d683968e965f5727ba">dagger</a> ? +1 : -1;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;      <span class="keywordflow">if</span> (shared) {</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        cache.<a class="code" href="classquda_1_1_vector_cache.html#aa3c30257feb1dee24fa797c70826d6af">sync</a>(); <span class="comment">// ensure we finish R before overwriting cache</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        cache.<a class="code" href="classquda_1_1_vector_cache.html#ab6140bbfafb29f3028d0c00f52bbb7e0">save</a>(in.project(4, proj_dir));</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        cache.<a class="code" href="classquda_1_1_vector_cache.html#aa3c30257feb1dee24fa797c70826d6af">sync</a>();</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;      }</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;      <span class="keywordtype">int</span> <a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a> = s_;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;      <span class="keyword">auto</span> L = coeff.<a class="code" href="classquda_1_1coeff__type.html#ad59899f3fd523feb48188b8ef4a51c61">c</a>(0);</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;      HalfVector l;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> s_count = 0; s_count &lt; arg.Ls; s_count++) {</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        <span class="keyword">auto</span> factorL = (s_ &gt; s ? -arg.m_f * L : L);</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;        <span class="keywordflow">if</span> (shared) {</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;          l += factorL * cache.<a class="code" href="classquda_1_1_vector_cache.html#a2c043a581f028fd1f527d262c8954da7">load</a>(threadIdx.x, s, parity);</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;          <a class="code" href="namespacequda.html#a4e54927fc030027c7892b4bff973aaaa">Vector</a> in = arg.in(s * arg.volume_4d_cb + x_cb, parity);</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;          l += factorL * in.project(4, proj_dir);</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        }</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;        L *= coeff.<a class="code" href="classquda_1_1coeff__type.html#ad4066c7187502f2f8c53a4fae37b0b62">b</a>(s);</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;        s = (s + 1) % arg.Ls;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;      }</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;      out += l.reconstruct(4, proj_dir);</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    }</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="staggered__invert__test_8cpp.html#af3806a0fd9f2d8dd7a627e9571984d33">out</a>;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  }</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Float, <span class="keywordtype">int</span> nColor, <span class="keywordtype">bool</span> dagger, <span class="keywordtype">bool</span> xpay, Dslash5Type type, <span class="keywordtype">bool</span> shared, <span class="keywordtype">bool</span> var_inverse, <span class="keyword">typename</span> Arg&gt;</div><div class="line"><a name="l00433"></a><span class="lineno"><a class="line" href="namespacequda.html#af777e107cf1788892e869cf8978b5b4e">  433</a></span>&#160;  __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespacequda.html#af777e107cf1788892e869cf8978b5b4e">dslash5inv</a>(<a class="code" href="structquda_1_1_arg.html">Arg</a> &amp;<a class="code" href="namespacequda.html#a519e30abf575a4084224e899c730e95f">arg</a>, <span class="keywordtype">int</span> <a class="code" href="covdev__test_8cpp.html#a5a1bb2e0fac8c62fc2ed33f5d3d3856f">parity</a>, <span class="keywordtype">int</span> x_cb, <span class="keywordtype">int</span> <a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a>)</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  {</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    constexpr <span class="keywordtype">int</span> nSpin = 4;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="structquda_1_1mapper.html">mapper&lt;Float&gt;::type</a> real;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <span class="keyword">typedef</span> <a class="code" href="structquda_1_1_color_spinor.html">ColorSpinor&lt;real, nColor, nSpin&gt;</a> <a class="code" href="namespacequda.html#a4e54927fc030027c7892b4bff973aaaa">Vector</a>;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <a class="code" href="classquda_1_1coeff__type.html">coeff_type&lt;real, is_variable&lt;type&gt;::value</a>, <a class="code" href="structquda_1_1_arg.html">Arg</a>&gt; coeff(arg);</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    Vector <a class="code" href="staggered__invert__test_8cpp.html#af3806a0fd9f2d8dd7a627e9571984d33">out</a>;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <span class="keywordflow">if</span> (var_inverse) { <span class="comment">// zMobius, must call variableInv</span></div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;      out = variableInv&lt;real, nColor, dagger, type, shared, Vector&gt;(<a class="code" href="namespacequda.html#a519e30abf575a4084224e899c730e95f">arg</a>, <a class="code" href="covdev__test_8cpp.html#a5a1bb2e0fac8c62fc2ed33f5d3d3856f">parity</a>, x_cb, <a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a>);</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;      out = constantInv&lt;real, nColor, dagger, type, shared, Vector&gt;(<a class="code" href="namespacequda.html#a519e30abf575a4084224e899c730e95f">arg</a>, <a class="code" href="covdev__test_8cpp.html#a5a1bb2e0fac8c62fc2ed33f5d3d3856f">parity</a>, x_cb, <a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a>);</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    }</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacequda_1_1blas.html#a8f3009e9e4a4bfe40b4d3f20d03c2f45">xpay</a>) {</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;      Vector x = arg.x(s * arg.volume_4d_cb + x_cb, parity);</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;      out = x + coeff.<a class="code" href="classquda_1_1coeff__type.html#a2460264e7f8e11496fcf7d0f3191abff">a</a>(s) * <a class="code" href="staggered__invert__test_8cpp.html#af3806a0fd9f2d8dd7a627e9571984d33">out</a>;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    }</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    arg.out(s * arg.volume_4d_cb + x_cb, parity) = <a class="code" href="staggered__invert__test_8cpp.html#af3806a0fd9f2d8dd7a627e9571984d33">out</a>;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  }</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Float, <span class="keywordtype">int</span> nColor, <span class="keywordtype">bool</span> dagger, <span class="keywordtype">bool</span> xpay, Dslash5Type type, <span class="keywordtype">bool</span> shared, <span class="keywordtype">bool</span> var_inverse, <span class="keyword">typename</span> Arg&gt;</div><div class="line"><a name="l00463"></a><span class="lineno"><a class="line" href="namespacequda.html#aa5824a02d74a559045359524a05b1005">  463</a></span>&#160;  __global__ <span class="keywordtype">void</span> <a class="code" href="namespacequda.html#aa5824a02d74a559045359524a05b1005">dslash5invGPU</a>(<a class="code" href="structquda_1_1_arg.html">Arg</a> <a class="code" href="namespacequda.html#a519e30abf575a4084224e899c730e95f">arg</a>)</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  {</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <span class="keywordtype">int</span> x_cb = blockIdx.x * blockDim.x + threadIdx.x;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a> = blockIdx.y * blockDim.y + threadIdx.y;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="covdev__test_8cpp.html#a5a1bb2e0fac8c62fc2ed33f5d3d3856f">parity</a> = blockIdx.z * blockDim.z + threadIdx.z;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <span class="keywordflow">if</span> (x_cb &gt;= arg.volume_4d_cb) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <span class="keywordflow">if</span> (s &gt;= arg.Ls) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <span class="keywordflow">if</span> (parity &gt;= arg.<a class="code" href="structquda_1_1_arg.html#a8c893cadf2b678609993f7bcef5d3e14">nParity</a>) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    dslash5inv&lt;Float, nColor, dagger, xpay, type, shared, var_inverse&gt;(<a class="code" href="namespacequda.html#a519e30abf575a4084224e899c730e95f">arg</a>, <a class="code" href="covdev__test_8cpp.html#a5a1bb2e0fac8c62fc2ed33f5d3d3856f">parity</a>, x_cb, <a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a>);</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  }</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;} <span class="comment">// namespace quda</span></div><div class="ttc" id="classquda_1_1coeff__type_html_a7d17fd51b463fe4fcf537c9570ba1292"><div class="ttname"><a href="classquda_1_1coeff__type.html#a7d17fd51b463fe4fcf537c9570ba1292">quda::coeff_type::coeff_type</a></div><div class="ttdeci">__device__ __host__ coeff_type(const Arg &amp;arg)</div><div class="ttdef"><b>Definition:</b> <a href="dslash__domain__wall__m5_8cuh_source.html#l00043">dslash_domain_wall_m5.cuh:43</a></div></div>
<div class="ttc" id="namespacequda_html_aecfddb045f6f276fbad230bbbc98b1c7ad3048ef8611b5db5a88a93d65977d6c3"><div class="ttname"><a href="namespacequda.html#aecfddb045f6f276fbad230bbbc98b1c7ad3048ef8611b5db5a88a93d65977d6c3">quda::M5_INV_MOBIUS</a></div><div class="ttdef"><b>Definition:</b> <a href="dslash__quda_8h_source.html#l00396">dslash_quda.h:396</a></div></div>
<div class="ttc" id="namespacequda_html_ab9807d002fda6a71d35be71340fc7e6d"><div class="ttname"><a href="namespacequda.html#ab9807d002fda6a71d35be71340fc7e6d">quda::mobius_d</a></div><div class="ttdeci">static __constant__ char mobius_d[size]</div><div class="ttdef"><b>Definition:</b> <a href="dslash__domain__wall__4d_8cuh_source.html#l00009">dslash_domain_wall_4d.cuh:9</a></div></div>
<div class="ttc" id="structquda_1_1_dslash5_arg_html_ac3179b0501ddf1290ac091a542b70961"><div class="ttname"><a href="structquda_1_1_dslash5_arg.html#ac3179b0501ddf1290ac091a542b70961">quda::Dslash5Arg::m_5</a></div><div class="ttdeci">const real m_5</div><div class="ttdef"><b>Definition:</b> <a href="dslash__domain__wall__m5_8cuh_source.html#l00091">dslash_domain_wall_m5.cuh:91</a></div></div>
<div class="ttc" id="classquda_1_1_color_spinor_field_html_a6067aeefbeb02a469fadc6534ce01794"><div class="ttname"><a href="classquda_1_1_color_spinor_field.html#a6067aeefbeb02a469fadc6534ce01794">quda::ColorSpinorField::Nspin</a></div><div class="ttdeci">int Nspin() const</div><div class="ttdef"><b>Definition:</b> <a href="color__spinor__field_8h_source.html#l00406">color_spinor_field.h:406</a></div></div>
<div class="ttc" id="namespacequda_html_a1ca789768bb250ae4267fa897384dc21"><div class="ttname"><a href="namespacequda.html#a1ca789768bb250ae4267fa897384dc21">quda::dslash5GPU</a></div><div class="ttdeci">__global__ void dslash5GPU(Arg arg)</div><div class="ttdoc">GPU kernel for applying the D5 operator. </div><div class="ttdef"><b>Definition:</b> <a href="dslash__domain__wall__m5_8cuh_source.html#l00266">dslash_domain_wall_m5.cuh:266</a></div></div>
<div class="ttc" id="structquda_1_1coeff__5_html_aa1cfe0469d2b49687610793d39abc171"><div class="ttname"><a href="structquda_1_1coeff__5.html#aa1cfe0469d2b49687610793d39abc171">quda::coeff_5::b</a></div><div class="ttdeci">complex&lt; real &gt; b[QUDA_MAX_DWF_LS]</div><div class="ttdef"><b>Definition:</b> <a href="dslash__domain__wall__m5_8cuh_source.html#l00014">dslash_domain_wall_m5.cuh:14</a></div></div>
<div class="ttc" id="structquda_1_1_dslash5_arg_html_a2f1b75051ce95ddf7cb906ca46d34044"><div class="ttname"><a href="structquda_1_1_dslash5_arg.html#a2f1b75051ce95ddf7cb906ca46d34044">quda::Dslash5Arg::c</a></div><div class="ttdeci">real c</div><div class="ttdef"><b>Definition:</b> <a href="dslash__domain__wall__m5_8cuh_source.html#l00097">dslash_domain_wall_m5.cuh:97</a></div></div>
<div class="ttc" id="structquda_1_1_dslash5_arg_html_a8801ad2a85496bd0e515a11eb933fa88"><div class="ttname"><a href="structquda_1_1_dslash5_arg.html#a8801ad2a85496bd0e515a11eb933fa88">quda::Dslash5Arg::volume_4d_cb</a></div><div class="ttdeci">const int volume_4d_cb</div><div class="ttdef"><b>Definition:</b> <a href="dslash__domain__wall__m5_8cuh_source.html#l00087">dslash_domain_wall_m5.cuh:87</a></div></div>
<div class="ttc" id="classquda_1_1_color_spinor_field_html"><div class="ttname"><a href="classquda_1_1_color_spinor_field.html">quda::ColorSpinorField</a></div><div class="ttdef"><b>Definition:</b> <a href="color__spinor__field_8h_source.html#l00311">color_spinor_field.h:311</a></div></div>
<div class="ttc" id="structquda_1_1_dslash5_arg_html_afca82269d73c2fc3fa5b92325a8b0a5d"><div class="ttname"><a href="structquda_1_1_dslash5_arg.html#afca82269d73c2fc3fa5b92325a8b0a5d">quda::Dslash5Arg::mobius_h</a></div><div class="ttdeci">coeff_5&lt; real &gt; * mobius_h</div><div class="ttdef"><b>Definition:</b> <a href="dslash__domain__wall__m5_8cuh_source.html#l00102">dslash_domain_wall_m5.cuh:102</a></div></div>
<div class="ttc" id="namespacequda_html_ab9b7c656cfd4121b9d553997230d76e2"><div class="ttname"><a href="namespacequda.html#ab9b7c656cfd4121b9d553997230d76e2">quda::exp</a></div><div class="ttdeci">__host__ __device__ ValueType exp(ValueType x)</div><div class="ttdef"><b>Definition:</b> <a href="complex__quda_8h_source.html#l00096">complex_quda.h:96</a></div></div>
<div class="ttc" id="util__quda_8h_html_af3bddfd9d113d50e8e0bbf58a35c5aac"><div class="ttname"><a href="util__quda_8h.html#af3bddfd9d113d50e8e0bbf58a35c5aac">errorQuda</a></div><div class="ttdeci">#define errorQuda(...)</div><div class="ttdef"><b>Definition:</b> <a href="util__quda_8h_source.html#l00121">util_quda.h:121</a></div></div>
<div class="ttc" id="structquda_1_1_color_spinor_html"><div class="ttname"><a href="structquda_1_1_color_spinor.html">quda::ColorSpinor</a></div><div class="ttdef"><b>Definition:</b> <a href="color__spinor_8h_source.html#l00024">color_spinor.h:24</a></div></div>
<div class="ttc" id="classquda_1_1coeff__type_3_01real_00_01true_00_01_arg_01_4_html_a4d9c789503be60c40b53c856cdf9f3b9"><div class="ttname"><a href="classquda_1_1coeff__type_3_01real_00_01true_00_01_arg_01_4.html#a4d9c789503be60c40b53c856cdf9f3b9">quda::coeff_type&lt; real, true, Arg &gt;::coeff_type</a></div><div class="ttdeci">__device__ __host__ coeff_type(const Arg &amp;arg)</div><div class="ttdef"><b>Definition:</b> <a href="dslash__domain__wall__m5_8cuh_source.html#l00069">dslash_domain_wall_m5.cuh:69</a></div></div>
<div class="ttc" id="namespacequda_html_a789d64f982984a0b1a4f335b4c59a717"><div class="ttname"><a href="namespacequda.html#a789d64f982984a0b1a4f335b4c59a717">quda::__fast_pow</a></div><div class="ttdeci">__device__ __host__ real __fast_pow(real a, int b)</div><div class="ttdef"><b>Definition:</b> <a href="math__helper_8cuh_source.html#l00015">math_helper.cuh:15</a></div></div>
<div class="ttc" id="quda__internal_8h_html_a0bf27533c025df9eb1aa7deb98a6fd02"><div class="ttname"><a href="quda__internal_8h.html#a0bf27533c025df9eb1aa7deb98a6fd02">streams</a></div><div class="ttdeci">cudaStream_t * streams</div><div class="ttdef"><b>Definition:</b> <a href="interface__quda_8cpp_source.html#l00157">interface_quda.cpp:157</a></div></div>
<div class="ttc" id="structquda_1_1_dslash5_arg_html_ad719e58f1b5372d1c13b3477ffaef72f"><div class="ttname"><a href="structquda_1_1_dslash5_arg.html#ad719e58f1b5372d1c13b3477ffaef72f">quda::Dslash5Arg::dagger</a></div><div class="ttdeci">const bool dagger</div><div class="ttdef"><b>Definition:</b> <a href="dslash__domain__wall__m5_8cuh_source.html#l00093">dslash_domain_wall_m5.cuh:93</a></div></div>
<div class="ttc" id="structquda_1_1_dslash5_arg_html_afdfbac8405ba9e7881da53608ae9a0cf"><div class="ttname"><a href="structquda_1_1_dslash5_arg.html#afdfbac8405ba9e7881da53608ae9a0cf">quda::Dslash5Arg::Dslash5Arg</a></div><div class="ttdeci">Dslash5Arg(ColorSpinorField &amp;out, const ColorSpinorField &amp;in, const ColorSpinorField &amp;x, double m_f, double m_5, const Complex *b_5_, const Complex *c_5_, double a_, bool dagger, Dslash5Type type)</div><div class="ttdef"><b>Definition:</b> <a href="dslash__domain__wall__m5_8cuh_source.html#l00104">dslash_domain_wall_m5.cuh:104</a></div></div>
<div class="ttc" id="namespacequda_html_aecfddb045f6f276fbad230bbbc98b1c7a8a6dd4152e43a17db6ae9be3a69f5815"><div class="ttname"><a href="namespacequda.html#aecfddb045f6f276fbad230bbbc98b1c7a8a6dd4152e43a17db6ae9be3a69f5815">quda::DSLASH5_MOBIUS</a></div><div class="ttdef"><b>Definition:</b> <a href="dslash__quda_8h_source.html#l00396">dslash_quda.h:396</a></div></div>
<div class="ttc" id="classquda_1_1coeff__type_html"><div class="ttname"><a href="classquda_1_1coeff__type.html">quda::coeff_type</a></div><div class="ttdoc">Helper class for grabbing the constant struct, whether we are on the GPU or CPU. </div><div class="ttdef"><b>Definition:</b> <a href="dslash__domain__wall__m5_8cuh_source.html#l00039">dslash_domain_wall_m5.cuh:39</a></div></div>
<div class="ttc" id="namespacequda_html_a229cda99dcc1663d87f9e88b90108f36"><div class="ttname"><a href="namespacequda.html#a229cda99dcc1663d87f9e88b90108f36">quda::Nstream</a></div><div class="ttdeci">const int Nstream</div><div class="ttdef"><b>Definition:</b> <a href="quda__internal_8h_source.html#l00083">quda_internal.h:83</a></div></div>
<div class="ttc" id="interface__quda_8cpp_html_a67b63ae29fb23d1a034f9ba7e0787745"><div class="ttname"><a href="interface__quda_8cpp.html#a67b63ae29fb23d1a034f9ba7e0787745">R</a></div><div class="ttdeci">static int R[4]</div><div class="ttdef"><b>Definition:</b> <a href="interface__quda_8cpp_source.html#l00084">interface_quda.cpp:84</a></div></div>
<div class="ttc" id="math__helper_8cuh_html"><div class="ttname"><a href="math__helper_8cuh.html">math_helper.cuh</a></div><div class="ttdoc">Helper math routines used in QUDA. </div></div>
<div class="ttc" id="namespacequda_html_aecfddb045f6f276fbad230bbbc98b1c7a31f01215dc722d248d68b1bd7b512ab5"><div class="ttname"><a href="namespacequda.html#aecfddb045f6f276fbad230bbbc98b1c7a31f01215dc722d248d68b1bd7b512ab5">quda::DSLASH5_DWF</a></div><div class="ttdef"><b>Definition:</b> <a href="dslash__quda_8h_source.html#l00396">dslash_quda.h:396</a></div></div>
<div class="ttc" id="structquda_1_1_dslash5_arg_html_a54d66ff388c436e64d8e57e505ebf925"><div class="ttname"><a href="structquda_1_1_dslash5_arg.html#a54d66ff388c436e64d8e57e505ebf925">quda::Dslash5Arg::volume_cb</a></div><div class="ttdeci">const int volume_cb</div><div class="ttdef"><b>Definition:</b> <a href="dslash__domain__wall__m5_8cuh_source.html#l00086">dslash_domain_wall_m5.cuh:86</a></div></div>
<div class="ttc" id="classquda_1_1coeff__type_3_01real_00_01true_00_01_arg_01_4_html_a94027da57dedba859103ea110d79f88e"><div class="ttname"><a href="classquda_1_1coeff__type_3_01real_00_01true_00_01_arg_01_4.html#a94027da57dedba859103ea110d79f88e">quda::coeff_type&lt; real, true, Arg &gt;::coeff</a></div><div class="ttdeci">__device__ __host__ const coeff_5&lt; real &gt; * coeff() const</div><div class="ttdoc">Helper function for grabbing the constant struct, whether we are on the GPU or CPU. </div><div class="ttdef"><b>Definition:</b> <a href="dslash__domain__wall__m5_8cuh_source.html#l00058">dslash_domain_wall_m5.cuh:58</a></div></div>
<div class="ttc" id="shared__memory__cache__helper_8cuh_html"><div class="ttname"><a href="shared__memory__cache__helper_8cuh.html">shared_memory_cache_helper.cuh</a></div></div>
<div class="ttc" id="structquda_1_1coeff__5_html"><div class="ttname"><a href="structquda_1_1coeff__5.html">quda::coeff_5</a></div><div class="ttdoc">Structure containing zMobius / Zolotarev coefficients. </div><div class="ttdef"><b>Definition:</b> <a href="dslash__domain__wall__m5_8cuh_source.html#l00012">dslash_domain_wall_m5.cuh:12</a></div></div>
<div class="ttc" id="namespacequda_html_aecfddb045f6f276fbad230bbbc98b1c7a506b4a61c0c8fdaf8bd2f5b7e51addf1"><div class="ttname"><a href="namespacequda.html#aecfddb045f6f276fbad230bbbc98b1c7a506b4a61c0c8fdaf8bd2f5b7e51addf1">quda::DSLASH5_MOBIUS_PRE</a></div><div class="ttdef"><b>Definition:</b> <a href="dslash__quda_8h_source.html#l00396">dslash_quda.h:396</a></div></div>
<div class="ttc" id="classint__fastdiv_html"><div class="ttname"><a href="classint__fastdiv.html">int_fastdiv</a></div><div class="ttdef"><b>Definition:</b> <a href="fast__intdiv_8h_source.html#l00020">fast_intdiv.h:20</a></div></div>
<div class="ttc" id="namespacequda_html"><div class="ttname"><a href="namespacequda.html">quda</a></div><div class="ttdef"><b>Definition:</b> <a href="blas__cublas_8h_source.html#l00005">blas_cublas.h:5</a></div></div>
<div class="ttc" id="namespacequda_html_aa5824a02d74a559045359524a05b1005"><div class="ttname"><a href="namespacequda.html#aa5824a02d74a559045359524a05b1005">quda::dslash5invGPU</a></div><div class="ttdeci">__global__ void dslash5invGPU(Arg arg)</div><div class="ttdoc">CPU kernel for applying the M5 inverse operator. </div><div class="ttdef"><b>Definition:</b> <a href="dslash__domain__wall__m5_8cuh_source.html#l00463">dslash_domain_wall_m5.cuh:463</a></div></div>
<div class="ttc" id="structquda_1_1_dslash5_arg_html_a31f5e2e8bd7b5c86a7410eb37a4d477b"><div class="ttname"><a href="structquda_1_1_dslash5_arg.html#a31f5e2e8bd7b5c86a7410eb37a4d477b">quda::Dslash5Arg::real</a></div><div class="ttdeci">mapper&lt; Float &gt;::type real</div><div class="ttdef"><b>Definition:</b> <a href="dslash__domain__wall__m5_8cuh_source.html#l00080">dslash_domain_wall_m5.cuh:80</a></div></div>
<div class="ttc" id="namespacequda_1_1blas_html_a8f3009e9e4a4bfe40b4d3f20d03c2f45"><div class="ttname"><a href="namespacequda_1_1blas.html#a8f3009e9e4a4bfe40b4d3f20d03c2f45">quda::blas::xpay</a></div><div class="ttdeci">void xpay(ColorSpinorField &amp;x, double a, ColorSpinorField &amp;y)</div><div class="ttdef"><b>Definition:</b> <a href="blas__quda_8h_source.html#l00037">blas_quda.h:37</a></div></div>
<div class="ttc" id="test__util_8cpp_html_a96202c3467aa608f6feee09ded0065a5"><div class="ttname"><a href="test__util_8cpp.html#a96202c3467aa608f6feee09ded0065a5">Ls</a></div><div class="ttdeci">int Ls</div><div class="ttdef"><b>Definition:</b> <a href="test__util_8cpp_source.html#l00038">test_util.cpp:38</a></div></div>
<div class="ttc" id="namespacequda_html_a438a885d331b3193ac17cedebb545e1f"><div class="ttname"><a href="namespacequda.html#a438a885d331b3193ac17cedebb545e1f">quda::variableInv</a></div><div class="ttdeci">__device__ __host__ Vector variableInv(Arg &amp;arg, int parity, int x_cb, int s_)</div><div class="ttdoc">Apply the M5 inverse operator at a given site on the lattice. This is an alternative algorithm that i...</div><div class="ttdef"><b>Definition:</b> <a href="dslash__domain__wall__m5_8cuh_source.html#l00352">dslash_domain_wall_m5.cuh:352</a></div></div>
<div class="ttc" id="structquda_1_1_dslash5_arg_html_a004d819b0011006a3939e6f5c766022d"><div class="ttname"><a href="structquda_1_1_dslash5_arg.html#a004d819b0011006a3939e6f5c766022d">quda::Dslash5Arg::type</a></div><div class="ttdeci">Dslash5Type type</div><div class="ttdef"><b>Definition:</b> <a href="dslash__domain__wall__m5_8cuh_source.html#l00100">dslash_domain_wall_m5.cuh:100</a></div></div>
<div class="ttc" id="classquda_1_1coeff__type_html_ad4066c7187502f2f8c53a4fae37b0b62"><div class="ttname"><a href="classquda_1_1coeff__type.html#ad4066c7187502f2f8c53a4fae37b0b62">quda::coeff_type::b</a></div><div class="ttdeci">__device__ __host__ real b(int s)</div><div class="ttdef"><b>Definition:</b> <a href="dslash__domain__wall__m5_8cuh_source.html#l00045">dslash_domain_wall_m5.cuh:45</a></div></div>
<div class="ttc" id="namespacequda_html_af777e107cf1788892e869cf8978b5b4e"><div class="ttname"><a href="namespacequda.html#af777e107cf1788892e869cf8978b5b4e">quda::dslash5inv</a></div><div class="ttdeci">__device__ __host__ void dslash5inv(Arg &amp;arg, int parity, int x_cb, int s)</div><div class="ttdoc">Apply the M5 inverse operator at a given site on the lattice. </div><div class="ttdef"><b>Definition:</b> <a href="dslash__domain__wall__m5_8cuh_source.html#l00433">dslash_domain_wall_m5.cuh:433</a></div></div>
<div class="ttc" id="classquda_1_1coeff__type_3_01real_00_01true_00_01_arg_01_4_html_a8a85cbf0754c7d187ba894184d7f2890"><div class="ttname"><a href="classquda_1_1coeff__type_3_01real_00_01true_00_01_arg_01_4.html#a8a85cbf0754c7d187ba894184d7f2890">quda::coeff_type&lt; real, true, Arg &gt;::a</a></div><div class="ttdeci">__device__ __host__ complex&lt; real &gt; a(int s)</div><div class="ttdef"><b>Definition:</b> <a href="dslash__domain__wall__m5_8cuh_source.html#l00070">dslash_domain_wall_m5.cuh:70</a></div></div>
<div class="ttc" id="covdev__test_8cpp_html_a8534bf561fd4d68d79107757d9cbac65"><div class="ttname"><a href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a></div><div class="ttdeci">const int nColor</div><div class="ttdef"><b>Definition:</b> <a href="covdev__test_8cpp_source.html#l00075">covdev_test.cpp:75</a></div></div>
<div class="ttc" id="staggered__invert__test_8cpp_html_af61ff6c9724eb687e3057b6a1a977487"><div class="ttname"><a href="staggered__invert__test_8cpp.html#af61ff6c9724eb687e3057b6a1a977487">in</a></div><div class="ttdeci">cpuColorSpinorField * in</div><div class="ttdef"><b>Definition:</b> <a href="staggered__invert__test_8cpp_source.html#l00098">staggered_invert_test.cpp:98</a></div></div>
<div class="ttc" id="classquda_1_1coeff__type_html_a2460264e7f8e11496fcf7d0f3191abff"><div class="ttname"><a href="classquda_1_1coeff__type.html#a2460264e7f8e11496fcf7d0f3191abff">quda::coeff_type::a</a></div><div class="ttdeci">__device__ __host__ real a(int s)</div><div class="ttdef"><b>Definition:</b> <a href="dslash__domain__wall__m5_8cuh_source.html#l00044">dslash_domain_wall_m5.cuh:44</a></div></div>
<div class="ttc" id="structquda_1_1_dslash5_arg_html_abe63650a3669236759b0dbef5944252d"><div class="ttname"><a href="structquda_1_1_dslash5_arg.html#abe63650a3669236759b0dbef5944252d">quda::Dslash5Arg::b</a></div><div class="ttdeci">real b</div><div class="ttdef"><b>Definition:</b> <a href="dslash__domain__wall__m5_8cuh_source.html#l00096">dslash_domain_wall_m5.cuh:96</a></div></div>
<div class="ttc" id="structquda_1_1_dslash5_arg_html_ac0e47ec5de621bf35c17277d0359c73b"><div class="ttname"><a href="structquda_1_1_dslash5_arg.html#ac0e47ec5de621bf35c17277d0359c73b">quda::Dslash5Arg::a</a></div><div class="ttdeci">real a</div><div class="ttdef"><b>Definition:</b> <a href="dslash__domain__wall__m5_8cuh_source.html#l00098">dslash_domain_wall_m5.cuh:98</a></div></div>
<div class="ttc" id="namespacequda_html_ac607b0c5fa5401f582b361eb935649fb"><div class="ttname"><a href="namespacequda.html#ac607b0c5fa5401f582b361eb935649fb">quda::size</a></div><div class="ttdeci">constexpr int size</div><div class="ttdef"><b>Definition:</b> <a href="dslash__domain__wall__4d_8cuh_source.html#l00008">dslash_domain_wall_4d.cuh:8</a></div></div>
<div class="ttc" id="classquda_1_1coeff__type_3_01real_00_01true_00_01_arg_01_4_html_af9688899bbddd38db36db7770be34a2f"><div class="ttname"><a href="classquda_1_1coeff__type_3_01real_00_01true_00_01_arg_01_4.html#af9688899bbddd38db36db7770be34a2f">quda::coeff_type&lt; real, true, Arg &gt;::arg</a></div><div class="ttdeci">const Arg &amp; arg</div><div class="ttdef"><b>Definition:</b> <a href="dslash__domain__wall__m5_8cuh_source.html#l00068">dslash_domain_wall_m5.cuh:68</a></div></div>
<div class="ttc" id="namespacequda_html_aaa35e68beb10c3fdbf3ba1d4915fa752"><div class="ttname"><a href="namespacequda.html#aaa35e68beb10c3fdbf3ba1d4915fa752">quda::pow</a></div><div class="ttdeci">__host__ __device__ ValueType pow(ValueType x, ExponentType e)</div><div class="ttdef"><b>Definition:</b> <a href="complex__quda_8h_source.html#l00111">complex_quda.h:111</a></div></div>
<div class="ttc" id="classquda_1_1_vector_cache_html_a2c043a581f028fd1f527d262c8954da7"><div class="ttname"><a href="classquda_1_1_vector_cache.html#a2c043a581f028fd1f527d262c8954da7">quda::VectorCache::load</a></div><div class="ttdeci">__device__ Vector load(int x, int y, int z)</div><div class="ttdoc">Load a vector from the shared memory cache. </div><div class="ttdef"><b>Definition:</b> <a href="shared__memory__cache__helper_8cuh_source.html#l00057">shared_memory_cache_helper.cuh:57</a></div></div>
<div class="ttc" id="structquda_1_1coeff__5_html_aa05e8b921d011a604ddc97bc10a3ee3c"><div class="ttname"><a href="structquda_1_1coeff__5.html#aa05e8b921d011a604ddc97bc10a3ee3c">quda::coeff_5::a</a></div><div class="ttdeci">complex&lt; real &gt; a[QUDA_MAX_DWF_LS]</div><div class="ttdef"><b>Definition:</b> <a href="dslash__domain__wall__m5_8cuh_source.html#l00013">dslash_domain_wall_m5.cuh:13</a></div></div>
<div class="ttc" id="covdev__test_8cpp_html_a7facd8f2fefe0ccaea751dff2592badb"><div class="ttname"><a href="covdev__test_8cpp.html#a7facd8f2fefe0ccaea751dff2592badb">X</a></div><div class="ttdeci">int X[4]</div><div class="ttdef"><b>Definition:</b> <a href="covdev__test_8cpp_source.html#l00070">covdev_test.cpp:70</a></div></div>
<div class="ttc" id="namespacequda_html_a61eb8e0789e8a2021032ee12761d924e"><div class="ttname"><a href="namespacequda.html#a61eb8e0789e8a2021032ee12761d924e">quda::Complex</a></div><div class="ttdeci">std::complex&lt; double &gt; Complex</div><div class="ttdef"><b>Definition:</b> <a href="quda__internal_8h_source.html#l00046">quda_internal.h:46</a></div></div>
<div class="ttc" id="structquda_1_1_dslash5_arg_html_ab13cd9411f132f5c8d6303f8ff1c9b5d"><div class="ttname"><a href="structquda_1_1_dslash5_arg.html#ab13cd9411f132f5c8d6303f8ff1c9b5d">quda::Dslash5Arg::in</a></div><div class="ttdeci">const F in</div><div class="ttdef"><b>Definition:</b> <a href="dslash__domain__wall__m5_8cuh_source.html#l00083">dslash_domain_wall_m5.cuh:83</a></div></div>
<div class="ttc" id="structquda_1_1_dslash5_arg_html_ae64c7f461478fbca984de5c0f491498f"><div class="ttname"><a href="structquda_1_1_dslash5_arg.html#ae64c7f461478fbca984de5c0f491498f">quda::Dslash5Arg::Ls</a></div><div class="ttdeci">const int_fastdiv Ls</div><div class="ttdef"><b>Definition:</b> <a href="dslash__domain__wall__m5_8cuh_source.html#l00088">dslash_domain_wall_m5.cuh:88</a></div></div>
<div class="ttc" id="structquda_1_1_dslash5_arg_html_a6e745fddefc6374bc5b6d9ecb3f0e7d1"><div class="ttname"><a href="structquda_1_1_dslash5_arg.html#a6e745fddefc6374bc5b6d9ecb3f0e7d1">quda::Dslash5Arg::x</a></div><div class="ttdeci">const F x</div><div class="ttdef"><b>Definition:</b> <a href="dslash__domain__wall__m5_8cuh_source.html#l00084">dslash_domain_wall_m5.cuh:84</a></div></div>
<div class="ttc" id="structquda_1_1_dslash5_arg_html_a705c5eea045b1bab516babcb8a877d33"><div class="ttname"><a href="structquda_1_1_dslash5_arg.html#a705c5eea045b1bab516babcb8a877d33">quda::Dslash5Arg::~Dslash5Arg</a></div><div class="ttdeci">virtual ~Dslash5Arg()</div><div class="ttdef"><b>Definition:</b> <a href="dslash__domain__wall__m5_8cuh_source.html#l00180">dslash_domain_wall_m5.cuh:180</a></div></div>
<div class="ttc" id="structquda_1_1_arg_html"><div class="ttname"><a href="structquda_1_1_arg.html">quda::Arg</a></div><div class="ttdef"><b>Definition:</b> <a href="spinor__noise_8cu_source.html#l00022">spinor_noise.cu:22</a></div></div>
<div class="ttc" id="classquda_1_1_color_spinor_field_html_ac324b268700ab27a4455e7d216f2e92c"><div class="ttname"><a href="classquda_1_1_color_spinor_field.html#ac324b268700ab27a4455e7d216f2e92c">quda::ColorSpinorField::isNative</a></div><div class="ttdeci">bool isNative() const</div><div class="ttdef"><b>Definition:</b> <a href="color__spinor__field_8cpp_source.html#l00568">color_spinor_field.cpp:568</a></div></div>
<div class="ttc" id="classquda_1_1coeff__type_html_ad59899f3fd523feb48188b8ef4a51c61"><div class="ttname"><a href="classquda_1_1coeff__type.html#ad59899f3fd523feb48188b8ef4a51c61">quda::coeff_type::c</a></div><div class="ttdeci">__device__ __host__ real c(int s)</div><div class="ttdef"><b>Definition:</b> <a href="dslash__domain__wall__m5_8cuh_source.html#l00046">dslash_domain_wall_m5.cuh:46</a></div></div>
<div class="ttc" id="namespacequda_html_aecfddb045f6f276fbad230bbbc98b1c7a8f95341b535ff1d3249dedb1953bd3a0"><div class="ttname"><a href="namespacequda.html#aecfddb045f6f276fbad230bbbc98b1c7a8f95341b535ff1d3249dedb1953bd3a0">quda::M5_INV_ZMOBIUS</a></div><div class="ttdef"><b>Definition:</b> <a href="dslash__quda_8h_source.html#l00396">dslash_quda.h:396</a></div></div>
<div class="ttc" id="structquda_1_1_dslash5_arg_html_a3d41d9031e55014d12e8ff656f29f00a"><div class="ttname"><a href="structquda_1_1_dslash5_arg.html#a3d41d9031e55014d12e8ff656f29f00a">quda::Dslash5Arg::nParity</a></div><div class="ttdeci">const int nParity</div><div class="ttdef"><b>Definition:</b> <a href="dslash__domain__wall__m5_8cuh_source.html#l00085">dslash_domain_wall_m5.cuh:85</a></div></div>
<div class="ttc" id="classquda_1_1_vector_cache_html_aa3c30257feb1dee24fa797c70826d6af"><div class="ttname"><a href="classquda_1_1_vector_cache.html#aa3c30257feb1dee24fa797c70826d6af">quda::VectorCache::sync</a></div><div class="ttdeci">__device__ void sync()</div><div class="ttdoc">Synchronize the cache. </div><div class="ttdef"><b>Definition:</b> <a href="shared__memory__cache__helper_8cuh_source.html#l00072">shared_memory_cache_helper.cuh:72</a></div></div>
<div class="ttc" id="structquda_1_1coeff__5_html_a3660a7fa603675c375d73ca3ac9728a0"><div class="ttname"><a href="structquda_1_1coeff__5.html#a3660a7fa603675c375d73ca3ac9728a0">quda::coeff_5::c</a></div><div class="ttdeci">complex&lt; real &gt; c[QUDA_MAX_DWF_LS]</div><div class="ttdef"><b>Definition:</b> <a href="dslash__domain__wall__m5_8cuh_source.html#l00015">dslash_domain_wall_m5.cuh:15</a></div></div>
<div class="ttc" id="namespacequda_html_aecfddb045f6f276fbad230bbbc98b1c7aeaaaf4f45cc1df49e594c6f20a14af24"><div class="ttname"><a href="namespacequda.html#aecfddb045f6f276fbad230bbbc98b1c7aeaaaf4f45cc1df49e594c6f20a14af24">quda::M5_INV_DWF</a></div><div class="ttdef"><b>Definition:</b> <a href="dslash__quda_8h_source.html#l00396">dslash_quda.h:396</a></div></div>
<div class="ttc" id="staggered__invert__test_8cpp_html_af3806a0fd9f2d8dd7a627e9571984d33"><div class="ttname"><a href="staggered__invert__test_8cpp.html#af3806a0fd9f2d8dd7a627e9571984d33">out</a></div><div class="ttdeci">cpuColorSpinorField * out</div><div class="ttdef"><b>Definition:</b> <a href="staggered__invert__test_8cpp_source.html#l00099">staggered_invert_test.cpp:99</a></div></div>
<div class="ttc" id="structquda_1_1_arg_html_a8c893cadf2b678609993f7bcef5d3e14"><div class="ttname"><a href="structquda_1_1_arg.html#a8c893cadf2b678609993f7bcef5d3e14">quda::Arg::nParity</a></div><div class="ttdeci">const int nParity</div><div class="ttdef"><b>Definition:</b> <a href="spinor__noise_8cu_source.html#l00025">spinor_noise.cu:25</a></div></div>
<div class="ttc" id="namespacequda_html_aecfddb045f6f276fbad230bbbc98b1c7"><div class="ttname"><a href="namespacequda.html#aecfddb045f6f276fbad230bbbc98b1c7">quda::Dslash5Type</a></div><div class="ttdeci">Dslash5Type</div><div class="ttdef"><b>Definition:</b> <a href="dslash__quda_8h_source.html#l00396">dslash_quda.h:396</a></div></div>
<div class="ttc" id="structquda_1_1mapper_html"><div class="ttname"><a href="structquda_1_1mapper.html">quda::mapper</a></div><div class="ttdef"><b>Definition:</b> <a href="register__traits_8h_source.html#l00043">register_traits.h:43</a></div></div>
<div class="ttc" id="classquda_1_1coeff__type_html_a6736ff66306b4f12b111c92a97d8c423"><div class="ttname"><a href="classquda_1_1coeff__type.html#a6736ff66306b4f12b111c92a97d8c423">quda::coeff_type::arg</a></div><div class="ttdeci">const Arg &amp; arg</div><div class="ttdef"><b>Definition:</b> <a href="dslash__domain__wall__m5_8cuh_source.html#l00042">dslash_domain_wall_m5.cuh:42</a></div></div>
<div class="ttc" id="structquda_1_1_dslash5_arg_html_a35c497d5d22613ddb7883d8197bd9612"><div class="ttname"><a href="structquda_1_1_dslash5_arg.html#a35c497d5d22613ddb7883d8197bd9612">quda::Dslash5Arg::m_f</a></div><div class="ttdeci">const real m_f</div><div class="ttdef"><b>Definition:</b> <a href="dslash__domain__wall__m5_8cuh_source.html#l00090">dslash_domain_wall_m5.cuh:90</a></div></div>
<div class="ttc" id="namespacequda_html_a011e515b863de3a8e2621be203bb1682"><div class="ttname"><a href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">quda::s</a></div><div class="ttdeci">__shared__ float s[]</div></div>
<div class="ttc" id="quda__constants_8h_html_a7f22cb708419e6cc1124433abd00a094"><div class="ttname"><a href="quda__constants_8h.html#a7f22cb708419e6cc1124433abd00a094">QUDA_MAX_DWF_LS</a></div><div class="ttdeci">#define QUDA_MAX_DWF_LS</div><div class="ttdoc">Maximum length of the Ls dimension for domain-wall fermions. </div><div class="ttdef"><b>Definition:</b> <a href="quda__constants_8h_source.html#l00049">quda_constants.h:49</a></div></div>
<div class="ttc" id="namespacequda_html_a8a923946d76979f01afbcd347a488866"><div class="ttname"><a href="namespacequda.html#a8a923946d76979f01afbcd347a488866">quda::constantInv</a></div><div class="ttdeci">__device__ __host__ Vector constantInv(Arg &amp;arg, int parity, int x_cb, int s_)</div><div class="ttdoc">Apply the M5 inverse operator at a given site on the lattice. This is the original algorithm as descr...</div><div class="ttdef"><b>Definition:</b> <a href="dslash__domain__wall__m5_8cuh_source.html#l00295">dslash_domain_wall_m5.cuh:295</a></div></div>
<div class="ttc" id="structquda_1_1colorspinor__mapper_html"><div class="ttname"><a href="structquda_1_1colorspinor__mapper.html">quda::colorspinor_mapper</a></div><div class="ttdef"><b>Definition:</b> <a href="color__spinor__field__order_8h_source.html#l01602">color_spinor_field_order.h:1602</a></div></div>
<div class="ttc" id="classquda_1_1_vector_cache_html"><div class="ttname"><a href="classquda_1_1_vector_cache.html">quda::VectorCache</a></div><div class="ttdoc">Class which wraps around a shared memory cache for a Vector type, where each thread in the thread blo...</div><div class="ttdef"><b>Definition:</b> <a href="shared__memory__cache__helper_8cuh_source.html#l00021">shared_memory_cache_helper.cuh:21</a></div></div>
<div class="ttc" id="structquda_1_1_dslash5_arg_html_ade544c5bbd6a69d6098fcf40ea52d976"><div class="ttname"><a href="structquda_1_1_dslash5_arg.html#ade544c5bbd6a69d6098fcf40ea52d976">quda::Dslash5Arg::xpay</a></div><div class="ttdeci">const bool xpay</div><div class="ttdef"><b>Definition:</b> <a href="dslash__domain__wall__m5_8cuh_source.html#l00094">dslash_domain_wall_m5.cuh:94</a></div></div>
<div class="ttc" id="namespacequda_html_a519e30abf575a4084224e899c730e95f"><div class="ttname"><a href="namespacequda.html#a519e30abf575a4084224e899c730e95f">quda::arg</a></div><div class="ttdeci">__host__ __device__ ValueType arg(const complex&lt; ValueType &gt; &amp;z)</div><div class="ttdoc">Returns the phase angle of z. </div><div class="ttdef"><b>Definition:</b> <a href="complex__quda_8h_source.html#l01076">complex_quda.h:1076</a></div></div>
<div class="ttc" id="namespacequda_html_a4e54927fc030027c7892b4bff973aaaa"><div class="ttname"><a href="namespacequda.html#a4e54927fc030027c7892b4bff973aaaa">quda::Vector</a></div><div class="ttdeci">VectorXcd Vector</div><div class="ttdef"><b>Definition:</b> <a href="inv__eigcg__quda_8cpp_source.html#l00038">inv_eigcg_quda.cpp:38</a></div></div>
<div class="ttc" id="structquda_1_1_dslash5_arg_html_a01595e1fe4f5141d24d652f3fb67b668"><div class="ttname"><a href="structquda_1_1_dslash5_arg.html#a01595e1fe4f5141d24d652f3fb67b668">quda::Dslash5Arg::out</a></div><div class="ttdeci">F out</div><div class="ttdef"><b>Definition:</b> <a href="dslash__domain__wall__m5_8cuh_source.html#l00082">dslash_domain_wall_m5.cuh:82</a></div></div>
<div class="ttc" id="structquda_1_1_dslash5_arg_html_a1ba6339ae5945f9c902bb9f7ceb80a40"><div class="ttname"><a href="structquda_1_1_dslash5_arg.html#a1ba6339ae5945f9c902bb9f7ceb80a40">quda::Dslash5Arg::F</a></div><div class="ttdeci">colorspinor_mapper&lt; Float, 4, nColor &gt;::type F</div><div class="ttdef"><b>Definition:</b> <a href="dslash__domain__wall__m5_8cuh_source.html#l00079">dslash_domain_wall_m5.cuh:79</a></div></div>
<div class="ttc" id="structquda_1_1complex_3_01double_01_4_html"><div class="ttname"><a href="structquda_1_1complex_3_01double_01_4.html">quda::complex&lt; double &gt;</a></div><div class="ttdef"><b>Definition:</b> <a href="complex__quda_8h_source.html#l00580">complex_quda.h:580</a></div></div>
<div class="ttc" id="structquda_1_1is__variable_html"><div class="ttname"><a href="structquda_1_1is__variable.html">quda::is_variable</a></div><div class="ttdef"><b>Definition:</b> <a href="dslash__domain__wall__m5_8cuh_source.html#l00022">dslash_domain_wall_m5.cuh:22</a></div></div>
<div class="ttc" id="classquda_1_1_vector_cache_html_ab6140bbfafb29f3028d0c00f52bbb7e0"><div class="ttname"><a href="classquda_1_1_vector_cache.html#ab6140bbfafb29f3028d0c00f52bbb7e0">quda::VectorCache::save</a></div><div class="ttdeci">__device__ void save(const Vector &amp;a)</div><div class="ttdoc">Save the vector into the 3-d shared memory cache. Implicitly store the vector at coordinates given by...</div><div class="ttdef"><b>Definition:</b> <a href="shared__memory__cache__helper_8cuh_source.html#l00040">shared_memory_cache_helper.cuh:40</a></div></div>
<div class="ttc" id="classquda_1_1coeff__type_3_01real_00_01true_00_01_arg_01_4_html_a839b49df714b4ede00cf0633711afb74"><div class="ttname"><a href="classquda_1_1coeff__type_3_01real_00_01true_00_01_arg_01_4.html#a839b49df714b4ede00cf0633711afb74">quda::coeff_type&lt; real, true, Arg &gt;::c</a></div><div class="ttdeci">__device__ __host__ complex&lt; real &gt; c(int s)</div><div class="ttdef"><b>Definition:</b> <a href="dslash__domain__wall__m5_8cuh_source.html#l00072">dslash_domain_wall_m5.cuh:72</a></div></div>
<div class="ttc" id="structquda_1_1_dslash5_arg_html"><div class="ttname"><a href="structquda_1_1_dslash5_arg.html">quda::Dslash5Arg</a></div><div class="ttdoc">Parameter structure for applying the Dslash. </div><div class="ttdef"><b>Definition:</b> <a href="dslash__domain__wall__m5_8cuh_source.html#l00078">dslash_domain_wall_m5.cuh:78</a></div></div>
<div class="ttc" id="covdev__test_8cpp_html_a39b25c22c5fc78d683968e965f5727ba"><div class="ttname"><a href="covdev__test_8cpp.html#a39b25c22c5fc78d683968e965f5727ba">dagger</a></div><div class="ttdeci">QudaDagType dagger</div><div class="ttdef"><b>Definition:</b> <a href="test__util_8cpp_source.html#l01620">test_util.cpp:1620</a></div></div>
<div class="ttc" id="classquda_1_1coeff__type_3_01real_00_01true_00_01_arg_01_4_html_a845ad553457d56d24ea29cc8c7a04c65"><div class="ttname"><a href="classquda_1_1coeff__type_3_01real_00_01true_00_01_arg_01_4.html#a845ad553457d56d24ea29cc8c7a04c65">quda::coeff_type&lt; real, true, Arg &gt;::b</a></div><div class="ttdeci">__device__ __host__ complex&lt; real &gt; b(int s)</div><div class="ttdef"><b>Definition:</b> <a href="dslash__domain__wall__m5_8cuh_source.html#l00071">dslash_domain_wall_m5.cuh:71</a></div></div>
<div class="ttc" id="covdev__test_8cpp_html_a5a1bb2e0fac8c62fc2ed33f5d3d3856f"><div class="ttname"><a href="covdev__test_8cpp.html#a5a1bb2e0fac8c62fc2ed33f5d3d3856f">parity</a></div><div class="ttdeci">QudaParity parity</div><div class="ttdef"><b>Definition:</b> <a href="covdev__test_8cpp_source.html#l00054">covdev_test.cpp:54</a></div></div>
<div class="ttc" id="classquda_1_1_color_spinor_field_html_ac825bed31e6f651d73c10da2595c7acc"><div class="ttname"><a href="classquda_1_1_color_spinor_field.html#ac825bed31e6f651d73c10da2595c7acc">quda::ColorSpinorField::FieldOrder</a></div><div class="ttdeci">QudaFieldOrder FieldOrder() const</div><div class="ttdef"><b>Definition:</b> <a href="color__spinor__field_8h_source.html#l00483">color_spinor_field.h:483</a></div></div>
<div class="ttc" id="namespacequda_html_a85cf88fd1ab74ff933edb1da3392d41b"><div class="ttname"><a href="namespacequda.html#a85cf88fd1ab74ff933edb1da3392d41b">quda::dslash5CPU</a></div><div class="ttdeci">void dslash5CPU(Arg &amp;arg)</div><div class="ttdoc">CPU kernel for applying the D5 operator. </div><div class="ttdef"><b>Definition:</b> <a href="dslash__domain__wall__m5_8cuh_source.html#l00250">dslash_domain_wall_m5.cuh:250</a></div></div>
<div class="ttc" id="namespacequda_html_a3d6118dd05ff19613170152017ca9e20"><div class="ttname"><a href="namespacequda.html#a3d6118dd05ff19613170152017ca9e20">quda::dslash5</a></div><div class="ttdeci">__device__ __host__ void dslash5(Arg &amp;arg, int parity, int x_cb, int s)</div><div class="ttdoc">Apply the D5 operator at given site. </div><div class="ttdef"><b>Definition:</b> <a href="dslash__domain__wall__m5_8cuh_source.html#l00191">dslash_domain_wall_m5.cuh:191</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
