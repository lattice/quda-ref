<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>QUDA: lib/cpu_gauge_field.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">QUDA
   &#160;<span id="projectnumber">1.0.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">cpu_gauge_field.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="cpu__gauge__field_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="quda__internal_8h.html">quda_internal.h</a>&gt;</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="gauge__field_8h.html">gauge_field.h</a>&gt;</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &lt;assert.h&gt;</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &lt;string.h&gt;</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &lt;typeinfo&gt;</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacequda.html">quda</a> {</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;</div><div class="line"><a name="l00009"></a><span class="lineno"><a class="line" href="classquda_1_1cpu_gauge_field.html#aed4d23cd5eac14f6e2661f09a345254e">    9</a></span>&#160;  <a class="code" href="classquda_1_1cpu_gauge_field.html#aed4d23cd5eac14f6e2661f09a345254e">cpuGaugeField::cpuGaugeField</a>(<span class="keyword">const</span> <a class="code" href="structquda_1_1_gauge_field_param.html">GaugeFieldParam</a> &amp;<a class="code" href="pack__test_8cpp.html#aba126262dff054e28bac5c0d901769c8">param</a>) :</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;    <a class="code" href="classquda_1_1_gauge_field.html">GaugeField</a>(param)</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;  {</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classquda_1_1_lattice_field.html#a6535520c1cb96795a40de1df52218f2d">precision</a> == <a class="code" href="enum__quda_8h.html#ac166c47d6ef16f830c164fefe6c8ab90afb568427ae928d5a1330ee47ef03c0b6">QUDA_HALF_PRECISION</a>) {</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;      <a class="code" href="util__quda_8h.html#af3bddfd9d113d50e8e0bbf58a35c5aac">errorQuda</a>(<span class="stringliteral">&quot;CPU fields do not support half precision&quot;</span>);</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    }</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classquda_1_1_lattice_field.html#a6535520c1cb96795a40de1df52218f2d">precision</a> == <a class="code" href="enum__quda_8h.html#ac166c47d6ef16f830c164fefe6c8ab90aeac943998f9a94180aa7e472599219c5">QUDA_QUARTER_PRECISION</a>) {</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;      <a class="code" href="util__quda_8h.html#af3bddfd9d113d50e8e0bbf58a35c5aac">errorQuda</a>(<span class="stringliteral">&quot;CPU fields do not support quarter precision&quot;</span>);</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    }</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classquda_1_1_lattice_field.html#a4793744a29f95009914eaa10b174bb94">pad</a> != 0) {</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;      <a class="code" href="util__quda_8h.html#af3bddfd9d113d50e8e0bbf58a35c5aac">errorQuda</a>(<span class="stringliteral">&quot;CPU fields do not support non-zero padding&quot;</span>);</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    }</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classquda_1_1_gauge_field.html#ae89fead7b7a46d6ccdb04041373f0632">reconstruct</a> != <a class="code" href="enum__quda_8h.html#a5cc304be12bc9174274636e1e7863841a41ab3553ef10af8aeb118f39d8f1e935">QUDA_RECONSTRUCT_NO</a> &amp;&amp; <a class="code" href="classquda_1_1_gauge_field.html#ae89fead7b7a46d6ccdb04041373f0632">reconstruct</a> != <a class="code" href="enum__quda_8h.html#a5cc304be12bc9174274636e1e7863841ac73ec20dcdd9bb298a7615e70b70799d">QUDA_RECONSTRUCT_10</a>) {</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;      <a class="code" href="util__quda_8h.html#af3bddfd9d113d50e8e0bbf58a35c5aac">errorQuda</a>(<span class="stringliteral">&quot;Reconstruction type %d not supported&quot;</span>, <a class="code" href="classquda_1_1_gauge_field.html#ae89fead7b7a46d6ccdb04041373f0632">reconstruct</a>);</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    }</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classquda_1_1_gauge_field.html#ae89fead7b7a46d6ccdb04041373f0632">reconstruct</a> == <a class="code" href="enum__quda_8h.html#a5cc304be12bc9174274636e1e7863841ac73ec20dcdd9bb298a7615e70b70799d">QUDA_RECONSTRUCT_10</a> &amp;&amp; <a class="code" href="classquda_1_1_gauge_field.html#a3d8cbee3feea3f19fb40d3c28de398e3">order</a> != <a class="code" href="enum__quda_8h.html#acb61fdc14d6b12e8c6177b6d966bd863adb1a4116b2cbd52bd33641d7400f0989">QUDA_MILC_GAUGE_ORDER</a> &amp;&amp; <a class="code" href="classquda_1_1_gauge_field.html#a3d8cbee3feea3f19fb40d3c28de398e3">order</a> != <a class="code" href="enum__quda_8h.html#acb61fdc14d6b12e8c6177b6d966bd863aa471b8765e76921b5954482c63393c28">QUDA_MILC_SITE_GAUGE_ORDER</a>) {</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;      <a class="code" href="util__quda_8h.html#af3bddfd9d113d50e8e0bbf58a35c5aac">errorQuda</a>(<span class="stringliteral">&quot;10-reconstruction only supported with MILC gauge order&quot;</span>);</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    }</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="keywordtype">int</span> siteDim=0;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classquda_1_1_gauge_field.html#ae13bc82ef4474f3d89b3a25e2000f936">geometry</a> == <a class="code" href="enum__quda_8h.html#a7589b295019a40887f1c10c76555feeaa090d4c508b643d4c75242cb54b8fa819">QUDA_SCALAR_GEOMETRY</a>) siteDim = 1;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classquda_1_1_gauge_field.html#ae13bc82ef4474f3d89b3a25e2000f936">geometry</a> == <a class="code" href="enum__quda_8h.html#a7589b295019a40887f1c10c76555feeaa2cc101847eb2a925159b08346100da2d">QUDA_VECTOR_GEOMETRY</a>) siteDim = <a class="code" href="classquda_1_1_lattice_field.html#a4ce6b8f181b1cbfaa755160e69fa85e7">nDim</a>;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classquda_1_1_gauge_field.html#ae13bc82ef4474f3d89b3a25e2000f936">geometry</a> == <a class="code" href="enum__quda_8h.html#a7589b295019a40887f1c10c76555feeaadad7f340080258c972d126a9b8b571b3">QUDA_TENSOR_GEOMETRY</a>) siteDim = <a class="code" href="classquda_1_1_lattice_field.html#a4ce6b8f181b1cbfaa755160e69fa85e7">nDim</a> * (<a class="code" href="classquda_1_1_lattice_field.html#a4ce6b8f181b1cbfaa755160e69fa85e7">nDim</a>-1) / 2;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classquda_1_1_gauge_field.html#ae13bc82ef4474f3d89b3a25e2000f936">geometry</a> == <a class="code" href="enum__quda_8h.html#a7589b295019a40887f1c10c76555feeaadc1a5ef802228fe4edd42346172c7605">QUDA_COARSE_GEOMETRY</a>) siteDim = 2*<a class="code" href="classquda_1_1_lattice_field.html#a4ce6b8f181b1cbfaa755160e69fa85e7">nDim</a>;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="keywordflow">else</span> <a class="code" href="util__quda_8h.html#af3bddfd9d113d50e8e0bbf58a35c5aac">errorQuda</a>(<span class="stringliteral">&quot;Unknown geometry type %d&quot;</span>, <a class="code" href="classquda_1_1_gauge_field.html#ae13bc82ef4474f3d89b3a25e2000f936">geometry</a>);</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="comment">// compute the correct bytes size for these padded field orders</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classquda_1_1_gauge_field.html#a3d8cbee3feea3f19fb40d3c28de398e3">order</a> == <a class="code" href="enum__quda_8h.html#acb61fdc14d6b12e8c6177b6d966bd863ada452210f42cce91ccd6c4f1d4650576">QUDA_TIFR_PADDED_GAUGE_ORDER</a>) {</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;      <a class="code" href="classquda_1_1_gauge_field.html#a8f2517a9224f01ad813a3262dc541edf">bytes</a> = siteDim * (<a class="code" href="classquda_1_1_lattice_field.html#a45f997815ff8532102798a5fdfcde416">x</a>[0]*<a class="code" href="classquda_1_1_lattice_field.html#a45f997815ff8532102798a5fdfcde416">x</a>[1]*(<a class="code" href="classquda_1_1_lattice_field.html#a45f997815ff8532102798a5fdfcde416">x</a>[2]+4)*<a class="code" href="classquda_1_1_lattice_field.html#a45f997815ff8532102798a5fdfcde416">x</a>[3]) * <a class="code" href="classquda_1_1_gauge_field.html#a3b7da036cfa15d6d8d65acac1cf41e2a">nInternal</a> * <a class="code" href="classquda_1_1_lattice_field.html#a6535520c1cb96795a40de1df52218f2d">precision</a>;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classquda_1_1_gauge_field.html#a3d8cbee3feea3f19fb40d3c28de398e3">order</a> == <a class="code" href="enum__quda_8h.html#acb61fdc14d6b12e8c6177b6d966bd863a335830aa4556580bfcf73019615ec35d">QUDA_BQCD_GAUGE_ORDER</a>) {</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;      <a class="code" href="classquda_1_1_gauge_field.html#a8f2517a9224f01ad813a3262dc541edf">bytes</a> = siteDim * (<a class="code" href="classquda_1_1_lattice_field.html#a45f997815ff8532102798a5fdfcde416">x</a>[0]+4)*(<a class="code" href="classquda_1_1_lattice_field.html#a45f997815ff8532102798a5fdfcde416">x</a>[1]+2)*(<a class="code" href="classquda_1_1_lattice_field.html#a45f997815ff8532102798a5fdfcde416">x</a>[2]+2)*(<a class="code" href="classquda_1_1_lattice_field.html#a45f997815ff8532102798a5fdfcde416">x</a>[3]+2) * <a class="code" href="classquda_1_1_gauge_field.html#a3b7da036cfa15d6d8d65acac1cf41e2a">nInternal</a> * <a class="code" href="classquda_1_1_lattice_field.html#a6535520c1cb96795a40de1df52218f2d">precision</a>;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classquda_1_1_gauge_field.html#a3d8cbee3feea3f19fb40d3c28de398e3">order</a> == <a class="code" href="enum__quda_8h.html#acb61fdc14d6b12e8c6177b6d966bd863aa471b8765e76921b5954482c63393c28">QUDA_MILC_SITE_GAUGE_ORDER</a>) {</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;      <a class="code" href="classquda_1_1_gauge_field.html#a8f2517a9224f01ad813a3262dc541edf">bytes</a> = <a class="code" href="classquda_1_1_lattice_field.html#a0bca0fd77c8e1820a4788a19131922f5">volume</a> * <a class="code" href="classquda_1_1_gauge_field.html#a5169ef7014b57198e730f3df202a1be5">site_size</a>;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    }</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classquda_1_1_gauge_field.html#a3d8cbee3feea3f19fb40d3c28de398e3">order</a> == <a class="code" href="enum__quda_8h.html#acb61fdc14d6b12e8c6177b6d966bd863a85ce3606ffcab0df5df3e6d2b069edc9">QUDA_QDP_GAUGE_ORDER</a>) {</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;      <a class="code" href="classquda_1_1cpu_gauge_field.html#ae36e574312c5cb03633ee75cd75c1901">gauge</a> = (<span class="keywordtype">void</span>**) <a class="code" href="malloc__quda_8h.html#a45d92b2c2231b848192b3086283d05b6">safe_malloc</a>(siteDim * <span class="keyword">sizeof</span>(<span class="keywordtype">void</span>*));</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d=0; d&lt;siteDim; d++) {</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="keywordtype">size_t</span> nbytes = <a class="code" href="classquda_1_1_lattice_field.html#a0bca0fd77c8e1820a4788a19131922f5">volume</a> * <a class="code" href="classquda_1_1_gauge_field.html#a3b7da036cfa15d6d8d65acac1cf41e2a">nInternal</a> * <a class="code" href="classquda_1_1_lattice_field.html#a6535520c1cb96795a40de1df52218f2d">precision</a>;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classquda_1_1_gauge_field.html#a0c619418f3faa2dddbb7547bffe9aa77">create</a> == <a class="code" href="enum__quda_8h.html#ae3c3f9e9961c64a4a34f144d8f87f805aea1e25f58c180e12c9285f26f53f973d">QUDA_NULL_FIELD_CREATE</a> || <a class="code" href="classquda_1_1_gauge_field.html#a0c619418f3faa2dddbb7547bffe9aa77">create</a> == <a class="code" href="enum__quda_8h.html#ae3c3f9e9961c64a4a34f144d8f87f805a0a7b5b5ebe4058a465669eee83915158">QUDA_ZERO_FIELD_CREATE</a>) {</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <a class="code" href="classquda_1_1cpu_gauge_field.html#ae36e574312c5cb03633ee75cd75c1901">gauge</a>[d] = <a class="code" href="malloc__quda_8h.html#a45d92b2c2231b848192b3086283d05b6">safe_malloc</a>(nbytes);</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classquda_1_1_gauge_field.html#a0c619418f3faa2dddbb7547bffe9aa77">create</a> == <a class="code" href="enum__quda_8h.html#ae3c3f9e9961c64a4a34f144d8f87f805a0a7b5b5ebe4058a465669eee83915158">QUDA_ZERO_FIELD_CREATE</a>) <a class="code" href="covdev__reference_8cpp.html#ace6ee45c30e71865e6eb635200379db9">memset</a>(<a class="code" href="classquda_1_1cpu_gauge_field.html#ae36e574312c5cb03633ee75cd75c1901">gauge</a>[d], 0, nbytes);</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classquda_1_1_gauge_field.html#a0c619418f3faa2dddbb7547bffe9aa77">create</a> == <a class="code" href="enum__quda_8h.html#ae3c3f9e9961c64a4a34f144d8f87f805ab0249b95aff915ee4dceca49f75b7f72">QUDA_REFERENCE_FIELD_CREATE</a>) {</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <a class="code" href="classquda_1_1cpu_gauge_field.html#ae36e574312c5cb03633ee75cd75c1901">gauge</a>[d] = ((<span class="keywordtype">void</span>**)param.<a class="code" href="structquda_1_1_gauge_field_param.html#a7770a935ed1d6c57d15a993c60ac5734">gauge</a>)[d];</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <a class="code" href="util__quda_8h.html#af3bddfd9d113d50e8e0bbf58a35c5aac">errorQuda</a>(<span class="stringliteral">&quot;Unsupported creation type %d&quot;</span>, <a class="code" href="classquda_1_1_gauge_field.html#a0c619418f3faa2dddbb7547bffe9aa77">create</a>);</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  }</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      }</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    </div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classquda_1_1_gauge_field.html#a3d8cbee3feea3f19fb40d3c28de398e3">order</a> == <a class="code" href="enum__quda_8h.html#acb61fdc14d6b12e8c6177b6d966bd863aa8e1a6764fc9b8a9abaed9f20faf56e6">QUDA_CPS_WILSON_GAUGE_ORDER</a> || <a class="code" href="classquda_1_1_gauge_field.html#a3d8cbee3feea3f19fb40d3c28de398e3">order</a> == <a class="code" href="enum__quda_8h.html#acb61fdc14d6b12e8c6177b6d966bd863adb1a4116b2cbd52bd33641d7400f0989">QUDA_MILC_GAUGE_ORDER</a>  ||</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;         <a class="code" href="classquda_1_1_gauge_field.html#a3d8cbee3feea3f19fb40d3c28de398e3">order</a> == <a class="code" href="enum__quda_8h.html#acb61fdc14d6b12e8c6177b6d966bd863a335830aa4556580bfcf73019615ec35d">QUDA_BQCD_GAUGE_ORDER</a> || <a class="code" href="classquda_1_1_gauge_field.html#a3d8cbee3feea3f19fb40d3c28de398e3">order</a> == <a class="code" href="enum__quda_8h.html#acb61fdc14d6b12e8c6177b6d966bd863a4ba8fd46dcb8d319a6632eebbe2da32b">QUDA_TIFR_GAUGE_ORDER</a> ||</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;         <a class="code" href="classquda_1_1_gauge_field.html#a3d8cbee3feea3f19fb40d3c28de398e3">order</a> == <a class="code" href="enum__quda_8h.html#acb61fdc14d6b12e8c6177b6d966bd863ada452210f42cce91ccd6c4f1d4650576">QUDA_TIFR_PADDED_GAUGE_ORDER</a> || <a class="code" href="classquda_1_1_gauge_field.html#a3d8cbee3feea3f19fb40d3c28de398e3">order</a> == <a class="code" href="enum__quda_8h.html#acb61fdc14d6b12e8c6177b6d966bd863aa471b8765e76921b5954482c63393c28">QUDA_MILC_SITE_GAUGE_ORDER</a>) {</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classquda_1_1_gauge_field.html#a3d8cbee3feea3f19fb40d3c28de398e3">order</a> == <a class="code" href="enum__quda_8h.html#acb61fdc14d6b12e8c6177b6d966bd863aa471b8765e76921b5954482c63393c28">QUDA_MILC_SITE_GAUGE_ORDER</a> &amp;&amp; <a class="code" href="classquda_1_1_gauge_field.html#a0c619418f3faa2dddbb7547bffe9aa77">create</a> != <a class="code" href="enum__quda_8h.html#ae3c3f9e9961c64a4a34f144d8f87f805ab0249b95aff915ee4dceca49f75b7f72">QUDA_REFERENCE_FIELD_CREATE</a>) {</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <a class="code" href="util__quda_8h.html#af3bddfd9d113d50e8e0bbf58a35c5aac">errorQuda</a>(<span class="stringliteral">&quot;MILC site gauge order only supported for reference fields&quot;</span>);</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      }</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classquda_1_1_gauge_field.html#a0c619418f3faa2dddbb7547bffe9aa77">create</a> == <a class="code" href="enum__quda_8h.html#ae3c3f9e9961c64a4a34f144d8f87f805aea1e25f58c180e12c9285f26f53f973d">QUDA_NULL_FIELD_CREATE</a> || <a class="code" href="classquda_1_1_gauge_field.html#a0c619418f3faa2dddbb7547bffe9aa77">create</a> == <a class="code" href="enum__quda_8h.html#ae3c3f9e9961c64a4a34f144d8f87f805a0a7b5b5ebe4058a465669eee83915158">QUDA_ZERO_FIELD_CREATE</a>) {</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <a class="code" href="classquda_1_1cpu_gauge_field.html#ae36e574312c5cb03633ee75cd75c1901">gauge</a> = (<span class="keywordtype">void</span> **) <a class="code" href="malloc__quda_8h.html#a45d92b2c2231b848192b3086283d05b6">safe_malloc</a>(<a class="code" href="classquda_1_1_gauge_field.html#a8f2517a9224f01ad813a3262dc541edf">bytes</a>);</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classquda_1_1_gauge_field.html#a0c619418f3faa2dddbb7547bffe9aa77">create</a> == <a class="code" href="enum__quda_8h.html#ae3c3f9e9961c64a4a34f144d8f87f805a0a7b5b5ebe4058a465669eee83915158">QUDA_ZERO_FIELD_CREATE</a>) <a class="code" href="covdev__reference_8cpp.html#ace6ee45c30e71865e6eb635200379db9">memset</a>(<a class="code" href="classquda_1_1cpu_gauge_field.html#ae36e574312c5cb03633ee75cd75c1901">gauge</a>, 0, <a class="code" href="classquda_1_1_gauge_field.html#a8f2517a9224f01ad813a3262dc541edf">bytes</a>);</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classquda_1_1_gauge_field.html#a0c619418f3faa2dddbb7547bffe9aa77">create</a> == <a class="code" href="enum__quda_8h.html#ae3c3f9e9961c64a4a34f144d8f87f805ab0249b95aff915ee4dceca49f75b7f72">QUDA_REFERENCE_FIELD_CREATE</a>) {</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <a class="code" href="classquda_1_1cpu_gauge_field.html#ae36e574312c5cb03633ee75cd75c1901">gauge</a> = (<span class="keywordtype">void</span>**) param.<a class="code" href="structquda_1_1_gauge_field_param.html#a7770a935ed1d6c57d15a993c60ac5734">gauge</a>;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <a class="code" href="util__quda_8h.html#af3bddfd9d113d50e8e0bbf58a35c5aac">errorQuda</a>(<span class="stringliteral">&quot;Unsupported creation type %d&quot;</span>, <a class="code" href="classquda_1_1_gauge_field.html#a0c619418f3faa2dddbb7547bffe9aa77">create</a>);</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      }</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      <a class="code" href="util__quda_8h.html#af3bddfd9d113d50e8e0bbf58a35c5aac">errorQuda</a>(<span class="stringliteral">&quot;Unsupported gauge order type %d&quot;</span>, <a class="code" href="classquda_1_1_gauge_field.html#a3d8cbee3feea3f19fb40d3c28de398e3">order</a>);</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    }</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  </div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="comment">// no need to exchange data if this is a momentum field</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classquda_1_1_gauge_field.html#a03852c1e5b42346de487927370ea3d36">link_type</a> != <a class="code" href="enum__quda_8h.html#af0b4185ef9aa540e660716ff1697b299a200651a50fc1d3ab3df3763724c6d812">QUDA_ASQTAD_MOM_LINKS</a>) {</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      <span class="comment">// Ghost zone is always 2-dimensional    </span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classquda_1_1_lattice_field.html#a4ce6b8f181b1cbfaa755160e69fa85e7">nDim</a>; i++) {</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <span class="keywordtype">size_t</span> nbytes = <a class="code" href="classquda_1_1_gauge_field.html#a9c069c0771836252674aa8dd009c2c49">nFace</a> * <a class="code" href="classquda_1_1_lattice_field.html#a9b454a5960bbe5c51085185de2a58ba5">surface</a>[i] * <a class="code" href="classquda_1_1_gauge_field.html#a3b7da036cfa15d6d8d65acac1cf41e2a">nInternal</a> * <a class="code" href="classquda_1_1_lattice_field.html#a6535520c1cb96795a40de1df52218f2d">precision</a>;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <a class="code" href="classquda_1_1_gauge_field.html#a126627f0f24e3bacedb464ae5061216a">ghost</a>[i] = nbytes ? <a class="code" href="malloc__quda_8h.html#a45d92b2c2231b848192b3086283d05b6">safe_malloc</a>(nbytes) : <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <a class="code" href="classquda_1_1_gauge_field.html#a126627f0f24e3bacedb464ae5061216a">ghost</a>[i+4] = (nbytes &amp;&amp; <a class="code" href="classquda_1_1_gauge_field.html#ae13bc82ef4474f3d89b3a25e2000f936">geometry</a> == <a class="code" href="enum__quda_8h.html#a7589b295019a40887f1c10c76555feeaadc1a5ef802228fe4edd42346172c7605">QUDA_COARSE_GEOMETRY</a>) ? <a class="code" href="malloc__quda_8h.html#a45d92b2c2231b848192b3086283d05b6">safe_malloc</a>(nbytes) : <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      }</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classquda_1_1_lattice_field.html#a038242dabcf96173e013f3588d0476de">ghostExchange</a> == <a class="code" href="enum__quda_8h.html#a93131cceecad27ce4b964cb184e8d47aaab94b36fc680dd39f976636dac350e53">QUDA_GHOST_EXCHANGE_PAD</a>) {</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="comment">// exchange the boundaries if a non-trivial field</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classquda_1_1_gauge_field.html#a0c619418f3faa2dddbb7547bffe9aa77">create</a> != <a class="code" href="enum__quda_8h.html#ae3c3f9e9961c64a4a34f144d8f87f805aea1e25f58c180e12c9285f26f53f973d">QUDA_NULL_FIELD_CREATE</a> &amp;&amp; <a class="code" href="classquda_1_1_gauge_field.html#a0c619418f3faa2dddbb7547bffe9aa77">create</a> != <a class="code" href="enum__quda_8h.html#ae3c3f9e9961c64a4a34f144d8f87f805a0a7b5b5ebe4058a465669eee83915158">QUDA_ZERO_FIELD_CREATE</a> &amp;&amp;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      (<a class="code" href="classquda_1_1_gauge_field.html#ae13bc82ef4474f3d89b3a25e2000f936">geometry</a> == <a class="code" href="enum__quda_8h.html#a7589b295019a40887f1c10c76555feeaa2cc101847eb2a925159b08346100da2d">QUDA_VECTOR_GEOMETRY</a> || <a class="code" href="classquda_1_1_gauge_field.html#ae13bc82ef4474f3d89b3a25e2000f936">geometry</a> == <a class="code" href="enum__quda_8h.html#a7589b295019a40887f1c10c76555feeaadc1a5ef802228fe4edd42346172c7605">QUDA_COARSE_GEOMETRY</a>) )</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <a class="code" href="classquda_1_1cpu_gauge_field.html#abcb214de4fba03d89b8d4a83db847b1d">exchangeGhost</a>(<a class="code" href="classquda_1_1_gauge_field.html#ae13bc82ef4474f3d89b3a25e2000f936">geometry</a> == <a class="code" href="enum__quda_8h.html#a7589b295019a40887f1c10c76555feeaa2cc101847eb2a925159b08346100da2d">QUDA_VECTOR_GEOMETRY</a> ? <a class="code" href="enum__quda_8h.html#a4cad225f00aa7a2e65b0513cc2f4b053ac73041d95c92af38448501907265b43b">QUDA_LINK_BACKWARDS</a> : <a class="code" href="enum__quda_8h.html#a4cad225f00aa7a2e65b0513cc2f4b053a70977ca93ce71cc94cd6a9dcd3625f8b">QUDA_LINK_BIDIRECTIONAL</a>);</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;      }</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    }</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="comment">// compute the fat link max now in case it is needed later (i.e., for half precision)</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="keywordflow">if</span> (param.<a class="code" href="structquda_1_1_gauge_field_param.html#aad5aed7f9db904d6a40d696e3b5c4108">compute_fat_link_max</a>) <a class="code" href="classquda_1_1_gauge_field.html#a78d11ce3fbd8e63151ee5f12eb874733">fat_link_max</a> = this-&gt;<a class="code" href="classquda_1_1_gauge_field.html#a612a0607a564fdd24cc803223cd00a44">abs_max</a>();</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  }</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div><div class="line"><a name="l00102"></a><span class="lineno"><a class="line" href="classquda_1_1cpu_gauge_field.html#a39d563f4f56b019f34c81699678993a8">  102</a></span>&#160;  <a class="code" href="classquda_1_1cpu_gauge_field.html#a39d563f4f56b019f34c81699678993a8">cpuGaugeField::~cpuGaugeField</a>()</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  {</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="keywordtype">int</span> siteDim = 0;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classquda_1_1_gauge_field.html#ae13bc82ef4474f3d89b3a25e2000f936">geometry</a> == <a class="code" href="enum__quda_8h.html#a7589b295019a40887f1c10c76555feeaa090d4c508b643d4c75242cb54b8fa819">QUDA_SCALAR_GEOMETRY</a>) siteDim = 1;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classquda_1_1_gauge_field.html#ae13bc82ef4474f3d89b3a25e2000f936">geometry</a> == <a class="code" href="enum__quda_8h.html#a7589b295019a40887f1c10c76555feeaa2cc101847eb2a925159b08346100da2d">QUDA_VECTOR_GEOMETRY</a>) siteDim = <a class="code" href="classquda_1_1_lattice_field.html#a4ce6b8f181b1cbfaa755160e69fa85e7">nDim</a>;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classquda_1_1_gauge_field.html#ae13bc82ef4474f3d89b3a25e2000f936">geometry</a> == <a class="code" href="enum__quda_8h.html#a7589b295019a40887f1c10c76555feeaadad7f340080258c972d126a9b8b571b3">QUDA_TENSOR_GEOMETRY</a>) siteDim = <a class="code" href="classquda_1_1_lattice_field.html#a4ce6b8f181b1cbfaa755160e69fa85e7">nDim</a> * (<a class="code" href="classquda_1_1_lattice_field.html#a4ce6b8f181b1cbfaa755160e69fa85e7">nDim</a>-1) / 2;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classquda_1_1_gauge_field.html#ae13bc82ef4474f3d89b3a25e2000f936">geometry</a> == <a class="code" href="enum__quda_8h.html#a7589b295019a40887f1c10c76555feeaadc1a5ef802228fe4edd42346172c7605">QUDA_COARSE_GEOMETRY</a>) siteDim = 2*<a class="code" href="classquda_1_1_lattice_field.html#a4ce6b8f181b1cbfaa755160e69fa85e7">nDim</a>;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="keywordflow">else</span> <a class="code" href="util__quda_8h.html#af3bddfd9d113d50e8e0bbf58a35c5aac">errorQuda</a>(<span class="stringliteral">&quot;Unknown geometry type %d&quot;</span>, <a class="code" href="classquda_1_1_gauge_field.html#ae13bc82ef4474f3d89b3a25e2000f936">geometry</a>);</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classquda_1_1_gauge_field.html#a0c619418f3faa2dddbb7547bffe9aa77">create</a> == <a class="code" href="enum__quda_8h.html#ae3c3f9e9961c64a4a34f144d8f87f805aea1e25f58c180e12c9285f26f53f973d">QUDA_NULL_FIELD_CREATE</a> || <a class="code" href="classquda_1_1_gauge_field.html#a0c619418f3faa2dddbb7547bffe9aa77">create</a> == <a class="code" href="enum__quda_8h.html#ae3c3f9e9961c64a4a34f144d8f87f805a0a7b5b5ebe4058a465669eee83915158">QUDA_ZERO_FIELD_CREATE</a>) {</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classquda_1_1_gauge_field.html#a3d8cbee3feea3f19fb40d3c28de398e3">order</a> == <a class="code" href="enum__quda_8h.html#acb61fdc14d6b12e8c6177b6d966bd863a85ce3606ffcab0df5df3e6d2b069edc9">QUDA_QDP_GAUGE_ORDER</a>) {</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d=0; d&lt;siteDim; d++) {</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classquda_1_1cpu_gauge_field.html#ae36e574312c5cb03633ee75cd75c1901">gauge</a>[d]) <a class="code" href="malloc__quda_8h.html#ad733cb3f6cac705c8db7b0afad9b3843">host_free</a>(<a class="code" href="classquda_1_1cpu_gauge_field.html#ae36e574312c5cb03633ee75cd75c1901">gauge</a>[d]);</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  }</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classquda_1_1cpu_gauge_field.html#ae36e574312c5cb03633ee75cd75c1901">gauge</a>) <a class="code" href="malloc__quda_8h.html#ad733cb3f6cac705c8db7b0afad9b3843">host_free</a>(<a class="code" href="classquda_1_1cpu_gauge_field.html#ae36e574312c5cb03633ee75cd75c1901">gauge</a>);</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classquda_1_1cpu_gauge_field.html#ae36e574312c5cb03633ee75cd75c1901">gauge</a>) <a class="code" href="malloc__quda_8h.html#ad733cb3f6cac705c8db7b0afad9b3843">host_free</a>(<a class="code" href="classquda_1_1cpu_gauge_field.html#ae36e574312c5cb03633ee75cd75c1901">gauge</a>);</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      }</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    } <span class="keywordflow">else</span> { <span class="comment">// QUDA_REFERENCE_FIELD_CREATE </span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classquda_1_1_gauge_field.html#a3d8cbee3feea3f19fb40d3c28de398e3">order</a> == <a class="code" href="enum__quda_8h.html#acb61fdc14d6b12e8c6177b6d966bd863a85ce3606ffcab0df5df3e6d2b069edc9">QUDA_QDP_GAUGE_ORDER</a>){</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classquda_1_1cpu_gauge_field.html#ae36e574312c5cb03633ee75cd75c1901">gauge</a>) <a class="code" href="malloc__quda_8h.html#ad733cb3f6cac705c8db7b0afad9b3843">host_free</a>(<a class="code" href="classquda_1_1cpu_gauge_field.html#ae36e574312c5cb03633ee75cd75c1901">gauge</a>);</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      }</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    }</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  </div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classquda_1_1_gauge_field.html#a03852c1e5b42346de487927370ea3d36">link_type</a> != <a class="code" href="enum__quda_8h.html#af0b4185ef9aa540e660716ff1697b299a200651a50fc1d3ab3df3763724c6d812">QUDA_ASQTAD_MOM_LINKS</a>) {</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classquda_1_1_lattice_field.html#a4ce6b8f181b1cbfaa755160e69fa85e7">nDim</a>; i++) {</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classquda_1_1_gauge_field.html#a126627f0f24e3bacedb464ae5061216a">ghost</a>[i]) <a class="code" href="malloc__quda_8h.html#ad733cb3f6cac705c8db7b0afad9b3843">host_free</a>(<a class="code" href="classquda_1_1_gauge_field.html#a126627f0f24e3bacedb464ae5061216a">ghost</a>[i]);</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classquda_1_1_gauge_field.html#a126627f0f24e3bacedb464ae5061216a">ghost</a>[i+4] &amp;&amp; <a class="code" href="classquda_1_1_gauge_field.html#ae13bc82ef4474f3d89b3a25e2000f936">geometry</a> == <a class="code" href="enum__quda_8h.html#a7589b295019a40887f1c10c76555feeaadc1a5ef802228fe4edd42346172c7605">QUDA_COARSE_GEOMETRY</a>) <a class="code" href="malloc__quda_8h.html#ad733cb3f6cac705c8db7b0afad9b3843">host_free</a>(<a class="code" href="classquda_1_1_gauge_field.html#a126627f0f24e3bacedb464ae5061216a">ghost</a>[i+4]);</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      }</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    }</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  }</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <span class="comment">// This does the exchange of the gauge field ghost zone and places it</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <span class="comment">// into the ghost array.</span></div><div class="line"><a name="l00136"></a><span class="lineno"><a class="line" href="classquda_1_1cpu_gauge_field.html#abcb214de4fba03d89b8d4a83db847b1d">  136</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classquda_1_1cpu_gauge_field.html#abcb214de4fba03d89b8d4a83db847b1d">cpuGaugeField::exchangeGhost</a>(<a class="code" href="enum__quda_8h.html#ac15ce1c1afbc117e224b553c8efd5ab7">QudaLinkDirection</a> link_direction) {</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classquda_1_1_gauge_field.html#ae13bc82ef4474f3d89b3a25e2000f936">geometry</a> != <a class="code" href="enum__quda_8h.html#a7589b295019a40887f1c10c76555feeaa2cc101847eb2a925159b08346100da2d">QUDA_VECTOR_GEOMETRY</a> &amp;&amp; <a class="code" href="classquda_1_1_gauge_field.html#ae13bc82ef4474f3d89b3a25e2000f936">geometry</a> != <a class="code" href="enum__quda_8h.html#a7589b295019a40887f1c10c76555feeaadc1a5ef802228fe4edd42346172c7605">QUDA_COARSE_GEOMETRY</a>)</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      <a class="code" href="util__quda_8h.html#af3bddfd9d113d50e8e0bbf58a35c5aac">errorQuda</a>(<span class="stringliteral">&quot;Cannot exchange for %d geometry gauge field&quot;</span>, <a class="code" href="classquda_1_1_gauge_field.html#ae13bc82ef4474f3d89b3a25e2000f936">geometry</a>);</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="keywordflow">if</span> ( (link_direction == <a class="code" href="enum__quda_8h.html#a4cad225f00aa7a2e65b0513cc2f4b053a70977ca93ce71cc94cd6a9dcd3625f8b">QUDA_LINK_BIDIRECTIONAL</a> || link_direction == <a class="code" href="enum__quda_8h.html#a4cad225f00aa7a2e65b0513cc2f4b053a764569276c09b35b0923e684b8585821">QUDA_LINK_FORWARDS</a>) &amp;&amp; <a class="code" href="classquda_1_1_gauge_field.html#ae13bc82ef4474f3d89b3a25e2000f936">geometry</a> != <a class="code" href="enum__quda_8h.html#a7589b295019a40887f1c10c76555feeaadc1a5ef802228fe4edd42346172c7605">QUDA_COARSE_GEOMETRY</a>)</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      <a class="code" href="util__quda_8h.html#af3bddfd9d113d50e8e0bbf58a35c5aac">errorQuda</a>(<span class="stringliteral">&quot;Cannot request exchange of forward links on non-coarse geometry&quot;</span>);</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="keywordtype">void</span> *send[2*<a class="code" href="quda__constants_8h.html#aa69925e50554e0ea81dd89fdcb572bbc">QUDA_MAX_DIM</a>];</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d=0; d&lt;<a class="code" href="classquda_1_1_lattice_field.html#a4ce6b8f181b1cbfaa755160e69fa85e7">nDim</a>; d++) {</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      send[d] = <a class="code" href="malloc__quda_8h.html#a45d92b2c2231b848192b3086283d05b6">safe_malloc</a>(<a class="code" href="classquda_1_1_gauge_field.html#a9c069c0771836252674aa8dd009c2c49">nFace</a>*<a class="code" href="classquda_1_1_lattice_field.html#a9b454a5960bbe5c51085185de2a58ba5">surface</a>[d]*<a class="code" href="classquda_1_1_gauge_field.html#a3b7da036cfa15d6d8d65acac1cf41e2a">nInternal</a>*<a class="code" href="classquda_1_1_lattice_field.html#a6535520c1cb96795a40de1df52218f2d">precision</a>);</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classquda_1_1_gauge_field.html#ae13bc82ef4474f3d89b3a25e2000f936">geometry</a> == <a class="code" href="enum__quda_8h.html#a7589b295019a40887f1c10c76555feeaadc1a5ef802228fe4edd42346172c7605">QUDA_COARSE_GEOMETRY</a>) send[d+4] = <a class="code" href="malloc__quda_8h.html#a45d92b2c2231b848192b3086283d05b6">safe_malloc</a>(<a class="code" href="classquda_1_1_gauge_field.html#a9c069c0771836252674aa8dd009c2c49">nFace</a>*<a class="code" href="classquda_1_1_lattice_field.html#a9b454a5960bbe5c51085185de2a58ba5">surface</a>[d]*<a class="code" href="classquda_1_1_gauge_field.html#a3b7da036cfa15d6d8d65acac1cf41e2a">nInternal</a>*precision);</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    }</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="keywordflow">if</span> (link_direction == <a class="code" href="enum__quda_8h.html#a4cad225f00aa7a2e65b0513cc2f4b053ac73041d95c92af38448501907265b43b">QUDA_LINK_BACKWARDS</a> || link_direction == <a class="code" href="enum__quda_8h.html#a4cad225f00aa7a2e65b0513cc2f4b053a70977ca93ce71cc94cd6a9dcd3625f8b">QUDA_LINK_BIDIRECTIONAL</a>) {</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      <span class="comment">// get the links into contiguous buffers</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      <a class="code" href="namespacequda.html#a30c73bae2ad5e120dd0c2fea452b7924">extractGaugeGhost</a>(*<span class="keyword">this</span>, send, <span class="keyword">true</span>);</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      <span class="comment">// communicate between nodes</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;      <a class="code" href="classquda_1_1_gauge_field.html#a93b1219a2b9d0a7540162587f756a913">exchange</a>(<a class="code" href="classquda_1_1_gauge_field.html#a126627f0f24e3bacedb464ae5061216a">ghost</a>, send, <a class="code" href="enum__quda_8h.html#a91c65a84d19d3d74f84fa06888d256b0a7f0d3766d3d7f169d8afffb789d0329b">QUDA_FORWARDS</a>);</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    }</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="comment">// repeat if requested and links are bi-directional</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keywordflow">if</span> (link_direction == <a class="code" href="enum__quda_8h.html#a4cad225f00aa7a2e65b0513cc2f4b053a764569276c09b35b0923e684b8585821">QUDA_LINK_FORWARDS</a> || link_direction == <a class="code" href="enum__quda_8h.html#a4cad225f00aa7a2e65b0513cc2f4b053a70977ca93ce71cc94cd6a9dcd3625f8b">QUDA_LINK_BIDIRECTIONAL</a>) {</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      <a class="code" href="namespacequda.html#a30c73bae2ad5e120dd0c2fea452b7924">extractGaugeGhost</a>(*<span class="keyword">this</span>, send, <span class="keyword">true</span>, nDim);</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      <a class="code" href="classquda_1_1_gauge_field.html#a93b1219a2b9d0a7540162587f756a913">exchange</a>(<a class="code" href="classquda_1_1_gauge_field.html#a126627f0f24e3bacedb464ae5061216a">ghost</a>+nDim, send+nDim, <a class="code" href="enum__quda_8h.html#a91c65a84d19d3d74f84fa06888d256b0a7f0d3766d3d7f169d8afffb789d0329b">QUDA_FORWARDS</a>);</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    }</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d=0; d&lt;<a class="code" href="classquda_1_1_gauge_field.html#ae13bc82ef4474f3d89b3a25e2000f936">geometry</a>; d++) <a class="code" href="malloc__quda_8h.html#ad733cb3f6cac705c8db7b0afad9b3843">host_free</a>(send[d]);</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  }</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  <span class="comment">// This does the opposite of exchangeGhost and sends back the ghost</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  <span class="comment">// zone to the node from which it came and injects it back into the</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  <span class="comment">// field</span></div><div class="line"><a name="l00169"></a><span class="lineno"><a class="line" href="classquda_1_1cpu_gauge_field.html#ab040665b9d326ac8929b77553b6d6f8a">  169</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classquda_1_1cpu_gauge_field.html#ab040665b9d326ac8929b77553b6d6f8a">cpuGaugeField::injectGhost</a>(<a class="code" href="enum__quda_8h.html#ac15ce1c1afbc117e224b553c8efd5ab7">QudaLinkDirection</a> link_direction) {</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classquda_1_1_gauge_field.html#ae13bc82ef4474f3d89b3a25e2000f936">geometry</a> != <a class="code" href="enum__quda_8h.html#a7589b295019a40887f1c10c76555feeaa2cc101847eb2a925159b08346100da2d">QUDA_VECTOR_GEOMETRY</a> &amp;&amp; <a class="code" href="classquda_1_1_gauge_field.html#ae13bc82ef4474f3d89b3a25e2000f936">geometry</a> != <a class="code" href="enum__quda_8h.html#a7589b295019a40887f1c10c76555feeaadc1a5ef802228fe4edd42346172c7605">QUDA_COARSE_GEOMETRY</a>)</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;      <a class="code" href="util__quda_8h.html#af3bddfd9d113d50e8e0bbf58a35c5aac">errorQuda</a>(<span class="stringliteral">&quot;Cannot exchange for %d geometry gauge field&quot;</span>, <a class="code" href="classquda_1_1_gauge_field.html#ae13bc82ef4474f3d89b3a25e2000f936">geometry</a>);</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="keywordflow">if</span> (link_direction != <a class="code" href="enum__quda_8h.html#a4cad225f00aa7a2e65b0513cc2f4b053ac73041d95c92af38448501907265b43b">QUDA_LINK_BACKWARDS</a>)</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      <a class="code" href="util__quda_8h.html#af3bddfd9d113d50e8e0bbf58a35c5aac">errorQuda</a>(<span class="stringliteral">&quot;link_direction = %d not supported&quot;</span>, link_direction);</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="keywordtype">void</span> *recv[<a class="code" href="quda__constants_8h.html#aa69925e50554e0ea81dd89fdcb572bbc">QUDA_MAX_DIM</a>];</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d=0; d&lt;<a class="code" href="classquda_1_1_lattice_field.html#a4ce6b8f181b1cbfaa755160e69fa85e7">nDim</a>; d++) recv[d] = <a class="code" href="malloc__quda_8h.html#a45d92b2c2231b848192b3086283d05b6">safe_malloc</a>(<a class="code" href="classquda_1_1_gauge_field.html#a9c069c0771836252674aa8dd009c2c49">nFace</a>*<a class="code" href="classquda_1_1_lattice_field.html#a9b454a5960bbe5c51085185de2a58ba5">surface</a>[d]*<a class="code" href="classquda_1_1_gauge_field.html#a3b7da036cfa15d6d8d65acac1cf41e2a">nInternal</a>*<a class="code" href="classquda_1_1_lattice_field.html#a6535520c1cb96795a40de1df52218f2d">precision</a>);</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="comment">// communicate between nodes</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <a class="code" href="classquda_1_1_gauge_field.html#a93b1219a2b9d0a7540162587f756a913">exchange</a>(recv, <a class="code" href="classquda_1_1_gauge_field.html#a126627f0f24e3bacedb464ae5061216a">ghost</a>, <a class="code" href="enum__quda_8h.html#a91c65a84d19d3d74f84fa06888d256b0a9d5fabe59f6075415f534e2936186d84">QUDA_BACKWARDS</a>);</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="comment">// get the links into contiguous buffers</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <a class="code" href="namespacequda.html#a30c73bae2ad5e120dd0c2fea452b7924">extractGaugeGhost</a>(*<span class="keyword">this</span>, recv, <span class="keyword">false</span>);</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d=0; d&lt;<a class="code" href="classquda_1_1_lattice_field.html#a4ce6b8f181b1cbfaa755160e69fa85e7">nDim</a>; d++) <a class="code" href="malloc__quda_8h.html#ad733cb3f6cac705c8db7b0afad9b3843">host_free</a>(recv[d]);</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  }</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div><div class="line"><a name="l00188"></a><span class="lineno"><a class="line" href="classquda_1_1cpu_gauge_field.html#ab0cc045fdabb6d5bb80af251426da60f">  188</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classquda_1_1cpu_gauge_field.html#ab0cc045fdabb6d5bb80af251426da60f">cpuGaugeField::exchangeExtendedGhost</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> *<a class="code" href="classquda_1_1_lattice_field.html#a96eccffaa1381a45cd03db7bdc4af2f1">R</a>, <span class="keywordtype">bool</span> no_comms_fill) {</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    </div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keywordtype">void</span> *send[<a class="code" href="quda__constants_8h.html#aa69925e50554e0ea81dd89fdcb572bbc">QUDA_MAX_DIM</a>];</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="keywordtype">void</span> *recv[<a class="code" href="quda__constants_8h.html#aa69925e50554e0ea81dd89fdcb572bbc">QUDA_MAX_DIM</a>];</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="classquda_1_1_gauge_field.html#a8f2517a9224f01ad813a3262dc541edf">bytes</a>[<a class="code" href="quda__constants_8h.html#aa69925e50554e0ea81dd89fdcb572bbc">QUDA_MAX_DIM</a>];</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="comment">// store both parities and directions in each</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d=0; d&lt;<a class="code" href="classquda_1_1_lattice_field.html#a4ce6b8f181b1cbfaa755160e69fa85e7">nDim</a>; d++) {</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      <span class="keywordflow">if</span> (!(<a class="code" href="comm__quda_8h.html#a9390c85afcad52ee6919c40cf85cbc2d">comm_dim_partitioned</a>(d) || (no_comms_fill &amp;&amp; R[d])) ) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      bytes[d] = <a class="code" href="classquda_1_1_lattice_field.html#a9b454a5960bbe5c51085185de2a58ba5">surface</a>[d] * R[d] * <a class="code" href="classquda_1_1_gauge_field.html#ae13bc82ef4474f3d89b3a25e2000f936">geometry</a> * <a class="code" href="classquda_1_1_gauge_field.html#a3b7da036cfa15d6d8d65acac1cf41e2a">nInternal</a> * <a class="code" href="classquda_1_1_lattice_field.html#a6535520c1cb96795a40de1df52218f2d">precision</a>;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;      send[d] = <a class="code" href="malloc__quda_8h.html#a45d92b2c2231b848192b3086283d05b6">safe_malloc</a>(2 * bytes[d]);</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      recv[d] = <a class="code" href="malloc__quda_8h.html#a45d92b2c2231b848192b3086283d05b6">safe_malloc</a>(2 * bytes[d]);</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    }</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d=0; d&lt;<a class="code" href="classquda_1_1_lattice_field.html#a4ce6b8f181b1cbfaa755160e69fa85e7">nDim</a>; d++) {</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      <span class="keywordflow">if</span> (!(<a class="code" href="comm__quda_8h.html#a9390c85afcad52ee6919c40cf85cbc2d">comm_dim_partitioned</a>(d) || (no_comms_fill &amp;&amp; R[d])) ) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      <span class="comment">//extract into a contiguous buffer</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      <a class="code" href="namespacequda.html#a623d46037fdf4933f8d68b2fa35dc1b8">extractExtendedGaugeGhost</a>(*<span class="keyword">this</span>, d, R, send, <span class="keyword">true</span>);</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="comm__quda_8h.html#a9390c85afcad52ee6919c40cf85cbc2d">comm_dim_partitioned</a>(d)) {</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  <span class="comment">// do the exchange</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  <a class="code" href="struct_msg_handle__s.html">MsgHandle</a> *<a class="code" href="classquda_1_1_lattice_field.html#ae64c2423ab6e570c5565fa20945e5c58">mh_recv_back</a>;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  <a class="code" href="struct_msg_handle__s.html">MsgHandle</a> *<a class="code" href="classquda_1_1_lattice_field.html#acfb0f79a3f5896fa2d6c876571e21d3f">mh_recv_fwd</a>;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  <a class="code" href="struct_msg_handle__s.html">MsgHandle</a> *<a class="code" href="classquda_1_1_lattice_field.html#a174488c5533899d5117c56efcfe5a55c">mh_send_fwd</a>;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <a class="code" href="struct_msg_handle__s.html">MsgHandle</a> *<a class="code" href="classquda_1_1_lattice_field.html#ab968c83742bbbe049ca56c42aba0fc18">mh_send_back</a>;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  </div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  mh_recv_back = <a class="code" href="comm__quda_8h.html#aa8fffe807eed8eed45776c04cf0994e4">comm_declare_receive_relative</a>(recv[d], d, -1, bytes[d]);</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  mh_recv_fwd  = <a class="code" href="comm__quda_8h.html#aa8fffe807eed8eed45776c04cf0994e4">comm_declare_receive_relative</a>(((<span class="keywordtype">char</span>*)recv[d])+bytes[d], d, +1, bytes[d]);</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  mh_send_back = <a class="code" href="comm__quda_8h.html#ae2ff2e1e8bf092e23d79c86377144066">comm_declare_send_relative</a>(send[d], d, -1, bytes[d]);</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  mh_send_fwd  = <a class="code" href="comm__quda_8h.html#ae2ff2e1e8bf092e23d79c86377144066">comm_declare_send_relative</a>(((<span class="keywordtype">char</span>*)send[d])+bytes[d], d, +1, bytes[d]);</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  </div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  <a class="code" href="comm__quda_8h.html#a0498a56438662fb30281fb92b5bc40b4">comm_start</a>(mh_recv_back);</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  <a class="code" href="comm__quda_8h.html#a0498a56438662fb30281fb92b5bc40b4">comm_start</a>(mh_recv_fwd);</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  <a class="code" href="comm__quda_8h.html#a0498a56438662fb30281fb92b5bc40b4">comm_start</a>(mh_send_fwd);</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <a class="code" href="comm__quda_8h.html#a0498a56438662fb30281fb92b5bc40b4">comm_start</a>(mh_send_back);</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  </div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  <a class="code" href="comm__quda_8h.html#aa949084ae3512a75d7218748b38f7015">comm_wait</a>(mh_send_fwd);</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  <a class="code" href="comm__quda_8h.html#aa949084ae3512a75d7218748b38f7015">comm_wait</a>(mh_send_back);</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  <a class="code" href="comm__quda_8h.html#aa949084ae3512a75d7218748b38f7015">comm_wait</a>(mh_recv_back);</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  <a class="code" href="comm__quda_8h.html#aa949084ae3512a75d7218748b38f7015">comm_wait</a>(mh_recv_fwd);</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  </div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  <a class="code" href="comm__quda_8h.html#aaf356c30715ea44b84953c66f65c1ef9">comm_free</a>(mh_send_fwd);</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  <a class="code" href="comm__quda_8h.html#aaf356c30715ea44b84953c66f65c1ef9">comm_free</a>(mh_send_back);</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <a class="code" href="comm__quda_8h.html#aaf356c30715ea44b84953c66f65c1ef9">comm_free</a>(mh_recv_back);</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  <a class="code" href="comm__quda_8h.html#aaf356c30715ea44b84953c66f65c1ef9">comm_free</a>(mh_recv_fwd);</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  memcpy(static_cast&lt;char*&gt;(recv[d])+bytes[d], send[d], bytes[d]);</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  memcpy(recv[d], static_cast&lt;char*&gt;(send[d])+bytes[d], bytes[d]);</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      }      </div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      <span class="comment">// inject back into the gauge field</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      <a class="code" href="namespacequda.html#a623d46037fdf4933f8d68b2fa35dc1b8">extractExtendedGaugeGhost</a>(*<span class="keyword">this</span>, d, R, recv, <span class="keyword">false</span>);</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    }</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d=0; d&lt;<a class="code" href="classquda_1_1_lattice_field.html#a4ce6b8f181b1cbfaa755160e69fa85e7">nDim</a>; d++) {</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      <span class="keywordflow">if</span> (!(<a class="code" href="comm__quda_8h.html#a9390c85afcad52ee6919c40cf85cbc2d">comm_dim_partitioned</a>(d) || (no_comms_fill &amp;&amp; R[d])) ) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;      <a class="code" href="malloc__quda_8h.html#ad733cb3f6cac705c8db7b0afad9b3843">host_free</a>(send[d]);</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      <a class="code" href="malloc__quda_8h.html#ad733cb3f6cac705c8db7b0afad9b3843">host_free</a>(recv[d]);</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    }</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  }</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div><div class="line"><a name="l00249"></a><span class="lineno"><a class="line" href="classquda_1_1cpu_gauge_field.html#a04ad35fc407cc1ed6bcb464dbbad45ba">  249</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classquda_1_1cpu_gauge_field.html#ab0cc045fdabb6d5bb80af251426da60f">cpuGaugeField::exchangeExtendedGhost</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> *<a class="code" href="classquda_1_1_lattice_field.html#a96eccffaa1381a45cd03db7bdc4af2f1">R</a>, <a class="code" href="classquda_1_1_time_profile.html">TimeProfile</a> &amp;profile, <span class="keywordtype">bool</span> no_comms_fill) {</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    profile.TPSTART(<a class="code" href="namespacequda.html#a8ad4f224c5228606d725a5f9a96c3f23a5783ef35aa9146682a943da4086c867a">QUDA_PROFILE_COMMS</a>);</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <a class="code" href="classquda_1_1cpu_gauge_field.html#ab0cc045fdabb6d5bb80af251426da60f">exchangeExtendedGhost</a>(R, no_comms_fill);</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    profile.TPSTOP(<a class="code" href="namespacequda.html#a8ad4f224c5228606d725a5f9a96c3f23a5783ef35aa9146682a943da4086c867a">QUDA_PROFILE_COMMS</a>);</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  }</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  <span class="comment">// defined in cudaGaugeField</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  <span class="keywordtype">void</span> *<a class="code" href="namespacequda.html#a0138c2d76b9b477b5a914ed4ff09134b">create_gauge_buffer</a>(<span class="keywordtype">size_t</span> <a class="code" href="classquda_1_1_gauge_field.html#a8f2517a9224f01ad813a3262dc541edf">bytes</a>, <a class="code" href="enum__quda_8h.html#a5e790fc01ee46c70ab9a83d1fff88d4c">QudaGaugeFieldOrder</a> <a class="code" href="classquda_1_1_gauge_field.html#a3d8cbee3feea3f19fb40d3c28de398e3">order</a>, <a class="code" href="enum__quda_8h.html#a7e13e13f465c82f4802f71dfdf551b33">QudaFieldGeometry</a> <a class="code" href="classquda_1_1_gauge_field.html#ae13bc82ef4474f3d89b3a25e2000f936">geometry</a>);</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  <span class="keywordtype">void</span> **<a class="code" href="namespacequda.html#a037d22e360b272cb3c5be04675a29b0c">create_ghost_buffer</a>(<span class="keywordtype">size_t</span> bytes[], <a class="code" href="enum__quda_8h.html#a5e790fc01ee46c70ab9a83d1fff88d4c">QudaGaugeFieldOrder</a> order, <a class="code" href="enum__quda_8h.html#a7e13e13f465c82f4802f71dfdf551b33">QudaFieldGeometry</a> geometry);</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="namespacequda.html#a82845c78c417da7a26d264e491e78a05">free_gauge_buffer</a>(<span class="keywordtype">void</span> *buffer, <a class="code" href="enum__quda_8h.html#a5e790fc01ee46c70ab9a83d1fff88d4c">QudaGaugeFieldOrder</a> order, <a class="code" href="enum__quda_8h.html#a7e13e13f465c82f4802f71dfdf551b33">QudaFieldGeometry</a> geometry);</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="namespacequda.html#a8e24b83a48d247f61634d3ca31b084c9">free_ghost_buffer</a>(<span class="keywordtype">void</span> **buffer, <a class="code" href="enum__quda_8h.html#a5e790fc01ee46c70ab9a83d1fff88d4c">QudaGaugeFieldOrder</a> order, <a class="code" href="enum__quda_8h.html#a7e13e13f465c82f4802f71dfdf551b33">QudaFieldGeometry</a> geometry);</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;</div><div class="line"><a name="l00261"></a><span class="lineno"><a class="line" href="classquda_1_1cpu_gauge_field.html#a6f4ec9b03d920ef9ad7ece9adbc10968">  261</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classquda_1_1cpu_gauge_field.html#a6f4ec9b03d920ef9ad7ece9adbc10968">cpuGaugeField::copy</a>(<span class="keyword">const</span> <a class="code" href="classquda_1_1_gauge_field.html">GaugeField</a> &amp;src) {</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">this</span> == &amp;src) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <a class="code" href="classquda_1_1_gauge_field.html#adbc8edd6e827e616d393c9ce5c25cb51">checkField</a>(src);</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classquda_1_1_gauge_field.html#a03852c1e5b42346de487927370ea3d36">link_type</a> == <a class="code" href="enum__quda_8h.html#af0b4185ef9aa540e660716ff1697b299aec0244661633b9cf637f77d16e46afc8">QUDA_ASQTAD_FAT_LINKS</a>) {</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;      <a class="code" href="classquda_1_1_gauge_field.html#a78d11ce3fbd8e63151ee5f12eb874733">fat_link_max</a> = src.<a class="code" href="classquda_1_1_gauge_field.html#a6d424948785fbc67b92e1f9febf028be">LinkMax</a>();</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="classquda_1_1_lattice_field.html#a6535520c1cb96795a40de1df52218f2d">precision</a> == <a class="code" href="enum__quda_8h.html#ac166c47d6ef16f830c164fefe6c8ab90afb568427ae928d5a1330ee47ef03c0b6">QUDA_HALF_PRECISION</a> || <a class="code" href="classquda_1_1_lattice_field.html#a6535520c1cb96795a40de1df52218f2d">precision</a> == <a class="code" href="enum__quda_8h.html#ac166c47d6ef16f830c164fefe6c8ab90aeac943998f9a94180aa7e472599219c5">QUDA_QUARTER_PRECISION</a>) &amp;&amp; <a class="code" href="classquda_1_1_gauge_field.html#a78d11ce3fbd8e63151ee5f12eb874733">fat_link_max</a> == 0.0)</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <a class="code" href="util__quda_8h.html#af3bddfd9d113d50e8e0bbf58a35c5aac">errorQuda</a>(<span class="stringliteral">&quot;fat_link_max has not been computed&quot;</span>);</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;      <a class="code" href="classquda_1_1_gauge_field.html#a78d11ce3fbd8e63151ee5f12eb874733">fat_link_max</a> = 1.0;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    }</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">typeid</span>(src) == <span class="keyword">typeid</span>(<a class="code" href="classquda_1_1cuda_gauge_field.html">cudaGaugeField</a>)) {</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacequda.html#aa25deeec640690f50f16e136639e8450">reorder_location</a>() == <a class="code" href="enum__quda_8h.html#a35de1312d8bed4b94234a3092907e0d9abe95344eb6e5a15d46e3bab3c5291617">QUDA_CPU_FIELD_LOCATION</a>) {</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  <span class="keywordflow">if</span> (!src.<a class="code" href="classquda_1_1_gauge_field.html#aca7e53965b88761140d7bf4a78ecd935">isNative</a>()) <a class="code" href="util__quda_8h.html#af3bddfd9d113d50e8e0bbf58a35c5aac">errorQuda</a>(<span class="stringliteral">&quot;Only native order is supported&quot;</span>);</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <span class="keywordtype">void</span> *buffer = <a class="code" href="malloc__quda_8h.html#a003773656f4cb295ca2494f4d62189d7">pool_pinned_malloc</a>(src.<a class="code" href="classquda_1_1_gauge_field.html#a741d99f6a1d461a0fbbb4775d9a4d4ee">Bytes</a>());</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  <span class="comment">// this copies over both even and odd</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  <a class="code" href="quda__cuda__api_8h.html#a679038676bff8332174e60c1daa039c8">qudaMemcpy</a>(buffer, static_cast&lt;const cudaGaugeField&amp;&gt;(src).<a class="code" href="classquda_1_1cpu_gauge_field.html#a31d35c35d809f3907d76408bcd10ca86">Gauge_p</a>(),</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;       src.<a class="code" href="classquda_1_1_gauge_field.html#a741d99f6a1d461a0fbbb4775d9a4d4ee">Bytes</a>(), cudaMemcpyDeviceToHost);</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  <a class="code" href="namespacequda.html#a075839243ec706913684940d2ba4ce43">copyGenericGauge</a>(*<span class="keyword">this</span>, src, <a class="code" href="enum__quda_8h.html#a35de1312d8bed4b94234a3092907e0d9abe95344eb6e5a15d46e3bab3c5291617">QUDA_CPU_FIELD_LOCATION</a>, <a class="code" href="classquda_1_1cpu_gauge_field.html#ae36e574312c5cb03633ee75cd75c1901">gauge</a>, buffer);</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  <a class="code" href="malloc__quda_8h.html#a538488342fae7318e1fa3d8ea475b9ea">pool_pinned_free</a>(buffer);</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;      } <span class="keywordflow">else</span> { <span class="comment">// else on the GPU</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  <span class="keywordtype">void</span> *buffer = <a class="code" href="namespacequda.html#a0138c2d76b9b477b5a914ed4ff09134b">create_gauge_buffer</a>(bytes, order, geometry);</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="classquda_1_1_lattice_field.html#a6ee46dcc8b34e13646a2729e37b7bd7e">ghost_bytes</a>[8];</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  <span class="keywordtype">int</span> dstNinternal = <a class="code" href="classquda_1_1_gauge_field.html#ae89fead7b7a46d6ccdb04041373f0632">reconstruct</a> != <a class="code" href="enum__quda_8h.html#a5cc304be12bc9174274636e1e7863841a41ab3553ef10af8aeb118f39d8f1e935">QUDA_RECONSTRUCT_NO</a> ? <a class="code" href="classquda_1_1_gauge_field.html#ae89fead7b7a46d6ccdb04041373f0632">reconstruct</a> : 2*<a class="code" href="classquda_1_1_gauge_field.html#a57ea39fb5f0a5d5d0ac4a3a31717e162">nColor</a>*<a class="code" href="classquda_1_1_gauge_field.html#a57ea39fb5f0a5d5d0ac4a3a31717e162">nColor</a>;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d=0; d&lt;<a class="code" href="classquda_1_1_gauge_field.html#ae13bc82ef4474f3d89b3a25e2000f936">geometry</a>; d++) ghost_bytes[d] = <a class="code" href="classquda_1_1_gauge_field.html#a9c069c0771836252674aa8dd009c2c49">nFace</a> * <a class="code" href="classquda_1_1_lattice_field.html#a9b454a5960bbe5c51085185de2a58ba5">surface</a>[d%4] * dstNinternal * <a class="code" href="classquda_1_1_lattice_field.html#a6535520c1cb96795a40de1df52218f2d">precision</a>;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  <span class="keywordtype">void</span> **ghost_buffer = (<a class="code" href="classquda_1_1_gauge_field.html#a9c069c0771836252674aa8dd009c2c49">nFace</a> &gt; 0) ? <a class="code" href="namespacequda.html#a037d22e360b272cb3c5be04675a29b0c">create_ghost_buffer</a>(ghost_bytes, order, geometry) : <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classquda_1_1_lattice_field.html#a038242dabcf96173e013f3588d0476de">ghostExchange</a> != <a class="code" href="enum__quda_8h.html#a93131cceecad27ce4b964cb184e8d47aa31e2396004ebee77471a7efacb6cde4e">QUDA_GHOST_EXCHANGE_EXTENDED</a>) {</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <a class="code" href="namespacequda.html#a075839243ec706913684940d2ba4ce43">copyGenericGauge</a>(*<span class="keyword">this</span>, src, <a class="code" href="enum__quda_8h.html#a35de1312d8bed4b94234a3092907e0d9a184379764fab0f101cab6f19a8a14690">QUDA_CUDA_FIELD_LOCATION</a>, buffer, 0, ghost_buffer, 0);</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="keywordflow">if</span> (geometry == <a class="code" href="enum__quda_8h.html#a7589b295019a40887f1c10c76555feeaadc1a5ef802228fe4edd42346172c7605">QUDA_COARSE_GEOMETRY</a>) <a class="code" href="namespacequda.html#a075839243ec706913684940d2ba4ce43">copyGenericGauge</a>(*<span class="keyword">this</span>, src, <a class="code" href="enum__quda_8h.html#a35de1312d8bed4b94234a3092907e0d9a184379764fab0f101cab6f19a8a14690">QUDA_CUDA_FIELD_LOCATION</a>, buffer, 0, ghost_buffer, 0, 3); <span class="comment">// forwards links if bi-directional</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <a class="code" href="namespacequda.html#ad288ddd1679350fa258fa42bd22accd4">copyExtendedGauge</a>(*<span class="keyword">this</span>, src, <a class="code" href="enum__quda_8h.html#a35de1312d8bed4b94234a3092907e0d9a184379764fab0f101cab6f19a8a14690">QUDA_CUDA_FIELD_LOCATION</a>, buffer, 0);</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  }</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  <span class="keywordflow">if</span> (order == <a class="code" href="enum__quda_8h.html#acb61fdc14d6b12e8c6177b6d966bd863a85ce3606ffcab0df5df3e6d2b069edc9">QUDA_QDP_GAUGE_ORDER</a>) {</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d=0; d&lt;<a class="code" href="classquda_1_1_gauge_field.html#ae13bc82ef4474f3d89b3a25e2000f936">geometry</a>; d++) {</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      <a class="code" href="quda__cuda__api_8h.html#a679038676bff8332174e60c1daa039c8">qudaMemcpy</a>(((<span class="keywordtype">void</span>**)<a class="code" href="classquda_1_1cpu_gauge_field.html#ae36e574312c5cb03633ee75cd75c1901">gauge</a>)[d], ((<span class="keywordtype">void</span>**)buffer)[d], bytes/geometry, cudaMemcpyDeviceToHost);</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    }</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <a class="code" href="quda__cuda__api_8h.html#a679038676bff8332174e60c1daa039c8">qudaMemcpy</a>(<a class="code" href="classquda_1_1cpu_gauge_field.html#ae36e574312c5cb03633ee75cd75c1901">gauge</a>, buffer, bytes, cudaMemcpyHostToDevice);</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  }</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  <span class="keywordflow">if</span> (order &gt; 4 &amp;&amp; <a class="code" href="classquda_1_1_lattice_field.html#a038242dabcf96173e013f3588d0476de">ghostExchange</a> == <a class="code" href="enum__quda_8h.html#a93131cceecad27ce4b964cb184e8d47aaab94b36fc680dd39f976636dac350e53">QUDA_GHOST_EXCHANGE_PAD</a> &amp;&amp; src.<a class="code" href="classquda_1_1_lattice_field.html#ac28a222cabb75e131517b3f129807bd6">GhostExchange</a>() == <a class="code" href="enum__quda_8h.html#a93131cceecad27ce4b964cb184e8d47aaab94b36fc680dd39f976636dac350e53">QUDA_GHOST_EXCHANGE_PAD</a> &amp;&amp; <a class="code" href="classquda_1_1_gauge_field.html#a9c069c0771836252674aa8dd009c2c49">nFace</a>)</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d=0; d&lt;<a class="code" href="classquda_1_1_gauge_field.html#ae13bc82ef4474f3d89b3a25e2000f936">geometry</a>; d++)</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;      <a class="code" href="quda__cuda__api_8h.html#a679038676bff8332174e60c1daa039c8">qudaMemcpy</a>(<a class="code" href="classquda_1_1_gauge_field.html#aedfa91e714c61b8e11caec9d2703dcfa">Ghost</a>()[d], ghost_buffer[d], ghost_bytes[d], cudaMemcpyDeviceToHost);</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  <a class="code" href="namespacequda.html#a82845c78c417da7a26d264e491e78a05">free_gauge_buffer</a>(buffer, order, geometry);</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classquda_1_1_gauge_field.html#a9c069c0771836252674aa8dd009c2c49">nFace</a> &gt; 0) <a class="code" href="namespacequda.html#a8e24b83a48d247f61634d3ca31b084c9">free_ghost_buffer</a>(ghost_buffer, order, geometry);</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;      }</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">typeid</span>(src) == <span class="keyword">typeid</span>(<a class="code" href="classquda_1_1cpu_gauge_field.html">cpuGaugeField</a>)) {</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;      <span class="comment">// copy field and ghost zone directly</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;      <a class="code" href="namespacequda.html#a075839243ec706913684940d2ba4ce43">copyGenericGauge</a>(*<span class="keyword">this</span>, src, <a class="code" href="enum__quda_8h.html#a35de1312d8bed4b94234a3092907e0d9abe95344eb6e5a15d46e3bab3c5291617">QUDA_CPU_FIELD_LOCATION</a>, <a class="code" href="classquda_1_1cpu_gauge_field.html#ae36e574312c5cb03633ee75cd75c1901">gauge</a>,</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;           const_cast&lt;void*&gt;(static_cast&lt;const cpuGaugeField&amp;&gt;(src).<a class="code" href="classquda_1_1cpu_gauge_field.html#a31d35c35d809f3907d76408bcd10ca86">Gauge_p</a>()));</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;      <a class="code" href="util__quda_8h.html#af3bddfd9d113d50e8e0bbf58a35c5aac">errorQuda</a>(<span class="stringliteral">&quot;Invalid gauge field type&quot;</span>);</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    }</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="comment">// if we have copied from a source without a pad then we need to exchange</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classquda_1_1_lattice_field.html#a038242dabcf96173e013f3588d0476de">ghostExchange</a> == <a class="code" href="enum__quda_8h.html#a93131cceecad27ce4b964cb184e8d47aaab94b36fc680dd39f976636dac350e53">QUDA_GHOST_EXCHANGE_PAD</a> &amp;&amp;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  src.<a class="code" href="classquda_1_1_lattice_field.html#ac28a222cabb75e131517b3f129807bd6">GhostExchange</a>() != <a class="code" href="enum__quda_8h.html#a93131cceecad27ce4b964cb184e8d47aaab94b36fc680dd39f976636dac350e53">QUDA_GHOST_EXCHANGE_PAD</a>) {</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;      <a class="code" href="classquda_1_1cpu_gauge_field.html#abcb214de4fba03d89b8d4a83db847b1d">exchangeGhost</a>(geometry == <a class="code" href="enum__quda_8h.html#a7589b295019a40887f1c10c76555feeaa2cc101847eb2a925159b08346100da2d">QUDA_VECTOR_GEOMETRY</a> ? <a class="code" href="enum__quda_8h.html#a4cad225f00aa7a2e65b0513cc2f4b053ac73041d95c92af38448501907265b43b">QUDA_LINK_BACKWARDS</a> : <a class="code" href="enum__quda_8h.html#a4cad225f00aa7a2e65b0513cc2f4b053a70977ca93ce71cc94cd6a9dcd3625f8b">QUDA_LINK_BIDIRECTIONAL</a>);</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    }</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <a class="code" href="util__quda_8h.html#a7668e6580e0f57b0db3112fae4959e34">checkCudaError</a>();</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  }</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;</div><div class="line"><a name="l00335"></a><span class="lineno"><a class="line" href="classquda_1_1cpu_gauge_field.html#aa18ba2332d5c4d3caea86def8186f082">  335</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classquda_1_1cpu_gauge_field.html#aa18ba2332d5c4d3caea86def8186f082">cpuGaugeField::setGauge</a>(<span class="keywordtype">void</span> **gauge_)</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  {</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classquda_1_1_gauge_field.html#a0c619418f3faa2dddbb7547bffe9aa77">create</a> != <a class="code" href="enum__quda_8h.html#ae3c3f9e9961c64a4a34f144d8f87f805ab0249b95aff915ee4dceca49f75b7f72">QUDA_REFERENCE_FIELD_CREATE</a>) {</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;      <a class="code" href="util__quda_8h.html#af3bddfd9d113d50e8e0bbf58a35c5aac">errorQuda</a>(<span class="stringliteral">&quot;Setting gauge pointer is only allowed when create=&quot;</span></div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="stringliteral">&quot;QUDA_REFERENCE_FIELD_CREATE type\n&quot;</span>);</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    }</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <a class="code" href="classquda_1_1cpu_gauge_field.html#ae36e574312c5cb03633ee75cd75c1901">gauge</a> = gauge_;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  }</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;</div><div class="line"><a name="l00344"></a><span class="lineno"><a class="line" href="classquda_1_1cpu_gauge_field.html#aa51ad073b8ec007f2e377865e7809695">  344</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classquda_1_1cpu_gauge_field.html#aa51ad073b8ec007f2e377865e7809695">cpuGaugeField::backup</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classquda_1_1_lattice_field.html#a1d864aa97fbc8539ce123418b11af1a2">backed_up</a>) <a class="code" href="util__quda_8h.html#af3bddfd9d113d50e8e0bbf58a35c5aac">errorQuda</a>(<span class="stringliteral">&quot;Gauge field already backed up&quot;</span>);</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="keywordflow">if</span> (order == <a class="code" href="enum__quda_8h.html#acb61fdc14d6b12e8c6177b6d966bd863a85ce3606ffcab0df5df3e6d2b069edc9">QUDA_QDP_GAUGE_ORDER</a>) {</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      <span class="keywordtype">char</span> **buffer = <span class="keyword">new</span> <span class="keywordtype">char</span>*[<a class="code" href="classquda_1_1_gauge_field.html#ae13bc82ef4474f3d89b3a25e2000f936">geometry</a>];</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d=0; d&lt;<a class="code" href="classquda_1_1_gauge_field.html#ae13bc82ef4474f3d89b3a25e2000f936">geometry</a>; d++) {</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  buffer[d] = <span class="keyword">new</span> <span class="keywordtype">char</span>[bytes/<a class="code" href="classquda_1_1_gauge_field.html#ae13bc82ef4474f3d89b3a25e2000f936">geometry</a>];</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  memcpy(buffer[d], <a class="code" href="classquda_1_1cpu_gauge_field.html#ae36e574312c5cb03633ee75cd75c1901">gauge</a>[d], bytes/geometry);</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;      }</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;      <a class="code" href="classquda_1_1_lattice_field.html#afc02b90543d60148c56402655d874648">backup_h</a> = <span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(buffer);</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;      <a class="code" href="classquda_1_1_lattice_field.html#afc02b90543d60148c56402655d874648">backup_h</a> = <span class="keyword">new</span> <span class="keywordtype">char</span>[<a class="code" href="classquda_1_1_gauge_field.html#a8f2517a9224f01ad813a3262dc541edf">bytes</a>];</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;      memcpy(<a class="code" href="classquda_1_1_lattice_field.html#afc02b90543d60148c56402655d874648">backup_h</a>, <a class="code" href="classquda_1_1cpu_gauge_field.html#ae36e574312c5cb03633ee75cd75c1901">gauge</a>, bytes);</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    }</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <a class="code" href="classquda_1_1_lattice_field.html#a1d864aa97fbc8539ce123418b11af1a2">backed_up</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  }</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;</div><div class="line"><a name="l00362"></a><span class="lineno"><a class="line" href="classquda_1_1cpu_gauge_field.html#ac1f1359faa0bbbaf288549a1c2d6f354">  362</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classquda_1_1cpu_gauge_field.html#ac1f1359faa0bbbaf288549a1c2d6f354">cpuGaugeField::restore</a>()<span class="keyword"> const</span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classquda_1_1_lattice_field.html#a1d864aa97fbc8539ce123418b11af1a2">backed_up</a>) <a class="code" href="util__quda_8h.html#af3bddfd9d113d50e8e0bbf58a35c5aac">errorQuda</a>(<span class="stringliteral">&quot;Cannot restore since not backed up&quot;</span>);</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="keywordflow">if</span> (order == <a class="code" href="enum__quda_8h.html#acb61fdc14d6b12e8c6177b6d966bd863a85ce3606ffcab0df5df3e6d2b069edc9">QUDA_QDP_GAUGE_ORDER</a>) {</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;      <span class="keywordtype">char</span> **buffer = <span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">char</span>**<span class="keyword">&gt;</span>(<a class="code" href="classquda_1_1_lattice_field.html#afc02b90543d60148c56402655d874648">backup_h</a>);</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d=0; d&lt;<a class="code" href="classquda_1_1_gauge_field.html#ae13bc82ef4474f3d89b3a25e2000f936">geometry</a>; d++) {</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  memcpy(<a class="code" href="classquda_1_1cpu_gauge_field.html#ae36e574312c5cb03633ee75cd75c1901">gauge</a>[d], buffer[d], bytes/geometry);</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  <span class="keyword">delete</span> []buffer[d];</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;      }</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;      <span class="keyword">delete</span> []buffer;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;      memcpy(<a class="code" href="classquda_1_1cpu_gauge_field.html#ae36e574312c5cb03633ee75cd75c1901">gauge</a>, <a class="code" href="classquda_1_1_lattice_field.html#afc02b90543d60148c56402655d874648">backup_h</a>, bytes);</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;      <span class="keyword">delete</span> []<a class="code" href="classquda_1_1_lattice_field.html#afc02b90543d60148c56402655d874648">backup_h</a>;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    }</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <a class="code" href="classquda_1_1_lattice_field.html#a1d864aa97fbc8539ce123418b11af1a2">backed_up</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  }</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;</div><div class="line"><a name="l00381"></a><span class="lineno"><a class="line" href="classquda_1_1cpu_gauge_field.html#abb49e71af68b8645ab37ef49c17f4c78">  381</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classquda_1_1cpu_gauge_field.html#abb49e71af68b8645ab37ef49c17f4c78">cpuGaugeField::zero</a>() {</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <a class="code" href="covdev__reference_8cpp.html#ace6ee45c30e71865e6eb635200379db9">memset</a>(<a class="code" href="classquda_1_1cpu_gauge_field.html#ae36e574312c5cb03633ee75cd75c1901">gauge</a>, 0, bytes);</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  }</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment">/*template &lt;typename Float&gt;</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment">void print_matrix(const Float &amp;m, unsigned int x) {</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment">  for (int s=0; s&lt;o.Nspin(); s++) {</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment">    std::cout &lt;&lt; &quot;x = &quot; &lt;&lt; x &lt;&lt; &quot;, s = &quot; &lt;&lt; s &lt;&lt; &quot;, { &quot;;</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment">    for (int c=0; c&lt;o.Ncolor(); c++) {</span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment">      std::cout &lt;&lt; &quot; ( &quot; &lt;&lt; o(x, s, c, 0) &lt;&lt; &quot; , &quot; ;</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment">      if (c&lt;o.Ncolor()-1) std::cout &lt;&lt; o(x, s, c, 1) &lt;&lt; &quot; ) ,&quot; ;</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment">      else std::cout &lt;&lt; o(x, s, c, 1) &lt;&lt; &quot; ) &quot; ;</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment">    }</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="comment">    std::cout &lt;&lt; &quot; } &quot; &lt;&lt; std::endl;</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="comment">  }</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment">}</span></div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment">// print out the vector at volume point x</span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="comment">void cpuColorSpinorField::PrintMatrix(unsigned int x) {</span></div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="comment">  </span></div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="comment">  switch(precision) {</span></div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment">  case QUDA_DOUBLE_PRECISION:</span></div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment">    print_matrix(*order_double, x);</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment">    break;</span></div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment">  case QUDA_SINGLE_PRECISION:</span></div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment">    print_matrix(*order_single, x);</span></div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment">    break;</span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="comment">  default:</span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="comment">    errorQuda(&quot;Precision %d not implemented&quot;, precision); </span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="comment">  }</span></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="comment">}</span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;} <span class="comment">// namespace quda</span></div><div class="ttc" id="enum__quda_8h_html_a91c65a84d19d3d74f84fa06888d256b0a9d5fabe59f6075415f534e2936186d84"><div class="ttname"><a href="enum__quda_8h.html#a91c65a84d19d3d74f84fa06888d256b0a9d5fabe59f6075415f534e2936186d84">QUDA_BACKWARDS</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00462">enum_quda.h:462</a></div></div>
<div class="ttc" id="quda__cuda__api_8h_html_a679038676bff8332174e60c1daa039c8"><div class="ttname"><a href="quda__cuda__api_8h.html#a679038676bff8332174e60c1daa039c8">qudaMemcpy</a></div><div class="ttdeci">#define qudaMemcpy(dst, src, count, kind)</div><div class="ttdef"><b>Definition:</b> <a href="quda__cuda__api_8h_source.html#l00033">quda_cuda_api.h:33</a></div></div>
<div class="ttc" id="enum__quda_8h_html_a5cc304be12bc9174274636e1e7863841a41ab3553ef10af8aeb118f39d8f1e935"><div class="ttname"><a href="enum__quda_8h.html#a5cc304be12bc9174274636e1e7863841a41ab3553ef10af8aeb118f39d8f1e935">QUDA_RECONSTRUCT_NO</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00067">enum_quda.h:67</a></div></div>
<div class="ttc" id="namespacequda_html_aa25deeec640690f50f16e136639e8450"><div class="ttname"><a href="namespacequda.html#aa25deeec640690f50f16e136639e8450">quda::reorder_location</a></div><div class="ttdeci">QudaFieldLocation reorder_location()</div><div class="ttdoc">Return whether data is reordered on the CPU or GPU. This can set at QUDA initialization using the env...</div><div class="ttdef"><b>Definition:</b> <a href="lattice__field_8cpp_source.html#l00725">lattice_field.cpp:725</a></div></div>
<div class="ttc" id="namespacequda_html_a30c73bae2ad5e120dd0c2fea452b7924"><div class="ttname"><a href="namespacequda.html#a30c73bae2ad5e120dd0c2fea452b7924">quda::extractGaugeGhost</a></div><div class="ttdeci">void extractGaugeGhost(const GaugeField &amp;u, void **ghost, bool extract=true, int offset=0)</div><div class="ttdef"><b>Definition:</b> <a href="extract__gauge__ghost_8cu_source.html#l00105">extract_gauge_ghost.cu:105</a></div></div>
<div class="ttc" id="classquda_1_1_lattice_field_html_a1d864aa97fbc8539ce123418b11af1a2"><div class="ttname"><a href="classquda_1_1_lattice_field.html#a1d864aa97fbc8539ce123418b11af1a2">quda::LatticeField::backed_up</a></div><div class="ttdeci">bool backed_up</div><div class="ttdef"><b>Definition:</b> <a href="lattice__field_8h_source.html#l00403">lattice_field.h:403</a></div></div>
<div class="ttc" id="enum__quda_8h_html_a5cc304be12bc9174274636e1e7863841ac73ec20dcdd9bb298a7615e70b70799d"><div class="ttname"><a href="enum__quda_8h.html#a5cc304be12bc9174274636e1e7863841ac73ec20dcdd9bb298a7615e70b70799d">QUDA_RECONSTRUCT_10</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00072">enum_quda.h:72</a></div></div>
<div class="ttc" id="classquda_1_1cpu_gauge_field_html_aa18ba2332d5c4d3caea86def8186f082"><div class="ttname"><a href="classquda_1_1cpu_gauge_field.html#aa18ba2332d5c4d3caea86def8186f082">quda::cpuGaugeField::setGauge</a></div><div class="ttdeci">void setGauge(void **_gauge)</div><div class="ttdef"><b>Definition:</b> <a href="cpu__gauge__field_8cpp_source.html#l00335">cpu_gauge_field.cpp:335</a></div></div>
<div class="ttc" id="malloc__quda_8h_html_a538488342fae7318e1fa3d8ea475b9ea"><div class="ttname"><a href="malloc__quda_8h.html#a538488342fae7318e1fa3d8ea475b9ea">pool_pinned_free</a></div><div class="ttdeci">#define pool_pinned_free(ptr)</div><div class="ttdef"><b>Definition:</b> <a href="malloc__quda_8h_source.html#l00128">malloc_quda.h:128</a></div></div>
<div class="ttc" id="namespacequda_html_a075839243ec706913684940d2ba4ce43"><div class="ttname"><a href="namespacequda.html#a075839243ec706913684940d2ba4ce43">quda::copyGenericGauge</a></div><div class="ttdeci">void copyGenericGauge(GaugeField &amp;out, const GaugeField &amp;in, QudaFieldLocation location, void *Out=0, void *In=0, void **ghostOut=0, void **ghostIn=0, int type=0)</div><div class="ttdef"><b>Definition:</b> <a href="copy__gauge_8cu_source.html#l00041">copy_gauge.cu:41</a></div></div>
<div class="ttc" id="classquda_1_1_lattice_field_html_a4793744a29f95009914eaa10b174bb94"><div class="ttname"><a href="classquda_1_1_lattice_field.html#a4793744a29f95009914eaa10b174bb94">quda::LatticeField::pad</a></div><div class="ttdeci">int pad</div><div class="ttdef"><b>Definition:</b> <a href="lattice__field_8h_source.html#l00154">lattice_field.h:154</a></div></div>
<div class="ttc" id="classquda_1_1_gauge_field_html_a8f2517a9224f01ad813a3262dc541edf"><div class="ttname"><a href="classquda_1_1_gauge_field.html#a8f2517a9224f01ad813a3262dc541edf">quda::GaugeField::bytes</a></div><div class="ttdeci">size_t bytes</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field_8h_source.html#l00167">gauge_field.h:167</a></div></div>
<div class="ttc" id="classquda_1_1cpu_gauge_field_html_ab0cc045fdabb6d5bb80af251426da60f"><div class="ttname"><a href="classquda_1_1cpu_gauge_field.html#ab0cc045fdabb6d5bb80af251426da60f">quda::cpuGaugeField::exchangeExtendedGhost</a></div><div class="ttdeci">void exchangeExtendedGhost(const int *R, bool no_comms_fill=false)</div><div class="ttdoc">This does routine will populate the border / halo region of a gauge field that has been created using...</div><div class="ttdef"><b>Definition:</b> <a href="cpu__gauge__field_8cpp_source.html#l00188">cpu_gauge_field.cpp:188</a></div></div>
<div class="ttc" id="enum__quda_8h_html_af0b4185ef9aa540e660716ff1697b299a200651a50fc1d3ab3df3763724c6d812"><div class="ttname"><a href="enum__quda_8h.html#af0b4185ef9aa540e660716ff1697b299a200651a50fc1d3ab3df3763724c6d812">QUDA_ASQTAD_MOM_LINKS</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00032">enum_quda.h:32</a></div></div>
<div class="ttc" id="util__quda_8h_html_af3bddfd9d113d50e8e0bbf58a35c5aac"><div class="ttname"><a href="util__quda_8h.html#af3bddfd9d113d50e8e0bbf58a35c5aac">errorQuda</a></div><div class="ttdeci">#define errorQuda(...)</div><div class="ttdef"><b>Definition:</b> <a href="util__quda_8h_source.html#l00121">util_quda.h:121</a></div></div>
<div class="ttc" id="enum__quda_8h_html_acb61fdc14d6b12e8c6177b6d966bd863a335830aa4556580bfcf73019615ec35d"><div class="ttname"><a href="enum__quda_8h.html#acb61fdc14d6b12e8c6177b6d966bd863a335830aa4556580bfcf73019615ec35d">QUDA_BQCD_GAUGE_ORDER</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00046">enum_quda.h:46</a></div></div>
<div class="ttc" id="namespacequda_html_a82845c78c417da7a26d264e491e78a05"><div class="ttname"><a href="namespacequda.html#a82845c78c417da7a26d264e491e78a05">quda::free_gauge_buffer</a></div><div class="ttdeci">void free_gauge_buffer(void *buffer, QudaGaugeFieldOrder order, QudaFieldGeometry geometry)</div><div class="ttdef"><b>Definition:</b> <a href="cuda__gauge__field_8cpp_source.html#l00614">cuda_gauge_field.cpp:614</a></div></div>
<div class="ttc" id="enum__quda_8h_html_a35de1312d8bed4b94234a3092907e0d9a184379764fab0f101cab6f19a8a14690"><div class="ttname"><a href="enum__quda_8h.html#a35de1312d8bed4b94234a3092907e0d9a184379764fab0f101cab6f19a8a14690">QUDA_CUDA_FIELD_LOCATION</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00326">enum_quda.h:326</a></div></div>
<div class="ttc" id="malloc__quda_8h_html_ad733cb3f6cac705c8db7b0afad9b3843"><div class="ttname"><a href="malloc__quda_8h.html#ad733cb3f6cac705c8db7b0afad9b3843">host_free</a></div><div class="ttdeci">#define host_free(ptr)</div><div class="ttdef"><b>Definition:</b> <a href="malloc__quda_8h_source.html#l00071">malloc_quda.h:71</a></div></div>
<div class="ttc" id="enum__quda_8h_html_ac166c47d6ef16f830c164fefe6c8ab90aeac943998f9a94180aa7e472599219c5"><div class="ttname"><a href="enum__quda_8h.html#ac166c47d6ef16f830c164fefe6c8ab90aeac943998f9a94180aa7e472599219c5">QUDA_QUARTER_PRECISION</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00059">enum_quda.h:59</a></div></div>
<div class="ttc" id="enum__quda_8h_html_ac166c47d6ef16f830c164fefe6c8ab90afb568427ae928d5a1330ee47ef03c0b6"><div class="ttname"><a href="enum__quda_8h.html#ac166c47d6ef16f830c164fefe6c8ab90afb568427ae928d5a1330ee47ef03c0b6">QUDA_HALF_PRECISION</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00060">enum_quda.h:60</a></div></div>
<div class="ttc" id="enum__quda_8h_html_acb61fdc14d6b12e8c6177b6d966bd863a85ce3606ffcab0df5df3e6d2b069edc9"><div class="ttname"><a href="enum__quda_8h.html#acb61fdc14d6b12e8c6177b6d966bd863a85ce3606ffcab0df5df3e6d2b069edc9">QUDA_QDP_GAUGE_ORDER</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00041">enum_quda.h:41</a></div></div>
<div class="ttc" id="enum__quda_8h_html_ac15ce1c1afbc117e224b553c8efd5ab7"><div class="ttname"><a href="enum__quda_8h.html#ac15ce1c1afbc117e224b553c8efd5ab7">QudaLinkDirection</a></div><div class="ttdeci">enum QudaLinkDirection_s QudaLinkDirection</div></div>
<div class="ttc" id="classquda_1_1_lattice_field_html_afc02b90543d60148c56402655d874648"><div class="ttname"><a href="classquda_1_1_lattice_field.html#afc02b90543d60148c56402655d874648">quda::LatticeField::backup_h</a></div><div class="ttdeci">char * backup_h</div><div class="ttdef"><b>Definition:</b> <a href="lattice__field_8h_source.html#l00401">lattice_field.h:401</a></div></div>
<div class="ttc" id="namespacequda_html_a8e24b83a48d247f61634d3ca31b084c9"><div class="ttname"><a href="namespacequda.html#a8e24b83a48d247f61634d3ca31b084c9">quda::free_ghost_buffer</a></div><div class="ttdeci">void free_ghost_buffer(void **buffer, QudaGaugeFieldOrder order, QudaFieldGeometry geometry)</div><div class="ttdef"><b>Definition:</b> <a href="cuda__gauge__field_8cpp_source.html#l00623">cuda_gauge_field.cpp:623</a></div></div>
<div class="ttc" id="classquda_1_1_gauge_field_html_ae89fead7b7a46d6ccdb04041373f0632"><div class="ttname"><a href="classquda_1_1_gauge_field.html#ae89fead7b7a46d6ccdb04041373f0632">quda::GaugeField::reconstruct</a></div><div class="ttdeci">QudaReconstructType reconstruct</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field_8h_source.html#l00176">gauge_field.h:176</a></div></div>
<div class="ttc" id="enum__quda_8h_html_a4cad225f00aa7a2e65b0513cc2f4b053a70977ca93ce71cc94cd6a9dcd3625f8b"><div class="ttname"><a href="enum__quda_8h.html#a4cad225f00aa7a2e65b0513cc2f4b053a70977ca93ce71cc94cd6a9dcd3625f8b">QUDA_LINK_BIDIRECTIONAL</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00470">enum_quda.h:470</a></div></div>
<div class="ttc" id="enum__quda_8h_html_ae3c3f9e9961c64a4a34f144d8f87f805aea1e25f58c180e12c9285f26f53f973d"><div class="ttname"><a href="enum__quda_8h.html#ae3c3f9e9961c64a4a34f144d8f87f805aea1e25f58c180e12c9285f26f53f973d">QUDA_NULL_FIELD_CREATE</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00359">enum_quda.h:359</a></div></div>
<div class="ttc" id="classquda_1_1_lattice_field_html_a45f997815ff8532102798a5fdfcde416"><div class="ttname"><a href="classquda_1_1_lattice_field.html#a45f997815ff8532102798a5fdfcde416">quda::LatticeField::x</a></div><div class="ttdeci">int x[QUDA_MAX_DIM]</div><div class="ttdef"><b>Definition:</b> <a href="lattice__field_8h_source.html#l00162">lattice_field.h:162</a></div></div>
<div class="ttc" id="classquda_1_1_gauge_field_html_a612a0607a564fdd24cc803223cd00a44"><div class="ttname"><a href="classquda_1_1_gauge_field.html#a612a0607a564fdd24cc803223cd00a44">quda::GaugeField::abs_max</a></div><div class="ttdeci">double abs_max(int dim=-1) const</div><div class="ttdoc">Compute the absolute maximum of the field (Linfinity norm) </div><div class="ttdef"><b>Definition:</b> <a href="max__gauge_8cu_source.html#l00084">max_gauge.cu:84</a></div></div>
<div class="ttc" id="classquda_1_1_lattice_field_html_a0bca0fd77c8e1820a4788a19131922f5"><div class="ttname"><a href="classquda_1_1_lattice_field.html#a0bca0fd77c8e1820a4788a19131922f5">quda::LatticeField::volume</a></div><div class="ttdeci">int volume</div><div class="ttdef"><b>Definition:</b> <a href="lattice__field_8h_source.html#l00148">lattice_field.h:148</a></div></div>
<div class="ttc" id="enum__quda_8h_html_acb61fdc14d6b12e8c6177b6d966bd863ada452210f42cce91ccd6c4f1d4650576"><div class="ttname"><a href="enum__quda_8h.html#acb61fdc14d6b12e8c6177b6d966bd863ada452210f42cce91ccd6c4f1d4650576">QUDA_TIFR_PADDED_GAUGE_ORDER</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00048">enum_quda.h:48</a></div></div>
<div class="ttc" id="enum__quda_8h_html_acb61fdc14d6b12e8c6177b6d966bd863aa471b8765e76921b5954482c63393c28"><div class="ttname"><a href="enum__quda_8h.html#acb61fdc14d6b12e8c6177b6d966bd863aa471b8765e76921b5954482c63393c28">QUDA_MILC_SITE_GAUGE_ORDER</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00045">enum_quda.h:45</a></div></div>
<div class="ttc" id="enum__quda_8h_html_a4cad225f00aa7a2e65b0513cc2f4b053a764569276c09b35b0923e684b8585821"><div class="ttname"><a href="enum__quda_8h.html#a4cad225f00aa7a2e65b0513cc2f4b053a764569276c09b35b0923e684b8585821">QUDA_LINK_FORWARDS</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00469">enum_quda.h:469</a></div></div>
<div class="ttc" id="classquda_1_1_gauge_field_html_a9c069c0771836252674aa8dd009c2c49"><div class="ttname"><a href="classquda_1_1_gauge_field.html#a9c069c0771836252674aa8dd009c2c49">quda::GaugeField::nFace</a></div><div class="ttdeci">int nFace</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field_8h_source.html#l00173">gauge_field.h:173</a></div></div>
<div class="ttc" id="namespacequda_html"><div class="ttname"><a href="namespacequda.html">quda</a></div><div class="ttdef"><b>Definition:</b> <a href="blas__cublas_8h_source.html#l00005">blas_cublas.h:5</a></div></div>
<div class="ttc" id="classquda_1_1_gauge_field_html_ae13bc82ef4474f3d89b3a25e2000f936"><div class="ttname"><a href="classquda_1_1_gauge_field.html#ae13bc82ef4474f3d89b3a25e2000f936">quda::GaugeField::geometry</a></div><div class="ttdeci">QudaFieldGeometry geometry</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field_8h_source.html#l00174">gauge_field.h:174</a></div></div>
<div class="ttc" id="enum__quda_8h_html_ae3c3f9e9961c64a4a34f144d8f87f805ab0249b95aff915ee4dceca49f75b7f72"><div class="ttname"><a href="enum__quda_8h.html#ae3c3f9e9961c64a4a34f144d8f87f805ab0249b95aff915ee4dceca49f75b7f72">QUDA_REFERENCE_FIELD_CREATE</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00362">enum_quda.h:362</a></div></div>
<div class="ttc" id="pack__test_8cpp_html_aba126262dff054e28bac5c0d901769c8"><div class="ttname"><a href="pack__test_8cpp.html#aba126262dff054e28bac5c0d901769c8">param</a></div><div class="ttdeci">QudaGaugeParam param</div><div class="ttdef"><b>Definition:</b> <a href="pack__test_8cpp_source.html#l00017">pack_test.cpp:17</a></div></div>
<div class="ttc" id="classquda_1_1_lattice_field_html_a96eccffaa1381a45cd03db7bdc4af2f1"><div class="ttname"><a href="classquda_1_1_lattice_field.html#a96eccffaa1381a45cd03db7bdc4af2f1">quda::LatticeField::R</a></div><div class="ttdeci">const int * R() const</div><div class="ttdef"><b>Definition:</b> <a href="lattice__field_8h_source.html#l00536">lattice_field.h:536</a></div></div>
<div class="ttc" id="structquda_1_1_gauge_field_param_html"><div class="ttname"><a href="structquda_1_1_gauge_field_param.html">quda::GaugeFieldParam</a></div><div class="ttdef"><b>Definition:</b> <a href="gauge__field_8h_source.html#l00010">gauge_field.h:10</a></div></div>
<div class="ttc" id="enum__quda_8h_html_a93131cceecad27ce4b964cb184e8d47aa31e2396004ebee77471a7efacb6cde4e"><div class="ttname"><a href="enum__quda_8h.html#a93131cceecad27ce4b964cb184e8d47aa31e2396004ebee77471a7efacb6cde4e">QUDA_GHOST_EXCHANGE_EXTENDED</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00484">enum_quda.h:484</a></div></div>
<div class="ttc" id="classquda_1_1_gauge_field_html_adbc8edd6e827e616d393c9ce5c25cb51"><div class="ttname"><a href="classquda_1_1_gauge_field.html#adbc8edd6e827e616d393c9ce5c25cb51">quda::GaugeField::checkField</a></div><div class="ttdeci">void checkField(const LatticeField &amp;) const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field_8cpp_source.html#l00265">gauge_field.cpp:265</a></div></div>
<div class="ttc" id="comm__quda_8h_html_ae2ff2e1e8bf092e23d79c86377144066"><div class="ttname"><a href="comm__quda_8h.html#ae2ff2e1e8bf092e23d79c86377144066">comm_declare_send_relative</a></div><div class="ttdeci">#define comm_declare_send_relative(buffer, dim, dir, nbytes)</div><div class="ttdef"><b>Definition:</b> <a href="comm__quda_8h_source.html#l00059">comm_quda.h:59</a></div></div>
<div class="ttc" id="enum__quda_8h_html_a4cad225f00aa7a2e65b0513cc2f4b053ac73041d95c92af38448501907265b43b"><div class="ttname"><a href="enum__quda_8h.html#a4cad225f00aa7a2e65b0513cc2f4b053ac73041d95c92af38448501907265b43b">QUDA_LINK_BACKWARDS</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00468">enum_quda.h:468</a></div></div>
<div class="ttc" id="comm__quda_8h_html_aa8fffe807eed8eed45776c04cf0994e4"><div class="ttname"><a href="comm__quda_8h.html#aa8fffe807eed8eed45776c04cf0994e4">comm_declare_receive_relative</a></div><div class="ttdeci">#define comm_declare_receive_relative(buffer, dim, dir, nbytes)</div><div class="ttdef"><b>Definition:</b> <a href="comm__quda_8h_source.html#l00074">comm_quda.h:74</a></div></div>
<div class="ttc" id="classquda_1_1cpu_gauge_field_html_ac1f1359faa0bbbaf288549a1c2d6f354"><div class="ttname"><a href="classquda_1_1cpu_gauge_field.html#ac1f1359faa0bbbaf288549a1c2d6f354">quda::cpuGaugeField::restore</a></div><div class="ttdeci">void restore() const</div><div class="ttdoc">Restores the cpuGaugeField. </div><div class="ttdef"><b>Definition:</b> <a href="cpu__gauge__field_8cpp_source.html#l00362">cpu_gauge_field.cpp:362</a></div></div>
<div class="ttc" id="classquda_1_1_gauge_field_html_a741d99f6a1d461a0fbbb4775d9a4d4ee"><div class="ttname"><a href="classquda_1_1_gauge_field.html#a741d99f6a1d461a0fbbb4775d9a4d4ee">quda::GaugeField::Bytes</a></div><div class="ttdeci">size_t Bytes() const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field_8h_source.html#l00311">gauge_field.h:311</a></div></div>
<div class="ttc" id="classquda_1_1_lattice_field_html_ae64c2423ab6e570c5565fa20945e5c58"><div class="ttname"><a href="classquda_1_1_lattice_field.html#ae64c2423ab6e570c5565fa20945e5c58">quda::LatticeField::mh_recv_back</a></div><div class="ttdeci">MsgHandle * mh_recv_back[2][QUDA_MAX_DIM]</div><div class="ttdef"><b>Definition:</b> <a href="lattice__field_8h_source.html#l00321">lattice_field.h:321</a></div></div>
<div class="ttc" id="classquda_1_1cpu_gauge_field_html_a6f4ec9b03d920ef9ad7ece9adbc10968"><div class="ttname"><a href="classquda_1_1cpu_gauge_field.html#a6f4ec9b03d920ef9ad7ece9adbc10968">quda::cpuGaugeField::copy</a></div><div class="ttdeci">void copy(const GaugeField &amp;src)</div><div class="ttdef"><b>Definition:</b> <a href="cpu__gauge__field_8cpp_source.html#l00261">cpu_gauge_field.cpp:261</a></div></div>
<div class="ttc" id="enum__quda_8h_html_acb61fdc14d6b12e8c6177b6d966bd863adb1a4116b2cbd52bd33641d7400f0989"><div class="ttname"><a href="enum__quda_8h.html#acb61fdc14d6b12e8c6177b6d966bd863adb1a4116b2cbd52bd33641d7400f0989">QUDA_MILC_GAUGE_ORDER</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00044">enum_quda.h:44</a></div></div>
<div class="ttc" id="namespacequda_html_a623d46037fdf4933f8d68b2fa35dc1b8"><div class="ttname"><a href="namespacequda.html#a623d46037fdf4933f8d68b2fa35dc1b8">quda::extractExtendedGaugeGhost</a></div><div class="ttdeci">void extractExtendedGaugeGhost(const GaugeField &amp;u, int dim, const int *R, void **ghost, bool extract)</div><div class="ttdef"><b>Definition:</b> <a href="extract__gauge__ghost__extended_8cu_source.html#l00418">extract_gauge_ghost_extended.cu:418</a></div></div>
<div class="ttc" id="classquda_1_1cpu_gauge_field_html"><div class="ttname"><a href="classquda_1_1cpu_gauge_field.html">quda::cpuGaugeField</a></div><div class="ttdef"><b>Definition:</b> <a href="gauge__field_8h_source.html#l00580">gauge_field.h:580</a></div></div>
<div class="ttc" id="comm__quda_8h_html_a0498a56438662fb30281fb92b5bc40b4"><div class="ttname"><a href="comm__quda_8h.html#a0498a56438662fb30281fb92b5bc40b4">comm_start</a></div><div class="ttdeci">void comm_start(MsgHandle *mh)</div><div class="ttdef"><b>Definition:</b> <a href="comm__mpi_8cpp_source.html#l00216">comm_mpi.cpp:216</a></div></div>
<div class="ttc" id="classquda_1_1_lattice_field_html_a038242dabcf96173e013f3588d0476de"><div class="ttname"><a href="classquda_1_1_lattice_field.html#a038242dabcf96173e013f3588d0476de">quda::LatticeField::ghostExchange</a></div><div class="ttdeci">QudaGhostExchange ghostExchange</div><div class="ttdef"><b>Definition:</b> <a href="lattice__field_8h_source.html#l00186">lattice_field.h:186</a></div></div>
<div class="ttc" id="classquda_1_1cuda_gauge_field_html"><div class="ttname"><a href="classquda_1_1cuda_gauge_field.html">quda::cudaGaugeField</a></div><div class="ttdef"><b>Definition:</b> <a href="gauge__field_8h_source.html#l00404">gauge_field.h:404</a></div></div>
<div class="ttc" id="classquda_1_1_gauge_field_html_a3b7da036cfa15d6d8d65acac1cf41e2a"><div class="ttname"><a href="classquda_1_1_gauge_field.html#a3b7da036cfa15d6d8d65acac1cf41e2a">quda::GaugeField::nInternal</a></div><div class="ttdeci">int nInternal</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field_8h_source.html#l00177">gauge_field.h:177</a></div></div>
<div class="ttc" id="enum__quda_8h_html_acb61fdc14d6b12e8c6177b6d966bd863aa8e1a6764fc9b8a9abaed9f20faf56e6"><div class="ttname"><a href="enum__quda_8h.html#acb61fdc14d6b12e8c6177b6d966bd863aa8e1a6764fc9b8a9abaed9f20faf56e6">QUDA_CPS_WILSON_GAUGE_ORDER</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00043">enum_quda.h:43</a></div></div>
<div class="ttc" id="classquda_1_1_gauge_field_html_a93b1219a2b9d0a7540162587f756a913"><div class="ttname"><a href="classquda_1_1_gauge_field.html#a93b1219a2b9d0a7540162587f756a913">quda::GaugeField::exchange</a></div><div class="ttdeci">void exchange(void **recv, void **send, QudaDirection dir) const</div><div class="ttdoc">Exchange the buffers across all dimensions in a given direction. </div><div class="ttdef"><b>Definition:</b> <a href="gauge__field_8cpp_source.html#l00185">gauge_field.cpp:185</a></div></div>
<div class="ttc" id="namespacequda_html_a0138c2d76b9b477b5a914ed4ff09134b"><div class="ttname"><a href="namespacequda.html#a0138c2d76b9b477b5a914ed4ff09134b">quda::create_gauge_buffer</a></div><div class="ttdeci">void * create_gauge_buffer(size_t bytes, QudaGaugeFieldOrder order, QudaFieldGeometry geometry)</div><div class="ttdef"><b>Definition:</b> <a href="cuda__gauge__field_8cpp_source.html#l00591">cuda_gauge_field.cpp:591</a></div></div>
<div class="ttc" id="classquda_1_1cpu_gauge_field_html_a31d35c35d809f3907d76408bcd10ca86"><div class="ttname"><a href="classquda_1_1cpu_gauge_field.html#a31d35c35d809f3907d76408bcd10ca86">quda::cpuGaugeField::Gauge_p</a></div><div class="ttdeci">void * Gauge_p()</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field_8h_source.html#l00642">gauge_field.h:642</a></div></div>
<div class="ttc" id="classquda_1_1_lattice_field_html_a6ee46dcc8b34e13646a2729e37b7bd7e"><div class="ttname"><a href="classquda_1_1_lattice_field.html#a6ee46dcc8b34e13646a2729e37b7bd7e">quda::LatticeField::ghost_bytes</a></div><div class="ttdeci">size_t ghost_bytes</div><div class="ttdef"><b>Definition:</b> <a href="lattice__field_8h_source.html#l00247">lattice_field.h:247</a></div></div>
<div class="ttc" id="classquda_1_1_gauge_field_html_aedfa91e714c61b8e11caec9d2703dcfa"><div class="ttname"><a href="classquda_1_1_gauge_field.html#aedfa91e714c61b8e11caec9d2703dcfa">quda::GaugeField::Ghost</a></div><div class="ttdeci">const void ** Ghost() const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field_8h_source.html#l00323">gauge_field.h:323</a></div></div>
<div class="ttc" id="enum__quda_8h_html_a5e790fc01ee46c70ab9a83d1fff88d4c"><div class="ttname"><a href="enum__quda_8h.html#a5e790fc01ee46c70ab9a83d1fff88d4c">QudaGaugeFieldOrder</a></div><div class="ttdeci">enum QudaGaugeFieldOrder_s QudaGaugeFieldOrder</div></div>
<div class="ttc" id="comm__quda_8h_html_aaf356c30715ea44b84953c66f65c1ef9"><div class="ttname"><a href="comm__quda_8h.html#aaf356c30715ea44b84953c66f65c1ef9">comm_free</a></div><div class="ttdeci">void comm_free(MsgHandle *&amp;mh)</div><div class="ttdef"><b>Definition:</b> <a href="comm__mpi_8cpp_source.html#l00207">comm_mpi.cpp:207</a></div></div>
<div class="ttc" id="classquda_1_1cpu_gauge_field_html_ab040665b9d326ac8929b77553b6d6f8a"><div class="ttname"><a href="classquda_1_1cpu_gauge_field.html#ab040665b9d326ac8929b77553b6d6f8a">quda::cpuGaugeField::injectGhost</a></div><div class="ttdeci">void injectGhost(QudaLinkDirection link_direction=QUDA_LINK_BACKWARDS)</div><div class="ttdoc">The opposite of exchangeGhost: take the ghost zone on x, send to node x-1, and inject back into the f...</div><div class="ttdef"><b>Definition:</b> <a href="cpu__gauge__field_8cpp_source.html#l00169">cpu_gauge_field.cpp:169</a></div></div>
<div class="ttc" id="classquda_1_1cpu_gauge_field_html_a39d563f4f56b019f34c81699678993a8"><div class="ttname"><a href="classquda_1_1cpu_gauge_field.html#a39d563f4f56b019f34c81699678993a8">quda::cpuGaugeField::~cpuGaugeField</a></div><div class="ttdeci">virtual ~cpuGaugeField()</div><div class="ttdef"><b>Definition:</b> <a href="cpu__gauge__field_8cpp_source.html#l00102">cpu_gauge_field.cpp:102</a></div></div>
<div class="ttc" id="classquda_1_1_lattice_field_html_a4ce6b8f181b1cbfaa755160e69fa85e7"><div class="ttname"><a href="classquda_1_1_lattice_field.html#a4ce6b8f181b1cbfaa755160e69fa85e7">quda::LatticeField::nDim</a></div><div class="ttdeci">int nDim</div><div class="ttdef"><b>Definition:</b> <a href="lattice__field_8h_source.html#l00159">lattice_field.h:159</a></div></div>
<div class="ttc" id="classquda_1_1cpu_gauge_field_html_ae36e574312c5cb03633ee75cd75c1901"><div class="ttname"><a href="classquda_1_1cpu_gauge_field.html#ae36e574312c5cb03633ee75cd75c1901">quda::cpuGaugeField::gauge</a></div><div class="ttdeci">void ** gauge</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field_8h_source.html#l00587">gauge_field.h:587</a></div></div>
<div class="ttc" id="enum__quda_8h_html_a7589b295019a40887f1c10c76555feeaa2cc101847eb2a925159b08346100da2d"><div class="ttname"><a href="enum__quda_8h.html#a7589b295019a40887f1c10c76555feeaa2cc101847eb2a925159b08346100da2d">QUDA_VECTOR_GEOMETRY</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00475">enum_quda.h:475</a></div></div>
<div class="ttc" id="malloc__quda_8h_html_a45d92b2c2231b848192b3086283d05b6"><div class="ttname"><a href="malloc__quda_8h.html#a45d92b2c2231b848192b3086283d05b6">safe_malloc</a></div><div class="ttdeci">#define safe_malloc(size)</div><div class="ttdef"><b>Definition:</b> <a href="malloc__quda_8h_source.html#l00066">malloc_quda.h:66</a></div></div>
<div class="ttc" id="classquda_1_1_lattice_field_html_a174488c5533899d5117c56efcfe5a55c"><div class="ttname"><a href="classquda_1_1_lattice_field.html#a174488c5533899d5117c56efcfe5a55c">quda::LatticeField::mh_send_fwd</a></div><div class="ttdeci">MsgHandle * mh_send_fwd[2][QUDA_MAX_DIM]</div><div class="ttdef"><b>Definition:</b> <a href="lattice__field_8h_source.html#l00324">lattice_field.h:324</a></div></div>
<div class="ttc" id="enum__quda_8h_html_acb61fdc14d6b12e8c6177b6d966bd863a4ba8fd46dcb8d319a6632eebbe2da32b"><div class="ttname"><a href="enum__quda_8h.html#acb61fdc14d6b12e8c6177b6d966bd863a4ba8fd46dcb8d319a6632eebbe2da32b">QUDA_TIFR_GAUGE_ORDER</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00047">enum_quda.h:47</a></div></div>
<div class="ttc" id="covdev__reference_8cpp_html_ace6ee45c30e71865e6eb635200379db9"><div class="ttname"><a href="covdev__reference_8cpp.html#ace6ee45c30e71865e6eb635200379db9">memset</a></div><div class="ttdeci">void * memset(void *s, int c, size_t n)</div></div>
<div class="ttc" id="classquda_1_1cpu_gauge_field_html_aed4d23cd5eac14f6e2661f09a345254e"><div class="ttname"><a href="classquda_1_1cpu_gauge_field.html#aed4d23cd5eac14f6e2661f09a345254e">quda::cpuGaugeField::cpuGaugeField</a></div><div class="ttdeci">cpuGaugeField(const GaugeFieldParam &amp;param)</div><div class="ttdoc">Constructor for cpuGaugeField from a GaugeFieldParam. </div><div class="ttdef"><b>Definition:</b> <a href="cpu__gauge__field_8cpp_source.html#l00009">cpu_gauge_field.cpp:9</a></div></div>
<div class="ttc" id="classquda_1_1_lattice_field_html_a9b454a5960bbe5c51085185de2a58ba5"><div class="ttname"><a href="classquda_1_1_lattice_field.html#a9b454a5960bbe5c51085185de2a58ba5">quda::LatticeField::surface</a></div><div class="ttdeci">int surface[QUDA_MAX_DIM]</div><div class="ttdef"><b>Definition:</b> <a href="lattice__field_8h_source.html#l00164">lattice_field.h:164</a></div></div>
<div class="ttc" id="malloc__quda_8h_html_a003773656f4cb295ca2494f4d62189d7"><div class="ttname"><a href="malloc__quda_8h.html#a003773656f4cb295ca2494f4d62189d7">pool_pinned_malloc</a></div><div class="ttdeci">#define pool_pinned_malloc(size)</div><div class="ttdef"><b>Definition:</b> <a href="malloc__quda_8h_source.html#l00127">malloc_quda.h:127</a></div></div>
<div class="ttc" id="classquda_1_1cpu_gauge_field_html_aa51ad073b8ec007f2e377865e7809695"><div class="ttname"><a href="classquda_1_1cpu_gauge_field.html#aa51ad073b8ec007f2e377865e7809695">quda::cpuGaugeField::backup</a></div><div class="ttdeci">void backup() const</div><div class="ttdoc">Backs up the cpuGaugeField. </div><div class="ttdef"><b>Definition:</b> <a href="cpu__gauge__field_8cpp_source.html#l00344">cpu_gauge_field.cpp:344</a></div></div>
<div class="ttc" id="classquda_1_1cpu_gauge_field_html_abcb214de4fba03d89b8d4a83db847b1d"><div class="ttname"><a href="classquda_1_1cpu_gauge_field.html#abcb214de4fba03d89b8d4a83db847b1d">quda::cpuGaugeField::exchangeGhost</a></div><div class="ttdeci">void exchangeGhost(QudaLinkDirection link_direction=QUDA_LINK_BACKWARDS)</div><div class="ttdoc">Exchange the ghost and store store in the padded region. </div><div class="ttdef"><b>Definition:</b> <a href="cpu__gauge__field_8cpp_source.html#l00136">cpu_gauge_field.cpp:136</a></div></div>
<div class="ttc" id="namespacequda_html_a037d22e360b272cb3c5be04675a29b0c"><div class="ttname"><a href="namespacequda.html#a037d22e360b272cb3c5be04675a29b0c">quda::create_ghost_buffer</a></div><div class="ttdeci">void ** create_ghost_buffer(size_t bytes[], QudaGaugeFieldOrder order, QudaFieldGeometry geometry)</div><div class="ttdef"><b>Definition:</b> <a href="cuda__gauge__field_8cpp_source.html#l00602">cuda_gauge_field.cpp:602</a></div></div>
<div class="ttc" id="classquda_1_1_gauge_field_html_a03852c1e5b42346de487927370ea3d36"><div class="ttname"><a href="classquda_1_1_gauge_field.html#a03852c1e5b42346de487927370ea3d36">quda::GaugeField::link_type</a></div><div class="ttdeci">QudaLinkType link_type</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field_8h_source.html#l00180">gauge_field.h:180</a></div></div>
<div class="ttc" id="classquda_1_1_gauge_field_html_a6d424948785fbc67b92e1f9febf028be"><div class="ttname"><a href="classquda_1_1_gauge_field.html#a6d424948785fbc67b92e1f9febf028be">quda::GaugeField::LinkMax</a></div><div class="ttdeci">const double &amp; LinkMax() const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field_8h_source.html#l00280">gauge_field.h:280</a></div></div>
<div class="ttc" id="classquda_1_1cpu_gauge_field_html_abb49e71af68b8645ab37ef49c17f4c78"><div class="ttname"><a href="classquda_1_1cpu_gauge_field.html#abb49e71af68b8645ab37ef49c17f4c78">quda::cpuGaugeField::zero</a></div><div class="ttdeci">void zero()</div><div class="ttdef"><b>Definition:</b> <a href="cpu__gauge__field_8cpp_source.html#l00381">cpu_gauge_field.cpp:381</a></div></div>
<div class="ttc" id="structquda_1_1_gauge_field_param_html_a7770a935ed1d6c57d15a993c60ac5734"><div class="ttname"><a href="structquda_1_1_gauge_field_param.html#a7770a935ed1d6c57d15a993c60ac5734">quda::GaugeFieldParam::gauge</a></div><div class="ttdeci">void * gauge</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field_8h_source.html#l00024">gauge_field.h:24</a></div></div>
<div class="ttc" id="classquda_1_1_gauge_field_html_a0c619418f3faa2dddbb7547bffe9aa77"><div class="ttname"><a href="classquda_1_1_gauge_field.html#a0c619418f3faa2dddbb7547bffe9aa77">quda::GaugeField::create</a></div><div class="ttdeci">QudaFieldCreate create</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field_8h_source.html#l00187">gauge_field.h:187</a></div></div>
<div class="ttc" id="classquda_1_1_gauge_field_html_a57ea39fb5f0a5d5d0ac4a3a31717e162"><div class="ttname"><a href="classquda_1_1_gauge_field.html#a57ea39fb5f0a5d5d0ac4a3a31717e162">quda::GaugeField::nColor</a></div><div class="ttdeci">int nColor</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field_8h_source.html#l00172">gauge_field.h:172</a></div></div>
<div class="ttc" id="classquda_1_1_time_profile_html"><div class="ttname"><a href="classquda_1_1_time_profile.html">quda::TimeProfile</a></div><div class="ttdef"><b>Definition:</b> <a href="timer_8h_source.html#l00171">timer.h:171</a></div></div>
<div class="ttc" id="enum__quda_8h_html_a91c65a84d19d3d74f84fa06888d256b0a7f0d3766d3d7f169d8afffb789d0329b"><div class="ttname"><a href="enum__quda_8h.html#a91c65a84d19d3d74f84fa06888d256b0a7f0d3766d3d7f169d8afffb789d0329b">QUDA_FORWARDS</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00463">enum_quda.h:463</a></div></div>
<div class="ttc" id="classquda_1_1_gauge_field_html_a78d11ce3fbd8e63151ee5f12eb874733"><div class="ttname"><a href="classquda_1_1_gauge_field.html#a78d11ce3fbd8e63151ee5f12eb874733">quda::GaugeField::fat_link_max</a></div><div class="ttdeci">double fat_link_max</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field_8h_source.html#l00185">gauge_field.h:185</a></div></div>
<div class="ttc" id="enum__quda_8h_html_a7e13e13f465c82f4802f71dfdf551b33"><div class="ttname"><a href="enum__quda_8h.html#a7e13e13f465c82f4802f71dfdf551b33">QudaFieldGeometry</a></div><div class="ttdeci">enum QudaFieldGeometry_s QudaFieldGeometry</div></div>
<div class="ttc" id="classquda_1_1_gauge_field_html_a5169ef7014b57198e730f3df202a1be5"><div class="ttname"><a href="classquda_1_1_gauge_field.html#a5169ef7014b57198e730f3df202a1be5">quda::GaugeField::site_size</a></div><div class="ttdeci">size_t site_size</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field_8h_source.html#l00224">gauge_field.h:224</a></div></div>
<div class="ttc" id="enum__quda_8h_html_a7589b295019a40887f1c10c76555feeaadc1a5ef802228fe4edd42346172c7605"><div class="ttname"><a href="enum__quda_8h.html#a7589b295019a40887f1c10c76555feeaadc1a5ef802228fe4edd42346172c7605">QUDA_COARSE_GEOMETRY</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00477">enum_quda.h:477</a></div></div>
<div class="ttc" id="quda__constants_8h_html_aa69925e50554e0ea81dd89fdcb572bbc"><div class="ttname"><a href="quda__constants_8h.html#aa69925e50554e0ea81dd89fdcb572bbc">QUDA_MAX_DIM</a></div><div class="ttdeci">#define QUDA_MAX_DIM</div><div class="ttdoc">Maximum number of dimensions supported by QUDA. In practice, no routines make use of more than 5...</div><div class="ttdef"><b>Definition:</b> <a href="quda__constants_8h_source.html#l00017">quda_constants.h:17</a></div></div>
<div class="ttc" id="util__quda_8h_html_a7668e6580e0f57b0db3112fae4959e34"><div class="ttname"><a href="util__quda_8h.html#a7668e6580e0f57b0db3112fae4959e34">checkCudaError</a></div><div class="ttdeci">#define checkCudaError()</div><div class="ttdef"><b>Definition:</b> <a href="util__quda_8h_source.html#l00161">util_quda.h:161</a></div></div>
<div class="ttc" id="structquda_1_1_gauge_field_param_html_aad5aed7f9db904d6a40d696e3b5c4108"><div class="ttname"><a href="structquda_1_1_gauge_field_param.html#aad5aed7f9db904d6a40d696e3b5c4108">quda::GaugeFieldParam::compute_fat_link_max</a></div><div class="ttdeci">bool compute_fat_link_max</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field_8h_source.html#l00033">gauge_field.h:33</a></div></div>
<div class="ttc" id="classquda_1_1_lattice_field_html_acfb0f79a3f5896fa2d6c876571e21d3f"><div class="ttname"><a href="classquda_1_1_lattice_field.html#acfb0f79a3f5896fa2d6c876571e21d3f">quda::LatticeField::mh_recv_fwd</a></div><div class="ttdeci">MsgHandle * mh_recv_fwd[2][QUDA_MAX_DIM]</div><div class="ttdef"><b>Definition:</b> <a href="lattice__field_8h_source.html#l00318">lattice_field.h:318</a></div></div>
<div class="ttc" id="enum__quda_8h_html_a7589b295019a40887f1c10c76555feeaa090d4c508b643d4c75242cb54b8fa819"><div class="ttname"><a href="enum__quda_8h.html#a7589b295019a40887f1c10c76555feeaa090d4c508b643d4c75242cb54b8fa819">QUDA_SCALAR_GEOMETRY</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00474">enum_quda.h:474</a></div></div>
<div class="ttc" id="enum__quda_8h_html_ae3c3f9e9961c64a4a34f144d8f87f805a0a7b5b5ebe4058a465669eee83915158"><div class="ttname"><a href="enum__quda_8h.html#ae3c3f9e9961c64a4a34f144d8f87f805a0a7b5b5ebe4058a465669eee83915158">QUDA_ZERO_FIELD_CREATE</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00360">enum_quda.h:360</a></div></div>
<div class="ttc" id="comm__quda_8h_html_aa949084ae3512a75d7218748b38f7015"><div class="ttname"><a href="comm__quda_8h.html#aa949084ae3512a75d7218748b38f7015">comm_wait</a></div><div class="ttdeci">void comm_wait(MsgHandle *mh)</div><div class="ttdef"><b>Definition:</b> <a href="comm__mpi_8cpp_source.html#l00222">comm_mpi.cpp:222</a></div></div>
<div class="ttc" id="classquda_1_1_gauge_field_html_a3d8cbee3feea3f19fb40d3c28de398e3"><div class="ttname"><a href="classquda_1_1_gauge_field.html#a3d8cbee3feea3f19fb40d3c28de398e3">quda::GaugeField::order</a></div><div class="ttdeci">QudaGaugeFieldOrder order</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field_8h_source.html#l00178">gauge_field.h:178</a></div></div>
<div class="ttc" id="classquda_1_1_lattice_field_html_ac28a222cabb75e131517b3f129807bd6"><div class="ttname"><a href="classquda_1_1_lattice_field.html#ac28a222cabb75e131517b3f129807bd6">quda::LatticeField::GhostExchange</a></div><div class="ttdeci">QudaGhostExchange GhostExchange() const</div><div class="ttdef"><b>Definition:</b> <a href="lattice__field_8h_source.html#l00541">lattice_field.h:541</a></div></div>
<div class="ttc" id="enum__quda_8h_html_a93131cceecad27ce4b964cb184e8d47aaab94b36fc680dd39f976636dac350e53"><div class="ttname"><a href="enum__quda_8h.html#a93131cceecad27ce4b964cb184e8d47aaab94b36fc680dd39f976636dac350e53">QUDA_GHOST_EXCHANGE_PAD</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00483">enum_quda.h:483</a></div></div>
<div class="ttc" id="classquda_1_1_gauge_field_html_aca7e53965b88761140d7bf4a78ecd935"><div class="ttname"><a href="classquda_1_1_gauge_field.html#aca7e53965b88761140d7bf4a78ecd935">quda::GaugeField::isNative</a></div><div class="ttdeci">bool isNative() const</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field_8cpp_source.html#l00167">gauge_field.cpp:167</a></div></div>
<div class="ttc" id="classquda_1_1_gauge_field_html_a126627f0f24e3bacedb464ae5061216a"><div class="ttname"><a href="classquda_1_1_gauge_field.html#a126627f0f24e3bacedb464ae5061216a">quda::GaugeField::ghost</a></div><div class="ttdeci">void * ghost[2 *QUDA_MAX_DIM]</div><div class="ttdef"><b>Definition:</b> <a href="gauge__field_8h_source.html#l00189">gauge_field.h:189</a></div></div>
<div class="ttc" id="enum__quda_8h_html_a7589b295019a40887f1c10c76555feeaadad7f340080258c972d126a9b8b571b3"><div class="ttname"><a href="enum__quda_8h.html#a7589b295019a40887f1c10c76555feeaadad7f340080258c972d126a9b8b571b3">QUDA_TENSOR_GEOMETRY</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00476">enum_quda.h:476</a></div></div>
<div class="ttc" id="enum__quda_8h_html_a35de1312d8bed4b94234a3092907e0d9abe95344eb6e5a15d46e3bab3c5291617"><div class="ttname"><a href="enum__quda_8h.html#a35de1312d8bed4b94234a3092907e0d9abe95344eb6e5a15d46e3bab3c5291617">QUDA_CPU_FIELD_LOCATION</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00325">enum_quda.h:325</a></div></div>
<div class="ttc" id="classquda_1_1_lattice_field_html_a6535520c1cb96795a40de1df52218f2d"><div class="ttname"><a href="classquda_1_1_lattice_field.html#a6535520c1cb96795a40de1df52218f2d">quda::LatticeField::precision</a></div><div class="ttdeci">QudaPrecision precision</div><div class="ttdef"><b>Definition:</b> <a href="lattice__field_8h_source.html#l00171">lattice_field.h:171</a></div></div>
<div class="ttc" id="classquda_1_1_lattice_field_html_ab968c83742bbbe049ca56c42aba0fc18"><div class="ttname"><a href="classquda_1_1_lattice_field.html#ab968c83742bbbe049ca56c42aba0fc18">quda::LatticeField::mh_send_back</a></div><div class="ttdeci">MsgHandle * mh_send_back[2][QUDA_MAX_DIM]</div><div class="ttdef"><b>Definition:</b> <a href="lattice__field_8h_source.html#l00327">lattice_field.h:327</a></div></div>
<div class="ttc" id="enum__quda_8h_html_af0b4185ef9aa540e660716ff1697b299aec0244661633b9cf637f77d16e46afc8"><div class="ttname"><a href="enum__quda_8h.html#af0b4185ef9aa540e660716ff1697b299aec0244661633b9cf637f77d16e46afc8">QUDA_ASQTAD_FAT_LINKS</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00030">enum_quda.h:30</a></div></div>
<div class="ttc" id="gauge__field_8h_html"><div class="ttname"><a href="gauge__field_8h.html">gauge_field.h</a></div></div>
<div class="ttc" id="namespacequda_html_ad288ddd1679350fa258fa42bd22accd4"><div class="ttname"><a href="namespacequda.html#ad288ddd1679350fa258fa42bd22accd4">quda::copyExtendedGauge</a></div><div class="ttdeci">void copyExtendedGauge(GaugeField &amp;out, const GaugeField &amp;in, QudaFieldLocation location, void *Out=0, void *In=0)</div><div class="ttdef"><b>Definition:</b> <a href="copy__gauge__extended_8cu_source.html#l00343">copy_gauge_extended.cu:343</a></div></div>
<div class="ttc" id="struct_msg_handle__s_html"><div class="ttname"><a href="struct_msg_handle__s.html">MsgHandle_s</a></div><div class="ttdef"><b>Definition:</b> <a href="comm__mpi_8cpp_source.html#l00024">comm_mpi.cpp:24</a></div></div>
<div class="ttc" id="comm__quda_8h_html_a9390c85afcad52ee6919c40cf85cbc2d"><div class="ttname"><a href="comm__quda_8h.html#a9390c85afcad52ee6919c40cf85cbc2d">comm_dim_partitioned</a></div><div class="ttdeci">int comm_dim_partitioned(int dim)</div><div class="ttdef"><b>Definition:</b> <a href="comm__common_8cpp_source.html#l00635">comm_common.cpp:635</a></div></div>
<div class="ttc" id="namespacequda_html_a8ad4f224c5228606d725a5f9a96c3f23a5783ef35aa9146682a943da4086c867a"><div class="ttname"><a href="namespacequda.html#a8ad4f224c5228606d725a5f9a96c3f23a5783ef35aa9146682a943da4086c867a">quda::QUDA_PROFILE_COMMS</a></div><div class="ttdef"><b>Definition:</b> <a href="timer_8h_source.html#l00109">timer.h:109</a></div></div>
<div class="ttc" id="quda__internal_8h_html"><div class="ttname"><a href="quda__internal_8h.html">quda_internal.h</a></div></div>
<div class="ttc" id="classquda_1_1_gauge_field_html"><div class="ttname"><a href="classquda_1_1_gauge_field.html">quda::GaugeField</a></div><div class="ttdef"><b>Definition:</b> <a href="gauge__field_8h_source.html#l00164">gauge_field.h:164</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
