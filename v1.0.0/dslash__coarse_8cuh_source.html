<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>QUDA: include/kernels/dslash_coarse.cuh Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">QUDA
   &#160;<span id="projectnumber">1.0.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_f2fd8bd6424c93166d6dd5f2b70706e7.html">kernels</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">dslash_coarse.cuh</div>  </div>
</div><!--header-->
<div class="contents">
<a href="dslash__coarse_8cuh.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="gauge__field__order_8h.html">gauge_field_order.h</a>&gt;</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="color__spinor__field__order_8h.html">color_spinor_field_order.h</a>&gt;</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="index__helper_8cuh.html">index_helper.cuh</a>&gt;</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="cub__helper_8cuh.html">cub_helper.cuh</a>&gt;</span> <span class="comment">// for vector_type</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#if (__COMPUTE_CAPABILITY__ &gt;= 300 || __CUDA_ARCH__ &gt;= 300)</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &lt;generics/shfl.h&gt;</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// splitting the dot-product between threads is buggy with CUDA 7.0</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#if __COMPUTE_CAPABILITY__ &gt;= 300 &amp;&amp; CUDA_VERSION &gt;= 7050</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#define DOT_PRODUCT_SPLIT</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacequda.html">quda</a> {</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;</div><div class="line"><a name="l00016"></a><span class="lineno"><a class="line" href="namespacequda.html#ae4a6349400e866db880cd96fb2fc4bbb">   16</a></span>&#160;  <span class="keyword">enum</span> <a class="code" href="namespacequda.html#ae4a6349400e866db880cd96fb2fc4bbb">DslashType</a> {</div><div class="line"><a name="l00017"></a><span class="lineno"><a class="line" href="namespacequda.html#ae4a6349400e866db880cd96fb2fc4bbba0c488e5576fd49a90d630b5f26e617c9">   17</a></span>&#160;    <a class="code" href="namespacequda.html#ae4a6349400e866db880cd96fb2fc4bbba0c488e5576fd49a90d630b5f26e617c9">DSLASH_INTERIOR</a>,</div><div class="line"><a name="l00018"></a><span class="lineno"><a class="line" href="namespacequda.html#ae4a6349400e866db880cd96fb2fc4bbba2d25e69c23e3dc7e917abacbee47f752">   18</a></span>&#160;    <a class="code" href="namespacequda.html#ae4a6349400e866db880cd96fb2fc4bbba2d25e69c23e3dc7e917abacbee47f752">DSLASH_EXTERIOR</a>,</div><div class="line"><a name="l00019"></a><span class="lineno"><a class="line" href="namespacequda.html#ae4a6349400e866db880cd96fb2fc4bbba07064ad40fe6fbf8f729a259a1b5be09">   19</a></span>&#160;    <a class="code" href="namespacequda.html#ae4a6349400e866db880cd96fb2fc4bbba07064ad40fe6fbf8f729a259a1b5be09">DSLASH_FULL</a></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;  };</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Float, <span class="keyword">typename</span> yFloat, <span class="keyword">typename</span> ghostFloat, <span class="keywordtype">int</span> coarseSpin, <span class="keywordtype">int</span> coarseColor, QudaFieldOrder csOrder, QudaGaugeFieldOrder gOrder&gt;</div><div class="line"><a name="l00023"></a><span class="lineno"><a class="line" href="structquda_1_1_dslash_coarse_arg.html">   23</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structquda_1_1_dslash_coarse_arg.html">DslashCoarseArg</a> {</div><div class="line"><a name="l00024"></a><span class="lineno"><a class="line" href="structquda_1_1_dslash_coarse_arg.html#a106ca1ab52da81d6c5fc43c3badc5ba0">   24</a></span>&#160;    <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="classquda_1_1colorspinor_1_1_field_order_c_b.html">colorspinor::FieldOrderCB&lt;Float,coarseSpin,coarseColor,1,csOrder,Float,ghostFloat&gt;</a> <a class="code" href="structquda_1_1_dslash_coarse_arg.html#a106ca1ab52da81d6c5fc43c3badc5ba0">F</a>;</div><div class="line"><a name="l00025"></a><span class="lineno"><a class="line" href="structquda_1_1_dslash_coarse_arg.html#aa64cf30070b5737aa439a7c4b33c3424">   25</a></span>&#160;    <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="structquda_1_1gauge_1_1_field_order.html">gauge::FieldOrder&lt;Float,coarseColor*coarseSpin,coarseSpin,gOrder,true,yFloat&gt;</a> <a class="code" href="structquda_1_1_dslash_coarse_arg.html#aa64cf30070b5737aa439a7c4b33c3424">G</a>;</div><div class="line"><a name="l00026"></a><span class="lineno"><a class="line" href="structquda_1_1_dslash_coarse_arg.html#a93b0b5c420e55c6c7f1631036c820fd0">   26</a></span>&#160;    <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="structquda_1_1gauge_1_1_field_order.html">gauge::FieldOrder&lt;Float,coarseColor*coarseSpin,coarseSpin,gOrder,true,yFloat&gt;</a> <a class="code" href="structquda_1_1_dslash_coarse_arg.html#a93b0b5c420e55c6c7f1631036c820fd0">GY</a>;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div><div class="line"><a name="l00028"></a><span class="lineno"><a class="line" href="structquda_1_1_dslash_coarse_arg.html#a4d8ac7ff508ad74014c3dcd6d459dae4">   28</a></span>&#160;    F <a class="code" href="structquda_1_1_dslash_coarse_arg.html#a4d8ac7ff508ad74014c3dcd6d459dae4">out</a>;</div><div class="line"><a name="l00029"></a><span class="lineno"><a class="line" href="structquda_1_1_dslash_coarse_arg.html#a5ca9268a23a76ad49bae6b2a57a9be09">   29</a></span>&#160;    <span class="keyword">const</span> F <a class="code" href="structquda_1_1_dslash_coarse_arg.html#a5ca9268a23a76ad49bae6b2a57a9be09">inA</a>;</div><div class="line"><a name="l00030"></a><span class="lineno"><a class="line" href="structquda_1_1_dslash_coarse_arg.html#a68882f597d6b40ea04b4898c17646c53">   30</a></span>&#160;    <span class="keyword">const</span> F <a class="code" href="structquda_1_1_dslash_coarse_arg.html#a68882f597d6b40ea04b4898c17646c53">inB</a>;</div><div class="line"><a name="l00031"></a><span class="lineno"><a class="line" href="structquda_1_1_dslash_coarse_arg.html#a52f2ed1783d6ac42d59398e5e6edeabc">   31</a></span>&#160;    <span class="keyword">const</span> GY <a class="code" href="structquda_1_1_dslash_coarse_arg.html#a52f2ed1783d6ac42d59398e5e6edeabc">Y</a>;</div><div class="line"><a name="l00032"></a><span class="lineno"><a class="line" href="structquda_1_1_dslash_coarse_arg.html#a96d0ee1e620ff15340fbcc7692652141">   32</a></span>&#160;    <span class="keyword">const</span> GY <a class="code" href="structquda_1_1_dslash_coarse_arg.html#a96d0ee1e620ff15340fbcc7692652141">X</a>;</div><div class="line"><a name="l00033"></a><span class="lineno"><a class="line" href="structquda_1_1_dslash_coarse_arg.html#aeeaf9dada95a18bb82fff290349613e6">   33</a></span>&#160;    <span class="keyword">const</span> Float <a class="code" href="structquda_1_1_dslash_coarse_arg.html#aeeaf9dada95a18bb82fff290349613e6">kappa</a>;</div><div class="line"><a name="l00034"></a><span class="lineno"><a class="line" href="structquda_1_1_dslash_coarse_arg.html#abf7ccaf7203aad235f924cca0e018ddb">   34</a></span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1_dslash_coarse_arg.html#abf7ccaf7203aad235f924cca0e018ddb">parity</a>; <span class="comment">// only use this for single parity fields</span></div><div class="line"><a name="l00035"></a><span class="lineno"><a class="line" href="structquda_1_1_dslash_coarse_arg.html#acbcbbe3cbb057286bcdd8061523b8fb3">   35</a></span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1_dslash_coarse_arg.html#acbcbbe3cbb057286bcdd8061523b8fb3">nParity</a>; <span class="comment">// number of parities we&#39;re working on</span></div><div class="line"><a name="l00036"></a><span class="lineno"><a class="line" href="structquda_1_1_dslash_coarse_arg.html#aab856074e4ff7e0035ec995cc9e0e0e0">   36</a></span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1_dslash_coarse_arg.html#aab856074e4ff7e0035ec995cc9e0e0e0">nFace</a>;  <span class="comment">// hard code to 1 for now</span></div><div class="line"><a name="l00037"></a><span class="lineno"><a class="line" href="structquda_1_1_dslash_coarse_arg.html#a01c6ccfdb8167003377bb304a5bafa60">   37</a></span>&#160;    <span class="keyword">const</span> <a class="code" href="classint__fastdiv.html">int_fastdiv</a> <a class="code" href="structquda_1_1_dslash_coarse_arg.html#a01c6ccfdb8167003377bb304a5bafa60">X0h</a>; <span class="comment">// X[0]/2</span></div><div class="line"><a name="l00038"></a><span class="lineno"><a class="line" href="structquda_1_1_dslash_coarse_arg.html#a0c580784884d08c8419bc2c4bea2deee">   38</a></span>&#160;    <span class="keyword">const</span> <a class="code" href="classint__fastdiv.html">int_fastdiv</a> <a class="code" href="structquda_1_1_dslash_coarse_arg.html#a0c580784884d08c8419bc2c4bea2deee">dim</a>[5];   <span class="comment">// full lattice dimensions</span></div><div class="line"><a name="l00039"></a><span class="lineno"><a class="line" href="structquda_1_1_dslash_coarse_arg.html#a348a73523b141fccf1295ce5efdcf810">   39</a></span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1_dslash_coarse_arg.html#a348a73523b141fccf1295ce5efdcf810">commDim</a>[4]; <span class="comment">// whether a given dimension is partitioned or not</span></div><div class="line"><a name="l00040"></a><span class="lineno"><a class="line" href="structquda_1_1_dslash_coarse_arg.html#ab29553ad8872a31a511d19b7ab9a7072">   40</a></span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1_dslash_coarse_arg.html#ab29553ad8872a31a511d19b7ab9a7072">volumeCB</a>;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div><div class="line"><a name="l00042"></a><span class="lineno"><a class="line" href="structquda_1_1_dslash_coarse_arg.html#addcfe55b9f2f442e061c6cf0b9d9747b">   42</a></span>&#160;    <span class="keyword">inline</span> <a class="code" href="structquda_1_1_dslash_coarse_arg.html#addcfe55b9f2f442e061c6cf0b9d9747b">DslashCoarseArg</a>(<a class="code" href="classquda_1_1_color_spinor_field.html">ColorSpinorField</a> &amp;out, <span class="keyword">const</span> <a class="code" href="classquda_1_1_color_spinor_field.html">ColorSpinorField</a> &amp;inA, <span class="keyword">const</span> <a class="code" href="classquda_1_1_color_spinor_field.html">ColorSpinorField</a> &amp;inB,</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;         <span class="keyword">const</span> <a class="code" href="classquda_1_1_gauge_field.html">GaugeField</a> &amp;Y, <span class="keyword">const</span> <a class="code" href="classquda_1_1_gauge_field.html">GaugeField</a> &amp;X, Float kappa, <span class="keywordtype">int</span> parity)</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;      : out(const_cast&lt;<a class="code" href="classquda_1_1_color_spinor_field.html">ColorSpinorField</a>&amp;&gt;(out)), inA(const_cast&lt;<a class="code" href="classquda_1_1_color_spinor_field.html">ColorSpinorField</a>&amp;&gt;(inA)),</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  inB(const_cast&lt;<a class="code" href="classquda_1_1_color_spinor_field.html">ColorSpinorField</a>&amp;&gt;(inB)), Y(const_cast&lt;<a class="code" href="classquda_1_1_gauge_field.html">GaugeField</a>&amp;&gt;(Y)),</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  X(const_cast&lt;<a class="code" href="classquda_1_1_gauge_field.html">GaugeField</a>&amp;&gt;(X)), kappa(kappa), parity(parity),</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  nParity(out.SiteSubset()), nFace(1), X0h( ((3-nParity) * out.X(0)) /2),</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  dim{ (3-<a class="code" href="structquda_1_1_dslash_coarse_arg.html#acbcbbe3cbb057286bcdd8061523b8fb3">nParity</a>) * out.<a class="code" href="classquda_1_1_color_spinor_field.html#af25b67fc2c472440b8138e553cceca07">X</a>(0), out.<a class="code" href="classquda_1_1_color_spinor_field.html#af25b67fc2c472440b8138e553cceca07">X</a>(1), out.<a class="code" href="classquda_1_1_color_spinor_field.html#af25b67fc2c472440b8138e553cceca07">X</a>(2), out.<a class="code" href="classquda_1_1_color_spinor_field.html#af25b67fc2c472440b8138e553cceca07">X</a>(3), out.<a class="code" href="classquda_1_1_color_spinor_field.html#a0fd1f89de7282388c6edb060396e8b8b">Ndim</a>() == 5 ? out.<a class="code" href="classquda_1_1_color_spinor_field.html#af25b67fc2c472440b8138e553cceca07">X</a>(4) : 1 },</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;      commDim{<a class="code" href="comm__quda_8h.html#a9390c85afcad52ee6919c40cf85cbc2d">comm_dim_partitioned</a>(0), <a class="code" href="comm__quda_8h.html#a9390c85afcad52ee6919c40cf85cbc2d">comm_dim_partitioned</a>(1), <a class="code" href="comm__quda_8h.html#a9390c85afcad52ee6919c40cf85cbc2d">comm_dim_partitioned</a>(2), <a class="code" href="comm__quda_8h.html#a9390c85afcad52ee6919c40cf85cbc2d">comm_dim_partitioned</a>(3)},</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;      <a class="code" href="structquda_1_1_dslash_coarse_arg.html#ab29553ad8872a31a511d19b7ab9a7072">volumeCB</a>(out.<a class="code" href="classquda_1_1colorspinor_1_1_field_order_c_b.html#af3c830a2f236400f204fd5b4a2f89b5a">VolumeCB</a>()/dim[4])</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    {  }</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  };</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <span class="keyword">template</span> &lt;DslashType type&gt;</div><div class="line"><a name="l00058"></a><span class="lineno"><a class="line" href="namespacequda.html#a74ce276c92432dd80623a3664bc34385">   58</a></span>&#160;  <span class="keyword">static</span> __host__ __device__ <span class="keywordtype">bool</span> <a class="code" href="namespacequda.html#a733d568efec9c5dc259f84b420ecc8b3">doHalo</a>() {</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="keywordflow">switch</span>(type) {</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacequda.html#ae4a6349400e866db880cd96fb2fc4bbba2d25e69c23e3dc7e917abacbee47f752">DSLASH_EXTERIOR</a>:</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacequda.html#ae4a6349400e866db880cd96fb2fc4bbba07064ad40fe6fbf8f729a259a1b5be09">DSLASH_FULL</a>:</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    }</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  }</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <span class="keyword">template</span> &lt;DslashType type&gt;</div><div class="line"><a name="l00072"></a><span class="lineno"><a class="line" href="namespacequda.html#a074bae51948ccd1b309c026403fc0344">   72</a></span>&#160;  <span class="keyword">static</span> __host__ __device__ <span class="keywordtype">bool</span> <a class="code" href="namespacequda.html#a1986215f6d063c3b29e5658dcbf6c4a4">doBulk</a>() {</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keywordflow">switch</span>(type) {</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacequda.html#ae4a6349400e866db880cd96fb2fc4bbba0c488e5576fd49a90d630b5f26e617c9">DSLASH_INTERIOR</a>:</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacequda.html#ae4a6349400e866db880cd96fb2fc4bbba07064ad40fe6fbf8f729a259a1b5be09">DSLASH_FULL</a>:</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    }</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  }</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <span class="keyword">extern</span> __shared__ <span class="keywordtype">float</span> <a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a>[];</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Float, <span class="keywordtype">int</span> nDim, <span class="keywordtype">int</span> Ns, <span class="keywordtype">int</span> Nc, <span class="keywordtype">int</span> Mc, <span class="keywordtype">int</span> color_str<span class="keywordtype">id</span>e, <span class="keywordtype">int</span> dim_str<span class="keywordtype">id</span>e, <span class="keywordtype">int</span> thread_dir, <span class="keywordtype">int</span> thread_dim, <span class="keywordtype">bool</span> dagger, DslashType type, <span class="keyword">typename</span> Arg&gt;</div><div class="line"><a name="l00094"></a><span class="lineno"><a class="line" href="namespacequda.html#ad7224fa56ac49e4be5e0a5a8e758a5d2">   94</a></span>&#160;  __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespacequda.html#ad7224fa56ac49e4be5e0a5a8e758a5d2">applyDslash</a>(complex&lt;Float&gt; <a class="code" href="structquda_1_1_dslash_coarse_arg.html#a4d8ac7ff508ad74014c3dcd6d459dae4">out</a>[], <a class="code" href="structquda_1_1_arg.html">Arg</a> &amp;<a class="code" href="namespacequda.html#a519e30abf575a4084224e899c730e95f">arg</a>, <span class="keywordtype">int</span> x_cb, <span class="keywordtype">int</span> src_idx, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1_dslash_coarse_arg.html#abf7ccaf7203aad235f924cca0e018ddb">parity</a>, <span class="keywordtype">int</span> s_row, <span class="keywordtype">int</span> color_block, <span class="keywordtype">int</span> color_offset) {</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> their_spinor_parity = (arg.<a class="code" href="structquda_1_1_arg.html#a8c893cadf2b678609993f7bcef5d3e14">nParity</a> == 2) ? 1-parity : 0;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="keywordtype">int</span> coord[5];</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <a class="code" href="namespacequda.html#a4534d3429a5a0d143e119a6e3e77f6ab">getCoordsCB</a>(coord, x_cb, arg.dim, arg.X0h, parity);</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    coord[4] = src_idx;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="preprocessor">#ifdef __CUDA_ARCH__</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    complex&lt;Float&gt; *shared_sum = (complex&lt;Float&gt;*)s;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keywordflow">if</span> (!thread_dir) {</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;      <span class="comment">//Forward gather - compute fwd offset for spinor fetch</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="preprocessor">#pragma unroll</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d = thread_dim; d &lt; nDim; d+=dim_stride) <span class="comment">// loop over dimension</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      {</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> fwd_idx = <a class="code" href="namespacequda.html#a0b554befac535568a3866593316bfe26">linkIndexP1</a>(coord, arg.dim, d);</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <span class="keywordflow">if</span> ( arg.commDim[d] &amp;&amp; (coord[d] + arg.nFace &gt;= arg.dim[d]) ) {</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="keywordflow">if</span> (doHalo&lt;type&gt;()) {</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;            <span class="keywordtype">int</span> ghost_idx = ghostFaceIndex&lt;1, 5&gt;(coord, arg.dim, d, arg.nFace);</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="preprocessor">#pragma unroll</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> color_local = 0; color_local &lt; Mc; color_local++) { <span class="comment">//Color row</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <span class="keywordtype">int</span> c_row = color_block + color_local; <span class="comment">// global color index</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        <span class="keywordtype">int</span> row = s_row*Nc + c_row;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="preprocessor">#pragma unroll</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> s_col = 0; s_col &lt; Ns; s_col++) { <span class="comment">//Spin column</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="preprocessor">#pragma unroll</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> c_col = 0; c_col &lt; Nc; c_col+=color_stride) { <span class="comment">//Color column</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      <span class="keywordtype">int</span> col = s_col*Nc + c_col + color_offset;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="covdev__test_8cpp.html#a39b25c22c5fc78d683968e965f5727ba">dagger</a>)</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        out[color_local] += arg.Y(d+4, parity, x_cb, row, col)</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;          * arg.inA.Ghost(d, 1, their_spinor_parity, ghost_idx + src_idx*arg.<a class="code" href="structquda_1_1_arg.html#ae6ac9133de68e8db6f03f281c461d70e">volumeCB</a>, s_col, c_col+color_offset);</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        out[color_local] += arg.Y(d, parity, x_cb, row, col)</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;          * arg.inA.Ghost(d, 1, their_spinor_parity, ghost_idx + src_idx*arg.<a class="code" href="structquda_1_1_arg.html#ae6ac9133de68e8db6f03f281c461d70e">volumeCB</a>, s_col, c_col+color_offset);</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    }</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        }</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      }</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    }</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (doBulk&lt;type&gt;()) {</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="preprocessor">#pragma unroll</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> color_local = 0; color_local &lt; Mc; color_local++) { <span class="comment">//Color row</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      <span class="keywordtype">int</span> c_row = color_block + color_local; <span class="comment">// global color index</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      <span class="keywordtype">int</span> row = s_row*Nc + c_row;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="preprocessor">#pragma unroll</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> s_col = 0; s_col &lt; Ns; s_col++) { <span class="comment">//Spin column</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="preprocessor">#pragma unroll</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> c_col = 0; c_col &lt; Nc; c_col+=color_stride) { <span class="comment">//Color column</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="keywordtype">int</span> col = s_col*Nc + c_col + color_offset;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="covdev__test_8cpp.html#a39b25c22c5fc78d683968e965f5727ba">dagger</a>)</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      out[color_local] += arg.Y(d+4, parity, x_cb, row, col)</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        * arg.inA(their_spinor_parity, fwd_idx + src_idx*arg.<a class="code" href="structquda_1_1_arg.html#ae6ac9133de68e8db6f03f281c461d70e">volumeCB</a>, s_col, c_col+color_offset);</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      out[color_local] += arg.Y(d, parity, x_cb, row, col)</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        * arg.inA(their_spinor_parity, fwd_idx + src_idx*arg.<a class="code" href="structquda_1_1_arg.html#ae6ac9133de68e8db6f03f281c461d70e">volumeCB</a>, s_col, c_col+color_offset);</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        }</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      }</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    }</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  }</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      } <span class="comment">// nDim</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="preprocessor">#if defined(__CUDA_ARCH__)</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      <span class="keywordflow">if</span> (thread_dim &gt; 0) { <span class="comment">// only need to write to shared memory if not master thread</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="preprocessor">#pragma unroll</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> color_local=0; color_local &lt; Mc; color_local++) {</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    shared_sum[((color_local * blockDim.z + threadIdx.z )*blockDim.y + threadIdx.y)*blockDim.x + threadIdx.x] = out[color_local];</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  }</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;      }</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="preprocessor">#ifdef __CUDA_ARCH__</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;      <span class="comment">//Backward gather - compute back offset for spinor and gauge fetch</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="preprocessor">#pragma unroll</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d = thread_dim; d &lt; nDim; d+=dim_stride)</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  {</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> back_idx = <a class="code" href="namespacequda.html#ab14419953c0b6e02a7e9ac4a4313e0b9">linkIndexM1</a>(coord, arg.dim, d);</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> gauge_idx = back_idx;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  <span class="keywordflow">if</span> ( arg.commDim[d] &amp;&amp; (coord[d] - arg.nFace &lt; 0) ) {</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="keywordflow">if</span> (doHalo&lt;type&gt;()) {</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> ghost_idx = ghostFaceIndex&lt;0, 5&gt;(coord, arg.dim, d, arg.nFace);</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="preprocessor">#pragma unroll</span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> color_local=0; color_local&lt;Mc; color_local++) {</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        <span class="keywordtype">int</span> c_row = color_block + color_local;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        <span class="keywordtype">int</span> row = s_row*Nc + c_row;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="preprocessor">#pragma unroll</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> s_col=0; s_col&lt;Ns; s_col++)</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;#pragma unroll</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c_col=0; c_col&lt;Nc; c_col+=color_stride) {</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      <span class="keywordtype">int</span> col = s_col*Nc + c_col + color_offset;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="covdev__test_8cpp.html#a39b25c22c5fc78d683968e965f5727ba">dagger</a>)</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        out[color_local] += <a class="code" href="namespacequda.html#a043738f16cdeb082fa1a5158fbad36b3">conj</a>(arg.Y.Ghost(d, 1-parity, ghost_idx, col, row))</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;          * arg.inA.Ghost(d, 0, their_spinor_parity, ghost_idx + src_idx*arg.<a class="code" href="structquda_1_1_arg.html#ae6ac9133de68e8db6f03f281c461d70e">volumeCB</a>, s_col, c_col+color_offset);</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        out[color_local] += <a class="code" href="namespacequda.html#a043738f16cdeb082fa1a5158fbad36b3">conj</a>(arg.Y.Ghost(d+4, 1-parity, ghost_idx, col, row))</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;          * arg.inA.Ghost(d, 0, their_spinor_parity, ghost_idx + src_idx*arg.<a class="code" href="structquda_1_1_arg.html#ae6ac9133de68e8db6f03f281c461d70e">volumeCB</a>, s_col, c_col+color_offset);</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    }</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      }</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    }</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (doBulk&lt;type&gt;()) {</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="preprocessor">#pragma unroll</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> color_local = 0; color_local &lt; Mc; color_local++) {</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      <span class="keywordtype">int</span> c_row = color_block + color_local;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      <span class="keywordtype">int</span> row = s_row*Nc + c_row;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="preprocessor">#pragma unroll</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> s_col = 0; s_col &lt; Ns; s_col++)</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;#pragma unroll</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> c_col = 0; c_col &lt; Nc; c_col+=color_stride) {</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="keywordtype">int</span> col = s_col*Nc + c_col + color_offset;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="covdev__test_8cpp.html#a39b25c22c5fc78d683968e965f5727ba">dagger</a>)</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      out[color_local] += <a class="code" href="namespacequda.html#a043738f16cdeb082fa1a5158fbad36b3">conj</a>(arg.Y(d, 1-parity, gauge_idx, col, row))</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        * arg.inA(their_spinor_parity, back_idx + src_idx*arg.<a class="code" href="structquda_1_1_arg.html#ae6ac9133de68e8db6f03f281c461d70e">volumeCB</a>, s_col, c_col+color_offset);</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      out[color_local] += <a class="code" href="namespacequda.html#a043738f16cdeb082fa1a5158fbad36b3">conj</a>(arg.Y(d+4, 1-parity, gauge_idx, col, row))</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        * arg.inA(their_spinor_parity, back_idx + src_idx*arg.<a class="code" href="structquda_1_1_arg.html#ae6ac9133de68e8db6f03f281c461d70e">volumeCB</a>, s_col, c_col+color_offset);</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        }</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    }</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  }</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;      } <span class="comment">//nDim</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="preprocessor">#if defined(__CUDA_ARCH__)</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="preprocessor">#pragma unroll</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> color_local=0; color_local &lt; Mc; color_local++) {</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  shared_sum[ ((color_local * blockDim.z + threadIdx.z )*blockDim.y + threadIdx.y)*blockDim.x + threadIdx.x] = out[color_local];</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      }</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    } <span class="comment">// forwards / backwards thread split</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="preprocessor">#ifdef __CUDA_ARCH__ // CUDA path has to recombine the foward and backward results</span></div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    __syncthreads();</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="comment">// (colorspin * dim_stride + dim * 2 + dir)</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="keywordflow">if</span> (thread_dim == 0 &amp;&amp; thread_dir == 0) {</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      <span class="comment">// full split over dimension and direction</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="preprocessor">#pragma unroll</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d=1; d&lt;dim_stride; d++) { <span class="comment">// get remaining forward fathers (if any)</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  <span class="comment">// 4-way 1,2,3  (stride = 4)</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <span class="comment">// 2-way 1      (stride = 2)</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="preprocessor">#pragma unroll</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> color_local=0; color_local &lt; Mc; color_local++) {</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    out[color_local] +=</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      shared_sum[(((color_local*blockDim.z/(2*dim_stride) + threadIdx.z/(2*dim_stride)) * 2 * dim_stride + d * 2 + 0)*blockDim.y+threadIdx.y)*blockDim.x+threadIdx.x];</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  }</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;      }</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="preprocessor">#pragma unroll</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d=0; d&lt;dim_stride; d++) { <span class="comment">// get all backward gathers</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="preprocessor">#pragma unroll</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> color_local=0; color_local &lt; Mc; color_local++) {</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    out[color_local] +=</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;      shared_sum[(((color_local*blockDim.z/(2*dim_stride) + threadIdx.z/(2*dim_stride)) * 2 * dim_stride + d * 2 + 1)*blockDim.y+threadIdx.y)*blockDim.x+threadIdx.x];</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  }</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;      }</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      <span class="comment">// apply kappa</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="preprocessor">#pragma unroll</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> color_local=0; color_local&lt;Mc; color_local++) out[color_local] *= -arg.kappa;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    }</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="preprocessor">#else // !__CUDA_ARCH__</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> color_local=0; color_local&lt;Mc; color_local++) out[color_local] *= -arg.kappa;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;#endif</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    }</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Float, <span class="keywordtype">int</span> Ns, <span class="keywordtype">int</span> Nc, <span class="keywordtype">int</span> Mc, <span class="keywordtype">int</span> color_str<span class="keywordtype">id</span>e, <span class="keywordtype">bool</span> dagger, <span class="keyword">typename</span> Arg&gt;</div><div class="line"><a name="l00280"></a><span class="lineno"><a class="line" href="namespacequda.html#a03fcc69bdf6789c65b0a217f7aaea85f">  280</a></span>&#160;  __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespacequda.html#a03fcc69bdf6789c65b0a217f7aaea85f">applyClover</a>(complex&lt;Float&gt; <a class="code" href="structquda_1_1_dslash_coarse_arg.html#a4d8ac7ff508ad74014c3dcd6d459dae4">out</a>[], <a class="code" href="structquda_1_1_arg.html">Arg</a> &amp;<a class="code" href="namespacequda.html#a519e30abf575a4084224e899c730e95f">arg</a>, <span class="keywordtype">int</span> x_cb, <span class="keywordtype">int</span> src_idx, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1_dslash_coarse_arg.html#abf7ccaf7203aad235f924cca0e018ddb">parity</a>, <span class="keywordtype">int</span> s, <span class="keywordtype">int</span> color_block, <span class="keywordtype">int</span> color_offset) {</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> spinor_parity = (arg.<a class="code" href="structquda_1_1_arg.html#a8c893cadf2b678609993f7bcef5d3e14">nParity</a> == 2) ? parity : 0;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="comment">// M is number of colors per thread</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="preprocessor">#pragma unroll</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> color_local = 0; color_local &lt; Mc; color_local++) {<span class="comment">//Color out</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;      <span class="keywordtype">int</span> c = color_block + color_local; <span class="comment">// global color index</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;      <span class="keywordtype">int</span> row = s*Nc + c;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="preprocessor">#pragma unroll</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> s_col = 0; s_col &lt; Ns; s_col++) <span class="comment">//Spin in</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;#pragma unroll</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c_col = 0; c_col &lt; Nc; c_col+=color_stride) { <span class="comment">//Color in</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="comment">//Factor of kappa and diagonal addition now incorporated in X</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="keywordtype">int</span> col = s_col*Nc + c_col + color_offset;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="covdev__test_8cpp.html#a39b25c22c5fc78d683968e965f5727ba">dagger</a>) {</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      out[color_local] += arg.X(0, parity, x_cb, row, col)</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        * arg.inB(spinor_parity, x_cb+src_idx*arg.<a class="code" href="structquda_1_1_arg.html#ae6ac9133de68e8db6f03f281c461d70e">volumeCB</a>, s_col, c_col+color_offset);</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;      out[color_local] += <a class="code" href="namespacequda.html#a043738f16cdeb082fa1a5158fbad36b3">conj</a>(arg.X(0, parity, x_cb, col, row))</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        * arg.inB(spinor_parity, x_cb+src_idx*arg.<a class="code" href="structquda_1_1_arg.html#ae6ac9133de68e8db6f03f281c461d70e">volumeCB</a>, s_col, c_col+color_offset);</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    }</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  }</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    }</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  }</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  <span class="comment">//out(x) = M*in = \sum_mu Y_{-\mu}(x)in(x+mu) + Y^\dagger_mu(x-mu)in(x-mu)</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Float, <span class="keywordtype">int</span> nDim, <span class="keywordtype">int</span> Ns, <span class="keywordtype">int</span> Nc, <span class="keywordtype">int</span> Mc, <span class="keywordtype">int</span> color_stride, <span class="keywordtype">int</span> dim_thread_split,</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;      <span class="keywordtype">bool</span> dslash, <span class="keywordtype">bool</span> clover, <span class="keywordtype">bool</span> <a class="code" href="covdev__test_8cpp.html#a39b25c22c5fc78d683968e965f5727ba">dagger</a>, <a class="code" href="namespacequda.html#ae4a6349400e866db880cd96fb2fc4bbb">DslashType</a> type, <span class="keywordtype">int</span> dir, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1_dslash_coarse_arg.html#a0c580784884d08c8419bc2c4bea2deee">dim</a>, <span class="keyword">typename</span> <a class="code" href="structquda_1_1_arg.html">Arg</a>&gt;</div><div class="line"><a name="l00309"></a><span class="lineno"><a class="line" href="namespacequda.html#a3f7717a0607c27ffc2df438c75612703">  309</a></span>&#160;  __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespacequda.html#a3f7717a0607c27ffc2df438c75612703">coarseDslash</a>(<a class="code" href="structquda_1_1_arg.html">Arg</a> &amp;<a class="code" href="namespacequda.html#a519e30abf575a4084224e899c730e95f">arg</a>, <span class="keywordtype">int</span> x_cb, <span class="keywordtype">int</span> src_idx, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1_dslash_coarse_arg.html#abf7ccaf7203aad235f924cca0e018ddb">parity</a>, <span class="keywordtype">int</span> s, <span class="keywordtype">int</span> color_block, <span class="keywordtype">int</span> color_offset)</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  {</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <a class="code" href="structquda_1_1vector__type.html">vector_type&lt;complex &lt;Float&gt;</a>, Mc&gt; <a class="code" href="structquda_1_1_dslash_coarse_arg.html#a4d8ac7ff508ad74014c3dcd6d459dae4">out</a>;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="keywordflow">if</span> (dslash) applyDslash&lt;Float,nDim,Ns,Nc,Mc,color_stride,dim_thread_split,dir,dim,dagger,type&gt;(out.<a class="code" href="structquda_1_1vector__type.html#aded6328476feb60c841e2c7f939168e6">data</a>, <a class="code" href="namespacequda.html#a519e30abf575a4084224e899c730e95f">arg</a>, x_cb, src_idx, <a class="code" href="structquda_1_1_dslash_coarse_arg.html#abf7ccaf7203aad235f924cca0e018ddb">parity</a>, <a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a>, color_block, color_offset);</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="keywordflow">if</span> (doBulk&lt;type&gt;() &amp;&amp; clover &amp;&amp; dir==0 &amp;&amp; dim==0) applyClover&lt;Float,Ns,Nc,Mc,color_stride,dagger&gt;(out.<a class="code" href="structquda_1_1vector__type.html#aded6328476feb60c841e2c7f939168e6">data</a>, arg, x_cb, src_idx, parity, s, color_block, color_offset);</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="keywordflow">if</span> (dir==0 &amp;&amp; dim==0) {</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> my_spinor_parity = (arg.<a class="code" href="structquda_1_1_arg.html#a8c893cadf2b678609993f7bcef5d3e14">nParity</a> == 2) ? parity : 0;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="preprocessor">#if __CUDA_ARCH__ &gt;= 300 // only have warp shuffle on Kepler and above</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="preprocessor">#pragma unroll</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> color_local=0; color_local&lt;Mc; color_local++) {</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  <span class="comment">// reduce down to the first group of column-split threads</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  constexpr <span class="keywordtype">int</span> warp_size = 32; <span class="comment">// FIXME - this is buggy when x-dim * color_stride &lt; 32</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="preprocessor">#pragma unroll</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> offset = warp_size/2; offset &gt;= warp_size/color_stride; offset /= 2)</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;#<span class="keywordflow">if</span> (__CUDACC_VER_MAJOR__ &gt;= 9 || CUDA_VERSION &gt;= 9000)</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="preprocessor">#define WARP_CONVERGED 0xffffffff // we know warp should be converged here</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    out[color_local] += __shfl_down_sync(WARP_CONVERGED, out[color_local], offset);</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    out[color_local] += __shfl_down(out[color_local], offset);</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;      }</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="preprocessor">#endif // __CUDA_ARCH__ &gt;= 300</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="preprocessor">#pragma unroll</span></div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> color_local=0; color_local&lt;Mc; color_local++) {</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  <span class="keywordtype">int</span> c = color_block + color_local; <span class="comment">// global color index</span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  <span class="keywordflow">if</span> (color_offset == 0) {</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="comment">// if not halo we just store, else we accumulate</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="keywordflow">if</span> (doBulk&lt;type&gt;()) arg.out(my_spinor_parity, x_cb+src_idx*arg.<a class="code" href="structquda_1_1_arg.html#ae6ac9133de68e8db6f03f281c461d70e">volumeCB</a>, s, c) = out[color_local];</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="keywordflow">else</span> arg.out(my_spinor_parity, x_cb+src_idx*arg.<a class="code" href="structquda_1_1_arg.html#ae6ac9133de68e8db6f03f281c461d70e">volumeCB</a>, s, c) += out[color_local];</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  }</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;      }</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    }</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  }</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  <span class="comment">// CPU kernel for applying the coarse Dslash to a vector</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Float, <span class="keywordtype">int</span> nDim, <span class="keywordtype">int</span> Ns, <span class="keywordtype">int</span> Nc, <span class="keywordtype">int</span> Mc, <span class="keywordtype">bool</span> dslash, <span class="keywordtype">bool</span> clover, <span class="keywordtype">bool</span> dagger, DslashType type, <span class="keyword">typename</span> Arg&gt;</div><div class="line"><a name="l00350"></a><span class="lineno"><a class="line" href="namespacequda.html#a51785da22b5d18216bb951fdd83ce60d">  350</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="namespacequda.html#a3f7717a0607c27ffc2df438c75612703">coarseDslash</a>(<a class="code" href="structquda_1_1_arg.html">Arg</a> <a class="code" href="namespacequda.html#a519e30abf575a4084224e899c730e95f">arg</a>)</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  {</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="comment">// the fine-grain parameters mean nothing for CPU variant</span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> color_stride = 1;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> color_offset = 0;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> dim_thread_split = 1;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> dir = 0;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> dim = 0;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="structquda_1_1_dslash_coarse_arg.html#abf7ccaf7203aad235f924cca0e018ddb">parity</a>= 0; <a class="code" href="structquda_1_1_dslash_coarse_arg.html#abf7ccaf7203aad235f924cca0e018ddb">parity</a> &lt; arg.<a class="code" href="structquda_1_1_arg.html#a8c893cadf2b678609993f7bcef5d3e14">nParity</a>; <a class="code" href="structquda_1_1_dslash_coarse_arg.html#abf7ccaf7203aad235f924cca0e018ddb">parity</a>++) {</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;      <span class="comment">// for full fields then set parity from loop else use arg setting</span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;      <a class="code" href="structquda_1_1_dslash_coarse_arg.html#abf7ccaf7203aad235f924cca0e018ddb">parity</a> = (arg.<a class="code" href="structquda_1_1_arg.html#a8c893cadf2b678609993f7bcef5d3e14">nParity</a> == 2) ? <a class="code" href="structquda_1_1_dslash_coarse_arg.html#abf7ccaf7203aad235f924cca0e018ddb">parity</a> : arg.parity;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;      for (<span class="keywordtype">int</span> src_idx = 0; src_idx &lt; arg.dim[4]; src_idx++) {</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  <span class="comment">//#pragma omp parallel for</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> x_cb = 0; x_cb &lt; arg.<a class="code" href="structquda_1_1_arg.html#ae6ac9133de68e8db6f03f281c461d70e">volumeCB</a>; x_cb++) { <span class="comment">// 4-d volume</span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> s=0; s&lt;2; s++) {</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> color_block=0; color_block&lt;Nc; color_block+=Mc) { <span class="comment">// Mc=Nc means all colors in a thread</span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        coarseDslash&lt;Float,nDim,Ns,Nc,Mc,color_stride,dim_thread_split,dslash,clover,dagger,type,dir,dim&gt;(<a class="code" href="namespacequda.html#a519e30abf575a4084224e899c730e95f">arg</a>, x_cb, src_idx, <a class="code" href="structquda_1_1_dslash_coarse_arg.html#abf7ccaf7203aad235f924cca0e018ddb">parity</a>, <a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a>, color_block, color_offset);</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;      }</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    }</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  } <span class="comment">// 4-d volumeCB</span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;      } <span class="comment">// src index</span></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    } <span class="comment">// parity</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  }</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  <span class="comment">// GPU Kernel for applying the coarse Dslash to a vector</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Float, <span class="keywordtype">int</span> nDim, <span class="keywordtype">int</span> Ns, <span class="keywordtype">int</span> Nc, <span class="keywordtype">int</span> Mc, <span class="keywordtype">int</span> color_str<span class="keywordtype">id</span>e, <span class="keywordtype">int</span> dim_thread_split, <span class="keywordtype">bool</span> dslash, <span class="keywordtype">bool</span> clover, <span class="keywordtype">bool</span> dagger, DslashType type, <span class="keyword">typename</span> Arg&gt;</div><div class="line"><a name="l00379"></a><span class="lineno"><a class="line" href="namespacequda.html#ad056ae0350f6401b3cea8d9b900f49e7">  379</a></span>&#160;  __global__ <span class="keywordtype">void</span> <a class="code" href="namespacequda.html#ad056ae0350f6401b3cea8d9b900f49e7">coarseDslashKernel</a>(<a class="code" href="structquda_1_1_arg.html">Arg</a> <a class="code" href="namespacequda.html#a519e30abf575a4084224e899c730e95f">arg</a>)</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  {</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    constexpr <span class="keywordtype">int</span> warp_size = 32;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> lane_id = threadIdx.x % warp_size;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> warp_id = threadIdx.x / warp_size;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> vector_site_width = warp_size / color_stride;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="keywordtype">int</span> x_cb = blockIdx.x*(blockDim.x/color_stride) + warp_id*(warp_size/color_stride) + lane_id % vector_site_width;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> color_offset = lane_id / vector_site_width;</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <span class="comment">// for full fields set parity from y thread index else use arg setting</span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="preprocessor">#if 0  // disable multi-src since this has a measurable impact on single src performance</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="keywordtype">int</span> paritySrc = blockDim.y*blockIdx.y + threadIdx.y;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    <span class="keywordflow">if</span> (paritySrc &gt;= arg.<a class="code" href="structquda_1_1_arg.html#a8c893cadf2b678609993f7bcef5d3e14">nParity</a> * arg.dim[4]) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> src_idx = (arg.<a class="code" href="structquda_1_1_arg.html#a8c893cadf2b678609993f7bcef5d3e14">nParity</a> == 2) ? paritySrc / 2 : paritySrc; <span class="comment">// maybe want to swap order or source and parity for improved locality of same parity</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1_dslash_coarse_arg.html#abf7ccaf7203aad235f924cca0e018ddb">parity</a> = (arg.<a class="code" href="structquda_1_1_arg.html#a8c893cadf2b678609993f7bcef5d3e14">nParity</a> == 2) ? paritySrc % 2 : arg.parity;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;#<span class="keywordflow">else</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> src_idx = 0;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> parity = (arg.<a class="code" href="structquda_1_1_arg.html#a8c893cadf2b678609993f7bcef5d3e14">nParity</a> == 2) ? blockDim.y*blockIdx.y + threadIdx.y : arg.parity;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <span class="comment">// z thread dimension is (( s*(Nc/Mc) + color_block )*dim_thread_split + dim)*2 + dir</span></div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="keywordtype">int</span> sMd = blockDim.z*blockIdx.z + threadIdx.z;</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <span class="keywordtype">int</span> dir = sMd &amp; 1;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="keywordtype">int</span> sMdim = sMd &gt;&gt; 1;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <span class="keywordtype">int</span> dim = sMdim % dim_thread_split;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="keywordtype">int</span> sM = sMdim / dim_thread_split;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <span class="keywordtype">int</span> s = sM / (Nc/Mc);</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="keywordtype">int</span> color_block = (sM % (Nc/Mc)) * Mc;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <span class="keywordflow">if</span> (x_cb &gt;= arg.<a class="code" href="structquda_1_1_arg.html#ae6ac9133de68e8db6f03f281c461d70e">volumeCB</a>) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="keywordflow">if</span> (dir == 0) {</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;      <span class="keywordflow">if</span> (dim == 0)      coarseDslash&lt;Float,nDim,Ns,Nc,Mc,color_stride,dim_thread_split,dslash,clover,dagger,type,0,0&gt;(<a class="code" href="namespacequda.html#a519e30abf575a4084224e899c730e95f">arg</a>, x_cb, src_idx, <a class="code" href="structquda_1_1_dslash_coarse_arg.html#abf7ccaf7203aad235f924cca0e018ddb">parity</a>, <a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a>, color_block, color_offset);</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dim == 1) coarseDslash&lt;Float,nDim,Ns,Nc,Mc,color_stride,dim_thread_split,dslash,clover,dagger,type,0,1&gt;(<a class="code" href="namespacequda.html#a519e30abf575a4084224e899c730e95f">arg</a>, x_cb, src_idx, <a class="code" href="structquda_1_1_dslash_coarse_arg.html#abf7ccaf7203aad235f924cca0e018ddb">parity</a>, <a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a>, color_block, color_offset);</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dim == 2) coarseDslash&lt;Float,nDim,Ns,Nc,Mc,color_stride,dim_thread_split,dslash,clover,dagger,type,0,2&gt;(<a class="code" href="namespacequda.html#a519e30abf575a4084224e899c730e95f">arg</a>, x_cb, src_idx, <a class="code" href="structquda_1_1_dslash_coarse_arg.html#abf7ccaf7203aad235f924cca0e018ddb">parity</a>, <a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a>, color_block, color_offset);</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dim == 3) coarseDslash&lt;Float,nDim,Ns,Nc,Mc,color_stride,dim_thread_split,dslash,clover,dagger,type,0,3&gt;(<a class="code" href="namespacequda.html#a519e30abf575a4084224e899c730e95f">arg</a>, x_cb, src_idx, <a class="code" href="structquda_1_1_dslash_coarse_arg.html#abf7ccaf7203aad235f924cca0e018ddb">parity</a>, <a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a>, color_block, color_offset);</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dir == 1) {</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;      <span class="keywordflow">if</span> (dim == 0)      coarseDslash&lt;Float,nDim,Ns,Nc,Mc,color_stride,dim_thread_split,dslash,clover,dagger,type,1,0&gt;(<a class="code" href="namespacequda.html#a519e30abf575a4084224e899c730e95f">arg</a>, x_cb, src_idx, <a class="code" href="structquda_1_1_dslash_coarse_arg.html#abf7ccaf7203aad235f924cca0e018ddb">parity</a>, <a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a>, color_block, color_offset);</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dim == 1) coarseDslash&lt;Float,nDim,Ns,Nc,Mc,color_stride,dim_thread_split,dslash,clover,dagger,type,1,1&gt;(<a class="code" href="namespacequda.html#a519e30abf575a4084224e899c730e95f">arg</a>, x_cb, src_idx, <a class="code" href="structquda_1_1_dslash_coarse_arg.html#abf7ccaf7203aad235f924cca0e018ddb">parity</a>, <a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a>, color_block, color_offset);</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dim == 2) coarseDslash&lt;Float,nDim,Ns,Nc,Mc,color_stride,dim_thread_split,dslash,clover,dagger,type,1,2&gt;(<a class="code" href="namespacequda.html#a519e30abf575a4084224e899c730e95f">arg</a>, x_cb, src_idx, <a class="code" href="structquda_1_1_dslash_coarse_arg.html#abf7ccaf7203aad235f924cca0e018ddb">parity</a>, <a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a>, color_block, color_offset);</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dim == 3) coarseDslash&lt;Float,nDim,Ns,Nc,Mc,color_stride,dim_thread_split,dslash,clover,dagger,type,1,3&gt;(<a class="code" href="namespacequda.html#a519e30abf575a4084224e899c730e95f">arg</a>, x_cb, src_idx, <a class="code" href="structquda_1_1_dslash_coarse_arg.html#abf7ccaf7203aad235f924cca0e018ddb">parity</a>, <a class="code" href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">s</a>, color_block, color_offset);</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    }</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  }</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;} <span class="comment">// namespace quda</span></div><div class="ttc" id="structquda_1_1_dslash_coarse_arg_html_a4d8ac7ff508ad74014c3dcd6d459dae4"><div class="ttname"><a href="structquda_1_1_dslash_coarse_arg.html#a4d8ac7ff508ad74014c3dcd6d459dae4">quda::DslashCoarseArg::out</a></div><div class="ttdeci">F out</div><div class="ttdef"><b>Definition:</b> <a href="dslash__coarse_8cuh_source.html#l00028">dslash_coarse.cuh:28</a></div></div>
<div class="ttc" id="structquda_1_1_dslash_coarse_arg_html_aeeaf9dada95a18bb82fff290349613e6"><div class="ttname"><a href="structquda_1_1_dslash_coarse_arg.html#aeeaf9dada95a18bb82fff290349613e6">quda::DslashCoarseArg::kappa</a></div><div class="ttdeci">const Float kappa</div><div class="ttdef"><b>Definition:</b> <a href="dslash__coarse_8cuh_source.html#l00033">dslash_coarse.cuh:33</a></div></div>
<div class="ttc" id="structquda_1_1vector__type_html"><div class="ttname"><a href="structquda_1_1vector__type.html">quda::vector_type</a></div><div class="ttdef"><b>Definition:</b> <a href="cub__helper_8cuh_source.html#l00034">cub_helper.cuh:34</a></div></div>
<div class="ttc" id="namespacequda_html_ae4a6349400e866db880cd96fb2fc4bbba07064ad40fe6fbf8f729a259a1b5be09"><div class="ttname"><a href="namespacequda.html#ae4a6349400e866db880cd96fb2fc4bbba07064ad40fe6fbf8f729a259a1b5be09">quda::DSLASH_FULL</a></div><div class="ttdef"><b>Definition:</b> <a href="dslash__coarse_8cuh_source.html#l00019">dslash_coarse.cuh:19</a></div></div>
<div class="ttc" id="classquda_1_1_color_spinor_field_html"><div class="ttname"><a href="classquda_1_1_color_spinor_field.html">quda::ColorSpinorField</a></div><div class="ttdef"><b>Definition:</b> <a href="color__spinor__field_8h_source.html#l00311">color_spinor_field.h:311</a></div></div>
<div class="ttc" id="structquda_1_1_dslash_coarse_arg_html_addcfe55b9f2f442e061c6cf0b9d9747b"><div class="ttname"><a href="structquda_1_1_dslash_coarse_arg.html#addcfe55b9f2f442e061c6cf0b9d9747b">quda::DslashCoarseArg::DslashCoarseArg</a></div><div class="ttdeci">DslashCoarseArg(ColorSpinorField &amp;out, const ColorSpinorField &amp;inA, const ColorSpinorField &amp;inB, const GaugeField &amp;Y, const GaugeField &amp;X, Float kappa, int parity)</div><div class="ttdef"><b>Definition:</b> <a href="dslash__coarse_8cuh_source.html#l00042">dslash_coarse.cuh:42</a></div></div>
<div class="ttc" id="cub__helper_8cuh_html"><div class="ttname"><a href="cub__helper_8cuh.html">cub_helper.cuh</a></div></div>
<div class="ttc" id="namespacequda_html_ae4a6349400e866db880cd96fb2fc4bbb"><div class="ttname"><a href="namespacequda.html#ae4a6349400e866db880cd96fb2fc4bbb">quda::DslashType</a></div><div class="ttdeci">DslashType</div><div class="ttdef"><b>Definition:</b> <a href="dslash__coarse_8cuh_source.html#l00016">dslash_coarse.cuh:16</a></div></div>
<div class="ttc" id="structquda_1_1vector__type_html_aded6328476feb60c841e2c7f939168e6"><div class="ttname"><a href="structquda_1_1vector__type.html#aded6328476feb60c841e2c7f939168e6">quda::vector_type::data</a></div><div class="ttdeci">scalar data[n]</div><div class="ttdef"><b>Definition:</b> <a href="cub__helper_8cuh_source.html#l00035">cub_helper.cuh:35</a></div></div>
<div class="ttc" id="namespacequda_html_a4534d3429a5a0d143e119a6e3e77f6ab"><div class="ttname"><a href="namespacequda.html#a4534d3429a5a0d143e119a6e3e77f6ab">quda::getCoordsCB</a></div><div class="ttdeci">static __device__ __host__ void getCoordsCB(int x[], int cb_index, const I X[], J X0h, int parity)</div><div class="ttdef"><b>Definition:</b> <a href="index__helper_8cuh_source.html#l00201">index_helper.cuh:201</a></div></div>
<div class="ttc" id="classquda_1_1colorspinor_1_1_field_order_c_b_html"><div class="ttname"><a href="classquda_1_1colorspinor_1_1_field_order_c_b.html">quda::colorspinor::FieldOrderCB&lt; Float, coarseSpin, coarseColor, 1, csOrder, Float, ghostFloat &gt;</a></div></div>
<div class="ttc" id="structquda_1_1_dslash_coarse_arg_html_a348a73523b141fccf1295ce5efdcf810"><div class="ttname"><a href="structquda_1_1_dslash_coarse_arg.html#a348a73523b141fccf1295ce5efdcf810">quda::DslashCoarseArg::commDim</a></div><div class="ttdeci">const int commDim[4]</div><div class="ttdef"><b>Definition:</b> <a href="dslash__coarse_8cuh_source.html#l00039">dslash_coarse.cuh:39</a></div></div>
<div class="ttc" id="classint__fastdiv_html"><div class="ttname"><a href="classint__fastdiv.html">int_fastdiv</a></div><div class="ttdef"><b>Definition:</b> <a href="fast__intdiv_8h_source.html#l00020">fast_intdiv.h:20</a></div></div>
<div class="ttc" id="structquda_1_1_dslash_coarse_arg_html_aa64cf30070b5737aa439a7c4b33c3424"><div class="ttname"><a href="structquda_1_1_dslash_coarse_arg.html#aa64cf30070b5737aa439a7c4b33c3424">quda::DslashCoarseArg::G</a></div><div class="ttdeci">gauge::FieldOrder&lt; Float, coarseColor *coarseSpin, coarseSpin, gOrder, true, yFloat &gt; G</div><div class="ttdef"><b>Definition:</b> <a href="dslash__coarse_8cuh_source.html#l00025">dslash_coarse.cuh:25</a></div></div>
<div class="ttc" id="classquda_1_1_color_spinor_field_html_a0fd1f89de7282388c6edb060396e8b8b"><div class="ttname"><a href="classquda_1_1_color_spinor_field.html#a0fd1f89de7282388c6edb060396e8b8b">quda::ColorSpinorField::Ndim</a></div><div class="ttdeci">int Ndim() const</div><div class="ttdef"><b>Definition:</b> <a href="color__spinor__field_8h_source.html#l00409">color_spinor_field.h:409</a></div></div>
<div class="ttc" id="namespacequda_html_a1986215f6d063c3b29e5658dcbf6c4a4"><div class="ttname"><a href="namespacequda.html#a1986215f6d063c3b29e5658dcbf6c4a4">quda::doBulk</a></div><div class="ttdeci">__host__ __device__ bool doBulk()</div><div class="ttdoc">Helper function to determine if we should do interior computation. </div><div class="ttdef"><b>Definition:</b> <a href="dslash__helper_8cuh_source.html#l00035">dslash_helper.cuh:35</a></div></div>
<div class="ttc" id="namespacequda_html"><div class="ttname"><a href="namespacequda.html">quda</a></div><div class="ttdef"><b>Definition:</b> <a href="blas__cublas_8h_source.html#l00005">blas_cublas.h:5</a></div></div>
<div class="ttc" id="namespacequda_html_ae4a6349400e866db880cd96fb2fc4bbba0c488e5576fd49a90d630b5f26e617c9"><div class="ttname"><a href="namespacequda.html#ae4a6349400e866db880cd96fb2fc4bbba0c488e5576fd49a90d630b5f26e617c9">quda::DSLASH_INTERIOR</a></div><div class="ttdef"><b>Definition:</b> <a href="dslash__coarse_8cuh_source.html#l00017">dslash_coarse.cuh:17</a></div></div>
<div class="ttc" id="namespacequda_html_a3f7717a0607c27ffc2df438c75612703"><div class="ttname"><a href="namespacequda.html#a3f7717a0607c27ffc2df438c75612703">quda::coarseDslash</a></div><div class="ttdeci">__device__ __host__ void coarseDslash(Arg &amp;arg, int x_cb, int src_idx, int parity, int s, int color_block, int color_offset)</div><div class="ttdef"><b>Definition:</b> <a href="dslash__coarse_8cuh_source.html#l00309">dslash_coarse.cuh:309</a></div></div>
<div class="ttc" id="structquda_1_1_dslash_coarse_arg_html_aab856074e4ff7e0035ec995cc9e0e0e0"><div class="ttname"><a href="structquda_1_1_dslash_coarse_arg.html#aab856074e4ff7e0035ec995cc9e0e0e0">quda::DslashCoarseArg::nFace</a></div><div class="ttdeci">const int nFace</div><div class="ttdef"><b>Definition:</b> <a href="dslash__coarse_8cuh_source.html#l00036">dslash_coarse.cuh:36</a></div></div>
<div class="ttc" id="structquda_1_1gauge_1_1_field_order_html"><div class="ttname"><a href="structquda_1_1gauge_1_1_field_order.html">quda::gauge::FieldOrder</a></div><div class="ttdef"><b>Definition:</b> <a href="gauge__field__order_8h_source.html#l00896">gauge_field_order.h:896</a></div></div>
<div class="ttc" id="namespacequda_html_ab14419953c0b6e02a7e9ac4a4313e0b9"><div class="ttname"><a href="namespacequda.html#ab14419953c0b6e02a7e9ac4a4313e0b9">quda::linkIndexM1</a></div><div class="ttdeci">static __device__ __host__ int linkIndexM1(const int x[], const I X[4], const int mu)</div><div class="ttdef"><b>Definition:</b> <a href="index__helper_8cuh_source.html#l00094">index_helper.cuh:94</a></div></div>
<div class="ttc" id="classquda_1_1colorspinor_1_1_field_order_c_b_html_af3c830a2f236400f204fd5b4a2f89b5a"><div class="ttname"><a href="classquda_1_1colorspinor_1_1_field_order_c_b.html#af3c830a2f236400f204fd5b4a2f89b5a">quda::colorspinor::FieldOrderCB::VolumeCB</a></div><div class="ttdeci">__device__ __host__ int VolumeCB() const</div><div class="ttdef"><b>Definition:</b> <a href="color__spinor__field__order_8h_source.html#l00733">color_spinor_field_order.h:733</a></div></div>
<div class="ttc" id="namespacequda_html_a733d568efec9c5dc259f84b420ecc8b3"><div class="ttname"><a href="namespacequda.html#a733d568efec9c5dc259f84b420ecc8b3">quda::doHalo</a></div><div class="ttdeci">__host__ __device__ bool doHalo(int dim=-1)</div><div class="ttdoc">Helper function to determine if we should do halo computation. </div><div class="ttdef"><b>Definition:</b> <a href="dslash__helper_8cuh_source.html#l00017">dslash_helper.cuh:17</a></div></div>
<div class="ttc" id="structquda_1_1_dslash_coarse_arg_html_a0c580784884d08c8419bc2c4bea2deee"><div class="ttname"><a href="structquda_1_1_dslash_coarse_arg.html#a0c580784884d08c8419bc2c4bea2deee">quda::DslashCoarseArg::dim</a></div><div class="ttdeci">const int_fastdiv dim[5]</div><div class="ttdef"><b>Definition:</b> <a href="dslash__coarse_8cuh_source.html#l00038">dslash_coarse.cuh:38</a></div></div>
<div class="ttc" id="namespacequda_html_ad056ae0350f6401b3cea8d9b900f49e7"><div class="ttname"><a href="namespacequda.html#ad056ae0350f6401b3cea8d9b900f49e7">quda::coarseDslashKernel</a></div><div class="ttdeci">__global__ void coarseDslashKernel(Arg arg)</div><div class="ttdef"><b>Definition:</b> <a href="dslash__coarse_8cuh_source.html#l00379">dslash_coarse.cuh:379</a></div></div>
<div class="ttc" id="structquda_1_1_dslash_coarse_arg_html"><div class="ttname"><a href="structquda_1_1_dslash_coarse_arg.html">quda::DslashCoarseArg</a></div><div class="ttdef"><b>Definition:</b> <a href="dslash__coarse_8cuh_source.html#l00023">dslash_coarse.cuh:23</a></div></div>
<div class="ttc" id="structquda_1_1_dslash_coarse_arg_html_a106ca1ab52da81d6c5fc43c3badc5ba0"><div class="ttname"><a href="structquda_1_1_dslash_coarse_arg.html#a106ca1ab52da81d6c5fc43c3badc5ba0">quda::DslashCoarseArg::F</a></div><div class="ttdeci">colorspinor::FieldOrderCB&lt; Float, coarseSpin, coarseColor, 1, csOrder, Float, ghostFloat &gt; F</div><div class="ttdef"><b>Definition:</b> <a href="dslash__coarse_8cuh_source.html#l00024">dslash_coarse.cuh:24</a></div></div>
<div class="ttc" id="gauge__field__order_8h_html"><div class="ttname"><a href="gauge__field__order_8h.html">gauge_field_order.h</a></div><div class="ttdoc">Main header file for host and device accessors to GaugeFields. </div></div>
<div class="ttc" id="namespacequda_html_ad7224fa56ac49e4be5e0a5a8e758a5d2"><div class="ttname"><a href="namespacequda.html#ad7224fa56ac49e4be5e0a5a8e758a5d2">quda::applyDslash</a></div><div class="ttdeci">__device__ __host__ void applyDslash(complex&lt; Float &gt; out[], Arg &amp;arg, int x_cb, int src_idx, int parity, int s_row, int color_block, int color_offset)</div><div class="ttdef"><b>Definition:</b> <a href="dslash__coarse_8cuh_source.html#l00094">dslash_coarse.cuh:94</a></div></div>
<div class="ttc" id="structquda_1_1_dslash_coarse_arg_html_abf7ccaf7203aad235f924cca0e018ddb"><div class="ttname"><a href="structquda_1_1_dslash_coarse_arg.html#abf7ccaf7203aad235f924cca0e018ddb">quda::DslashCoarseArg::parity</a></div><div class="ttdeci">const int parity</div><div class="ttdef"><b>Definition:</b> <a href="dslash__coarse_8cuh_source.html#l00034">dslash_coarse.cuh:34</a></div></div>
<div class="ttc" id="structquda_1_1_arg_html"><div class="ttname"><a href="structquda_1_1_arg.html">quda::Arg</a></div><div class="ttdef"><b>Definition:</b> <a href="spinor__noise_8cu_source.html#l00022">spinor_noise.cu:22</a></div></div>
<div class="ttc" id="structquda_1_1_dslash_coarse_arg_html_a96d0ee1e620ff15340fbcc7692652141"><div class="ttname"><a href="structquda_1_1_dslash_coarse_arg.html#a96d0ee1e620ff15340fbcc7692652141">quda::DslashCoarseArg::X</a></div><div class="ttdeci">const GY X</div><div class="ttdef"><b>Definition:</b> <a href="dslash__coarse_8cuh_source.html#l00032">dslash_coarse.cuh:32</a></div></div>
<div class="ttc" id="structquda_1_1_dslash_coarse_arg_html_a01c6ccfdb8167003377bb304a5bafa60"><div class="ttname"><a href="structquda_1_1_dslash_coarse_arg.html#a01c6ccfdb8167003377bb304a5bafa60">quda::DslashCoarseArg::X0h</a></div><div class="ttdeci">const int_fastdiv X0h</div><div class="ttdef"><b>Definition:</b> <a href="dslash__coarse_8cuh_source.html#l00037">dslash_coarse.cuh:37</a></div></div>
<div class="ttc" id="index__helper_8cuh_html"><div class="ttname"><a href="index__helper_8cuh.html">index_helper.cuh</a></div></div>
<div class="ttc" id="structquda_1_1_arg_html_a8c893cadf2b678609993f7bcef5d3e14"><div class="ttname"><a href="structquda_1_1_arg.html#a8c893cadf2b678609993f7bcef5d3e14">quda::Arg::nParity</a></div><div class="ttdeci">const int nParity</div><div class="ttdef"><b>Definition:</b> <a href="spinor__noise_8cu_source.html#l00025">spinor_noise.cu:25</a></div></div>
<div class="ttc" id="structquda_1_1_dslash_coarse_arg_html_acbcbbe3cbb057286bcdd8061523b8fb3"><div class="ttname"><a href="structquda_1_1_dslash_coarse_arg.html#acbcbbe3cbb057286bcdd8061523b8fb3">quda::DslashCoarseArg::nParity</a></div><div class="ttdeci">const int nParity</div><div class="ttdef"><b>Definition:</b> <a href="dslash__coarse_8cuh_source.html#l00035">dslash_coarse.cuh:35</a></div></div>
<div class="ttc" id="color__spinor__field__order_8h_html"><div class="ttname"><a href="color__spinor__field__order_8h.html">color_spinor_field_order.h</a></div></div>
<div class="ttc" id="namespacequda_html_a011e515b863de3a8e2621be203bb1682"><div class="ttname"><a href="namespacequda.html#a011e515b863de3a8e2621be203bb1682">quda::s</a></div><div class="ttdeci">__shared__ float s[]</div></div>
<div class="ttc" id="structquda_1_1_dslash_coarse_arg_html_a5ca9268a23a76ad49bae6b2a57a9be09"><div class="ttname"><a href="structquda_1_1_dslash_coarse_arg.html#a5ca9268a23a76ad49bae6b2a57a9be09">quda::DslashCoarseArg::inA</a></div><div class="ttdeci">const F inA</div><div class="ttdef"><b>Definition:</b> <a href="dslash__coarse_8cuh_source.html#l00029">dslash_coarse.cuh:29</a></div></div>
<div class="ttc" id="structquda_1_1_dslash_coarse_arg_html_a68882f597d6b40ea04b4898c17646c53"><div class="ttname"><a href="structquda_1_1_dslash_coarse_arg.html#a68882f597d6b40ea04b4898c17646c53">quda::DslashCoarseArg::inB</a></div><div class="ttdeci">const F inB</div><div class="ttdef"><b>Definition:</b> <a href="dslash__coarse_8cuh_source.html#l00030">dslash_coarse.cuh:30</a></div></div>
<div class="ttc" id="namespacequda_html_a519e30abf575a4084224e899c730e95f"><div class="ttname"><a href="namespacequda.html#a519e30abf575a4084224e899c730e95f">quda::arg</a></div><div class="ttdeci">__host__ __device__ ValueType arg(const complex&lt; ValueType &gt; &amp;z)</div><div class="ttdoc">Returns the phase angle of z. </div><div class="ttdef"><b>Definition:</b> <a href="complex__quda_8h_source.html#l01076">complex_quda.h:1076</a></div></div>
<div class="ttc" id="structquda_1_1_arg_html_ae6ac9133de68e8db6f03f281c461d70e"><div class="ttname"><a href="structquda_1_1_arg.html#ae6ac9133de68e8db6f03f281c461d70e">quda::Arg::volumeCB</a></div><div class="ttdeci">const int volumeCB</div><div class="ttdef"><b>Definition:</b> <a href="spinor__noise_8cu_source.html#l00026">spinor_noise.cu:26</a></div></div>
<div class="ttc" id="classquda_1_1_color_spinor_field_html_af25b67fc2c472440b8138e553cceca07"><div class="ttname"><a href="classquda_1_1_color_spinor_field.html#af25b67fc2c472440b8138e553cceca07">quda::ColorSpinorField::X</a></div><div class="ttdeci">const int * X() const</div><div class="ttdef"><b>Definition:</b> <a href="color__spinor__field_8h_source.html#l00410">color_spinor_field.h:410</a></div></div>
<div class="ttc" id="structquda_1_1_dslash_coarse_arg_html_a52f2ed1783d6ac42d59398e5e6edeabc"><div class="ttname"><a href="structquda_1_1_dslash_coarse_arg.html#a52f2ed1783d6ac42d59398e5e6edeabc">quda::DslashCoarseArg::Y</a></div><div class="ttdeci">const GY Y</div><div class="ttdef"><b>Definition:</b> <a href="dslash__coarse_8cuh_source.html#l00031">dslash_coarse.cuh:31</a></div></div>
<div class="ttc" id="namespacequda_html_a03fcc69bdf6789c65b0a217f7aaea85f"><div class="ttname"><a href="namespacequda.html#a03fcc69bdf6789c65b0a217f7aaea85f">quda::applyClover</a></div><div class="ttdeci">__device__ __host__ void applyClover(complex&lt; Float &gt; out[], Arg &amp;arg, int x_cb, int src_idx, int parity, int s, int color_block, int color_offset)</div><div class="ttdef"><b>Definition:</b> <a href="dslash__coarse_8cuh_source.html#l00280">dslash_coarse.cuh:280</a></div></div>
<div class="ttc" id="structquda_1_1_dslash_coarse_arg_html_a93b0b5c420e55c6c7f1631036c820fd0"><div class="ttname"><a href="structquda_1_1_dslash_coarse_arg.html#a93b0b5c420e55c6c7f1631036c820fd0">quda::DslashCoarseArg::GY</a></div><div class="ttdeci">gauge::FieldOrder&lt; Float, coarseColor *coarseSpin, coarseSpin, gOrder, true, yFloat &gt; GY</div><div class="ttdef"><b>Definition:</b> <a href="dslash__coarse_8cuh_source.html#l00026">dslash_coarse.cuh:26</a></div></div>
<div class="ttc" id="namespacequda_html_a043738f16cdeb082fa1a5158fbad36b3"><div class="ttname"><a href="namespacequda.html#a043738f16cdeb082fa1a5158fbad36b3">quda::conj</a></div><div class="ttdeci">__host__ __device__ ValueType conj(ValueType x)</div><div class="ttdef"><b>Definition:</b> <a href="complex__quda_8h_source.html#l00130">complex_quda.h:130</a></div></div>
<div class="ttc" id="namespacequda_html_a0b554befac535568a3866593316bfe26"><div class="ttname"><a href="namespacequda.html#a0b554befac535568a3866593316bfe26">quda::linkIndexP1</a></div><div class="ttdeci">static __device__ __host__ int linkIndexP1(const int x[], const I X[4], const int mu)</div><div class="ttdef"><b>Definition:</b> <a href="index__helper_8cuh_source.html#l00139">index_helper.cuh:139</a></div></div>
<div class="ttc" id="covdev__test_8cpp_html_a39b25c22c5fc78d683968e965f5727ba"><div class="ttname"><a href="covdev__test_8cpp.html#a39b25c22c5fc78d683968e965f5727ba">dagger</a></div><div class="ttdeci">QudaDagType dagger</div><div class="ttdef"><b>Definition:</b> <a href="test__util_8cpp_source.html#l01620">test_util.cpp:1620</a></div></div>
<div class="ttc" id="namespacequda_html_ae4a6349400e866db880cd96fb2fc4bbba2d25e69c23e3dc7e917abacbee47f752"><div class="ttname"><a href="namespacequda.html#ae4a6349400e866db880cd96fb2fc4bbba2d25e69c23e3dc7e917abacbee47f752">quda::DSLASH_EXTERIOR</a></div><div class="ttdef"><b>Definition:</b> <a href="dslash__coarse_8cuh_source.html#l00018">dslash_coarse.cuh:18</a></div></div>
<div class="ttc" id="comm__quda_8h_html_a9390c85afcad52ee6919c40cf85cbc2d"><div class="ttname"><a href="comm__quda_8h.html#a9390c85afcad52ee6919c40cf85cbc2d">comm_dim_partitioned</a></div><div class="ttdeci">int comm_dim_partitioned(int dim)</div><div class="ttdef"><b>Definition:</b> <a href="comm__common_8cpp_source.html#l00635">comm_common.cpp:635</a></div></div>
<div class="ttc" id="structquda_1_1_dslash_coarse_arg_html_ab29553ad8872a31a511d19b7ab9a7072"><div class="ttname"><a href="structquda_1_1_dslash_coarse_arg.html#ab29553ad8872a31a511d19b7ab9a7072">quda::DslashCoarseArg::volumeCB</a></div><div class="ttdeci">const int volumeCB</div><div class="ttdef"><b>Definition:</b> <a href="dslash__coarse_8cuh_source.html#l00040">dslash_coarse.cuh:40</a></div></div>
<div class="ttc" id="classquda_1_1_gauge_field_html"><div class="ttname"><a href="classquda_1_1_gauge_field.html">quda::GaugeField</a></div><div class="ttdef"><b>Definition:</b> <a href="gauge__field_8h_source.html#l00164">gauge_field.h:164</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
