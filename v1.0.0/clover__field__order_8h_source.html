<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>QUDA: include/clover_field_order.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">QUDA
   &#160;<span id="projectnumber">1.0.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">clover_field_order.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="clover__field__order_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#ifndef _CLOVER_ORDER_H</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#define _CLOVER_ORDER_H</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="register__traits_8h.html">register_traits.h</a>&gt;</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="clover__field_8h.html">clover_field.h</a>&gt;</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="complex__quda_8h.html">complex_quda.h</a>&gt;</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="thrust__helper_8cuh.html">thrust_helper.cuh</a>&gt;</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="quda__matrix_8h.html">quda_matrix.h</a>&gt;</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="color__spinor_8h.html">color_spinor.h</a>&gt;</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="trove__helper_8cuh.html">trove_helper.cuh</a>&gt;</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="texture__helper_8cuh.html">texture_helper.cuh</a>&gt;</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacequda.html">quda</a> {</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Float, <span class="keyword">typename</span> T&gt;</div><div class="line"><a name="l00034"></a><span class="lineno"><a class="line" href="structquda_1_1clover__wrapper.html">   34</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structquda_1_1clover__wrapper.html">clover_wrapper</a> {</div><div class="line"><a name="l00035"></a><span class="lineno"><a class="line" href="structquda_1_1clover__wrapper.html#a06fe5a74a40f5bc94fa8abf741a2e7af">   35</a></span>&#160;      T &amp;<a class="code" href="structquda_1_1clover__wrapper.html#a06fe5a74a40f5bc94fa8abf741a2e7af">field</a>;</div><div class="line"><a name="l00036"></a><span class="lineno"><a class="line" href="structquda_1_1clover__wrapper.html#a75bdd32c1094dadb06e0d1c419574640">   36</a></span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1clover__wrapper.html#a75bdd32c1094dadb06e0d1c419574640">x_cb</a>;</div><div class="line"><a name="l00037"></a><span class="lineno"><a class="line" href="structquda_1_1clover__wrapper.html#a8505d18a553ab77811defae10fc3c183">   37</a></span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1clover__wrapper.html#a8505d18a553ab77811defae10fc3c183">parity</a>;</div><div class="line"><a name="l00038"></a><span class="lineno"><a class="line" href="structquda_1_1clover__wrapper.html#a1abc4bd026597f55be802fb1e493fcb4">   38</a></span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1clover__wrapper.html#a1abc4bd026597f55be802fb1e493fcb4">chirality</a>;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div><div class="line"><a name="l00047"></a><span class="lineno"><a class="line" href="structquda_1_1clover__wrapper.html#a482c322a2bd4efb9322d5bff3637a092">   47</a></span>&#160;      __device__ __host__ <span class="keyword">inline</span> <a class="code" href="structquda_1_1clover__wrapper.html">clover_wrapper&lt;Float,T&gt;</a>(T &amp;<a class="code" href="structquda_1_1clover__wrapper.html#a06fe5a74a40f5bc94fa8abf741a2e7af">field</a>, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1clover__wrapper.html#a75bdd32c1094dadb06e0d1c419574640">x_cb</a>, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1clover__wrapper.html#a8505d18a553ab77811defae10fc3c183">parity</a>, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1clover__wrapper.html#a1abc4bd026597f55be802fb1e493fcb4">chirality</a>)</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  : <a class="code" href="structquda_1_1clover__wrapper.html#a06fe5a74a40f5bc94fa8abf741a2e7af">field</a>(field), <a class="code" href="structquda_1_1clover__wrapper.html#a75bdd32c1094dadb06e0d1c419574640">x_cb</a>(x_cb), <a class="code" href="structquda_1_1clover__wrapper.html#a8505d18a553ab77811defae10fc3c183">parity</a>(parity), <a class="code" href="structquda_1_1clover__wrapper.html#a1abc4bd026597f55be802fb1e493fcb4">chirality</a>(chirality) { }</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> C&gt;</div><div class="line"><a name="l00055"></a><span class="lineno"><a class="line" href="structquda_1_1clover__wrapper.html#a40b45f33bb573ea9e403143dc27b171d">   55</a></span>&#160;      __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structquda_1_1clover__wrapper.html#a40b45f33bb573ea9e403143dc27b171d">operator=</a>(<span class="keyword">const</span> C &amp;a) {</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        field.save(a.data, x_cb, parity, chirality);</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      }</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    };</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keywordtype">int</span> N&gt;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> S&gt;</div><div class="line"><a name="l00062"></a><span class="lineno"><a class="line" href="structquda_1_1_h_matrix.html#ae3bbb080dc81958f41f48c714fbce437">   62</a></span>&#160;    __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structquda_1_1_h_matrix.html#a6d5ed0041e8fe91d5c042383560968c0">HMatrix&lt;T,N&gt;::operator=</a>(<span class="keyword">const</span> <a class="code" href="structquda_1_1clover__wrapper.html">clover_wrapper&lt;T,S&gt;</a> &amp;a) {</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    a.<a class="code" href="structquda_1_1clover__wrapper.html#a06fe5a74a40f5bc94fa8abf741a2e7af">field</a>.load(data, a.<a class="code" href="structquda_1_1clover__wrapper.html#a75bdd32c1094dadb06e0d1c419574640">x_cb</a>, a.<a class="code" href="structquda_1_1clover__wrapper.html#a8505d18a553ab77811defae10fc3c183">parity</a>, a.<a class="code" href="structquda_1_1clover__wrapper.html#a1abc4bd026597f55be802fb1e493fcb4">chirality</a>);</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  }</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keywordtype">int</span> N&gt;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> S&gt;</div><div class="line"><a name="l00068"></a><span class="lineno"><a class="line" href="structquda_1_1_h_matrix.html#af334878e7ed81dd5aae4358bd65a4e2d">   68</a></span>&#160;    __device__ __host__ <span class="keyword">inline</span> <a class="code" href="structquda_1_1_h_matrix.html#abe9882ee4d5f74e542975edb57100b4f">HMatrix&lt;T,N&gt;::HMatrix</a>(<span class="keyword">const</span> <a class="code" href="structquda_1_1clover__wrapper.html">clover_wrapper&lt;T,S&gt;</a> &amp;a) {</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    a.<a class="code" href="structquda_1_1clover__wrapper.html#a06fe5a74a40f5bc94fa8abf741a2e7af">field</a>.load(data, a.<a class="code" href="structquda_1_1clover__wrapper.html#a75bdd32c1094dadb06e0d1c419574640">x_cb</a>, a.<a class="code" href="structquda_1_1clover__wrapper.html#a8505d18a553ab77811defae10fc3c183">parity</a>, a.<a class="code" href="structquda_1_1clover__wrapper.html#a1abc4bd026597f55be802fb1e493fcb4">chirality</a>);</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  }</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div><div class="line"><a name="l00072"></a><span class="lineno"><a class="line" href="namespacequda_1_1clover.html">   72</a></span>&#160;  <span class="keyword">namespace </span>clover {</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div><div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1square__.html">   74</a></span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> ReduceType, <span class="keyword">typename</span> Float&gt; <span class="keyword">struct </span><a class="code" href="structquda_1_1clover_1_1square__.html">square_</a> {</div><div class="line"><a name="l00075"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1square__.html#ad0fd8d5383dbf028bbe349153f78bdad">   75</a></span>&#160;      __host__ __device__ <span class="keyword">inline</span> ReduceType <a class="code" href="structquda_1_1clover_1_1square__.html#ad0fd8d5383dbf028bbe349153f78bdad">operator()</a>(<span class="keyword">const</span> quda::complex&lt;Float&gt; &amp;x)</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      { <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span>ReduceType<span class="keyword">&gt;</span>(<a class="code" href="namespacequda.html#abeed8b3819eb6b18921f208412fe40d1">norm</a>(x)); }</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    };</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div><div class="line"><a name="l00079"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1abs__.html">   79</a></span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> ReduceType, <span class="keyword">typename</span> Float&gt; <span class="keyword">struct </span><a class="code" href="structquda_1_1clover_1_1abs__.html">abs_</a> {</div><div class="line"><a name="l00080"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1abs__.html#ac04b8e391688c107db67320cf91793df">   80</a></span>&#160;      __host__ __device__ <span class="keyword">inline</span> ReduceType <a class="code" href="structquda_1_1clover_1_1abs__.html#ac04b8e391688c107db67320cf91793df">operator()</a>(<span class="keyword">const</span> quda::complex&lt;Float&gt; &amp;x)</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      { <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span>ReduceType<span class="keyword">&gt;</span>(<a class="code" href="namespacequda.html#afc8f979be274d625e247ce913db49805">abs</a>(x)); }</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    };</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div><div class="line"><a name="l00168"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_accessor.html">  168</a></span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> Float, <span class="keywordtype">int</span> nColor, <span class="keywordtype">int</span> nSpin, QudaCloverFieldOrder order&gt; <span class="keyword">struct </span><a class="code" href="structquda_1_1clover_1_1_accessor.html">Accessor</a> {</div><div class="line"><a name="l00169"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_accessor.html#adc2697616f10f4f591508e3c2c7437a2">  169</a></span>&#160;      <span class="keyword">mutable</span> complex&lt;Float&gt; <a class="code" href="structquda_1_1clover_1_1_accessor.html#adc2697616f10f4f591508e3c2c7437a2">dummy</a>;</div><div class="line"><a name="l00170"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_accessor.html#a497c61bc7b95f3f677fe1008d950d574">  170</a></span>&#160;      <a class="code" href="structquda_1_1clover_1_1_accessor.html#a497c61bc7b95f3f677fe1008d950d574">Accessor</a>(<span class="keyword">const</span> <a class="code" href="classquda_1_1_clover_field.html">CloverField</a> &amp;A, <span class="keywordtype">bool</span> <a class="code" href="namespacequda.html#a599ff2d7aba3544b3e0559cd50861906">inverse</a>=<span class="keyword">false</span>) {</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <a class="code" href="util__quda_8h.html#af3bddfd9d113d50e8e0bbf58a35c5aac">errorQuda</a>(<span class="stringliteral">&quot;Not implemented for order %d&quot;</span>, order);</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      }</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div><div class="line"><a name="l00174"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_accessor.html#a22bdd0119157278ab658128e1e1e30e3">  174</a></span>&#160;      __device__ __host__ <span class="keyword">inline</span> complex&lt;Float&gt;&amp; <a class="code" href="structquda_1_1clover_1_1_accessor.html#a22bdd0119157278ab658128e1e1e30e3">operator()</a>(<span class="keywordtype">int</span> <a class="code" href="structquda_1_1clover__wrapper.html#a8505d18a553ab77811defae10fc3c183">parity</a>, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> s_row, <span class="keywordtype">int</span> s_col,</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                  <span class="keywordtype">int</span> c_row, <span class="keywordtype">int</span> c_col)<span class="keyword"> const </span>{</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="keywordflow">return</span> dummy;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      }</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> helper, <span class="keyword">typename</span> reducer&gt;</div><div class="line"><a name="l00180"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_accessor.html#acd10a705d2c216fb249faccf6bbf45ab">  180</a></span>&#160;        __host__ <span class="keywordtype">double</span> <a class="code" href="structquda_1_1clover_1_1_accessor.html#acd10a705d2c216fb249faccf6bbf45ab">transform_reduce</a>(<a class="code" href="enum__quda_8h.html#a7e07bc0f2e37ab1df05cd3c87017ff33">QudaFieldLocation</a> location, helper h, reducer r, <span class="keywordtype">double</span> i)<span class="keyword"> const</span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="keyword">      </span>{</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        <span class="keywordflow">return</span> 0.0;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      }</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    };</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> Float, <span class="keywordtype">int</span> nColor, <span class="keywordtype">int</span> nSpin&gt;</div><div class="line"><a name="l00187"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___f_l_o_a_t2___c_l_o_v_e_r___o_r_d_e_r_01_4.html">  187</a></span>&#160;      <span class="keyword">struct </span><a class="code" href="structquda_1_1clover_1_1_accessor.html">Accessor</a>&lt;Float,<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a>,nSpin,<a class="code" href="enum__quda_8h.html#a0b751fe440798c39fb8c49c9f2a38911ab0e8c3a8d7516b0d3bade11faa91eda8">QUDA_FLOAT2_CLOVER_ORDER</a>&gt; {</div><div class="line"><a name="l00188"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___f_l_o_a_t2___c_l_o_v_e_r___o_r_d_e_r_01_4.html#a9b2df5d6167a1a139452f30f57d35967">  188</a></span>&#160;      Float *<a class="code" href="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___f_l_o_a_t2___c_l_o_v_e_r___o_r_d_e_r_01_4.html#a9b2df5d6167a1a139452f30f57d35967">a</a>;</div><div class="line"><a name="l00189"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___f_l_o_a_t2___c_l_o_v_e_r___o_r_d_e_r_01_4.html#a7af42b4824ddddb33b8d9dfb964e3c44">  189</a></span>&#160;      <span class="keywordtype">int</span> <a class="code" href="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___f_l_o_a_t2___c_l_o_v_e_r___o_r_d_e_r_01_4.html#a7af42b4824ddddb33b8d9dfb964e3c44">stride</a>;</div><div class="line"><a name="l00190"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___f_l_o_a_t2___c_l_o_v_e_r___o_r_d_e_r_01_4.html#a7a11b530e4ca00a1c8307c8b448054ab">  190</a></span>&#160;      <span class="keywordtype">size_t</span> <a class="code" href="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___f_l_o_a_t2___c_l_o_v_e_r___o_r_d_e_r_01_4.html#a7a11b530e4ca00a1c8307c8b448054ab">offset_cb</a>;</div><div class="line"><a name="l00191"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___f_l_o_a_t2___c_l_o_v_e_r___o_r_d_e_r_01_4.html#abea45e90b4893b3b7c6312b7a8158b82">  191</a></span>&#160;      <span class="keyword">static</span> constexpr <span class="keywordtype">int</span> N = nSpin * <a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a> / 2;</div><div class="line"><a name="l00192"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___f_l_o_a_t2___c_l_o_v_e_r___o_r_d_e_r_01_4.html#afbdc8d006c9bcd4e9956808b5c904d12">  192</a></span>&#160;    <a class="code" href="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___f_l_o_a_t2___c_l_o_v_e_r___o_r_d_e_r_01_4.html#afbdc8d006c9bcd4e9956808b5c904d12">Accessor</a>(<span class="keyword">const</span> <a class="code" href="classquda_1_1_clover_field.html">CloverField</a> &amp;A, <span class="keywordtype">bool</span> <a class="code" href="namespacequda.html#a599ff2d7aba3544b3e0559cd50861906">inverse</a>=<span class="keyword">false</span>)</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      : a(static_cast&lt;Float*&gt;(const_cast&lt;void*&gt;(A.<a class="code" href="contract__reference_8h.html#a91e334f289dc11ba09da0df4a9c72123">V</a>(<a class="code" href="namespacequda.html#a599ff2d7aba3544b3e0559cd50861906">inverse</a>)))), stride(A.Stride()),</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  offset_cb(A.Bytes()/(2*sizeof(Float))) { }</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div><div class="line"><a name="l00196"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___f_l_o_a_t2___c_l_o_v_e_r___o_r_d_e_r_01_4.html#a689f2d80b0c3ccdb173c0db14d4173f0">  196</a></span>&#160;      __device__ __host__ <span class="keyword">inline</span> complex&lt;Float&gt; <a class="code" href="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___f_l_o_a_t2___c_l_o_v_e_r___o_r_d_e_r_01_4.html#a689f2d80b0c3ccdb173c0db14d4173f0">operator()</a>(<span class="keywordtype">int</span> <a class="code" href="structquda_1_1clover__wrapper.html#a8505d18a553ab77811defae10fc3c183">parity</a>, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> s_row, <span class="keywordtype">int</span> s_col, <span class="keywordtype">int</span> c_row, <span class="keywordtype">int</span> c_col)<span class="keyword"> const </span>{</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  <span class="comment">// if not in the diagonal chiral block then return 0.0</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <span class="keywordflow">if</span> (s_col / 2 != s_row / 2) { <span class="keywordflow">return</span> complex&lt;Float&gt;(0.0); }</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1clover__wrapper.html#a1abc4bd026597f55be802fb1e493fcb4">chirality</a> = s_col / 2;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <span class="keywordtype">int</span> row = s_row%2 * <a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a> + c_row;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <span class="keywordtype">int</span> col = s_col%2 * <a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a> + c_col;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  Float *a_ = a+parity*offset_cb+stride*chirality*N*N;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  <span class="keywordflow">if</span> (row == col) {</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="keywordflow">return</span> 2*a_[ row*stride+x ];</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (col &lt; row) {</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="comment">// switch coordinates to count from bottom right instead of top left of matrix</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="keywordtype">int</span> k = N*(N-1)/2 - (N-col)*(N-col-1)/2 + row - col - 1;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;          complex&lt;Float&gt; *off = <span class="keyword">reinterpret_cast&lt;</span>complex&lt;Float&gt;*<span class="keyword">&gt;</span>(a_ + N);</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;          <span class="keywordflow">return</span> 2*off[k*stride + x];</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="comment">// requesting upper triangular so return conjugate transpose</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="comment">// switch coordinates to count from bottom right instead of top left of matrix</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="keywordtype">int</span> k = N*(N-1)/2 - (N-row)*(N-row-1)/2 + col - row - 1;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;          complex&lt;Float&gt; *off = <span class="keyword">reinterpret_cast&lt;</span>complex&lt;Float&gt;*<span class="keyword">&gt;</span>(a_ + N);</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;          <span class="keywordflow">return</span> 2*<a class="code" href="namespacequda.html#a043738f16cdeb082fa1a5158fbad36b3">conj</a>(off[k*stride + x]);</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  }</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;      }</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> helper, <span class="keyword">typename</span> reducer&gt;</div><div class="line"><a name="l00225"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___f_l_o_a_t2___c_l_o_v_e_r___o_r_d_e_r_01_4.html#ada45daf52c1c0426cb72fc772bbaf235">  225</a></span>&#160;        __host__ <span class="keywordtype">double</span> <a class="code" href="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___f_l_o_a_t2___c_l_o_v_e_r___o_r_d_e_r_01_4.html#ada45daf52c1c0426cb72fc772bbaf235">transform_reduce</a>(<a class="code" href="enum__quda_8h.html#a7e07bc0f2e37ab1df05cd3c87017ff33">QudaFieldLocation</a> location, helper h, reducer r, <span class="keywordtype">double</span> <a class="code" href="namespacequda_1_1cublas.html#ac642c2c4f9dd3abfe528cc1581e5bf76">init</a>)<span class="keyword"> const </span>{</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        <span class="keywordtype">double</span> result = <a class="code" href="namespacequda_1_1cublas.html#ac642c2c4f9dd3abfe528cc1581e5bf76">init</a>;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        <span class="keywordflow">if</span> (location == <a class="code" href="enum__quda_8h.html#a35de1312d8bed4b94234a3092907e0d9a184379764fab0f101cab6f19a8a14690">QUDA_CUDA_FIELD_LOCATION</a>) {</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;          <a class="code" href="classthrust__allocator.html">thrust_allocator</a> <a class="code" href="namespacequda.html#a4fae7f819003f6b7116efc43e7830908">alloc</a>;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;          thrust::device_ptr&lt;complex&lt;Float&gt; &gt; ptr(<span class="keyword">reinterpret_cast&lt;</span>complex&lt;Float&gt;*<span class="keyword">&gt;</span>(a));</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;          result = thrust::transform_reduce(thrust::cuda::par(alloc), ptr, ptr+offset_cb, h, result, r);</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;          <span class="comment">// just use offset_cb, since factor of two from parity is equivalent to complexity</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;          complex&lt;Float&gt; *ptr = <span class="keyword">reinterpret_cast&lt;</span>complex&lt;Float&gt;*<span class="keyword">&gt;</span>(a);</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;          result = thrust::transform_reduce(thrust::seq, ptr, ptr+offset_cb, h, result, r);</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        }</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        <span class="keywordflow">return</span> 2.0 * result; <span class="comment">// factor of two is normalization</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      }</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    };</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="keyword">template</span>&lt;<span class="keywordtype">int</span> N&gt;</div><div class="line"><a name="l00242"></a><span class="lineno"><a class="line" href="namespacequda_1_1clover.html#aa356224212581cf8af5f8dad868a2ddb">  242</a></span>&#160;      __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="namespacequda_1_1clover.html#aa356224212581cf8af5f8dad868a2ddb">indexFloatN</a>(<span class="keywordtype">int</span> k, <span class="keywordtype">int</span> stride, <span class="keywordtype">int</span> x) {</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;      <span class="keywordtype">int</span> j = k / N;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      <span class="keywordtype">int</span> i = k % N;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      <span class="keywordflow">return</span> (j*stride+x)*N + i;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    };</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> Float, <span class="keywordtype">int</span> nColor, <span class="keywordtype">int</span> nSpin&gt;</div><div class="line"><a name="l00249"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___f_l_o_a_t4___c_l_o_v_e_r___o_r_d_e_r_01_4.html">  249</a></span>&#160;      <span class="keyword">struct </span><a class="code" href="structquda_1_1clover_1_1_accessor.html">Accessor</a>&lt;Float,<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a>,nSpin,<a class="code" href="enum__quda_8h.html#a0b751fe440798c39fb8c49c9f2a38911a99dff6b9f0fe3de07efc0858bee04ff4">QUDA_FLOAT4_CLOVER_ORDER</a>&gt; {</div><div class="line"><a name="l00250"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___f_l_o_a_t4___c_l_o_v_e_r___o_r_d_e_r_01_4.html#a6c4b80461c745ae6eb3bfcfd98942d10">  250</a></span>&#160;      Float *<a class="code" href="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___f_l_o_a_t4___c_l_o_v_e_r___o_r_d_e_r_01_4.html#a6c4b80461c745ae6eb3bfcfd98942d10">a</a>;</div><div class="line"><a name="l00251"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___f_l_o_a_t4___c_l_o_v_e_r___o_r_d_e_r_01_4.html#ab04d28b0a50aabc5831161b2fa25b972">  251</a></span>&#160;      <span class="keywordtype">int</span> <a class="code" href="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___f_l_o_a_t4___c_l_o_v_e_r___o_r_d_e_r_01_4.html#ab04d28b0a50aabc5831161b2fa25b972">stride</a>;</div><div class="line"><a name="l00252"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___f_l_o_a_t4___c_l_o_v_e_r___o_r_d_e_r_01_4.html#a0b2be43650e7d3e1db84b38b32dd80e0">  252</a></span>&#160;      <span class="keywordtype">size_t</span> <a class="code" href="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___f_l_o_a_t4___c_l_o_v_e_r___o_r_d_e_r_01_4.html#a0b2be43650e7d3e1db84b38b32dd80e0">offset_cb</a>;</div><div class="line"><a name="l00253"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___f_l_o_a_t4___c_l_o_v_e_r___o_r_d_e_r_01_4.html#aa3b6913fd14e910b835105b1b10d1ac0">  253</a></span>&#160;      <span class="keyword">static</span> constexpr <span class="keywordtype">int</span> N = nSpin * <a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a> / 2;</div><div class="line"><a name="l00254"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___f_l_o_a_t4___c_l_o_v_e_r___o_r_d_e_r_01_4.html#a0a2f005bc7ee62d27350408ddfefac82">  254</a></span>&#160;    <a class="code" href="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___f_l_o_a_t4___c_l_o_v_e_r___o_r_d_e_r_01_4.html#a0a2f005bc7ee62d27350408ddfefac82">Accessor</a>(<span class="keyword">const</span> <a class="code" href="classquda_1_1_clover_field.html">CloverField</a> &amp;A, <span class="keywordtype">bool</span> <a class="code" href="namespacequda.html#a599ff2d7aba3544b3e0559cd50861906">inverse</a>=<span class="keyword">false</span>)</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;      : a(static_cast&lt;Float*&gt;(const_cast&lt;void*&gt;(A.<a class="code" href="contract__reference_8h.html#a91e334f289dc11ba09da0df4a9c72123">V</a>(<a class="code" href="namespacequda.html#a599ff2d7aba3544b3e0559cd50861906">inverse</a>)))), stride(A.Stride()),</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  offset_cb(A.Bytes()/(2*sizeof(Float))) { }</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;</div><div class="line"><a name="l00258"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___f_l_o_a_t4___c_l_o_v_e_r___o_r_d_e_r_01_4.html#a6018e04972cc238a5bab18a6bb923e58">  258</a></span>&#160;      __device__ __host__ <span class="keyword">inline</span> complex&lt;Float&gt; <a class="code" href="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___f_l_o_a_t4___c_l_o_v_e_r___o_r_d_e_r_01_4.html#a6018e04972cc238a5bab18a6bb923e58">operator()</a>(<span class="keywordtype">int</span> <a class="code" href="structquda_1_1clover__wrapper.html#a8505d18a553ab77811defae10fc3c183">parity</a>, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> s_row, <span class="keywordtype">int</span> s_col, <span class="keywordtype">int</span> c_row, <span class="keywordtype">int</span> c_col)<span class="keyword"> const </span>{</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  <span class="comment">// if not in the diagonal chiral block then return 0.0</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  <span class="keywordflow">if</span> (s_col / 2 != s_row / 2) { <span class="keywordflow">return</span> complex&lt;Float&gt;(0.0); }</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1clover__wrapper.html#a1abc4bd026597f55be802fb1e493fcb4">chirality</a> = s_col / 2;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  <span class="keywordtype">int</span> row = s_row%2 * <a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a> + c_row;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  <span class="keywordtype">int</span> col = s_col%2 * <a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a> + c_col;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  Float *a_ = a+parity*offset_cb+stride*chirality*N*N;</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  <span class="keywordflow">if</span> (row == col) {</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="keywordflow">return</span> 2*a_[ indexFloatN&lt;QUDA_FLOAT4_CLOVER_ORDER&gt;(row, stride, x) ];</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (col &lt; row) {</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="comment">// switch coordinates to count from bottom right instead of top left of matrix</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="keywordtype">int</span> k = N*(N-1)/2 - (N-col)*(N-col-1)/2 + row - col - 1;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;          <span class="keywordtype">int</span> idx = N + 2*k;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;          <span class="keywordflow">return</span> 2*complex&lt;Float&gt;(a_[ indexFloatN&lt;QUDA_FLOAT4_CLOVER_ORDER&gt;(idx+0,stride,x) ],</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;          a_[ indexFloatN&lt;QUDA_FLOAT4_CLOVER_ORDER&gt;(idx+1,stride,x) ]);</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="comment">// requesting upper triangular so return conjugate transpose</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="comment">// switch coordinates to count from bottom right instead of top left of matrix</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="keywordtype">int</span> k = N*(N-1)/2 - (N-row)*(N-row-1)/2 + col - row - 1;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;          <span class="keywordtype">int</span> idx = N + 2*k;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;          <span class="keywordflow">return</span> 2*complex&lt;Float&gt;( a_[ indexFloatN&lt;QUDA_FLOAT4_CLOVER_ORDER&gt;(idx+0,stride,x) ],</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;          -a_[ indexFloatN&lt;QUDA_FLOAT4_CLOVER_ORDER&gt;(idx+1,stride,x) ]);</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  }</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;      }</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> helper, <span class="keyword">typename</span> reducer&gt;</div><div class="line"><a name="l00290"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___f_l_o_a_t4___c_l_o_v_e_r___o_r_d_e_r_01_4.html#a5db385c9945d5eb777d47b3304cc9b0d">  290</a></span>&#160;        __host__ <span class="keywordtype">double</span> <a class="code" href="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___f_l_o_a_t4___c_l_o_v_e_r___o_r_d_e_r_01_4.html#a5db385c9945d5eb777d47b3304cc9b0d">transform_reduce</a>(<a class="code" href="enum__quda_8h.html#a7e07bc0f2e37ab1df05cd3c87017ff33">QudaFieldLocation</a> location, helper h, reducer r, <span class="keywordtype">double</span> <a class="code" href="namespacequda_1_1cublas.html#ac642c2c4f9dd3abfe528cc1581e5bf76">init</a>)<span class="keyword"> const </span>{</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        <span class="keywordtype">double</span> result = <a class="code" href="namespacequda_1_1cublas.html#ac642c2c4f9dd3abfe528cc1581e5bf76">init</a>;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        <span class="keywordflow">if</span> (location == <a class="code" href="enum__quda_8h.html#a35de1312d8bed4b94234a3092907e0d9a184379764fab0f101cab6f19a8a14690">QUDA_CUDA_FIELD_LOCATION</a>) {</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;          <a class="code" href="classthrust__allocator.html">thrust_allocator</a> <a class="code" href="namespacequda.html#a4fae7f819003f6b7116efc43e7830908">alloc</a>;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;          thrust::device_ptr&lt;complex&lt;Float&gt; &gt; ptr(<span class="keyword">reinterpret_cast&lt;</span>complex&lt;Float&gt;*<span class="keyword">&gt;</span>(a));</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;          result = thrust::transform_reduce(thrust::cuda::par(alloc), ptr, ptr+offset_cb, h, result, r);</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;          <span class="comment">// just use offset_cb, since factor of two from parity is equivalent to complexity</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;          complex&lt;Float&gt; *ptr = <span class="keyword">reinterpret_cast&lt;</span>complex&lt;Float&gt;*<span class="keyword">&gt;</span>(a);</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;          result = thrust::transform_reduce(thrust::seq, ptr, ptr+offset_cb, h, result, r);</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        }</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        <span class="keywordflow">return</span> 2.0 * result; <span class="comment">// factor of two is normalization</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      }</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    };</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> Float, <span class="keywordtype">int</span> nColor, <span class="keywordtype">int</span> nSpin&gt; </div><div class="line"><a name="l00307"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___p_a_c_k_e_232545b3542066bbebdd93a49a8fe0b1.html">  307</a></span>&#160;      <span class="keyword">struct </span><a class="code" href="structquda_1_1clover_1_1_accessor.html">Accessor</a>&lt;Float,<a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a>,nSpin,<a class="code" href="enum__quda_8h.html#a0b751fe440798c39fb8c49c9f2a38911adb80f12d6b8d3a4083a1ec3b7d550d07">QUDA_PACKED_CLOVER_ORDER</a>&gt; { </div><div class="line"><a name="l00308"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___p_a_c_k_e_232545b3542066bbebdd93a49a8fe0b1.html#ab06180cfa7770ca8e2b0557fe73628d9">  308</a></span>&#160;      Float *a[2];</div><div class="line"><a name="l00309"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___p_a_c_k_e_232545b3542066bbebdd93a49a8fe0b1.html#aa5ee7dedd432a7c5f46ab07ce03811f2">  309</a></span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> N = nSpin * <a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a> / 2;</div><div class="line"><a name="l00310"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___p_a_c_k_e_232545b3542066bbebdd93a49a8fe0b1.html#a79d5e663fc511c732e85bfc30d5e95c1">  310</a></span>&#160;      complex&lt;Float&gt; <a class="code" href="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___p_a_c_k_e_232545b3542066bbebdd93a49a8fe0b1.html#a79d5e663fc511c732e85bfc30d5e95c1">zero</a>;</div><div class="line"><a name="l00311"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___p_a_c_k_e_232545b3542066bbebdd93a49a8fe0b1.html#aaf63f413ced2ccadfb3e533a308e15ef">  311</a></span>&#160;      <a class="code" href="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___p_a_c_k_e_232545b3542066bbebdd93a49a8fe0b1.html#aaf63f413ced2ccadfb3e533a308e15ef">Accessor</a>(<span class="keyword">const</span> <a class="code" href="classquda_1_1_clover_field.html">CloverField</a> &amp;A, <span class="keywordtype">bool</span> <a class="code" href="namespacequda.html#a599ff2d7aba3544b3e0559cd50861906">inverse</a>=<span class="keyword">false</span>) {</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  <span class="comment">// even</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  a[0] = <span class="keyword">static_cast&lt;</span>Float*<span class="keyword">&gt;</span>(<span class="keyword">const_cast&lt;</span><span class="keywordtype">void</span>*<span class="keyword">&gt;</span>(A.<a class="code" href="classquda_1_1_clover_field.html#a6ee83d32cf08ff66f215da8eaa30f97f">V</a>(<a class="code" href="namespacequda.html#a599ff2d7aba3544b3e0559cd50861906">inverse</a>)));</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  <span class="comment">// odd</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  a[1] = <span class="keyword">static_cast&lt;</span>Float*<span class="keyword">&gt;</span>(<span class="keyword">const_cast&lt;</span><span class="keywordtype">void</span>*<span class="keyword">&gt;</span>(A.<a class="code" href="classquda_1_1_clover_field.html#a6ee83d32cf08ff66f215da8eaa30f97f">V</a>(<a class="code" href="namespacequda.html#a599ff2d7aba3544b3e0559cd50861906">inverse</a>))) + A.<a class="code" href="classquda_1_1_clover_field.html#ada28d819c5115c004df406956c16d9e6">Bytes</a>()/(2*<span class="keyword">sizeof</span>(Float));</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  zero = complex&lt;Float&gt;(0.0,0.0);</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;      }</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;</div><div class="line"><a name="l00319"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___p_a_c_k_e_232545b3542066bbebdd93a49a8fe0b1.html#a973320ef133242e8f86ba1950de50d72">  319</a></span>&#160;      __device__ __host__ <span class="keyword">inline</span> complex&lt;Float&gt; <a class="code" href="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___p_a_c_k_e_232545b3542066bbebdd93a49a8fe0b1.html#a973320ef133242e8f86ba1950de50d72">operator()</a>(<span class="keywordtype">int</span> <a class="code" href="structquda_1_1clover__wrapper.html#a8505d18a553ab77811defae10fc3c183">parity</a>, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> s_row, <span class="keywordtype">int</span> s_col, <span class="keywordtype">int</span> c_row, <span class="keywordtype">int</span> c_col)<span class="keyword"> const </span>{</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  <span class="comment">// if not in the diagonal chiral block then return 0.0</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  <span class="keywordflow">if</span> (s_col / 2 != s_row / 2) { <span class="keywordflow">return</span> <a class="code" href="namespacequda.html#afdd60a37d49f6d12f8472e2a910e80c6">zero</a>; }</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1clover__wrapper.html#a1abc4bd026597f55be802fb1e493fcb4">chirality</a> = s_col / 2;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> row = s_row%2 * <a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a> + c_row;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> col = s_col%2 * <a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a> + c_col;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  <span class="keywordflow">if</span> (row == col) {</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    complex&lt;Float&gt; <a class="code" href="covdev__test_8cpp.html#a788da19b1cbae7d08eb18da226046dd7">tmp</a> = a[<a class="code" href="structquda_1_1clover__wrapper.html#a8505d18a553ab77811defae10fc3c183">parity</a>][(x*2 + <a class="code" href="structquda_1_1clover__wrapper.html#a1abc4bd026597f55be802fb1e493fcb4">chirality</a>)*N*N + row];</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="covdev__test_8cpp.html#a788da19b1cbae7d08eb18da226046dd7">tmp</a>;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (col &lt; row) {</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="comment">// switch coordinates to count from bottom right instead of top left of matrix</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="keywordtype">int</span> k = N*(N-1)/2 - (N-col)*(N-col-1)/2 + row - col - 1;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;          <span class="keywordtype">int</span> idx = (x*2 + <a class="code" href="structquda_1_1clover__wrapper.html#a1abc4bd026597f55be802fb1e493fcb4">chirality</a>)*N*N + N + 2*k;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;          <span class="keywordflow">return</span> complex&lt;Float&gt;(a[<a class="code" href="structquda_1_1clover__wrapper.html#a8505d18a553ab77811defae10fc3c183">parity</a>][idx], a[<a class="code" href="structquda_1_1clover__wrapper.html#a8505d18a553ab77811defae10fc3c183">parity</a>][idx+1]);</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="comment">// switch coordinates to count from bottom right instead of top left of matrix</span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="keywordtype">int</span> k = N*(N-1)/2 - (N-row)*(N-row-1)/2 + col - row - 1;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;          <span class="keywordtype">int</span> idx = (x*2 + <a class="code" href="structquda_1_1clover__wrapper.html#a1abc4bd026597f55be802fb1e493fcb4">chirality</a>)*N*N + N + 2*k;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;          <span class="keywordflow">return</span> complex&lt;Float&gt;(a[<a class="code" href="structquda_1_1clover__wrapper.html#a8505d18a553ab77811defae10fc3c183">parity</a>][idx], -a[<a class="code" href="structquda_1_1clover__wrapper.html#a8505d18a553ab77811defae10fc3c183">parity</a>][idx+1]);</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  }</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;      }</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;      <span class="keyword">template</span> &lt;<span class="keyword">typename</span> helper, <span class="keyword">typename</span> reducer&gt;</div><div class="line"><a name="l00345"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___p_a_c_k_e_232545b3542066bbebdd93a49a8fe0b1.html#a8929fc58b32dc05b4901cca368be6b21">  345</a></span>&#160;      __host__ <span class="keywordtype">double</span> <a class="code" href="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___p_a_c_k_e_232545b3542066bbebdd93a49a8fe0b1.html#a8929fc58b32dc05b4901cca368be6b21">transform_reduce</a>(<a class="code" href="enum__quda_8h.html#a7e07bc0f2e37ab1df05cd3c87017ff33">QudaFieldLocation</a> location, helper h, reducer r, <span class="keywordtype">double</span> <a class="code" href="namespacequda_1_1cublas.html#ac642c2c4f9dd3abfe528cc1581e5bf76">init</a>)<span class="keyword"> const</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="keyword">      </span>{</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        <a class="code" href="util__quda_8h.html#af3bddfd9d113d50e8e0bbf58a35c5aac">errorQuda</a>(<span class="stringliteral">&quot;Not implemented&quot;</span>);</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  <span class="keywordflow">return</span> 0.0;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;      }</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    };</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment">      FIXME the below is the old optimization used for reading the</span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment">      clover field, making use of the symmetry to reduce the number of</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment">      reads.</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment">#define READ_CLOVER2_DOUBLE_STR(clover_, chi)                           \</span></div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment">    double2 C0, C1, C2, C3, C4, C5, C6, C7, C8, C9;                       \</span></div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment">    double2 C10, C11, C12, C13, C14, C15, C16, C17;                       \</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment">    double2* clover = (double2*)clover_;                                  \</span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment">    load_streaming_double2(C0, &amp;clover[sid + (18*chi+0)*param.cl_stride]); \</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment">    load_streaming_double2(C1, &amp;clover[sid + (18*chi+1)*param.cl_stride]); \</span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment">    double diag = 0.5*(C0.x + C1.y);                                      \</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment">    double diag_inv = 1.0/diag;                                           \</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment">    C2 = make_double2(diag*(2-C0.y*diag_inv), diag*(2-C1.x*diag_inv));    \</span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment">    load_streaming_double2(C3, &amp;clover[sid + (18*chi+3)*param.cl_stride]);        \</span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment">    load_streaming_double2(C4, &amp;clover[sid + (18*chi+4)*param.cl_stride]);        \</span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">    load_streaming_double2(C5, &amp;clover[sid + (18*chi+5)*param.cl_stride]);        \</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment">    load_streaming_double2(C6, &amp;clover[sid + (18*chi+6)*param.cl_stride]);        \</span></div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">    load_streaming_double2(C7, &amp;clover[sid + (18*chi+7)*param.cl_stride]);        \</span></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment">    load_streaming_double2(C8, &amp;clover[sid + (18*chi+8)*param.cl_stride]);        \</span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment">    load_streaming_double2(C9, &amp;clover[sid + (18*chi+9)*param.cl_stride]);        \</span></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment">    load_streaming_double2(C10, &amp;clover[sid + (18*chi+10)*param.cl_stride]);      \</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment">    load_streaming_double2(C11, &amp;clover[sid + (18*chi+11)*param.cl_stride]);      \</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment">    load_streaming_double2(C12, &amp;clover[sid + (18*chi+12)*param.cl_stride]);      \</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment">    load_streaming_double2(C13, &amp;clover[sid + (18*chi+13)*param.cl_stride]);      \</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment">    load_streaming_double2(C14, &amp;clover[sid + (18*chi+14)*param.cl_stride]); \</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment">    C15 = make_double2(-C3.x,-C3.y);                                      \</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment">    C16 = make_double2(-C4.x,-C4.y);                                      \</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment">    C17 = make_double2(-C8.x,-C8.y);                                      \</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Float, <span class="keywordtype">int</span> nColor, <span class="keywordtype">int</span> nSpin, QudaCloverFieldOrder order&gt;</div><div class="line"><a name="l00389"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_field_order.html">  389</a></span>&#160;      <span class="keyword">struct </span><a class="code" href="structquda_1_1clover_1_1_field_order.html">FieldOrder</a> {</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;      <span class="keyword">protected</span>:</div><div class="line"><a name="l00393"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_field_order.html#ae7b6c1dd940daf5e70d8e1ce0732543a">  393</a></span>&#160;  <a class="code" href="classquda_1_1_clover_field.html">CloverField</a> &amp;<a class="code" href="structquda_1_1clover_1_1_field_order.html#ae7b6c1dd940daf5e70d8e1ce0732543a">A</a>;</div><div class="line"><a name="l00394"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_field_order.html#a2ebbda6709aa7a934b05f11e62f65bc3">  394</a></span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1clover_1_1_field_order.html#a2ebbda6709aa7a934b05f11e62f65bc3">volumeCB</a>;</div><div class="line"><a name="l00395"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_field_order.html#a434c93d72c652433cebd2bc95e4a02cd">  395</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="structquda_1_1clover_1_1_accessor.html">Accessor&lt;Float,nColor,nSpin,order&gt;</a> <a class="code" href="structquda_1_1clover_1_1_field_order.html#a434c93d72c652433cebd2bc95e4a02cd">accessor</a>;</div><div class="line"><a name="l00396"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_field_order.html#a30b54256d5da88bdbfead7a761c5200e">  396</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="structquda_1_1clover_1_1_field_order.html#a30b54256d5da88bdbfead7a761c5200e">inverse</a>;</div><div class="line"><a name="l00397"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_field_order.html#a2d78548b79ba7070b0daf25fa796227d">  397</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="enum__quda_8h.html#a7e07bc0f2e37ab1df05cd3c87017ff33">QudaFieldLocation</a> <a class="code" href="structquda_1_1clover_1_1_field_order.html#a2d78548b79ba7070b0daf25fa796227d">location</a>;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;      <span class="keyword">public</span>:</div><div class="line"><a name="l00404"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_field_order.html#a292200af541aa305fea09ab5a492ff84">  404</a></span>&#160;      <a class="code" href="structquda_1_1clover_1_1_field_order.html#a292200af541aa305fea09ab5a492ff84">FieldOrder</a>(<a class="code" href="classquda_1_1_clover_field.html">CloverField</a> &amp;A, <span class="keywordtype">bool</span> inverse=<span class="keyword">false</span>)</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;      : A(A), volumeCB(A.VolumeCB()), accessor(A,inverse), inverse(inverse), location(A.Location())</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  { }</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  </div><div class="line"><a name="l00408"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_field_order.html#a40a40c00cf5aacbc4ab2b3359121a66d">  408</a></span>&#160;  <a class="code" href="classquda_1_1_clover_field.html">CloverField</a>&amp; <a class="code" href="structquda_1_1clover_1_1_field_order.html#a40a40c00cf5aacbc4ab2b3359121a66d">Field</a>() { <span class="keywordflow">return</span> A; }</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  </div><div class="line"><a name="l00420"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_field_order.html#a5cd41dc4e3649c92f2973c5b732ec7f3">  420</a></span>&#160;  __device__ __host__ <span class="keyword">inline</span> <span class="keyword">const</span> complex&lt;Float&gt; <a class="code" href="structquda_1_1clover_1_1_field_order.html#a5cd41dc4e3649c92f2973c5b732ec7f3">operator()</a>(<span class="keywordtype">int</span> <a class="code" href="structquda_1_1clover__wrapper.html#a8505d18a553ab77811defae10fc3c183">parity</a>, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> s_row,</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                   <span class="keywordtype">int</span> s_col, <span class="keywordtype">int</span> c_row, <span class="keywordtype">int</span> c_col)<span class="keyword"> const </span>{</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="keywordflow">return</span> accessor(parity, x, s_row, s_col, c_row, c_col);</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  }</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  </div><div class="line"><a name="l00439"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_field_order.html#a024d4e2d3bff2b37e394265dd21949b6">  439</a></span>&#160;  __device__ __host__ <span class="keyword">inline</span> complex&lt;Float&gt; <a class="code" href="structquda_1_1clover_1_1_field_order.html#a024d4e2d3bff2b37e394265dd21949b6">operator()</a>(<span class="keywordtype">int</span> dummy, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1clover__wrapper.html#a8505d18a553ab77811defae10fc3c183">parity</a>, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> s_row,</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                   <span class="keywordtype">int</span> s_col, <span class="keywordtype">int</span> c_row, <span class="keywordtype">int</span> c_col)<span class="keyword"> const </span>{</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <span class="keywordflow">return</span> accessor(parity,x,s_row,s_col,c_row,c_col);</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  }</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="comment">  __device__ __host__ inline complex&lt;Float&gt;&amp; operator()(int parity, int x, int s_row,</span></div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="comment">                   int s_col, int c_row, int c_col) {</span></div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="comment">    //errorQuda(&quot;Clover accessor not implemented as a lvalue&quot;);</span></div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="comment">    return accessor(parity, x, s_row, s_col, c_row, c_col);</span></div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="comment">    }</span></div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  </div><div class="line"><a name="l00463"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_field_order.html#a18e1d25793df1521fee8747dbbbfe5e3">  463</a></span>&#160;  __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1clover_1_1_field_order.html#a18e1d25793df1521fee8747dbbbfe5e3">Ncolor</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a>; }</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;</div><div class="line"><a name="l00466"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_field_order.html#a516a249a5510118731ea219e7778a5a3">  466</a></span>&#160;  __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1clover_1_1_field_order.html#a516a249a5510118731ea219e7778a5a3">Volume</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> 2*<a class="code" href="face__gauge_8cpp.html#aef2e90455f2a9cbc0eae8c4c96cd159b">volumeCB</a>; }</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;</div><div class="line"><a name="l00469"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_field_order.html#a2ef0bb94bc8d38f8a2fa0bf722620fed">  469</a></span>&#160;  __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1clover_1_1_field_order.html#a2ef0bb94bc8d38f8a2fa0bf722620fed">VolumeCB</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="face__gauge_8cpp.html#aef2e90455f2a9cbc0eae8c4c96cd159b">volumeCB</a>; }</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;</div><div class="line"><a name="l00472"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_field_order.html#a236ae07a68257f7ab30cd10436b681a6">  472</a></span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="structquda_1_1clover_1_1_field_order.html#a236ae07a68257f7ab30cd10436b681a6">Bytes</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    constexpr <span class="keywordtype">int</span> n = (nSpin * <a class="code" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a>) / 2;</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    constexpr <span class="keywordtype">int</span> chiral_block = n * n / 2;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(<a class="code" href="face__gauge_8cpp.html#aef2e90455f2a9cbc0eae8c4c96cd159b">volumeCB</a>) * chiral_block * 2ll * 2ll * <span class="keyword">sizeof</span>(Float); <span class="comment">// 2 from complex, 2 from chirality</span></div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  }</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;</div><div class="line"><a name="l00483"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_field_order.html#a2f8135432ab105e69c40018af3d2a37b">  483</a></span>&#160;  __host__ <span class="keywordtype">double</span> <a class="code" href="structquda_1_1clover_1_1_field_order.html#a2f8135432ab105e69c40018af3d2a37b">norm1</a>(<span class="keywordtype">int</span> dim=-1, <span class="keywordtype">bool</span> global=<span class="keyword">true</span>)<span class="keyword"> const </span>{</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;          <span class="keywordtype">double</span> nrm1 = accessor.<a class="code" href="structquda_1_1clover_1_1_accessor.html#acd10a705d2c216fb249faccf6bbf45ab">transform_reduce</a>(location, <a class="code" href="structquda_1_1clover_1_1abs__.html">abs_&lt;double,Float&gt;</a>(),</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                                                  thrust::plus&lt;double&gt;(), 0.0);</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <span class="keywordflow">if</span> (global) <a class="code" href="comm__quda_8h.html#ad219441b0cdddb8ddf27cf958557713e">comm_allreduce</a>(&amp;nrm1);</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="keywordflow">return</span> nrm1;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  }</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;</div><div class="line"><a name="l00495"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_field_order.html#a3c65469c2fa4a20cd104211d46b5b83e">  495</a></span>&#160;  __host__ <span class="keywordtype">double</span> <a class="code" href="structquda_1_1clover_1_1_field_order.html#a3c65469c2fa4a20cd104211d46b5b83e">norm2</a>(<span class="keywordtype">int</span> dim=-1, <span class="keywordtype">bool</span> global=<span class="keyword">true</span>)<span class="keyword"> const </span>{</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;          <span class="keywordtype">double</span> nrm2 = accessor.<a class="code" href="structquda_1_1clover_1_1_accessor.html#acd10a705d2c216fb249faccf6bbf45ab">transform_reduce</a>(location, <a class="code" href="structquda_1_1clover_1_1square__.html">square_&lt;double,Float&gt;</a>(),</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                                                  thrust::plus&lt;double&gt;(), 0.0);</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <span class="keywordflow">if</span> (global) <a class="code" href="comm__quda_8h.html#ad219441b0cdddb8ddf27cf958557713e">comm_allreduce</a>(&amp;nrm2);</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="keywordflow">return</span> nrm2;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  }</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;</div><div class="line"><a name="l00507"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_field_order.html#a7210f54cd7b3800ad69e041039743a8c">  507</a></span>&#160;  __host__ <span class="keywordtype">double</span> <a class="code" href="structquda_1_1clover_1_1_field_order.html#a7210f54cd7b3800ad69e041039743a8c">abs_max</a>(<span class="keywordtype">int</span> dim=-1, <span class="keywordtype">bool</span> global=<span class="keyword">true</span>)<span class="keyword"> const </span>{</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="keywordtype">double</span> absmax = accessor.<a class="code" href="structquda_1_1clover_1_1_accessor.html#acd10a705d2c216fb249faccf6bbf45ab">transform_reduce</a>(location, <a class="code" href="structquda_1_1clover_1_1abs__.html">abs_&lt;Float,Float&gt;</a>(),</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                                                    thrust::maximum&lt;Float&gt;(), 0.0);</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <span class="keywordflow">if</span> (global) <a class="code" href="comm__quda_8h.html#abdf7d13f471c3c6b39e142c09fb130b4">comm_allreduce_max</a>(&amp;absmax);</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <span class="keywordflow">return</span> absmax;</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  }</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;</div><div class="line"><a name="l00519"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_field_order.html#aac48e9ca0e7b74e518966486cb941f2b">  519</a></span>&#160;  __host__ <span class="keywordtype">double</span> <a class="code" href="structquda_1_1clover_1_1_field_order.html#aac48e9ca0e7b74e518966486cb941f2b">abs_min</a>(<span class="keywordtype">int</span> dim=-1, <span class="keywordtype">bool</span> global=<span class="keyword">true</span>)<span class="keyword"> const </span>{</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <span class="keywordtype">double</span> absmax = accessor.<a class="code" href="structquda_1_1clover_1_1_accessor.html#acd10a705d2c216fb249faccf6bbf45ab">transform_reduce</a>(location, <a class="code" href="structquda_1_1clover_1_1abs__.html">abs_&lt;Float,Float&gt;</a>(),</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                                                    thrust::minimum&lt;Float&gt;(), std::numeric_limits&lt;double&gt;::max());</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    <span class="keywordflow">if</span> (global) <a class="code" href="comm__quda_8h.html#aadfcf98463bceb3dc953a0b0d815179a">comm_allreduce_min</a>(&amp;absmax);</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <span class="keywordflow">return</span> absmax;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;  }</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;      };</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Float, <span class="keywordtype">int</span> length, <span class="keywordtype">int</span> N, <span class="keywordtype">bool</span> add_rho=false, <span class="keywordtype">bool</span> huge_alloc=false&gt;</div><div class="line"><a name="l00541"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_float_n_order.html">  541</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structquda_1_1clover_1_1_float_n_order.html">FloatNOrder</a> {</div><div class="line"><a name="l00542"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_float_n_order.html#a27ba2141ad2b34b3f8dabdb149073038">  542</a></span>&#160;      <span class="keyword">using</span> <a class="code" href="structquda_1_1clover_1_1_float_n_order.html">Accessor</a> = <a class="code" href="structquda_1_1clover_1_1_float_n_order.html">FloatNOrder&lt;Float, length, N, add_rho, huge_alloc&gt;</a>;</div><div class="line"><a name="l00543"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_float_n_order.html#a78e3b401440aa7389f549221fd0abdbf">  543</a></span>&#160;      <span class="keyword">using</span> <a class="code" href="structquda_1_1clover_1_1_float_n_order.html#a78e3b401440aa7389f549221fd0abdbf">real</a> = <span class="keyword">typename</span> <a class="code" href="structquda_1_1mapper.html">mapper&lt;Float&gt;::type</a>;</div><div class="line"><a name="l00544"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_float_n_order.html#a91a4ad71aca49f4301e5eafa8562e714">  544</a></span>&#160;      <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="structquda_1_1_vector_type.html">VectorType&lt;Float, N&gt;::type</a> <a class="code" href="structquda_1_1clover_1_1_float_n_order.html#a91a4ad71aca49f4301e5eafa8562e714">Vector</a>;</div><div class="line"><a name="l00545"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_float_n_order.html#a794d59f97e7f0023e124b688b1335eb1">  545</a></span>&#160;      <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="structquda_1_1_alloc_type.html">AllocType&lt;huge_alloc&gt;::type</a> <a class="code" href="structquda_1_1clover_1_1_float_n_order.html#a794d59f97e7f0023e124b688b1335eb1">AllocInt</a>;</div><div class="line"><a name="l00546"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_float_n_order.html#a9278182b50341637fff9faa9898037ba">  546</a></span>&#160;      <span class="keyword">typedef</span> <span class="keywordtype">float</span> <a class="code" href="structquda_1_1clover_1_1_float_n_order.html#a9278182b50341637fff9faa9898037ba">norm_type</a>;</div><div class="line"><a name="l00547"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_float_n_order.html#a0e7877ffebfedf9e5e5ced87e5ef54f6">  547</a></span>&#160;      <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> M = <a class="code" href="gauge__force__test_8cpp.html#a2bcd2adde36b870d02897e694ecc39cb">length</a> / (N * 2); <span class="comment">// number of short vectors per chiral block</span></div><div class="line"><a name="l00548"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_float_n_order.html#a708cdee1342c845ba8ff88fa992fd3aa">  548</a></span>&#160;      <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> block = <a class="code" href="gauge__force__test_8cpp.html#a2bcd2adde36b870d02897e694ecc39cb">length</a> / 2;   <span class="comment">// chiral block size</span></div><div class="line"><a name="l00549"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_float_n_order.html#abac8192f2c15188d32461562d14bed7a">  549</a></span>&#160;      Float *<a class="code" href="structquda_1_1clover_1_1_float_n_order.html#abac8192f2c15188d32461562d14bed7a">clover</a>;</div><div class="line"><a name="l00550"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_float_n_order.html#a9716635fae2bbbce99fa2a560b6f54f9">  550</a></span>&#160;      norm_type *<a class="code" href="structquda_1_1clover_1_1_float_n_order.html#a9716635fae2bbbce99fa2a560b6f54f9">norm</a>;</div><div class="line"><a name="l00551"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_float_n_order.html#a5348ddb9bd0607e2841d9af09c137ad7">  551</a></span>&#160;      <span class="keyword">const</span> AllocInt <a class="code" href="structquda_1_1clover_1_1_float_n_order.html#a5348ddb9bd0607e2841d9af09c137ad7">offset</a>; <span class="comment">// offset can be 32-bit or 64-bit</span></div><div class="line"><a name="l00552"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_float_n_order.html#a0c46b3ef2837ea6f9e8b2bd80f8a4704">  552</a></span>&#160;      <span class="keyword">const</span> AllocInt <a class="code" href="structquda_1_1clover_1_1_float_n_order.html#a0c46b3ef2837ea6f9e8b2bd80f8a4704">norm_offset</a>;</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="preprocessor">#ifdef USE_TEXTURE_OBJECTS</span></div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="structquda_1_1_tex_vector_type.html">TexVectorType&lt;real, N&gt;::type</a> TexVector;</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;  cudaTextureObject_t tex;</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;  cudaTextureObject_t normTex;</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> tex_offset;</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00559"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_float_n_order.html#a40cac8a0b759bd6d168902526480a609">  559</a></span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1clover_1_1_float_n_order.html#a40cac8a0b759bd6d168902526480a609">volumeCB</a>;</div><div class="line"><a name="l00560"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_float_n_order.html#aee884001f9a3b67b442be29d8d25ab23">  560</a></span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1clover_1_1_float_n_order.html#aee884001f9a3b67b442be29d8d25ab23">stride</a>;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;</div><div class="line"><a name="l00562"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_float_n_order.html#a0a821c2e6a5463eebfcd7ad740a35371">  562</a></span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="structquda_1_1clover_1_1_float_n_order.html#a0a821c2e6a5463eebfcd7ad740a35371">twisted</a>;</div><div class="line"><a name="l00563"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_float_n_order.html#aa19fce564e076c9b8fbf2574577e392d">  563</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="structquda_1_1clover_1_1_float_n_order.html#a78e3b401440aa7389f549221fd0abdbf">real</a> <a class="code" href="structquda_1_1clover_1_1_float_n_order.html#aa19fce564e076c9b8fbf2574577e392d">mu2</a>;</div><div class="line"><a name="l00564"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_float_n_order.html#a59e3704b4288a4811168e6c8c172607d">  564</a></span>&#160;        <span class="keyword">const</span> <a class="code" href="structquda_1_1clover_1_1_float_n_order.html#a78e3b401440aa7389f549221fd0abdbf">real</a> <a class="code" href="structquda_1_1clover_1_1_float_n_order.html#a59e3704b4288a4811168e6c8c172607d">rho</a>;</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;</div><div class="line"><a name="l00566"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_float_n_order.html#a4ceed30e387daec290cc7ad6aa595f77">  566</a></span>&#160;        <span class="keywordtype">size_t</span> <a class="code" href="structquda_1_1clover_1_1_float_n_order.html#a4ceed30e387daec290cc7ad6aa595f77">bytes</a>;</div><div class="line"><a name="l00567"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_float_n_order.html#a033bd43c8bbce8a80e617276f2211610">  567</a></span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="structquda_1_1clover_1_1_float_n_order.html#a033bd43c8bbce8a80e617276f2211610">norm_bytes</a>;</div><div class="line"><a name="l00568"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_float_n_order.html#a16e436b44415962df69d308ccf82e228">  568</a></span>&#160;  <span class="keywordtype">void</span> *<a class="code" href="structquda_1_1clover_1_1_float_n_order.html#a16e436b44415962df69d308ccf82e228">backup_h</a>; </div><div class="line"><a name="l00569"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_float_n_order.html#aaebffaeb094b36d17411bb6a5faf86a6">  569</a></span>&#160;  <span class="keywordtype">void</span> *<a class="code" href="structquda_1_1clover_1_1_float_n_order.html#aaebffaeb094b36d17411bb6a5faf86a6">backup_norm_h</a>; </div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;</div><div class="line"><a name="l00571"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_float_n_order.html#a7fe20337c58af4fe4d901fa5682f6da6">  571</a></span>&#160;        <a class="code" href="structquda_1_1clover_1_1_float_n_order.html#a7fe20337c58af4fe4d901fa5682f6da6">FloatNOrder</a>(<span class="keyword">const</span> <a class="code" href="classquda_1_1_clover_field.html">CloverField</a> &amp;clover, <span class="keywordtype">bool</span> is_inverse, Float *clover_ = 0, norm_type *norm_ = 0,</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                    <span class="keywordtype">bool</span> <span class="keyword">override</span> = <span class="keyword">false</span>) :</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;            offset(clover.Bytes() / (2 * sizeof(Float))),</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;            norm_offset(clover.NormBytes() / (2 * sizeof(norm_type))),</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;#ifdef USE_TEXTURE_OBJECTS</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;            tex(0),</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;            normTex(0),</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;            tex_offset(offset / N),</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;#endif</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;            volumeCB(clover.VolumeCB()),</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;            stride(clover.Stride()),</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;            twisted(clover.Twisted()),</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;            mu2(clover.Mu2()),</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;            rho(clover.Rho()),</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;            bytes(clover.Bytes()),</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;            norm_bytes(clover.NormBytes()),</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;            backup_h(nullptr),</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;            backup_norm_h(nullptr)</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;  {</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    this-&gt;clover = clover_ ? clover_ : (Float*)(clover.<a class="code" href="classquda_1_1_clover_field.html#a6ee83d32cf08ff66f215da8eaa30f97f">V</a>(is_inverse));</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;          this-&gt;norm = norm_ ? norm_ : (norm_type *)(clover.<a class="code" href="classquda_1_1_clover_field.html#a0af989ede54c81592f9fe839d07f859a">Norm</a>(is_inverse));</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="preprocessor">#ifdef USE_TEXTURE_OBJECTS</span></div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    <span class="keywordflow">if</span> (clover.<a class="code" href="classquda_1_1_lattice_field.html#a644c9306ed8f513cdb2c88c755e305d8">Location</a>() == <a class="code" href="enum__quda_8h.html#a35de1312d8bed4b94234a3092907e0d9a184379764fab0f101cab6f19a8a14690">QUDA_CUDA_FIELD_LOCATION</a>) {</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;      <span class="keywordflow">if</span> (is_inverse) {</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;        tex = <span class="keyword">static_cast&lt;</span><span class="keyword">const </span><a class="code" href="classquda_1_1cuda_clover_field.html">cudaCloverField</a>&amp;<span class="keyword">&gt;</span>(clover).InvTex();</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        normTex = <span class="keyword">static_cast&lt;</span><span class="keyword">const </span><a class="code" href="classquda_1_1cuda_clover_field.html">cudaCloverField</a>&amp;<span class="keyword">&gt;</span>(clover).InvNormTex();</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;        tex = <span class="keyword">static_cast&lt;</span><span class="keyword">const </span><a class="code" href="classquda_1_1cuda_clover_field.html">cudaCloverField</a>&amp;<span class="keyword">&gt;</span>(clover).Tex();</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        normTex = <span class="keyword">static_cast&lt;</span><span class="keyword">const </span><a class="code" href="classquda_1_1cuda_clover_field.html">cudaCloverField</a>&amp;<span class="keyword">&gt;</span>(clover).NormTex();</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;      }</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;      <span class="keywordflow">if</span> (!huge_alloc &amp;&amp; (this-&gt;clover != clover.<a class="code" href="classquda_1_1_clover_field.html#a6ee83d32cf08ff66f215da8eaa30f97f">V</a>(is_inverse) ||</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;        ((clover.<a class="code" href="classquda_1_1_lattice_field.html#a5ddb59a67d4ade2aad18f1d974599073">Precision</a>() == <a class="code" href="enum__quda_8h.html#ac166c47d6ef16f830c164fefe6c8ab90afb568427ae928d5a1330ee47ef03c0b6">QUDA_HALF_PRECISION</a> || clover.<a class="code" href="classquda_1_1_lattice_field.html#a5ddb59a67d4ade2aad18f1d974599073">Precision</a>() == <a class="code" href="enum__quda_8h.html#ac166c47d6ef16f830c164fefe6c8ab90aeac943998f9a94180aa7e472599219c5">QUDA_QUARTER_PRECISION</a>) &amp;&amp; this-&gt;norm != clover.<a class="code" href="classquda_1_1_clover_field.html#a0af989ede54c81592f9fe839d07f859a">Norm</a>(is_inverse)) ) &amp;&amp; !<span class="keyword">override</span>) {</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        <a class="code" href="util__quda_8h.html#af3bddfd9d113d50e8e0bbf58a35c5aac">errorQuda</a>(<span class="stringliteral">&quot;Cannot use texture read since data pointer does not equal field pointer - use with huge_alloc=true instead&quot;</span>);</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;      }</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    }</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;  }</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;</div><div class="line"><a name="l00609"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_float_n_order.html#afca847714f45caf0618eb5d614ef58db">  609</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="structquda_1_1clover_1_1_float_n_order.html#afca847714f45caf0618eb5d614ef58db">Twisted</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> twisted; }</div><div class="line"><a name="l00610"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_float_n_order.html#a6a79dea3081969da52086b0bf9a750a6">  610</a></span>&#160;  <a class="code" href="structquda_1_1clover_1_1_float_n_order.html#a78e3b401440aa7389f549221fd0abdbf">real</a> <a class="code" href="structquda_1_1clover_1_1_float_n_order.html#a6a79dea3081969da52086b0bf9a750a6">Mu2</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> mu2; }</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;</div><div class="line"><a name="l00622"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_float_n_order.html#a0b84085b326733132eb3a3cd8db9d9f9">  622</a></span>&#160;        __device__ __host__ <span class="keyword">inline</span> <a class="code" href="structquda_1_1clover__wrapper.html">clover_wrapper&lt;real, Accessor&gt;</a> <a class="code" href="structquda_1_1clover_1_1_float_n_order.html#a0b84085b326733132eb3a3cd8db9d9f9">operator()</a>(<span class="keywordtype">int</span> <a class="code" href="structquda_1_1clover__wrapper.html#a75bdd32c1094dadb06e0d1c419574640">x_cb</a>, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1clover__wrapper.html#a8505d18a553ab77811defae10fc3c183">parity</a>, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1clover__wrapper.html#a1abc4bd026597f55be802fb1e493fcb4">chirality</a>)</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        {</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="structquda_1_1clover__wrapper.html">clover_wrapper&lt;real, Accessor&gt;</a>(*<span class="keyword">this</span>, <a class="code" href="structquda_1_1clover__wrapper.html#a75bdd32c1094dadb06e0d1c419574640">x_cb</a>, <a class="code" href="structquda_1_1clover__wrapper.html#a8505d18a553ab77811defae10fc3c183">parity</a>, <a class="code" href="structquda_1_1clover__wrapper.html#a1abc4bd026597f55be802fb1e493fcb4">chirality</a>);</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        }</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;</div><div class="line"><a name="l00637"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_float_n_order.html#a63e1cf7f32c5dff50075e706a4d3f4b3">  637</a></span>&#160;        __device__ __host__ <span class="keyword">inline</span> <span class="keyword">const</span> <a class="code" href="structquda_1_1clover__wrapper.html">clover_wrapper&lt;real, Accessor&gt;</a> <a class="code" href="structquda_1_1clover_1_1_float_n_order.html#a63e1cf7f32c5dff50075e706a4d3f4b3">operator()</a>(</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;            <span class="keywordtype">int</span> <a class="code" href="structquda_1_1clover__wrapper.html#a75bdd32c1094dadb06e0d1c419574640">x_cb</a>, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1clover__wrapper.html#a8505d18a553ab77811defae10fc3c183">parity</a>, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1clover__wrapper.html#a1abc4bd026597f55be802fb1e493fcb4">chirality</a>)<span class="keyword"> const</span></div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="keyword">        </span>{</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="structquda_1_1clover__wrapper.html">clover_wrapper&lt;real, Accessor&gt;</a>(<span class="keyword">const_cast&lt;</span><a class="code" href="structquda_1_1clover_1_1_float_n_order.html">Accessor</a> &amp;<span class="keyword">&gt;</span>(*this), <a class="code" href="structquda_1_1clover__wrapper.html#a75bdd32c1094dadb06e0d1c419574640">x_cb</a>, <a class="code" href="structquda_1_1clover__wrapper.html#a8505d18a553ab77811defae10fc3c183">parity</a>, <a class="code" href="structquda_1_1clover__wrapper.html#a1abc4bd026597f55be802fb1e493fcb4">chirality</a>);</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;        }</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;</div><div class="line"><a name="l00650"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_float_n_order.html#a008bead55dc528e9b61d9c31d0bbe973">  650</a></span>&#160;  __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structquda_1_1clover_1_1_float_n_order.html#a008bead55dc528e9b61d9c31d0bbe973">load</a>(<a class="code" href="structquda_1_1clover_1_1_float_n_order.html#a78e3b401440aa7389f549221fd0abdbf">real</a> v[block], <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1clover__wrapper.html#a8505d18a553ab77811defae10fc3c183">parity</a>, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1clover__wrapper.html#a1abc4bd026597f55be802fb1e493fcb4">chirality</a>)<span class="keyword"> const</span></div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;<span class="keyword">        </span>{</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;          norm_type nrm;</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="structquda_1_1is_fixed.html">isFixed&lt;Float&gt;::value</a>) {</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="preprocessor">#if defined(USE_TEXTURE_OBJECTS) &amp;&amp; defined(__CUDA_ARCH__)</span></div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;            nrm = !huge_alloc ? tex1Dfetch_&lt;float&gt;(normTex, parity * norm_offset + chirality * stride + x) :</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;                                norm[parity * norm_offset + chirality * stride + x];</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;            nrm = norm[parity * norm_offset + chirality * stride + x];</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;          }</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="preprocessor">#pragma unroll</span></div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;M; i++) {</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="preprocessor">#if defined(USE_TEXTURE_OBJECTS) &amp;&amp; defined(__CUDA_ARCH__)</span></div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;      <span class="keywordflow">if</span> (!huge_alloc) { <span class="comment">// use textures unless we have a huge alloc</span></div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;                               <span class="comment">// first do texture load from memory</span></div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;              TexVector vecTmp = tex1Dfetch_&lt;TexVector&gt;(tex, parity*tex_offset + stride*(chirality*M+i) + x);</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;              <span class="comment">// now insert into output array</span></div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<span class="preprocessor">#pragma unroll</span></div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; N; j++) {</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;                <a class="code" href="namespacequda.html#abf5b4d5728021e058d90ff1d07446399">copy</a>(v[i * N + j], reinterpret_cast&lt;real *&gt;(&amp;vecTmp)[j]);</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="structquda_1_1is_fixed.html">isFixed&lt;Float&gt;::value</a>) v[i * N + j] *= nrm;</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;              }</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;            } <span class="keywordflow">else</span></div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;      {</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;              <span class="comment">// first load from memory</span></div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;              Vector vecTmp = vector_load&lt;Vector&gt;(clover + parity*offset, x + stride*(chirality*M+i));</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;        <span class="comment">// second do scalar copy converting into register type</span></div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;<span class="preprocessor">#pragma unroll</span></div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; N; j++) { <a class="code" href="namespacequda.html#ac323f3a5a3665f54d224c1427d1085e7">copy_and_scale</a>(v[i * N + j], reinterpret_cast&lt;Float *&gt;(&amp;vecTmp)[j], nrm); }</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;            }</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    }</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;          <span class="keywordflow">if</span> (add_rho) <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;6; i++) v[i] += rho;</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;        }</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;  </div><div class="line"><a name="l00695"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_float_n_order.html#a4aaa02e127657003d68c634bcda15a9f">  695</a></span>&#160;  __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structquda_1_1clover_1_1_float_n_order.html#a4aaa02e127657003d68c634bcda15a9f">save</a>(<span class="keyword">const</span> <a class="code" href="structquda_1_1clover_1_1_float_n_order.html#a78e3b401440aa7389f549221fd0abdbf">real</a> v[block], <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1clover__wrapper.html#a8505d18a553ab77811defae10fc3c183">parity</a>, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1clover__wrapper.html#a1abc4bd026597f55be802fb1e493fcb4">chirality</a>)</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;        {</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;          <a class="code" href="structquda_1_1clover_1_1_float_n_order.html#a78e3b401440aa7389f549221fd0abdbf">real</a> <a class="code" href="covdev__test_8cpp.html#a788da19b1cbae7d08eb18da226046dd7">tmp</a>[block];</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;          <span class="comment">// find the norm of each chiral block</span></div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="structquda_1_1is_fixed.html">isFixed&lt;Float&gt;::value</a>) {</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;            norm_type scale = 0.0;</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="preprocessor">#pragma unroll</span></div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; block; i++) scale = fabsf((norm_type)v[i]) &gt; scale ? fabsf((norm_type)v[i]) : scale;</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;            norm[parity*norm_offset + chirality*stride + x] = scale;</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="preprocessor">#ifdef __CUDA_ARCH__</span></div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;            <a class="code" href="structquda_1_1clover_1_1_float_n_order.html#a78e3b401440aa7389f549221fd0abdbf">real</a> scale_inv = __fdividef(<a class="code" href="structquda_1_1fixed_max_value.html">fixedMaxValue&lt;Float&gt;::value</a>, scale);</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;            <a class="code" href="structquda_1_1clover_1_1_float_n_order.html#a78e3b401440aa7389f549221fd0abdbf">real</a> scale_inv = <a class="code" href="structquda_1_1fixed_max_value.html">fixedMaxValue&lt;Float&gt;::value</a> / scale;</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;<span class="preprocessor">#pragma unroll</span></div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; block; i++) tmp[i] = v[i] * scale_inv;</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;          } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;<span class="preprocessor">#pragma unroll</span></div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; block; i++) tmp[i] = v[i];</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;          }</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;<span class="preprocessor">#pragma unroll</span></div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; M; i++) {</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;            Vector vecTmp;</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;            <span class="comment">// first do scalar copy converting into storage type</span></div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; N; j++) copy_scaled(reinterpret_cast&lt;Float *&gt;(&amp;vecTmp)[j], tmp[i * N + j]);</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;            <span class="comment">// second do vectorized copy into memory</span></div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;      <a class="code" href="namespacequda.html#aaeda4e4f5aabf19dae35f28e4c8802b7">vector_store</a>(clover + parity*offset, x + stride*(chirality*M+i), vecTmp);</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;          }</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;        }</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;</div><div class="line"><a name="l00735"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_float_n_order.html#aa8955fcd899acd3c9e469d0c5b9c6b45">  735</a></span>&#160;  __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structquda_1_1clover_1_1_float_n_order.html#aa8955fcd899acd3c9e469d0c5b9c6b45">load</a>(<a class="code" href="structquda_1_1clover_1_1_float_n_order.html#a78e3b401440aa7389f549221fd0abdbf">real</a> v[<a class="code" href="gauge__force__test_8cpp.html#a2bcd2adde36b870d02897e694ecc39cb">length</a>], <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1clover__wrapper.html#a8505d18a553ab77811defae10fc3c183">parity</a>)<span class="keyword"> const </span>{</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;<span class="preprocessor">#pragma unroll</span></div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="structquda_1_1clover__wrapper.html#a1abc4bd026597f55be802fb1e493fcb4">chirality</a> = 0; <a class="code" href="structquda_1_1clover__wrapper.html#a1abc4bd026597f55be802fb1e493fcb4">chirality</a> &lt; 2; <a class="code" href="structquda_1_1clover__wrapper.html#a1abc4bd026597f55be802fb1e493fcb4">chirality</a>++) load(&amp;v[<a class="code" href="structquda_1_1clover__wrapper.html#a1abc4bd026597f55be802fb1e493fcb4">chirality</a> * block], x, parity, <a class="code" href="structquda_1_1clover__wrapper.html#a1abc4bd026597f55be802fb1e493fcb4">chirality</a>);</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;        }</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;</div><div class="line"><a name="l00747"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_float_n_order.html#a3e405e6e58431b32451622370a8b8414">  747</a></span>&#160;  __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structquda_1_1clover_1_1_float_n_order.html#a3e405e6e58431b32451622370a8b8414">save</a>(<span class="keyword">const</span> <a class="code" href="structquda_1_1clover_1_1_float_n_order.html#a78e3b401440aa7389f549221fd0abdbf">real</a> v[<a class="code" href="gauge__force__test_8cpp.html#a2bcd2adde36b870d02897e694ecc39cb">length</a>], <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1clover__wrapper.html#a8505d18a553ab77811defae10fc3c183">parity</a>) {</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;<span class="preprocessor">#pragma unroll</span></div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="structquda_1_1clover__wrapper.html#a1abc4bd026597f55be802fb1e493fcb4">chirality</a> = 0; <a class="code" href="structquda_1_1clover__wrapper.html#a1abc4bd026597f55be802fb1e493fcb4">chirality</a> &lt; 2; <a class="code" href="structquda_1_1clover__wrapper.html#a1abc4bd026597f55be802fb1e493fcb4">chirality</a>++) save(&amp;v[<a class="code" href="structquda_1_1clover__wrapper.html#a1abc4bd026597f55be802fb1e493fcb4">chirality</a> * block], x, parity, <a class="code" href="structquda_1_1clover__wrapper.html#a1abc4bd026597f55be802fb1e493fcb4">chirality</a>);</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;        }</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;</div><div class="line"><a name="l00755"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_float_n_order.html#a4a92be20680bf82332c498da18432ead">  755</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="structquda_1_1clover_1_1_float_n_order.html#a4a92be20680bf82332c498da18432ead">save</a>() {</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    <span class="keywordflow">if</span> (backup_h) <a class="code" href="util__quda_8h.html#af3bddfd9d113d50e8e0bbf58a35c5aac">errorQuda</a>(<span class="stringliteral">&quot;Already allocated host backup&quot;</span>);</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    backup_h = <a class="code" href="malloc__quda_8h.html#a45d92b2c2231b848192b3086283d05b6">safe_malloc</a>(bytes);</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    cudaMemcpy(backup_h, clover, bytes, cudaMemcpyDeviceToHost);</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    <span class="keywordflow">if</span> (norm_bytes) {</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;      backup_norm_h = <a class="code" href="malloc__quda_8h.html#a45d92b2c2231b848192b3086283d05b6">safe_malloc</a>(norm_bytes);</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;      cudaMemcpy(backup_norm_h, norm, norm_bytes, cudaMemcpyDeviceToHost);</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    }</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    <a class="code" href="util__quda_8h.html#a7668e6580e0f57b0db3112fae4959e34">checkCudaError</a>();</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;  }</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;</div><div class="line"><a name="l00769"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_float_n_order.html#a82f0ae22d54b477d6c93df7c08dc9e95">  769</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="structquda_1_1clover_1_1_float_n_order.html#a82f0ae22d54b477d6c93df7c08dc9e95">load</a>() {</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    cudaMemcpy(clover, backup_h, bytes, cudaMemcpyHostToDevice);</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    <a class="code" href="malloc__quda_8h.html#ad733cb3f6cac705c8db7b0afad9b3843">host_free</a>(backup_h);</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    backup_h = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    <span class="keywordflow">if</span> (norm_bytes) {</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;      cudaMemcpy(norm, backup_norm_h, norm_bytes, cudaMemcpyHostToDevice);</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;      <a class="code" href="malloc__quda_8h.html#ad733cb3f6cac705c8db7b0afad9b3843">host_free</a>(backup_norm_h);</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;      backup_norm_h = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    }</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    <a class="code" href="util__quda_8h.html#a7668e6580e0f57b0db3112fae4959e34">checkCudaError</a>();</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;  }</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;</div><div class="line"><a name="l00781"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_float_n_order.html#a97461cacbca468e24fe4c65fa7e07167">  781</a></span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="structquda_1_1clover_1_1_float_n_order.html#a97461cacbca468e24fe4c65fa7e07167">Bytes</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    <span class="keywordtype">size_t</span> bytes = <a class="code" href="gauge__force__test_8cpp.html#a2bcd2adde36b870d02897e694ecc39cb">length</a>*<span class="keyword">sizeof</span>(Float);</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="structquda_1_1is_fixed.html">isFixed&lt;Float&gt;::value</a>) bytes += 2 * <span class="keyword">sizeof</span>(norm_type);</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="namespacequda_1_1blas.html#a7ed3575de8e06ebadf04a1cb8ae3512e">bytes</a>;</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;  }</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;      };</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;</div><div class="line"><a name="l00794"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_s.html#a43c15c9135e93af9ecee90591fb161da">  794</a></span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> real, <span class="keywordtype">int</span> length&gt; <span class="keyword">struct </span><a class="code" href="structquda_1_1clover_1_1_s.html">S</a> { real v[<a class="code" href="gauge__force__test_8cpp.html#a2bcd2adde36b870d02897e694ecc39cb">length</a>]; };</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Float, <span class="keywordtype">int</span> length&gt;</div><div class="line"><a name="l00800"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_q_d_p_order.html">  800</a></span>&#160;      <span class="keyword">struct </span><a class="code" href="structquda_1_1clover_1_1_q_d_p_order.html">QDPOrder</a> {</div><div class="line"><a name="l00801"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_q_d_p_order.html#a3fffb432aefdab5dadc0997c70ecaec6">  801</a></span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="structquda_1_1mapper.html">mapper&lt;Float&gt;::type</a> <a class="code" href="structquda_1_1clover_1_1_q_d_p_order.html#a3fffb432aefdab5dadc0997c70ecaec6">RegType</a>;</div><div class="line"><a name="l00802"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_q_d_p_order.html#a2aed1e70fe0e7de0081e051640a1d720">  802</a></span>&#160;  Float *<a class="code" href="structquda_1_1clover_1_1_q_d_p_order.html#a2aed1e70fe0e7de0081e051640a1d720">clover</a>;</div><div class="line"><a name="l00803"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_q_d_p_order.html#a1d374e0c56188fcfe520dd52d72e77e4">  803</a></span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1clover_1_1_q_d_p_order.html#a1d374e0c56188fcfe520dd52d72e77e4">volumeCB</a>;</div><div class="line"><a name="l00804"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_q_d_p_order.html#a4788b718641d1470e783235d73f31460">  804</a></span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1clover_1_1_q_d_p_order.html#a4788b718641d1470e783235d73f31460">stride</a>;</div><div class="line"><a name="l00805"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_q_d_p_order.html#aa976ec5197bf07a48607af68b4e6b7d5">  805</a></span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1clover_1_1_q_d_p_order.html#aa976ec5197bf07a48607af68b4e6b7d5">offset</a>;</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;</div><div class="line"><a name="l00807"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_q_d_p_order.html#a96852b665f563cba3573780afe2bd19f">  807</a></span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="structquda_1_1clover_1_1_q_d_p_order.html#a96852b665f563cba3573780afe2bd19f">twisted</a>;</div><div class="line"><a name="l00808"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_q_d_p_order.html#a6cbf9964a7f76a11df0e631227de4fa2">  808</a></span>&#160;  <span class="keyword">const</span> Float <a class="code" href="structquda_1_1clover_1_1_q_d_p_order.html#a6cbf9964a7f76a11df0e631227de4fa2">mu2</a>;</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;</div><div class="line"><a name="l00810"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_q_d_p_order.html#a08bf125ae82b82f73e3e4dcdf58f200e">  810</a></span>&#160;      <a class="code" href="structquda_1_1clover_1_1_q_d_p_order.html#a08bf125ae82b82f73e3e4dcdf58f200e">QDPOrder</a>(<span class="keyword">const</span> <a class="code" href="classquda_1_1_clover_field.html">CloverField</a> &amp;clover, <span class="keywordtype">bool</span> <a class="code" href="namespacequda.html#a599ff2d7aba3544b3e0559cd50861906">inverse</a>, Float *clover_=0) </div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;      : volumeCB(clover.VolumeCB()), stride(volumeCB), offset(clover.Bytes()/(2*sizeof(Float))),</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;  twisted(clover.Twisted()), mu2(clover.Mu2()) {</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;  this-&gt;clover = clover_ ? clover_ : (Float*)(clover.<a class="code" href="classquda_1_1_clover_field.html#a6ee83d32cf08ff66f215da8eaa30f97f">V</a>(inverse));</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;      }</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;</div><div class="line"><a name="l00816"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_q_d_p_order.html#a218eb9cbe53dad8cdebbbec4da7a3dc5">  816</a></span>&#160;  <span class="keywordtype">bool</span>  <a class="code" href="structquda_1_1clover_1_1_q_d_p_order.html#a218eb9cbe53dad8cdebbbec4da7a3dc5">Twisted</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> twisted;}</div><div class="line"><a name="l00817"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_q_d_p_order.html#adc97f94b046f77a09ff1ff17a27a0e2b">  817</a></span>&#160;  Float <a class="code" href="structquda_1_1clover_1_1_q_d_p_order.html#adc97f94b046f77a09ff1ff17a27a0e2b">Mu2</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> mu2;}</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;</div><div class="line"><a name="l00819"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_q_d_p_order.html#a8bd0c3203ef7d283ae5ad2f0e22b9ce0">  819</a></span>&#160;  __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structquda_1_1clover_1_1_q_d_p_order.html#a8bd0c3203ef7d283ae5ad2f0e22b9ce0">load</a>(RegType v[<a class="code" href="gauge__force__test_8cpp.html#a2bcd2adde36b870d02897e694ecc39cb">length</a>], <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1clover__wrapper.html#a8505d18a553ab77811defae10fc3c183">parity</a>)<span class="keyword"> const </span>{</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    <span class="comment">// factor of 0.5 comes from basis change</span></div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;<span class="preprocessor">#if defined( __CUDA_ARCH__) &amp;&amp; !defined(DISABLE_TROVE)</span></div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;    <span class="keyword">typedef</span> <a class="code" href="structquda_1_1clover_1_1_s.html">S&lt;Float,length&gt;</a> structure;</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    trove::coalesced_ptr&lt;structure&gt; clover_((structure*)clover);</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    structure v_ = clover_[parity*volumeCB + x];</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="gauge__force__test_8cpp.html#a2bcd2adde36b870d02897e694ecc39cb">length</a>; i++) v[i] = 0.5*(RegType)v_.v[i];</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="gauge__force__test_8cpp.html#a2bcd2adde36b870d02897e694ecc39cb">length</a>; i++) v[i] = 0.5*clover[parity*offset + x*length+i];</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;  }</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;  </div><div class="line"><a name="l00831"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_q_d_p_order.html#ab2b1b60d78b2bfac2d7f31f6c6eee71d">  831</a></span>&#160;  __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structquda_1_1clover_1_1_q_d_p_order.html#ab2b1b60d78b2bfac2d7f31f6c6eee71d">save</a>(<span class="keyword">const</span> RegType v[<a class="code" href="gauge__force__test_8cpp.html#a2bcd2adde36b870d02897e694ecc39cb">length</a>], <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1clover__wrapper.html#a8505d18a553ab77811defae10fc3c183">parity</a>) {</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;<span class="preprocessor">#if defined( __CUDA_ARCH__) &amp;&amp; !defined(DISABLE_TROVE)</span></div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    <span class="keyword">typedef</span> <a class="code" href="structquda_1_1clover_1_1_s.html">S&lt;Float,length&gt;</a> structure;</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    trove::coalesced_ptr&lt;structure&gt; clover_((structure*)clover);</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    structure v_;</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="gauge__force__test_8cpp.html#a2bcd2adde36b870d02897e694ecc39cb">length</a>; i++) v_.v[i] = 2.0*(Float)v[i];</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;    clover_[parity*volumeCB + x] = v_;</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="gauge__force__test_8cpp.html#a2bcd2adde36b870d02897e694ecc39cb">length</a>; i++) clover[parity*offset + x*length+i] = 2.0*v[i];</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;  }</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;</div><div class="line"><a name="l00843"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_q_d_p_order.html#a879769d4669df73cd1709a1872abac6c">  843</a></span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="structquda_1_1clover_1_1_q_d_p_order.html#a879769d4669df73cd1709a1872abac6c">Bytes</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="gauge__force__test_8cpp.html#a2bcd2adde36b870d02897e694ecc39cb">length</a>*<span class="keyword">sizeof</span>(Float); }</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;      };</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Float, <span class="keywordtype">int</span> length&gt;</div><div class="line"><a name="l00850"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_q_d_p_j_i_t_order.html">  850</a></span>&#160;      <span class="keyword">struct </span><a class="code" href="structquda_1_1clover_1_1_q_d_p_j_i_t_order.html">QDPJITOrder</a> {</div><div class="line"><a name="l00851"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_q_d_p_j_i_t_order.html#ab1e7f260e5bb3d4b4e4029f4bb03098f">  851</a></span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="structquda_1_1mapper.html">mapper&lt;Float&gt;::type</a> <a class="code" href="structquda_1_1clover_1_1_q_d_p_j_i_t_order.html#ab1e7f260e5bb3d4b4e4029f4bb03098f">RegType</a>;</div><div class="line"><a name="l00852"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_q_d_p_j_i_t_order.html#a3518a312cae97e5e05a656e247753d99">  852</a></span>&#160;  Float *<a class="code" href="structquda_1_1clover_1_1_q_d_p_j_i_t_order.html#a3518a312cae97e5e05a656e247753d99">diag</a>;     </div><div class="line"><a name="l00853"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_q_d_p_j_i_t_order.html#a7382d344ad60080ce5ca879038f266f7">  853</a></span>&#160;  Float *<a class="code" href="structquda_1_1clover_1_1_q_d_p_j_i_t_order.html#a7382d344ad60080ce5ca879038f266f7">offdiag</a>;   </div><div class="line"><a name="l00854"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_q_d_p_j_i_t_order.html#a3dfb8e679e0052270963860bd1e9f740">  854</a></span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1clover_1_1_q_d_p_j_i_t_order.html#a3dfb8e679e0052270963860bd1e9f740">volumeCB</a>;</div><div class="line"><a name="l00855"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_q_d_p_j_i_t_order.html#aadd339bd8b3bef84dc2998ac6751cf5c">  855</a></span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1clover_1_1_q_d_p_j_i_t_order.html#aadd339bd8b3bef84dc2998ac6751cf5c">stride</a>;</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;</div><div class="line"><a name="l00857"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_q_d_p_j_i_t_order.html#a399cc08fe3a9bceb4609d4551588db89">  857</a></span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="structquda_1_1clover_1_1_q_d_p_j_i_t_order.html#a399cc08fe3a9bceb4609d4551588db89">twisted</a>;</div><div class="line"><a name="l00858"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_q_d_p_j_i_t_order.html#adc515295907de1f1df56498608918006">  858</a></span>&#160;  <span class="keyword">const</span> Float <a class="code" href="structquda_1_1clover_1_1_q_d_p_j_i_t_order.html#adc515295907de1f1df56498608918006">mu2</a>;</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;</div><div class="line"><a name="l00860"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_q_d_p_j_i_t_order.html#a09cb4b2217e7f8d2526807919b7961df">  860</a></span>&#160;      <a class="code" href="structquda_1_1clover_1_1_q_d_p_j_i_t_order.html#a09cb4b2217e7f8d2526807919b7961df">QDPJITOrder</a>(<span class="keyword">const</span> <a class="code" href="classquda_1_1_clover_field.html">CloverField</a> &amp;clover, <span class="keywordtype">bool</span> <a class="code" href="namespacequda.html#a599ff2d7aba3544b3e0559cd50861906">inverse</a>, Float *clover_=0) </div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;      : volumeCB(clover.VolumeCB()), stride(volumeCB), twisted(clover.Twisted()), mu2(clover.Mu2()) {</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;  offdiag = clover_ ? ((Float**)clover_)[0] : ((Float**)clover.<a class="code" href="classquda_1_1_clover_field.html#a6ee83d32cf08ff66f215da8eaa30f97f">V</a>(inverse))[0];</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;  diag = clover_ ? ((Float**)clover_)[1] : ((Float**)clover.<a class="code" href="classquda_1_1_clover_field.html#a6ee83d32cf08ff66f215da8eaa30f97f">V</a>(inverse))[1];</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;      }</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;  </div><div class="line"><a name="l00866"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_q_d_p_j_i_t_order.html#a716e95b15ded88a0bd80152e6d538f97">  866</a></span>&#160;      <span class="keywordtype">bool</span>  <a class="code" href="structquda_1_1clover_1_1_q_d_p_j_i_t_order.html#a716e95b15ded88a0bd80152e6d538f97">Twisted</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> twisted;}</div><div class="line"><a name="l00867"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_q_d_p_j_i_t_order.html#aa8b4b8c540aff06867045500b54dc418">  867</a></span>&#160;      Float <a class="code" href="structquda_1_1clover_1_1_q_d_p_j_i_t_order.html#aa8b4b8c540aff06867045500b54dc418">Mu2</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> mu2;}</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;</div><div class="line"><a name="l00869"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_q_d_p_j_i_t_order.html#aa85c78a9d121d2ccfe81613a8d169ea5">  869</a></span>&#160;  __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structquda_1_1clover_1_1_q_d_p_j_i_t_order.html#aa85c78a9d121d2ccfe81613a8d169ea5">load</a>(RegType v[<a class="code" href="gauge__force__test_8cpp.html#a2bcd2adde36b870d02897e694ecc39cb">length</a>], <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1clover__wrapper.html#a8505d18a553ab77811defae10fc3c183">parity</a>)<span class="keyword"> const </span>{</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    <span class="comment">// the factor of 0.5 comes from a basis change</span></div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="structquda_1_1clover__wrapper.html#a1abc4bd026597f55be802fb1e493fcb4">chirality</a>=0; <a class="code" href="structquda_1_1clover__wrapper.html#a1abc4bd026597f55be802fb1e493fcb4">chirality</a>&lt;2; <a class="code" href="structquda_1_1clover__wrapper.html#a1abc4bd026597f55be802fb1e493fcb4">chirality</a>++) {</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;      <span class="comment">// set diagonal elements</span></div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;6; i++) {</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;        v[<a class="code" href="structquda_1_1clover__wrapper.html#a1abc4bd026597f55be802fb1e493fcb4">chirality</a>*36 + i] = 0.5*diag[((i*2 + <a class="code" href="structquda_1_1clover__wrapper.html#a1abc4bd026597f55be802fb1e493fcb4">chirality</a>)*2 + parity)*volumeCB + x];</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;      }</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;      <span class="comment">// the off diagonal elements</span></div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;30; i++) {</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;        <span class="keywordtype">int</span> z = i%2;</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;        <span class="keywordtype">int</span> off = i/2;</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> idtab[15]={0,1,3,6,10,2,4,7,11,5,8,12,9,13,14};</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;        v[<a class="code" href="structquda_1_1clover__wrapper.html#a1abc4bd026597f55be802fb1e493fcb4">chirality</a>*36 + 6 + i] = 0.5*offdiag[(((z*15 + idtab[off])*2 + <a class="code" href="structquda_1_1clover__wrapper.html#a1abc4bd026597f55be802fb1e493fcb4">chirality</a>)*2 + <a class="code" href="structquda_1_1clover__wrapper.html#a8505d18a553ab77811defae10fc3c183">parity</a>)*volumeCB + x];</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;      }</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    }</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;  }</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;  </div><div class="line"><a name="l00888"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_q_d_p_j_i_t_order.html#aaf7ef4cc8140b2e2be2c988cd6cdd8f7">  888</a></span>&#160;  __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structquda_1_1clover_1_1_q_d_p_j_i_t_order.html#aaf7ef4cc8140b2e2be2c988cd6cdd8f7">save</a>(<span class="keyword">const</span> RegType v[<a class="code" href="gauge__force__test_8cpp.html#a2bcd2adde36b870d02897e694ecc39cb">length</a>], <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1clover__wrapper.html#a8505d18a553ab77811defae10fc3c183">parity</a>) {</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    <span class="comment">// the factor of 2.0 comes from undoing the basis change</span></div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="structquda_1_1clover__wrapper.html#a1abc4bd026597f55be802fb1e493fcb4">chirality</a>=0; <a class="code" href="structquda_1_1clover__wrapper.html#a1abc4bd026597f55be802fb1e493fcb4">chirality</a>&lt;2; <a class="code" href="structquda_1_1clover__wrapper.html#a1abc4bd026597f55be802fb1e493fcb4">chirality</a>++) {</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;      <span class="comment">// set diagonal elements</span></div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;6; i++) {</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;        diag[((i*2 + <a class="code" href="structquda_1_1clover__wrapper.html#a1abc4bd026597f55be802fb1e493fcb4">chirality</a>)*2 + parity)*volumeCB + x] = 2.0*v[<a class="code" href="structquda_1_1clover__wrapper.html#a1abc4bd026597f55be802fb1e493fcb4">chirality</a>*36 + i];</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;      }</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;      <span class="comment">// the off diagonal elements</span></div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;30; i++) {</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;        <span class="keywordtype">int</span> z = i%2;</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;        <span class="keywordtype">int</span> off = i/2;</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> idtab[15]={0,1,3,6,10,2,4,7,11,5,8,12,9,13,14};</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;        offdiag[(((z*15 + idtab[off])*2 + <a class="code" href="structquda_1_1clover__wrapper.html#a1abc4bd026597f55be802fb1e493fcb4">chirality</a>)*2 + <a class="code" href="structquda_1_1clover__wrapper.html#a8505d18a553ab77811defae10fc3c183">parity</a>)*volumeCB + x] = 2.0*v[<a class="code" href="structquda_1_1clover__wrapper.html#a1abc4bd026597f55be802fb1e493fcb4">chirality</a>*36 + 6 + i];</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;      }</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;    }</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;  }</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;  </div><div class="line"><a name="l00906"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_q_d_p_j_i_t_order.html#adc060f60e9d3f67a0128236f5fa7d4d9">  906</a></span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="structquda_1_1clover_1_1_q_d_p_j_i_t_order.html#adc060f60e9d3f67a0128236f5fa7d4d9">Bytes</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="gauge__force__test_8cpp.html#a2bcd2adde36b870d02897e694ecc39cb">length</a>*<span class="keyword">sizeof</span>(Float); }</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;      };</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;      </div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Float, <span class="keywordtype">int</span> length&gt;</div><div class="line"><a name="l00917"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_b_q_c_d_order.html">  917</a></span>&#160;      <span class="keyword">struct </span><a class="code" href="structquda_1_1clover_1_1_b_q_c_d_order.html">BQCDOrder</a> {</div><div class="line"><a name="l00918"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_b_q_c_d_order.html#a26d4239009034d92cfb3ea515075fafc">  918</a></span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="structquda_1_1mapper.html">mapper&lt;Float&gt;::type</a> <a class="code" href="structquda_1_1clover_1_1_b_q_c_d_order.html#a26d4239009034d92cfb3ea515075fafc">RegType</a>;</div><div class="line"><a name="l00919"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_b_q_c_d_order.html#aca80768653bb0aa774f46975c0f2aaa8">  919</a></span>&#160;  Float *clover[2];</div><div class="line"><a name="l00920"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_b_q_c_d_order.html#ae88d033948f2948b5127f07ba6aa3e91">  920</a></span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1clover_1_1_b_q_c_d_order.html#ae88d033948f2948b5127f07ba6aa3e91">volumeCB</a>;</div><div class="line"><a name="l00921"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_b_q_c_d_order.html#a6fbe3a2c2685737750716d1031b6d86c">  921</a></span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structquda_1_1clover_1_1_b_q_c_d_order.html#a6fbe3a2c2685737750716d1031b6d86c">stride</a>;</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;</div><div class="line"><a name="l00923"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_b_q_c_d_order.html#a7760c346badbf0f43446e4ae206aac51">  923</a></span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="structquda_1_1clover_1_1_b_q_c_d_order.html#a7760c346badbf0f43446e4ae206aac51">twisted</a>;</div><div class="line"><a name="l00924"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_b_q_c_d_order.html#af0385b75cd2c5fdd7be03e7e89991199">  924</a></span>&#160;  <span class="keyword">const</span> Float <a class="code" href="structquda_1_1clover_1_1_b_q_c_d_order.html#af0385b75cd2c5fdd7be03e7e89991199">mu2</a>;</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;</div><div class="line"><a name="l00926"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_b_q_c_d_order.html#ada8bce220dd38a75d6b9ef314530e5bc">  926</a></span>&#160;      <a class="code" href="structquda_1_1clover_1_1_b_q_c_d_order.html#ada8bce220dd38a75d6b9ef314530e5bc">BQCDOrder</a>(<span class="keyword">const</span> <a class="code" href="classquda_1_1_clover_field.html">CloverField</a> &amp;clover, <span class="keywordtype">bool</span> <a class="code" href="namespacequda.html#a599ff2d7aba3544b3e0559cd50861906">inverse</a>, Float *clover_=0) </div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;      : volumeCB(clover.Stride()), stride(volumeCB), twisted(clover.Twisted()), mu2(clover.Mu2()) {</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;  this-&gt;clover[0] = clover_ ? clover_ : (Float*)(clover.<a class="code" href="classquda_1_1_clover_field.html#a6ee83d32cf08ff66f215da8eaa30f97f">V</a>(inverse));</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;  this-&gt;clover[1] = (Float*)((<span class="keywordtype">char</span>*)this-&gt;clover[0] + clover.<a class="code" href="classquda_1_1_clover_field.html#ada28d819c5115c004df406956c16d9e6">Bytes</a>()/2);</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;      }</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;</div><div class="line"><a name="l00933"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_b_q_c_d_order.html#a02f773397094dc7f7baa998b06ba0e30">  933</a></span>&#160;  <span class="keywordtype">bool</span>  <a class="code" href="structquda_1_1clover_1_1_b_q_c_d_order.html#a02f773397094dc7f7baa998b06ba0e30">Twisted</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> twisted;}</div><div class="line"><a name="l00934"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_b_q_c_d_order.html#aaef5628d9225fbab383dc38868213ef9">  934</a></span>&#160;  Float <a class="code" href="structquda_1_1clover_1_1_b_q_c_d_order.html#aaef5628d9225fbab383dc38868213ef9">Mu2</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> mu2;}</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;</div><div class="line"><a name="l00941"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_b_q_c_d_order.html#a21f15213660708479a3471ce7a600299">  941</a></span>&#160;  __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structquda_1_1clover_1_1_b_q_c_d_order.html#a21f15213660708479a3471ce7a600299">load</a>(RegType v[<a class="code" href="gauge__force__test_8cpp.html#a2bcd2adde36b870d02897e694ecc39cb">length</a>], <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1clover__wrapper.html#a8505d18a553ab77811defae10fc3c183">parity</a>)<span class="keyword"> const </span>{</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;    <span class="keywordtype">int</span> bq[36] = { 21, 32, 33, 0,  1, 20,                   <span class="comment">// diagonal</span></div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;       28, 29, 30, 31, 6, 7,  14, 15, 22, 23,   <span class="comment">// column 1  6</span></div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;       34, 35, 8, 9, 16, 17, 24, 25,            <span class="comment">// column 2  16</span></div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;       10, 11, 18, 19, 26, 27,                  <span class="comment">// column 3  24</span></div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;       2,  3,  4,  5,                           <span class="comment">// column 4  30</span></div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;       12, 13};</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    </div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    <span class="comment">// flip the sign of the imaginary components</span></div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    <span class="keywordtype">int</span> sign[36];</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;6; i++) sign[i] = 1;</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=6; i&lt;36; i+=2) {</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;      <span class="keywordflow">if</span> ( (i &gt;= 10 &amp;&amp; i&lt;= 15) || (i &gt;= 18 &amp;&amp; i &lt;= 29) )  { sign[i] = -1; sign[i+1] = -1; }</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;      <span class="keywordflow">else</span> { sign[i] = 1; sign[i+1] = -1; }</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    }</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;  </div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> M=length/2;</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="structquda_1_1clover__wrapper.html#a1abc4bd026597f55be802fb1e493fcb4">chirality</a>=0; <a class="code" href="structquda_1_1clover__wrapper.html#a1abc4bd026597f55be802fb1e493fcb4">chirality</a>&lt;2; <a class="code" href="structquda_1_1clover__wrapper.html#a1abc4bd026597f55be802fb1e493fcb4">chirality</a>++) </div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;M; i++) </div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;        v[<a class="code" href="structquda_1_1clover__wrapper.html#a1abc4bd026597f55be802fb1e493fcb4">chirality</a>*M+i] = sign[i] * clover[parity][x*length+<a class="code" href="structquda_1_1clover__wrapper.html#a1abc4bd026597f55be802fb1e493fcb4">chirality</a>*M+bq[i]];</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;  </div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;  }</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;  </div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;  <span class="comment">// FIXME implement the save routine for BQCD ordered fields</span></div><div class="line"><a name="l00965"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_b_q_c_d_order.html#a92943f85c846b1e6470ef0857ef7196d">  965</a></span>&#160;  __device__ __host__ <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structquda_1_1clover_1_1_b_q_c_d_order.html#a92943f85c846b1e6470ef0857ef7196d">save</a>(RegType v[<a class="code" href="gauge__force__test_8cpp.html#a2bcd2adde36b870d02897e694ecc39cb">length</a>], <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> <a class="code" href="structquda_1_1clover__wrapper.html#a8505d18a553ab77811defae10fc3c183">parity</a>) {</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;  };</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;</div><div class="line"><a name="l00969"></a><span class="lineno"><a class="line" href="structquda_1_1clover_1_1_b_q_c_d_order.html#ad37f064ff4dea4f7c7cb71f6fc9bba06">  969</a></span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="structquda_1_1clover_1_1_b_q_c_d_order.html#ad37f064ff4dea4f7c7cb71f6fc9bba06">Bytes</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="gauge__force__test_8cpp.html#a2bcd2adde36b870d02897e694ecc39cb">length</a>*<span class="keyword">sizeof</span>(Float); }</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;      };</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;  } <span class="comment">// namespace clover</span></div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;  <span class="comment">// Use traits to reduce the template explosion</span></div><div class="line"><a name="l00975"></a><span class="lineno"><a class="line" href="structquda_1_1clover__mapper.html">  975</a></span>&#160;  <span class="keyword">template</span>&lt;<span class="keyword">typename</span> Float,<span class="keywordtype">int</span> N=72, <span class="keywordtype">bool</span> add_rho=false&gt; <span class="keyword">struct </span><a class="code" href="structquda_1_1clover__mapper.html">clover_mapper</a> { };</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;  <span class="comment">// double precision uses Float2</span></div><div class="line"><a name="l00978"></a><span class="lineno"><a class="line" href="structquda_1_1clover__mapper_3_01double_00_01_n_00_01add__rho_01_4.html#a5df9347cdc06f4d51d3189c52fc1f1c4">  978</a></span>&#160;  <span class="keyword">template</span>&lt;<span class="keywordtype">int</span> N, <span class="keywordtype">bool</span> add_rho&gt; <span class="keyword">struct </span><a class="code" href="structquda_1_1clover__mapper.html">clover_mapper</a>&lt;double,N,add_rho&gt; { <span class="keyword">typedef</span> <a class="code" href="structquda_1_1clover_1_1_float_n_order.html">clover::FloatNOrder&lt;double, N, 2, add_rho&gt;</a> <a class="code" href="structquda_1_1clover__mapper_3_01double_00_01_n_00_01add__rho_01_4.html#a5df9347cdc06f4d51d3189c52fc1f1c4">type</a>; };</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;  <span class="comment">// single precision uses Float4</span></div><div class="line"><a name="l00981"></a><span class="lineno"><a class="line" href="structquda_1_1clover__mapper_3_01float_00_01_n_00_01add__rho_01_4.html#a0c02ce225a50050bf6f59ff3a6425467">  981</a></span>&#160;  <span class="keyword">template</span>&lt;<span class="keywordtype">int</span> N, <span class="keywordtype">bool</span> add_rho&gt; <span class="keyword">struct </span><a class="code" href="structquda_1_1clover__mapper.html">clover_mapper</a>&lt;float,N,add_rho&gt; { <span class="keyword">typedef</span> <a class="code" href="structquda_1_1clover_1_1_float_n_order.html">clover::FloatNOrder&lt;float, N, 4, add_rho&gt;</a> <a class="code" href="structquda_1_1clover__mapper_3_01float_00_01_n_00_01add__rho_01_4.html#a0c02ce225a50050bf6f59ff3a6425467">type</a>; };</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;  <span class="comment">// half precision uses Float4</span></div><div class="line"><a name="l00984"></a><span class="lineno"><a class="line" href="structquda_1_1clover__mapper_3_01short_00_01_n_00_01add__rho_01_4.html#aee3fe8b59d2cb7267373c88b2c9836c6">  984</a></span>&#160;  <span class="keyword">template</span>&lt;<span class="keywordtype">int</span> N, <span class="keywordtype">bool</span> add_rho&gt; <span class="keyword">struct </span><a class="code" href="structquda_1_1clover__mapper.html">clover_mapper</a>&lt;short,N,add_rho&gt; { <span class="keyword">typedef</span> <a class="code" href="structquda_1_1clover_1_1_float_n_order.html">clover::FloatNOrder&lt;short, N, 4, add_rho&gt;</a> <a class="code" href="structquda_1_1clover__mapper_3_01short_00_01_n_00_01add__rho_01_4.html#aee3fe8b59d2cb7267373c88b2c9836c6">type</a>; };</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;  <span class="comment">// quarter precision uses Float4</span></div><div class="line"><a name="l00987"></a><span class="lineno"><a class="line" href="structquda_1_1clover__mapper_3_01char_00_01_n_00_01add__rho_01_4.html#a1eacc765c43059b7c9da9f0e8d3a3633">  987</a></span>&#160;  <span class="keyword">template</span>&lt;<span class="keywordtype">int</span> N, <span class="keywordtype">bool</span> add_rho&gt; <span class="keyword">struct </span><a class="code" href="structquda_1_1clover__mapper.html">clover_mapper</a>&lt;char,N,add_rho&gt; { <span class="keyword">typedef</span> <a class="code" href="structquda_1_1clover_1_1_float_n_order.html">clover::FloatNOrder&lt;char, N, 4, add_rho&gt;</a> <a class="code" href="structquda_1_1clover__mapper_3_01char_00_01_n_00_01add__rho_01_4.html#a1eacc765c43059b7c9da9f0e8d3a3633">type</a>; };</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;} <span class="comment">// namespace quda</span></div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;<span class="preprocessor">#endif //_CLOVER_ORDER_H</span></div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;</div><div class="ttc" id="structquda_1_1clover_1_1_float_n_order_html_a008bead55dc528e9b61d9c31d0bbe973"><div class="ttname"><a href="structquda_1_1clover_1_1_float_n_order.html#a008bead55dc528e9b61d9c31d0bbe973">quda::clover::FloatNOrder::load</a></div><div class="ttdeci">__device__ __host__ void load(real v[block], int x, int parity, int chirality) const</div><div class="ttdoc">Load accessor for a single chiral block. </div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00650">clover_field_order.h:650</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_field_order_html_a2ebbda6709aa7a934b05f11e62f65bc3"><div class="ttname"><a href="structquda_1_1clover_1_1_field_order.html#a2ebbda6709aa7a934b05f11e62f65bc3">quda::clover::FieldOrder::volumeCB</a></div><div class="ttdeci">const int volumeCB</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00394">clover_field_order.h:394</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___f_l_o_a_t4___c_l_o_v_e_r___o_r_d_e_r_01_4_html_a0a2f005bc7ee62d27350408ddfefac82"><div class="ttname"><a href="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___f_l_o_a_t4___c_l_o_v_e_r___o_r_d_e_r_01_4.html#a0a2f005bc7ee62d27350408ddfefac82">quda::clover::Accessor&lt; Float, nColor, nSpin, QUDA_FLOAT4_CLOVER_ORDER &gt;::Accessor</a></div><div class="ttdeci">Accessor(const CloverField &amp;A, bool inverse=false)</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00254">clover_field_order.h:254</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_q_d_p_order_html_a879769d4669df73cd1709a1872abac6c"><div class="ttname"><a href="structquda_1_1clover_1_1_q_d_p_order.html#a879769d4669df73cd1709a1872abac6c">quda::clover::QDPOrder::Bytes</a></div><div class="ttdeci">size_t Bytes() const</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00843">clover_field_order.h:843</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___p_a_c_k_e_232545b3542066bbebdd93a49a8fe0b1_html_a79d5e663fc511c732e85bfc30d5e95c1"><div class="ttname"><a href="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___p_a_c_k_e_232545b3542066bbebdd93a49a8fe0b1.html#a79d5e663fc511c732e85bfc30d5e95c1">quda::clover::Accessor&lt; Float, nColor, nSpin, QUDA_PACKED_CLOVER_ORDER &gt;::zero</a></div><div class="ttdeci">complex&lt; Float &gt; zero</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00310">clover_field_order.h:310</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_float_n_order_html_a0c46b3ef2837ea6f9e8b2bd80f8a4704"><div class="ttname"><a href="structquda_1_1clover_1_1_float_n_order.html#a0c46b3ef2837ea6f9e8b2bd80f8a4704">quda::clover::FloatNOrder::norm_offset</a></div><div class="ttdeci">const AllocInt norm_offset</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00552">clover_field_order.h:552</a></div></div>
<div class="ttc" id="enum__quda_8h_html_a0b751fe440798c39fb8c49c9f2a38911adb80f12d6b8d3a4083a1ec3b7d550d07"><div class="ttname"><a href="enum__quda_8h.html#a0b751fe440798c39fb8c49c9f2a38911adb80f12d6b8d3a4083a1ec3b7d550d07">QUDA_PACKED_CLOVER_ORDER</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00256">enum_quda.h:256</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_b_q_c_d_order_html_a02f773397094dc7f7baa998b06ba0e30"><div class="ttname"><a href="structquda_1_1clover_1_1_b_q_c_d_order.html#a02f773397094dc7f7baa998b06ba0e30">quda::clover::BQCDOrder::Twisted</a></div><div class="ttdeci">bool Twisted() const</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00933">clover_field_order.h:933</a></div></div>
<div class="ttc" id="classquda_1_1_clover_field_html_a6ee83d32cf08ff66f215da8eaa30f97f"><div class="ttname"><a href="classquda_1_1_clover_field.html#a6ee83d32cf08ff66f215da8eaa30f97f">quda::CloverField::V</a></div><div class="ttdeci">void * V(bool inverse=false)</div><div class="ttdef"><b>Definition:</b> <a href="clover__field_8h_source.html#l00074">clover_field.h:74</a></div></div>
<div class="ttc" id="namespacequda_html_abeed8b3819eb6b18921f208412fe40d1"><div class="ttname"><a href="namespacequda.html#abeed8b3819eb6b18921f208412fe40d1">quda::norm</a></div><div class="ttdeci">__host__ __device__ ValueType norm(const complex&lt; ValueType &gt; &amp;z)</div><div class="ttdoc">Returns the magnitude of z squared. </div><div class="ttdef"><b>Definition:</b> <a href="complex__quda_8h_source.html#l01092">complex_quda.h:1092</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_accessor_html_acd10a705d2c216fb249faccf6bbf45ab"><div class="ttname"><a href="structquda_1_1clover_1_1_accessor.html#acd10a705d2c216fb249faccf6bbf45ab">quda::clover::Accessor::transform_reduce</a></div><div class="ttdeci">__host__ double transform_reduce(QudaFieldLocation location, helper h, reducer r, double i) const</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00180">clover_field_order.h:180</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_q_d_p_j_i_t_order_html"><div class="ttname"><a href="structquda_1_1clover_1_1_q_d_p_j_i_t_order.html">quda::clover::QDPJITOrder</a></div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00850">clover_field_order.h:850</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_field_order_html_a236ae07a68257f7ab30cd10436b681a6"><div class="ttname"><a href="structquda_1_1clover_1_1_field_order.html#a236ae07a68257f7ab30cd10436b681a6">quda::clover::FieldOrder::Bytes</a></div><div class="ttdeci">size_t Bytes() const</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00472">clover_field_order.h:472</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_field_order_html_a5cd41dc4e3649c92f2973c5b732ec7f3"><div class="ttname"><a href="structquda_1_1clover_1_1_field_order.html#a5cd41dc4e3649c92f2973c5b732ec7f3">quda::clover::FieldOrder::operator()</a></div><div class="ttdeci">__device__ __host__ const complex&lt; Float &gt; operator()(int parity, int x, int s_row, int s_col, int c_row, int c_col) const</div><div class="ttdoc">Read-only complex-member accessor function. </div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00420">clover_field_order.h:420</a></div></div>
<div class="ttc" id="util__quda_8h_html_af3bddfd9d113d50e8e0bbf58a35c5aac"><div class="ttname"><a href="util__quda_8h.html#af3bddfd9d113d50e8e0bbf58a35c5aac">errorQuda</a></div><div class="ttdeci">#define errorQuda(...)</div><div class="ttdef"><b>Definition:</b> <a href="util__quda_8h_source.html#l00121">util_quda.h:121</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_field_order_html_a18e1d25793df1521fee8747dbbbfe5e3"><div class="ttname"><a href="structquda_1_1clover_1_1_field_order.html#a18e1d25793df1521fee8747dbbbfe5e3">quda::clover::FieldOrder::Ncolor</a></div><div class="ttdeci">__device__ __host__ int Ncolor() const</div><div class="ttdoc">Complex-member accessor function. </div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00463">clover_field_order.h:463</a></div></div>
<div class="ttc" id="enum__quda_8h_html_a35de1312d8bed4b94234a3092907e0d9a184379764fab0f101cab6f19a8a14690"><div class="ttname"><a href="enum__quda_8h.html#a35de1312d8bed4b94234a3092907e0d9a184379764fab0f101cab6f19a8a14690">QUDA_CUDA_FIELD_LOCATION</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00326">enum_quda.h:326</a></div></div>
<div class="ttc" id="classquda_1_1_clover_field_html_ada28d819c5115c004df406956c16d9e6"><div class="ttname"><a href="classquda_1_1_clover_field.html#ada28d819c5115c004df406956c16d9e6">quda::CloverField::Bytes</a></div><div class="ttdeci">size_t Bytes() const</div><div class="ttdef"><b>Definition:</b> <a href="clover__field_8h_source.html#l00098">clover_field.h:98</a></div></div>
<div class="ttc" id="malloc__quda_8h_html_ad733cb3f6cac705c8db7b0afad9b3843"><div class="ttname"><a href="malloc__quda_8h.html#ad733cb3f6cac705c8db7b0afad9b3843">host_free</a></div><div class="ttdeci">#define host_free(ptr)</div><div class="ttdef"><b>Definition:</b> <a href="malloc__quda_8h_source.html#l00071">malloc_quda.h:71</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_q_d_p_j_i_t_order_html_a3518a312cae97e5e05a656e247753d99"><div class="ttname"><a href="structquda_1_1clover_1_1_q_d_p_j_i_t_order.html#a3518a312cae97e5e05a656e247753d99">quda::clover::QDPJITOrder::diag</a></div><div class="ttdeci">Float * diag</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00852">clover_field_order.h:852</a></div></div>
<div class="ttc" id="enum__quda_8h_html_ac166c47d6ef16f830c164fefe6c8ab90aeac943998f9a94180aa7e472599219c5"><div class="ttname"><a href="enum__quda_8h.html#ac166c47d6ef16f830c164fefe6c8ab90aeac943998f9a94180aa7e472599219c5">QUDA_QUARTER_PRECISION</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00059">enum_quda.h:59</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_b_q_c_d_order_html_a7760c346badbf0f43446e4ae206aac51"><div class="ttname"><a href="structquda_1_1clover_1_1_b_q_c_d_order.html#a7760c346badbf0f43446e4ae206aac51">quda::clover::BQCDOrder::twisted</a></div><div class="ttdeci">const bool twisted</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00923">clover_field_order.h:923</a></div></div>
<div class="ttc" id="enum__quda_8h_html_ac166c47d6ef16f830c164fefe6c8ab90afb568427ae928d5a1330ee47ef03c0b6"><div class="ttname"><a href="enum__quda_8h.html#ac166c47d6ef16f830c164fefe6c8ab90afb568427ae928d5a1330ee47ef03c0b6">QUDA_HALF_PRECISION</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00060">enum_quda.h:60</a></div></div>
<div class="ttc" id="classquda_1_1_clover_field_html"><div class="ttname"><a href="classquda_1_1_clover_field.html">quda::CloverField</a></div><div class="ttdef"><b>Definition:</b> <a href="clover__field_8h_source.html#l00045">clover_field.h:45</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_float_n_order_html_a78e3b401440aa7389f549221fd0abdbf"><div class="ttname"><a href="structquda_1_1clover_1_1_float_n_order.html#a78e3b401440aa7389f549221fd0abdbf">quda::clover::FloatNOrder::real</a></div><div class="ttdeci">typename mapper&lt; Float &gt;::type real</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00543">clover_field_order.h:543</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_q_d_p_order_html_a6cbf9964a7f76a11df0e631227de4fa2"><div class="ttname"><a href="structquda_1_1clover_1_1_q_d_p_order.html#a6cbf9964a7f76a11df0e631227de4fa2">quda::clover::QDPOrder::mu2</a></div><div class="ttdeci">const Float mu2</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00808">clover_field_order.h:808</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_q_d_p_j_i_t_order_html_ab1e7f260e5bb3d4b4e4029f4bb03098f"><div class="ttname"><a href="structquda_1_1clover_1_1_q_d_p_j_i_t_order.html#ab1e7f260e5bb3d4b4e4029f4bb03098f">quda::clover::QDPJITOrder::RegType</a></div><div class="ttdeci">mapper&lt; Float &gt;::type RegType</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00851">clover_field_order.h:851</a></div></div>
<div class="ttc" id="namespacequda_html_a4fae7f819003f6b7116efc43e7830908"><div class="ttname"><a href="namespacequda.html#a4fae7f819003f6b7116efc43e7830908">quda::alloc</a></div><div class="ttdeci">static std::map&lt; void *, MemAlloc &gt; alloc[N_ALLOC_TYPE]</div><div class="ttdef"><b>Definition:</b> <a href="malloc_8cpp_source.html#l00053">malloc.cpp:53</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_b_q_c_d_order_html_a26d4239009034d92cfb3ea515075fafc"><div class="ttname"><a href="structquda_1_1clover_1_1_b_q_c_d_order.html#a26d4239009034d92cfb3ea515075fafc">quda::clover::BQCDOrder::RegType</a></div><div class="ttdeci">mapper&lt; Float &gt;::type RegType</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00918">clover_field_order.h:918</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_b_q_c_d_order_html_af0385b75cd2c5fdd7be03e7e89991199"><div class="ttname"><a href="structquda_1_1clover_1_1_b_q_c_d_order.html#af0385b75cd2c5fdd7be03e7e89991199">quda::clover::BQCDOrder::mu2</a></div><div class="ttdeci">const Float mu2</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00924">clover_field_order.h:924</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_float_n_order_html_a0b84085b326733132eb3a3cd8db9d9f9"><div class="ttname"><a href="structquda_1_1clover_1_1_float_n_order.html#a0b84085b326733132eb3a3cd8db9d9f9">quda::clover::FloatNOrder::operator()</a></div><div class="ttdeci">__device__ __host__ clover_wrapper&lt; real, Accessor &gt; operator()(int x_cb, int parity, int chirality)</div><div class="ttdoc">This accessor routine returns a clover_wrapper to this object, allowing us to overload various operat...</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00622">clover_field_order.h:622</a></div></div>
<div class="ttc" id="covdev__test_8cpp_html_a788da19b1cbae7d08eb18da226046dd7"><div class="ttname"><a href="covdev__test_8cpp.html#a788da19b1cbae7d08eb18da226046dd7">tmp</a></div><div class="ttdeci">cudaColorSpinorField * tmp</div><div class="ttdef"><b>Definition:</b> <a href="covdev__test_8cpp_source.html#l00044">covdev_test.cpp:44</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_float_n_order_html_a63e1cf7f32c5dff50075e706a4d3f4b3"><div class="ttname"><a href="structquda_1_1clover_1_1_float_n_order.html#a63e1cf7f32c5dff50075e706a4d3f4b3">quda::clover::FloatNOrder::operator()</a></div><div class="ttdeci">__device__ __host__ const clover_wrapper&lt; real, Accessor &gt; operator()(int x_cb, int parity, int chirality) const</div><div class="ttdoc">This accessor routine returns a const colorspinor_wrapper to this object, allowing us to overload var...</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00637">clover_field_order.h:637</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_float_n_order_html_abac8192f2c15188d32461562d14bed7a"><div class="ttname"><a href="structquda_1_1clover_1_1_float_n_order.html#abac8192f2c15188d32461562d14bed7a">quda::clover::FloatNOrder::clover</a></div><div class="ttdeci">Float * clover</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00549">clover_field_order.h:549</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_q_d_p_order_html_adc97f94b046f77a09ff1ff17a27a0e2b"><div class="ttname"><a href="structquda_1_1clover_1_1_q_d_p_order.html#adc97f94b046f77a09ff1ff17a27a0e2b">quda::clover::QDPOrder::Mu2</a></div><div class="ttdeci">Float Mu2() const</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00817">clover_field_order.h:817</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_q_d_p_order_html_a4788b718641d1470e783235d73f31460"><div class="ttname"><a href="structquda_1_1clover_1_1_q_d_p_order.html#a4788b718641d1470e783235d73f31460">quda::clover::QDPOrder::stride</a></div><div class="ttdeci">const int stride</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00804">clover_field_order.h:804</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_field_order_html_a024d4e2d3bff2b37e394265dd21949b6"><div class="ttname"><a href="structquda_1_1clover_1_1_field_order.html#a024d4e2d3bff2b37e394265dd21949b6">quda::clover::FieldOrder::operator()</a></div><div class="ttdeci">__device__ __host__ complex&lt; Float &gt; operator()(int dummy, int parity, int x, int s_row, int s_col, int c_row, int c_col) const</div><div class="ttdoc">Read-only complex-member accessor function. This is a special variant that is compatible with the equ...</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00439">clover_field_order.h:439</a></div></div>
<div class="ttc" id="namespacequda_html_abf5b4d5728021e058d90ff1d07446399"><div class="ttname"><a href="namespacequda.html#abf5b4d5728021e058d90ff1d07446399">quda::copy</a></div><div class="ttdeci">__host__ __device__ void copy(T1 &amp;a, const T2 &amp;b)</div><div class="ttdef"><b>Definition:</b> <a href="register__traits_8h_source.html#l00152">register_traits.h:152</a></div></div>
<div class="ttc" id="structquda_1_1clover__wrapper_html_a8505d18a553ab77811defae10fc3c183"><div class="ttname"><a href="structquda_1_1clover__wrapper.html#a8505d18a553ab77811defae10fc3c183">quda::clover_wrapper::parity</a></div><div class="ttdeci">const int parity</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00037">clover_field_order.h:37</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_q_d_p_order_html_aa976ec5197bf07a48607af68b4e6b7d5"><div class="ttname"><a href="structquda_1_1clover_1_1_q_d_p_order.html#aa976ec5197bf07a48607af68b4e6b7d5">quda::clover::QDPOrder::offset</a></div><div class="ttdeci">const int offset</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00805">clover_field_order.h:805</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___f_l_o_a_t2___c_l_o_v_e_r___o_r_d_e_r_01_4_html_a7af42b4824ddddb33b8d9dfb964e3c44"><div class="ttname"><a href="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___f_l_o_a_t2___c_l_o_v_e_r___o_r_d_e_r_01_4.html#a7af42b4824ddddb33b8d9dfb964e3c44">quda::clover::Accessor&lt; Float, nColor, nSpin, QUDA_FLOAT2_CLOVER_ORDER &gt;::stride</a></div><div class="ttdeci">int stride</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00189">clover_field_order.h:189</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_q_d_p_j_i_t_order_html_a399cc08fe3a9bceb4609d4551588db89"><div class="ttname"><a href="structquda_1_1clover_1_1_q_d_p_j_i_t_order.html#a399cc08fe3a9bceb4609d4551588db89">quda::clover::QDPJITOrder::twisted</a></div><div class="ttdeci">const bool twisted</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00857">clover_field_order.h:857</a></div></div>
<div class="ttc" id="gauge__force__test_8cpp_html_a2bcd2adde36b870d02897e694ecc39cb"><div class="ttname"><a href="gauge__force__test_8cpp.html#a2bcd2adde36b870d02897e694ecc39cb">length</a></div><div class="ttdeci">int length[]</div><div class="ttdef"><b>Definition:</b> <a href="gauge__force__test_8cpp_source.html#l00034">gauge_force_test.cpp:34</a></div></div>
<div class="ttc" id="texture__helper_8cuh_html"><div class="ttname"><a href="texture__helper_8cuh.html">texture_helper.cuh</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_q_d_p_j_i_t_order_html_adc060f60e9d3f67a0128236f5fa7d4d9"><div class="ttname"><a href="structquda_1_1clover_1_1_q_d_p_j_i_t_order.html#adc060f60e9d3f67a0128236f5fa7d4d9">quda::clover::QDPJITOrder::Bytes</a></div><div class="ttdeci">size_t Bytes() const</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00906">clover_field_order.h:906</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_float_n_order_html_aaebffaeb094b36d17411bb6a5faf86a6"><div class="ttname"><a href="structquda_1_1clover_1_1_float_n_order.html#aaebffaeb094b36d17411bb6a5faf86a6">quda::clover::FloatNOrder::backup_norm_h</a></div><div class="ttdeci">void * backup_norm_h</div><div class="ttdoc">host memory for backing up the field when tuning </div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00569">clover_field_order.h:569</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_field_order_html_a434c93d72c652433cebd2bc95e4a02cd"><div class="ttname"><a href="structquda_1_1clover_1_1_field_order.html#a434c93d72c652433cebd2bc95e4a02cd">quda::clover::FieldOrder::accessor</a></div><div class="ttdeci">const Accessor&lt; Float, nColor, nSpin, order &gt; accessor</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00395">clover_field_order.h:395</a></div></div>
<div class="ttc" id="namespacequda_html"><div class="ttname"><a href="namespacequda.html">quda</a></div><div class="ttdef"><b>Definition:</b> <a href="blas__cublas_8h_source.html#l00005">blas_cublas.h:5</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_s_html"><div class="ttname"><a href="structquda_1_1clover_1_1_s.html">quda::clover::S</a></div><div class="ttdoc">This is just a dummy structure we use for trove to define the required structure size. </div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00794">clover_field_order.h:794</a></div></div>
<div class="ttc" id="thrust__helper_8cuh_html"><div class="ttname"><a href="thrust__helper_8cuh.html">thrust_helper.cuh</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_float_n_order_html_aa8955fcd899acd3c9e469d0c5b9c6b45"><div class="ttname"><a href="structquda_1_1clover_1_1_float_n_order.html#aa8955fcd899acd3c9e469d0c5b9c6b45">quda::clover::FloatNOrder::load</a></div><div class="ttdeci">__device__ __host__ void load(real v[length], int x, int parity) const</div><div class="ttdoc">Load accessor for the clover matrix. </div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00735">clover_field_order.h:735</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_b_q_c_d_order_html_a6fbe3a2c2685737750716d1031b6d86c"><div class="ttname"><a href="structquda_1_1clover_1_1_b_q_c_d_order.html#a6fbe3a2c2685737750716d1031b6d86c">quda::clover::BQCDOrder::stride</a></div><div class="ttdeci">const int stride</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00921">clover_field_order.h:921</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_b_q_c_d_order_html_a92943f85c846b1e6470ef0857ef7196d"><div class="ttname"><a href="structquda_1_1clover_1_1_b_q_c_d_order.html#a92943f85c846b1e6470ef0857ef7196d">quda::clover::BQCDOrder::save</a></div><div class="ttdeci">__device__ __host__ void save(RegType v[length], int x, int parity)</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00965">clover_field_order.h:965</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_field_order_html_a292200af541aa305fea09ab5a492ff84"><div class="ttname"><a href="structquda_1_1clover_1_1_field_order.html#a292200af541aa305fea09ab5a492ff84">quda::clover::FieldOrder::FieldOrder</a></div><div class="ttdeci">FieldOrder(CloverField &amp;A, bool inverse=false)</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00404">clover_field_order.h:404</a></div></div>
<div class="ttc" id="structquda_1_1_tex_vector_type_html"><div class="ttname"><a href="structquda_1_1_tex_vector_type.html">quda::TexVectorType</a></div><div class="ttdef"><b>Definition:</b> <a href="register__traits_8h_source.html#l00390">register_traits.h:390</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1square___html"><div class="ttname"><a href="structquda_1_1clover_1_1square__.html">quda::clover::square_</a></div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00074">clover_field_order.h:74</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_q_d_p_j_i_t_order_html_a3dfb8e679e0052270963860bd1e9f740"><div class="ttname"><a href="structquda_1_1clover_1_1_q_d_p_j_i_t_order.html#a3dfb8e679e0052270963860bd1e9f740">quda::clover::QDPJITOrder::volumeCB</a></div><div class="ttdeci">const int volumeCB</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00854">clover_field_order.h:854</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_b_q_c_d_order_html_ae88d033948f2948b5127f07ba6aa3e91"><div class="ttname"><a href="structquda_1_1clover_1_1_b_q_c_d_order.html#ae88d033948f2948b5127f07ba6aa3e91">quda::clover::BQCDOrder::volumeCB</a></div><div class="ttdeci">const int volumeCB</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00920">clover_field_order.h:920</a></div></div>
<div class="ttc" id="structquda_1_1clover__wrapper_html_a06fe5a74a40f5bc94fa8abf741a2e7af"><div class="ttname"><a href="structquda_1_1clover__wrapper.html#a06fe5a74a40f5bc94fa8abf741a2e7af">quda::clover_wrapper::field</a></div><div class="ttdeci">T &amp; field</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00035">clover_field_order.h:35</a></div></div>
<div class="ttc" id="enum__quda_8h_html_a0b751fe440798c39fb8c49c9f2a38911ab0e8c3a8d7516b0d3bade11faa91eda8"><div class="ttname"><a href="enum__quda_8h.html#a0b751fe440798c39fb8c49c9f2a38911ab0e8c3a8d7516b0d3bade11faa91eda8">QUDA_FLOAT2_CLOVER_ORDER</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00254">enum_quda.h:254</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_float_n_order_html_afca847714f45caf0618eb5d614ef58db"><div class="ttname"><a href="structquda_1_1clover_1_1_float_n_order.html#afca847714f45caf0618eb5d614ef58db">quda::clover::FloatNOrder::Twisted</a></div><div class="ttdeci">bool Twisted() const</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00609">clover_field_order.h:609</a></div></div>
<div class="ttc" id="classquda_1_1cuda_clover_field_html"><div class="ttname"><a href="classquda_1_1cuda_clover_field.html">quda::cudaCloverField</a></div><div class="ttdef"><b>Definition:</b> <a href="clover__field_8h_source.html#l00168">clover_field.h:168</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___p_a_c_k_e_232545b3542066bbebdd93a49a8fe0b1_html_a973320ef133242e8f86ba1950de50d72"><div class="ttname"><a href="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___p_a_c_k_e_232545b3542066bbebdd93a49a8fe0b1.html#a973320ef133242e8f86ba1950de50d72">quda::clover::Accessor&lt; Float, nColor, nSpin, QUDA_PACKED_CLOVER_ORDER &gt;::operator()</a></div><div class="ttdeci">__device__ __host__ complex&lt; Float &gt; operator()(int parity, int x, int s_row, int s_col, int c_row, int c_col) const</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00319">clover_field_order.h:319</a></div></div>
<div class="ttc" id="comm__quda_8h_html_aadfcf98463bceb3dc953a0b0d815179a"><div class="ttname"><a href="comm__quda_8h.html#aadfcf98463bceb3dc953a0b0d815179a">comm_allreduce_min</a></div><div class="ttdeci">void comm_allreduce_min(double *data)</div><div class="ttdef"><b>Definition:</b> <a href="comm__mpi_8cpp_source.html#l00265">comm_mpi.cpp:265</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1abs___html_ac04b8e391688c107db67320cf91793df"><div class="ttname"><a href="structquda_1_1clover_1_1abs__.html#ac04b8e391688c107db67320cf91793df">quda::clover::abs_::operator()</a></div><div class="ttdeci">__host__ __device__ ReduceType operator()(const quda::complex&lt; Float &gt; &amp;x)</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00080">clover_field_order.h:80</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_field_order_html_a2ef0bb94bc8d38f8a2fa0bf722620fed"><div class="ttname"><a href="structquda_1_1clover_1_1_field_order.html#a2ef0bb94bc8d38f8a2fa0bf722620fed">quda::clover::FieldOrder::VolumeCB</a></div><div class="ttdeci">__device__ __host__ int VolumeCB() const</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00469">clover_field_order.h:469</a></div></div>
<div class="ttc" id="structquda_1_1_vector_type_html"><div class="ttname"><a href="structquda_1_1_vector_type.html">quda::VectorType</a></div><div class="ttdef"><b>Definition:</b> <a href="register__traits_8h_source.html#l00367">register_traits.h:367</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1abs___html"><div class="ttname"><a href="structquda_1_1clover_1_1abs__.html">quda::clover::abs_</a></div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00079">clover_field_order.h:79</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_field_order_html_a2d78548b79ba7070b0daf25fa796227d"><div class="ttname"><a href="structquda_1_1clover_1_1_field_order.html#a2d78548b79ba7070b0daf25fa796227d">quda::clover::FieldOrder::location</a></div><div class="ttdeci">const QudaFieldLocation location</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00397">clover_field_order.h:397</a></div></div>
<div class="ttc" id="covdev__test_8cpp_html_a8534bf561fd4d68d79107757d9cbac65"><div class="ttname"><a href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a></div><div class="ttdeci">const int nColor</div><div class="ttdef"><b>Definition:</b> <a href="covdev__test_8cpp_source.html#l00075">covdev_test.cpp:75</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_accessor_html_adc2697616f10f4f591508e3c2c7437a2"><div class="ttname"><a href="structquda_1_1clover_1_1_accessor.html#adc2697616f10f4f591508e3c2c7437a2">quda::clover::Accessor::dummy</a></div><div class="ttdeci">complex&lt; Float &gt; dummy</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00169">clover_field_order.h:169</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_float_n_order_html_a9716635fae2bbbce99fa2a560b6f54f9"><div class="ttname"><a href="structquda_1_1clover_1_1_float_n_order.html#a9716635fae2bbbce99fa2a560b6f54f9">quda::clover::FloatNOrder::norm</a></div><div class="ttdeci">norm_type * norm</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00550">clover_field_order.h:550</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_float_n_order_html_a97461cacbca468e24fe4c65fa7e07167"><div class="ttname"><a href="structquda_1_1clover_1_1_float_n_order.html#a97461cacbca468e24fe4c65fa7e07167">quda::clover::FloatNOrder::Bytes</a></div><div class="ttdeci">size_t Bytes() const</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00781">clover_field_order.h:781</a></div></div>
<div class="ttc" id="structquda_1_1_h_matrix_html_abe9882ee4d5f74e542975edb57100b4f"><div class="ttname"><a href="structquda_1_1_h_matrix.html#abe9882ee4d5f74e542975edb57100b4f">quda::HMatrix::HMatrix</a></div><div class="ttdeci">__device__ __host__ HMatrix()</div><div class="ttdef"><b>Definition:</b> <a href="quda__matrix_8h_source.html#l00307">quda_matrix.h:307</a></div></div>
<div class="ttc" id="namespacequda_html_aaeda4e4f5aabf19dae35f28e4c8802b7"><div class="ttname"><a href="namespacequda.html#aaeda4e4f5aabf19dae35f28e4c8802b7">quda::vector_store</a></div><div class="ttdeci">__device__ __host__ void vector_store(void *ptr, int idx, const VectorType &amp;value)</div><div class="ttdef"><b>Definition:</b> <a href="register__traits_8h_source.html#l00422">register_traits.h:422</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_float_n_order_html_a40cac8a0b759bd6d168902526480a609"><div class="ttname"><a href="structquda_1_1clover_1_1_float_n_order.html#a40cac8a0b759bd6d168902526480a609">quda::clover::FloatNOrder::volumeCB</a></div><div class="ttdeci">const int volumeCB</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00559">clover_field_order.h:559</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___p_a_c_k_e_232545b3542066bbebdd93a49a8fe0b1_html_aaf63f413ced2ccadfb3e533a308e15ef"><div class="ttname"><a href="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___p_a_c_k_e_232545b3542066bbebdd93a49a8fe0b1.html#aaf63f413ced2ccadfb3e533a308e15ef">quda::clover::Accessor&lt; Float, nColor, nSpin, QUDA_PACKED_CLOVER_ORDER &gt;::Accessor</a></div><div class="ttdeci">Accessor(const CloverField &amp;A, bool inverse=false)</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00311">clover_field_order.h:311</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_float_n_order_html_a5348ddb9bd0607e2841d9af09c137ad7"><div class="ttname"><a href="structquda_1_1clover_1_1_float_n_order.html#a5348ddb9bd0607e2841d9af09c137ad7">quda::clover::FloatNOrder::offset</a></div><div class="ttdeci">const AllocInt offset</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00551">clover_field_order.h:551</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_accessor_html"><div class="ttname"><a href="structquda_1_1clover_1_1_accessor.html">quda::clover::Accessor</a></div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00168">clover_field_order.h:168</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_float_n_order_html_a794d59f97e7f0023e124b688b1335eb1"><div class="ttname"><a href="structquda_1_1clover_1_1_float_n_order.html#a794d59f97e7f0023e124b688b1335eb1">quda::clover::FloatNOrder::AllocInt</a></div><div class="ttdeci">AllocType&lt; huge_alloc &gt;::type AllocInt</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00545">clover_field_order.h:545</a></div></div>
<div class="ttc" id="structquda_1_1clover__mapper_3_01char_00_01_n_00_01add__rho_01_4_html_a1eacc765c43059b7c9da9f0e8d3a3633"><div class="ttname"><a href="structquda_1_1clover__mapper_3_01char_00_01_n_00_01add__rho_01_4.html#a1eacc765c43059b7c9da9f0e8d3a3633">quda::clover_mapper&lt; char, N, add_rho &gt;::type</a></div><div class="ttdeci">clover::FloatNOrder&lt; char, N, 4, add_rho &gt; type</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00987">clover_field_order.h:987</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_field_order_html_a7210f54cd7b3800ad69e041039743a8c"><div class="ttname"><a href="structquda_1_1clover_1_1_field_order.html#a7210f54cd7b3800ad69e041039743a8c">quda::clover::FieldOrder::abs_max</a></div><div class="ttdeci">__host__ double abs_max(int dim=-1, bool global=true) const</div><div class="ttdoc">Returns the Linfinity norm of the field. </div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00507">clover_field_order.h:507</a></div></div>
<div class="ttc" id="structquda_1_1clover__mapper_3_01short_00_01_n_00_01add__rho_01_4_html_aee3fe8b59d2cb7267373c88b2c9836c6"><div class="ttname"><a href="structquda_1_1clover__mapper_3_01short_00_01_n_00_01add__rho_01_4.html#aee3fe8b59d2cb7267373c88b2c9836c6">quda::clover_mapper&lt; short, N, add_rho &gt;::type</a></div><div class="ttdeci">clover::FloatNOrder&lt; short, N, 4, add_rho &gt; type</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00984">clover_field_order.h:984</a></div></div>
<div class="ttc" id="structquda_1_1clover__wrapper_html"><div class="ttname"><a href="structquda_1_1clover__wrapper.html">quda::clover_wrapper</a></div><div class="ttdoc">clover_wrapper is an internal class that is used to wrap instances of colorspinor accessors...</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00034">clover_field_order.h:34</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_float_n_order_html_a82f0ae22d54b477d6c93df7c08dc9e95"><div class="ttname"><a href="structquda_1_1clover_1_1_float_n_order.html#a82f0ae22d54b477d6c93df7c08dc9e95">quda::clover::FloatNOrder::load</a></div><div class="ttdeci">void load()</div><div class="ttdoc">Restore the field from the host after tuning. </div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00769">clover_field_order.h:769</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_field_order_html_a30b54256d5da88bdbfead7a761c5200e"><div class="ttname"><a href="structquda_1_1clover_1_1_field_order.html#a30b54256d5da88bdbfead7a761c5200e">quda::clover::FieldOrder::inverse</a></div><div class="ttdeci">bool inverse</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00396">clover_field_order.h:396</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_q_d_p_order_html_ab2b1b60d78b2bfac2d7f31f6c6eee71d"><div class="ttname"><a href="structquda_1_1clover_1_1_q_d_p_order.html#ab2b1b60d78b2bfac2d7f31f6c6eee71d">quda::clover::QDPOrder::save</a></div><div class="ttdeci">__device__ __host__ void save(const RegType v[length], int x, int parity)</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00831">clover_field_order.h:831</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_float_n_order_html_a16e436b44415962df69d308ccf82e228"><div class="ttname"><a href="structquda_1_1clover_1_1_float_n_order.html#a16e436b44415962df69d308ccf82e228">quda::clover::FloatNOrder::backup_h</a></div><div class="ttdeci">void * backup_h</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00568">clover_field_order.h:568</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_field_order_html_a516a249a5510118731ea219e7778a5a3"><div class="ttname"><a href="structquda_1_1clover_1_1_field_order.html#a516a249a5510118731ea219e7778a5a3">quda::clover::FieldOrder::Volume</a></div><div class="ttdeci">__device__ __host__ int Volume() const</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00466">clover_field_order.h:466</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_q_d_p_j_i_t_order_html_aa85c78a9d121d2ccfe81613a8d169ea5"><div class="ttname"><a href="structquda_1_1clover_1_1_q_d_p_j_i_t_order.html#aa85c78a9d121d2ccfe81613a8d169ea5">quda::clover::QDPJITOrder::load</a></div><div class="ttdeci">__device__ __host__ void load(RegType v[length], int x, int parity) const</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00869">clover_field_order.h:869</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_float_n_order_html_a9278182b50341637fff9faa9898037ba"><div class="ttname"><a href="structquda_1_1clover_1_1_float_n_order.html#a9278182b50341637fff9faa9898037ba">quda::clover::FloatNOrder::norm_type</a></div><div class="ttdeci">float norm_type</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00546">clover_field_order.h:546</a></div></div>
<div class="ttc" id="register__traits_8h_html"><div class="ttname"><a href="register__traits_8h.html">register_traits.h</a></div><div class="ttdoc">Provides precision abstractions and defines the register precision given the storage precision using ...</div></div>
<div class="ttc" id="enum__quda_8h_html_a0b751fe440798c39fb8c49c9f2a38911a99dff6b9f0fe3de07efc0858bee04ff4"><div class="ttname"><a href="enum__quda_8h.html#a0b751fe440798c39fb8c49c9f2a38911a99dff6b9f0fe3de07efc0858bee04ff4">QUDA_FLOAT4_CLOVER_ORDER</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__quda_8h_source.html#l00255">enum_quda.h:255</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_float_n_order_html_aa19fce564e076c9b8fbf2574577e392d"><div class="ttname"><a href="structquda_1_1clover_1_1_float_n_order.html#aa19fce564e076c9b8fbf2574577e392d">quda::clover::FloatNOrder::mu2</a></div><div class="ttdeci">const real mu2</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00563">clover_field_order.h:563</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___f_l_o_a_t4___c_l_o_v_e_r___o_r_d_e_r_01_4_html_a5db385c9945d5eb777d47b3304cc9b0d"><div class="ttname"><a href="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___f_l_o_a_t4___c_l_o_v_e_r___o_r_d_e_r_01_4.html#a5db385c9945d5eb777d47b3304cc9b0d">quda::clover::Accessor&lt; Float, nColor, nSpin, QUDA_FLOAT4_CLOVER_ORDER &gt;::transform_reduce</a></div><div class="ttdeci">__host__ double transform_reduce(QudaFieldLocation location, helper h, reducer r, double init) const</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00290">clover_field_order.h:290</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_field_order_html_a3c65469c2fa4a20cd104211d46b5b83e"><div class="ttname"><a href="structquda_1_1clover_1_1_field_order.html#a3c65469c2fa4a20cd104211d46b5b83e">quda::clover::FieldOrder::norm2</a></div><div class="ttdeci">__host__ double norm2(int dim=-1, bool global=true) const</div><div class="ttdoc">Returns the L2 norm suared of the field. </div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00495">clover_field_order.h:495</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_accessor_html_a497c61bc7b95f3f677fe1008d950d574"><div class="ttname"><a href="structquda_1_1clover_1_1_accessor.html#a497c61bc7b95f3f677fe1008d950d574">quda::clover::Accessor::Accessor</a></div><div class="ttdeci">Accessor(const CloverField &amp;A, bool inverse=false)</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00170">clover_field_order.h:170</a></div></div>
<div class="ttc" id="namespacequda_1_1cublas_html_ac642c2c4f9dd3abfe528cc1581e5bf76"><div class="ttname"><a href="namespacequda_1_1cublas.html#ac642c2c4f9dd3abfe528cc1581e5bf76">quda::cublas::init</a></div><div class="ttdeci">void init()</div><div class="ttdoc">Create the CUBLAS context. </div><div class="ttdef"><b>Definition:</b> <a href="blas__cublas_8cu_source.html#l00031">blas_cublas.cu:31</a></div></div>
<div class="ttc" id="clover__field_8h_html"><div class="ttname"><a href="clover__field_8h.html">clover_field.h</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___f_l_o_a_t4___c_l_o_v_e_r___o_r_d_e_r_01_4_html_a0b2be43650e7d3e1db84b38b32dd80e0"><div class="ttname"><a href="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___f_l_o_a_t4___c_l_o_v_e_r___o_r_d_e_r_01_4.html#a0b2be43650e7d3e1db84b38b32dd80e0">quda::clover::Accessor&lt; Float, nColor, nSpin, QUDA_FLOAT4_CLOVER_ORDER &gt;::offset_cb</a></div><div class="ttdeci">size_t offset_cb</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00252">clover_field_order.h:252</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_float_n_order_html_a0a821c2e6a5463eebfcd7ad740a35371"><div class="ttname"><a href="structquda_1_1clover_1_1_float_n_order.html#a0a821c2e6a5463eebfcd7ad740a35371">quda::clover::FloatNOrder::twisted</a></div><div class="ttdeci">const bool twisted</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00562">clover_field_order.h:562</a></div></div>
<div class="ttc" id="trove__helper_8cuh_html"><div class="ttname"><a href="trove__helper_8cuh.html">trove_helper.cuh</a></div></div>
<div class="ttc" id="malloc__quda_8h_html_a45d92b2c2231b848192b3086283d05b6"><div class="ttname"><a href="malloc__quda_8h.html#a45d92b2c2231b848192b3086283d05b6">safe_malloc</a></div><div class="ttdeci">#define safe_malloc(size)</div><div class="ttdef"><b>Definition:</b> <a href="malloc__quda_8h_source.html#l00066">malloc_quda.h:66</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_q_d_p_order_html"><div class="ttname"><a href="structquda_1_1clover_1_1_q_d_p_order.html">quda::clover::QDPOrder</a></div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00800">clover_field_order.h:800</a></div></div>
<div class="ttc" id="structquda_1_1clover__mapper_3_01double_00_01_n_00_01add__rho_01_4_html_a5df9347cdc06f4d51d3189c52fc1f1c4"><div class="ttname"><a href="structquda_1_1clover__mapper_3_01double_00_01_n_00_01add__rho_01_4.html#a5df9347cdc06f4d51d3189c52fc1f1c4">quda::clover_mapper&lt; double, N, add_rho &gt;::type</a></div><div class="ttdeci">clover::FloatNOrder&lt; double, N, 2, add_rho &gt; type</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00978">clover_field_order.h:978</a></div></div>
<div class="ttc" id="contract__reference_8h_html_a91e334f289dc11ba09da0df4a9c72123"><div class="ttname"><a href="contract__reference_8h.html#a91e334f289dc11ba09da0df4a9c72123">V</a></div><div class="ttdeci">int V</div><div class="ttdef"><b>Definition:</b> <a href="test__util_8cpp_source.html#l00027">test_util.cpp:27</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_float_n_order_html_a6a79dea3081969da52086b0bf9a750a6"><div class="ttname"><a href="structquda_1_1clover_1_1_float_n_order.html#a6a79dea3081969da52086b0bf9a750a6">quda::clover::FloatNOrder::Mu2</a></div><div class="ttdeci">real Mu2() const</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00610">clover_field_order.h:610</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_q_d_p_order_html_a08bf125ae82b82f73e3e4dcdf58f200e"><div class="ttname"><a href="structquda_1_1clover_1_1_q_d_p_order.html#a08bf125ae82b82f73e3e4dcdf58f200e">quda::clover::QDPOrder::QDPOrder</a></div><div class="ttdeci">QDPOrder(const CloverField &amp;clover, bool inverse, Float *clover_=0)</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00810">clover_field_order.h:810</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_float_n_order_html_a3e405e6e58431b32451622370a8b8414"><div class="ttname"><a href="structquda_1_1clover_1_1_float_n_order.html#a3e405e6e58431b32451622370a8b8414">quda::clover::FloatNOrder::save</a></div><div class="ttdeci">__device__ __host__ void save(const real v[length], int x, int parity)</div><div class="ttdoc">Store accessor for the clover matrix. </div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00747">clover_field_order.h:747</a></div></div>
<div class="ttc" id="classquda_1_1_lattice_field_html_a644c9306ed8f513cdb2c88c755e305d8"><div class="ttname"><a href="classquda_1_1_lattice_field.html#a644c9306ed8f513cdb2c88c755e305d8">quda::LatticeField::Location</a></div><div class="ttdeci">QudaFieldLocation Location() const</div><div class="ttdef"><b>Definition:</b> <a href="lattice__field_8cpp_source.html#l00660">lattice_field.cpp:660</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_float_n_order_html_a4aaa02e127657003d68c634bcda15a9f"><div class="ttname"><a href="structquda_1_1clover_1_1_float_n_order.html#a4aaa02e127657003d68c634bcda15a9f">quda::clover::FloatNOrder::save</a></div><div class="ttdeci">__device__ __host__ void save(const real v[block], int x, int parity, int chirality)</div><div class="ttdoc">Store accessor for a single chiral block. </div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00695">clover_field_order.h:695</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_field_order_html_a2f8135432ab105e69c40018af3d2a37b"><div class="ttname"><a href="structquda_1_1clover_1_1_field_order.html#a2f8135432ab105e69c40018af3d2a37b">quda::clover::FieldOrder::norm1</a></div><div class="ttdeci">__host__ double norm1(int dim=-1, bool global=true) const</div><div class="ttdoc">Returns the L1 norm of the field. </div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00483">clover_field_order.h:483</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_field_order_html"><div class="ttname"><a href="structquda_1_1clover_1_1_field_order.html">quda::clover::FieldOrder</a></div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00389">clover_field_order.h:389</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_float_n_order_html_a59e3704b4288a4811168e6c8c172607d"><div class="ttname"><a href="structquda_1_1clover_1_1_float_n_order.html#a59e3704b4288a4811168e6c8c172607d">quda::clover::FloatNOrder::rho</a></div><div class="ttdeci">const real rho</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00564">clover_field_order.h:564</a></div></div>
<div class="ttc" id="quda__matrix_8h_html"><div class="ttname"><a href="quda__matrix_8h.html">quda_matrix.h</a></div></div>
<div class="ttc" id="enum__quda_8h_html_a7e07bc0f2e37ab1df05cd3c87017ff33"><div class="ttname"><a href="enum__quda_8h.html#a7e07bc0f2e37ab1df05cd3c87017ff33">QudaFieldLocation</a></div><div class="ttdeci">enum QudaFieldLocation_s QudaFieldLocation</div></div>
<div class="ttc" id="structquda_1_1clover_1_1_b_q_c_d_order_html_ad37f064ff4dea4f7c7cb71f6fc9bba06"><div class="ttname"><a href="structquda_1_1clover_1_1_b_q_c_d_order.html#ad37f064ff4dea4f7c7cb71f6fc9bba06">quda::clover::BQCDOrder::Bytes</a></div><div class="ttdeci">size_t Bytes() const</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00969">clover_field_order.h:969</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_q_d_p_order_html_a3fffb432aefdab5dadc0997c70ecaec6"><div class="ttname"><a href="structquda_1_1clover_1_1_q_d_p_order.html#a3fffb432aefdab5dadc0997c70ecaec6">quda::clover::QDPOrder::RegType</a></div><div class="ttdeci">mapper&lt; Float &gt;::type RegType</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00801">clover_field_order.h:801</a></div></div>
<div class="ttc" id="structquda_1_1is_fixed_html"><div class="ttname"><a href="structquda_1_1is_fixed.html">quda::isFixed</a></div><div class="ttdef"><b>Definition:</b> <a href="register__traits_8h_source.html#l00144">register_traits.h:144</a></div></div>
<div class="ttc" id="structquda_1_1clover__wrapper_html_a40b45f33bb573ea9e403143dc27b171d"><div class="ttname"><a href="structquda_1_1clover__wrapper.html#a40b45f33bb573ea9e403143dc27b171d">quda::clover_wrapper::operator=</a></div><div class="ttdeci">__device__ __host__ void operator=(const C &amp;a)</div><div class="ttdoc">Assignment operator with H matrix instance as input. </div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00055">clover_field_order.h:55</a></div></div>
<div class="ttc" id="namespacequda_html_a599ff2d7aba3544b3e0559cd50861906"><div class="ttname"><a href="namespacequda.html#a599ff2d7aba3544b3e0559cd50861906">quda::inverse</a></div><div class="ttdeci">__device__ __host__ Matrix&lt; T, 3 &gt; inverse(const Matrix&lt; T, 3 &gt; &amp;u)</div><div class="ttdef"><b>Definition:</b> <a href="quda__matrix_8h_source.html#l00611">quda_matrix.h:611</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_q_d_p_j_i_t_order_html_aadd339bd8b3bef84dc2998ac6751cf5c"><div class="ttname"><a href="structquda_1_1clover_1_1_q_d_p_j_i_t_order.html#aadd339bd8b3bef84dc2998ac6751cf5c">quda::clover::QDPJITOrder::stride</a></div><div class="ttdeci">const int stride</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00855">clover_field_order.h:855</a></div></div>
<div class="ttc" id="structquda_1_1clover__wrapper_html_a75bdd32c1094dadb06e0d1c419574640"><div class="ttname"><a href="structquda_1_1clover__wrapper.html#a75bdd32c1094dadb06e0d1c419574640">quda::clover_wrapper::x_cb</a></div><div class="ttdeci">const int x_cb</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00036">clover_field_order.h:36</a></div></div>
<div class="ttc" id="structquda_1_1clover__mapper_3_01float_00_01_n_00_01add__rho_01_4_html_a0c02ce225a50050bf6f59ff3a6425467"><div class="ttname"><a href="structquda_1_1clover__mapper_3_01float_00_01_n_00_01add__rho_01_4.html#a0c02ce225a50050bf6f59ff3a6425467">quda::clover_mapper&lt; float, N, add_rho &gt;::type</a></div><div class="ttdeci">clover::FloatNOrder&lt; float, N, 4, add_rho &gt; type</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00981">clover_field_order.h:981</a></div></div>
<div class="ttc" id="structquda_1_1mapper_html"><div class="ttname"><a href="structquda_1_1mapper.html">quda::mapper</a></div><div class="ttdef"><b>Definition:</b> <a href="register__traits_8h_source.html#l00043">register_traits.h:43</a></div></div>
<div class="ttc" id="classquda_1_1_clover_field_html_a0af989ede54c81592f9fe839d07f859a"><div class="ttname"><a href="classquda_1_1_clover_field.html#a0af989ede54c81592f9fe839d07f859a">quda::CloverField::Norm</a></div><div class="ttdeci">void * Norm(bool inverse=false)</div><div class="ttdef"><b>Definition:</b> <a href="clover__field_8h_source.html#l00075">clover_field.h:75</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_float_n_order_html_a91a4ad71aca49f4301e5eafa8562e714"><div class="ttname"><a href="structquda_1_1clover_1_1_float_n_order.html#a91a4ad71aca49f4301e5eafa8562e714">quda::clover::FloatNOrder::Vector</a></div><div class="ttdeci">VectorType&lt; Float, N &gt;::type Vector</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00544">clover_field_order.h:544</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_q_d_p_j_i_t_order_html_aa8b4b8c540aff06867045500b54dc418"><div class="ttname"><a href="structquda_1_1clover_1_1_q_d_p_j_i_t_order.html#aa8b4b8c540aff06867045500b54dc418">quda::clover::QDPJITOrder::Mu2</a></div><div class="ttdeci">Float Mu2() const</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00867">clover_field_order.h:867</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_float_n_order_html_a033bd43c8bbce8a80e617276f2211610"><div class="ttname"><a href="structquda_1_1clover_1_1_float_n_order.html#a033bd43c8bbce8a80e617276f2211610">quda::clover::FloatNOrder::norm_bytes</a></div><div class="ttdeci">size_t norm_bytes</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00567">clover_field_order.h:567</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_float_n_order_html_a7fe20337c58af4fe4d901fa5682f6da6"><div class="ttname"><a href="structquda_1_1clover_1_1_float_n_order.html#a7fe20337c58af4fe4d901fa5682f6da6">quda::clover::FloatNOrder::FloatNOrder</a></div><div class="ttdeci">FloatNOrder(const CloverField &amp;clover, bool is_inverse, Float *clover_=0, norm_type *norm_=0, bool override=false)</div><div class="ttdoc">host memory for backing up norm when tuning </div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00571">clover_field_order.h:571</a></div></div>
<div class="ttc" id="structquda_1_1clover__wrapper_html_a1abc4bd026597f55be802fb1e493fcb4"><div class="ttname"><a href="structquda_1_1clover__wrapper.html#a1abc4bd026597f55be802fb1e493fcb4">quda::clover_wrapper::chirality</a></div><div class="ttdeci">const int chirality</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00038">clover_field_order.h:38</a></div></div>
<div class="ttc" id="structquda_1_1_h_matrix_html_a6d5ed0041e8fe91d5c042383560968c0"><div class="ttname"><a href="structquda_1_1_h_matrix.html#a6d5ed0041e8fe91d5c042383560968c0">quda::HMatrix::operator=</a></div><div class="ttdeci">__device__ __host__ void operator=(const HMatrix&lt; U, N &gt; &amp;b)</div><div class="ttdef"><b>Definition:</b> <a href="quda__matrix_8h_source.html#l00338">quda_matrix.h:338</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_q_d_p_j_i_t_order_html_aaf7ef4cc8140b2e2be2c988cd6cdd8f7"><div class="ttname"><a href="structquda_1_1clover_1_1_q_d_p_j_i_t_order.html#aaf7ef4cc8140b2e2be2c988cd6cdd8f7">quda::clover::QDPJITOrder::save</a></div><div class="ttdeci">__device__ __host__ void save(const RegType v[length], int x, int parity)</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00888">clover_field_order.h:888</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_q_d_p_j_i_t_order_html_a716e95b15ded88a0bd80152e6d538f97"><div class="ttname"><a href="structquda_1_1clover_1_1_q_d_p_j_i_t_order.html#a716e95b15ded88a0bd80152e6d538f97">quda::clover::QDPJITOrder::Twisted</a></div><div class="ttdeci">bool Twisted() const</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00866">clover_field_order.h:866</a></div></div>
<div class="ttc" id="structquda_1_1clover__mapper_html"><div class="ttname"><a href="structquda_1_1clover__mapper.html">quda::clover_mapper</a></div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00975">clover_field_order.h:975</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_q_d_p_order_html_a2aed1e70fe0e7de0081e051640a1d720"><div class="ttname"><a href="structquda_1_1clover_1_1_q_d_p_order.html#a2aed1e70fe0e7de0081e051640a1d720">quda::clover::QDPOrder::clover</a></div><div class="ttdeci">Float * clover</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00802">clover_field_order.h:802</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_q_d_p_order_html_a218eb9cbe53dad8cdebbbec4da7a3dc5"><div class="ttname"><a href="structquda_1_1clover_1_1_q_d_p_order.html#a218eb9cbe53dad8cdebbbec4da7a3dc5">quda::clover::QDPOrder::Twisted</a></div><div class="ttdeci">bool Twisted() const</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00816">clover_field_order.h:816</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_float_n_order_html"><div class="ttname"><a href="structquda_1_1clover_1_1_float_n_order.html">quda::clover::FloatNOrder</a></div><div class="ttdoc">Accessor routine for CloverFields in native field order. </div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00541">clover_field_order.h:541</a></div></div>
<div class="ttc" id="complex__quda_8h_html"><div class="ttname"><a href="complex__quda_8h.html">complex_quda.h</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_q_d_p_j_i_t_order_html_a09cb4b2217e7f8d2526807919b7961df"><div class="ttname"><a href="structquda_1_1clover_1_1_q_d_p_j_i_t_order.html#a09cb4b2217e7f8d2526807919b7961df">quda::clover::QDPJITOrder::QDPJITOrder</a></div><div class="ttdeci">QDPJITOrder(const CloverField &amp;clover, bool inverse, Float *clover_=0)</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00860">clover_field_order.h:860</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_field_order_html_a40a40c00cf5aacbc4ab2b3359121a66d"><div class="ttname"><a href="structquda_1_1clover_1_1_field_order.html#a40a40c00cf5aacbc4ab2b3359121a66d">quda::clover::FieldOrder::Field</a></div><div class="ttdeci">CloverField &amp; Field()</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00408">clover_field_order.h:408</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___f_l_o_a_t2___c_l_o_v_e_r___o_r_d_e_r_01_4_html_ada45daf52c1c0426cb72fc772bbaf235"><div class="ttname"><a href="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___f_l_o_a_t2___c_l_o_v_e_r___o_r_d_e_r_01_4.html#ada45daf52c1c0426cb72fc772bbaf235">quda::clover::Accessor&lt; Float, nColor, nSpin, QUDA_FLOAT2_CLOVER_ORDER &gt;::transform_reduce</a></div><div class="ttdeci">__host__ double transform_reduce(QudaFieldLocation location, helper h, reducer r, double init) const</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00225">clover_field_order.h:225</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_accessor_html_a22bdd0119157278ab658128e1e1e30e3"><div class="ttname"><a href="structquda_1_1clover_1_1_accessor.html#a22bdd0119157278ab658128e1e1e30e3">quda::clover::Accessor::operator()</a></div><div class="ttdeci">__device__ __host__ complex&lt; Float &gt; &amp; operator()(int parity, int x, int s_row, int s_col, int c_row, int c_col) const</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00174">clover_field_order.h:174</a></div></div>
<div class="ttc" id="namespacequda_html_afc8f979be274d625e247ce913db49805"><div class="ttname"><a href="namespacequda.html#afc8f979be274d625e247ce913db49805">quda::abs</a></div><div class="ttdeci">__host__ __device__ ValueType abs(ValueType x)</div><div class="ttdef"><b>Definition:</b> <a href="complex__quda_8h_source.html#l00125">complex_quda.h:125</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_q_d_p_order_html_a96852b665f563cba3573780afe2bd19f"><div class="ttname"><a href="structquda_1_1clover_1_1_q_d_p_order.html#a96852b665f563cba3573780afe2bd19f">quda::clover::QDPOrder::twisted</a></div><div class="ttdeci">const bool twisted</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00807">clover_field_order.h:807</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_b_q_c_d_order_html_aaef5628d9225fbab383dc38868213ef9"><div class="ttname"><a href="structquda_1_1clover_1_1_b_q_c_d_order.html#aaef5628d9225fbab383dc38868213ef9">quda::clover::BQCDOrder::Mu2</a></div><div class="ttdeci">Float Mu2() const</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00934">clover_field_order.h:934</a></div></div>
<div class="ttc" id="face__gauge_8cpp_html_aef2e90455f2a9cbc0eae8c4c96cd159b"><div class="ttname"><a href="face__gauge_8cpp.html#aef2e90455f2a9cbc0eae8c4c96cd159b">volumeCB</a></div><div class="ttdeci">static int volumeCB</div><div class="ttdef"><b>Definition:</b> <a href="face__gauge_8cpp_source.html#l00043">face_gauge.cpp:43</a></div></div>
<div class="ttc" id="util__quda_8h_html_a7668e6580e0f57b0db3112fae4959e34"><div class="ttname"><a href="util__quda_8h.html#a7668e6580e0f57b0db3112fae4959e34">checkCudaError</a></div><div class="ttdeci">#define checkCudaError()</div><div class="ttdef"><b>Definition:</b> <a href="util__quda_8h_source.html#l00161">util_quda.h:161</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_q_d_p_j_i_t_order_html_adc515295907de1f1df56498608918006"><div class="ttname"><a href="structquda_1_1clover_1_1_q_d_p_j_i_t_order.html#adc515295907de1f1df56498608918006">quda::clover::QDPJITOrder::mu2</a></div><div class="ttdeci">const Float mu2</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00858">clover_field_order.h:858</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_b_q_c_d_order_html"><div class="ttname"><a href="structquda_1_1clover_1_1_b_q_c_d_order.html">quda::clover::BQCDOrder</a></div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00917">clover_field_order.h:917</a></div></div>
<div class="ttc" id="comm__quda_8h_html_ad219441b0cdddb8ddf27cf958557713e"><div class="ttname"><a href="comm__quda_8h.html#ad219441b0cdddb8ddf27cf958557713e">comm_allreduce</a></div><div class="ttdeci">void comm_allreduce(double *data)</div><div class="ttdef"><b>Definition:</b> <a href="comm__mpi_8cpp_source.html#l00242">comm_mpi.cpp:242</a></div></div>
<div class="ttc" id="namespacequda_html_a043738f16cdeb082fa1a5158fbad36b3"><div class="ttname"><a href="namespacequda.html#a043738f16cdeb082fa1a5158fbad36b3">quda::conj</a></div><div class="ttdeci">__host__ __device__ ValueType conj(ValueType x)</div><div class="ttdef"><b>Definition:</b> <a href="complex__quda_8h_source.html#l00130">complex_quda.h:130</a></div></div>
<div class="ttc" id="comm__quda_8h_html_abdf7d13f471c3c6b39e142c09fb130b4"><div class="ttname"><a href="comm__quda_8h.html#abdf7d13f471c3c6b39e142c09fb130b4">comm_allreduce_max</a></div><div class="ttdeci">void comm_allreduce_max(double *data)</div><div class="ttdef"><b>Definition:</b> <a href="comm__mpi_8cpp_source.html#l00258">comm_mpi.cpp:258</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_b_q_c_d_order_html_ada8bce220dd38a75d6b9ef314530e5bc"><div class="ttname"><a href="structquda_1_1clover_1_1_b_q_c_d_order.html#ada8bce220dd38a75d6b9ef314530e5bc">quda::clover::BQCDOrder::BQCDOrder</a></div><div class="ttdeci">BQCDOrder(const CloverField &amp;clover, bool inverse, Float *clover_=0)</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00926">clover_field_order.h:926</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___f_l_o_a_t2___c_l_o_v_e_r___o_r_d_e_r_01_4_html_afbdc8d006c9bcd4e9956808b5c904d12"><div class="ttname"><a href="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___f_l_o_a_t2___c_l_o_v_e_r___o_r_d_e_r_01_4.html#afbdc8d006c9bcd4e9956808b5c904d12">quda::clover::Accessor&lt; Float, nColor, nSpin, QUDA_FLOAT2_CLOVER_ORDER &gt;::Accessor</a></div><div class="ttdeci">Accessor(const CloverField &amp;A, bool inverse=false)</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00192">clover_field_order.h:192</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1square___html_ad0fd8d5383dbf028bbe349153f78bdad"><div class="ttname"><a href="structquda_1_1clover_1_1square__.html#ad0fd8d5383dbf028bbe349153f78bdad">quda::clover::square_::operator()</a></div><div class="ttdeci">__host__ __device__ ReduceType operator()(const quda::complex&lt; Float &gt; &amp;x)</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00075">clover_field_order.h:75</a></div></div>
<div class="ttc" id="structquda_1_1_alloc_type_html"><div class="ttname"><a href="structquda_1_1_alloc_type.html">quda::AllocType</a></div><div class="ttdef"><b>Definition:</b> <a href="register__traits_8h_source.html#l00493">register_traits.h:493</a></div></div>
<div class="ttc" id="classthrust__allocator_html"><div class="ttname"><a href="classthrust__allocator.html">thrust_allocator</a></div><div class="ttdef"><b>Definition:</b> <a href="thrust__helper_8cuh_source.html#l00027">thrust_helper.cuh:27</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_float_n_order_html_a4ceed30e387daec290cc7ad6aa595f77"><div class="ttname"><a href="structquda_1_1clover_1_1_float_n_order.html#a4ceed30e387daec290cc7ad6aa595f77">quda::clover::FloatNOrder::bytes</a></div><div class="ttdeci">size_t bytes</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00566">clover_field_order.h:566</a></div></div>
<div class="ttc" id="classquda_1_1_lattice_field_html_a5ddb59a67d4ade2aad18f1d974599073"><div class="ttname"><a href="classquda_1_1_lattice_field.html#a5ddb59a67d4ade2aad18f1d974599073">quda::LatticeField::Precision</a></div><div class="ttdeci">QudaPrecision Precision() const</div><div class="ttdef"><b>Definition:</b> <a href="lattice__field_8h_source.html#l00546">lattice_field.h:546</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_b_q_c_d_order_html_a21f15213660708479a3471ce7a600299"><div class="ttname"><a href="structquda_1_1clover_1_1_b_q_c_d_order.html#a21f15213660708479a3471ce7a600299">quda::clover::BQCDOrder::load</a></div><div class="ttdeci">__device__ __host__ void load(RegType v[length], int x, int parity) const</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00941">clover_field_order.h:941</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_float_n_order_html_aee884001f9a3b67b442be29d8d25ab23"><div class="ttname"><a href="structquda_1_1clover_1_1_float_n_order.html#aee884001f9a3b67b442be29d8d25ab23">quda::clover::FloatNOrder::stride</a></div><div class="ttdeci">const int stride</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00560">clover_field_order.h:560</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_field_order_html_ae7b6c1dd940daf5e70d8e1ce0732543a"><div class="ttname"><a href="structquda_1_1clover_1_1_field_order.html#ae7b6c1dd940daf5e70d8e1ce0732543a">quda::clover::FieldOrder::A</a></div><div class="ttdeci">CloverField &amp; A</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00393">clover_field_order.h:393</a></div></div>
<div class="ttc" id="namespacequda_html_afdd60a37d49f6d12f8472e2a910e80c6"><div class="ttname"><a href="namespacequda.html#afdd60a37d49f6d12f8472e2a910e80c6">quda::zero</a></div><div class="ttdeci">__device__ __host__ void zero(vector_type&lt; scalar, n &gt; &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="cub__helper_8cuh_source.html#l00054">cub_helper.cuh:54</a></div></div>
<div class="ttc" id="namespacequda_1_1clover_html_aa356224212581cf8af5f8dad868a2ddb"><div class="ttname"><a href="namespacequda_1_1clover.html#aa356224212581cf8af5f8dad868a2ddb">quda::clover::indexFloatN</a></div><div class="ttdeci">__device__ __host__ int indexFloatN(int k, int stride, int x)</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00242">clover_field_order.h:242</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_q_d_p_j_i_t_order_html_a7382d344ad60080ce5ca879038f266f7"><div class="ttname"><a href="structquda_1_1clover_1_1_q_d_p_j_i_t_order.html#a7382d344ad60080ce5ca879038f266f7">quda::clover::QDPJITOrder::offdiag</a></div><div class="ttdeci">Float * offdiag</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00853">clover_field_order.h:853</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___f_l_o_a_t2___c_l_o_v_e_r___o_r_d_e_r_01_4_html_a7a11b530e4ca00a1c8307c8b448054ab"><div class="ttname"><a href="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___f_l_o_a_t2___c_l_o_v_e_r___o_r_d_e_r_01_4.html#a7a11b530e4ca00a1c8307c8b448054ab">quda::clover::Accessor&lt; Float, nColor, nSpin, QUDA_FLOAT2_CLOVER_ORDER &gt;::offset_cb</a></div><div class="ttdeci">size_t offset_cb</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00190">clover_field_order.h:190</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_q_d_p_order_html_a8bd0c3203ef7d283ae5ad2f0e22b9ce0"><div class="ttname"><a href="structquda_1_1clover_1_1_q_d_p_order.html#a8bd0c3203ef7d283ae5ad2f0e22b9ce0">quda::clover::QDPOrder::load</a></div><div class="ttdeci">__device__ __host__ void load(RegType v[length], int x, int parity) const</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00819">clover_field_order.h:819</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___f_l_o_a_t4___c_l_o_v_e_r___o_r_d_e_r_01_4_html_a6c4b80461c745ae6eb3bfcfd98942d10"><div class="ttname"><a href="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___f_l_o_a_t4___c_l_o_v_e_r___o_r_d_e_r_01_4.html#a6c4b80461c745ae6eb3bfcfd98942d10">quda::clover::Accessor&lt; Float, nColor, nSpin, QUDA_FLOAT4_CLOVER_ORDER &gt;::a</a></div><div class="ttdeci">Float * a</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00250">clover_field_order.h:250</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_field_order_html_aac48e9ca0e7b74e518966486cb941f2b"><div class="ttname"><a href="structquda_1_1clover_1_1_field_order.html#aac48e9ca0e7b74e518966486cb941f2b">quda::clover::FieldOrder::abs_min</a></div><div class="ttdeci">__host__ double abs_min(int dim=-1, bool global=true) const</div><div class="ttdoc">Returns the minimum absolute value of the field. </div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00519">clover_field_order.h:519</a></div></div>
<div class="ttc" id="namespacequda_1_1blas_html_a7ed3575de8e06ebadf04a1cb8ae3512e"><div class="ttname"><a href="namespacequda_1_1blas.html#a7ed3575de8e06ebadf04a1cb8ae3512e">quda::blas::bytes</a></div><div class="ttdeci">unsigned long long bytes</div><div class="ttdef"><b>Definition:</b> <a href="blas__quda_8cu_source.html#l00023">blas_quda.cu:23</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___f_l_o_a_t2___c_l_o_v_e_r___o_r_d_e_r_01_4_html_a689f2d80b0c3ccdb173c0db14d4173f0"><div class="ttname"><a href="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___f_l_o_a_t2___c_l_o_v_e_r___o_r_d_e_r_01_4.html#a689f2d80b0c3ccdb173c0db14d4173f0">quda::clover::Accessor&lt; Float, nColor, nSpin, QUDA_FLOAT2_CLOVER_ORDER &gt;::operator()</a></div><div class="ttdeci">__device__ __host__ complex&lt; Float &gt; operator()(int parity, int x, int s_row, int s_col, int c_row, int c_col) const</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00196">clover_field_order.h:196</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___p_a_c_k_e_232545b3542066bbebdd93a49a8fe0b1_html_a8929fc58b32dc05b4901cca368be6b21"><div class="ttname"><a href="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___p_a_c_k_e_232545b3542066bbebdd93a49a8fe0b1.html#a8929fc58b32dc05b4901cca368be6b21">quda::clover::Accessor&lt; Float, nColor, nSpin, QUDA_PACKED_CLOVER_ORDER &gt;::transform_reduce</a></div><div class="ttdeci">__host__ double transform_reduce(QudaFieldLocation location, helper h, reducer r, double init) const</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00345">clover_field_order.h:345</a></div></div>
<div class="ttc" id="structquda_1_1fixed_max_value_html"><div class="ttname"><a href="structquda_1_1fixed_max_value.html">quda::fixedMaxValue</a></div><div class="ttdef"><b>Definition:</b> <a href="quda__internal_8h_source.html#l00053">quda_internal.h:53</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_float_n_order_html_a4a92be20680bf82332c498da18432ead"><div class="ttname"><a href="structquda_1_1clover_1_1_float_n_order.html#a4a92be20680bf82332c498da18432ead">quda::clover::FloatNOrder::save</a></div><div class="ttdeci">void save()</div><div class="ttdoc">Backup the field to the host when tuning. </div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00755">clover_field_order.h:755</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___f_l_o_a_t4___c_l_o_v_e_r___o_r_d_e_r_01_4_html_a6018e04972cc238a5bab18a6bb923e58"><div class="ttname"><a href="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___f_l_o_a_t4___c_l_o_v_e_r___o_r_d_e_r_01_4.html#a6018e04972cc238a5bab18a6bb923e58">quda::clover::Accessor&lt; Float, nColor, nSpin, QUDA_FLOAT4_CLOVER_ORDER &gt;::operator()</a></div><div class="ttdeci">__device__ __host__ complex&lt; Float &gt; operator()(int parity, int x, int s_row, int s_col, int c_row, int c_col) const</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00258">clover_field_order.h:258</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_q_d_p_order_html_a1d374e0c56188fcfe520dd52d72e77e4"><div class="ttname"><a href="structquda_1_1clover_1_1_q_d_p_order.html#a1d374e0c56188fcfe520dd52d72e77e4">quda::clover::QDPOrder::volumeCB</a></div><div class="ttdeci">const int volumeCB</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00803">clover_field_order.h:803</a></div></div>
<div class="ttc" id="color__spinor_8h_html"><div class="ttname"><a href="color__spinor_8h.html">color_spinor.h</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___f_l_o_a_t4___c_l_o_v_e_r___o_r_d_e_r_01_4_html_ab04d28b0a50aabc5831161b2fa25b972"><div class="ttname"><a href="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___f_l_o_a_t4___c_l_o_v_e_r___o_r_d_e_r_01_4.html#ab04d28b0a50aabc5831161b2fa25b972">quda::clover::Accessor&lt; Float, nColor, nSpin, QUDA_FLOAT4_CLOVER_ORDER &gt;::stride</a></div><div class="ttdeci">int stride</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00251">clover_field_order.h:251</a></div></div>
<div class="ttc" id="namespacequda_html_ac323f3a5a3665f54d224c1427d1085e7"><div class="ttname"><a href="namespacequda.html#ac323f3a5a3665f54d224c1427d1085e7">quda::copy_and_scale</a></div><div class="ttdeci">__host__ __device__ void copy_and_scale(T1 &amp;a, const T2 &amp;b, const T3 &amp;c)</div><div class="ttdoc">Specialized variants of the copy function that include an additional scale factor. Note the scale factor is ignored unless the input type (b) is either a short or char vector. </div><div class="ttdef"><b>Definition:</b> <a href="register__traits_8h_source.html#l00249">register_traits.h:249</a></div></div>
<div class="ttc" id="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___f_l_o_a_t2___c_l_o_v_e_r___o_r_d_e_r_01_4_html_a9b2df5d6167a1a139452f30f57d35967"><div class="ttname"><a href="structquda_1_1clover_1_1_accessor_3_01_float_00_01n_color_00_01n_spin_00_01_q_u_d_a___f_l_o_a_t2___c_l_o_v_e_r___o_r_d_e_r_01_4.html#a9b2df5d6167a1a139452f30f57d35967">quda::clover::Accessor&lt; Float, nColor, nSpin, QUDA_FLOAT2_CLOVER_ORDER &gt;::a</a></div><div class="ttdeci">Float * a</div><div class="ttdef"><b>Definition:</b> <a href="clover__field__order_8h_source.html#l00188">clover_field_order.h:188</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
