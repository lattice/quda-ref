<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>QUDA: quda::clover::Accessor&lt; Float, nColor, nSpin, order &gt; Struct Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">QUDA
   &#160;<span id="projectnumber">v1.1.0</span>
   </div>
   <div id="projectbrief">A library for QCD on GPUs</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacequda.html">quda</a></li><li class="navelem"><a class="el" href="namespacequda_1_1clover.html">clover</a></li><li class="navelem"><a class="el" href="structquda_1_1clover_1_1_accessor.html">Accessor</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="structquda_1_1clover_1_1_accessor-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">quda::clover::Accessor&lt; Float, nColor, nSpin, order &gt; Struct Template Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="clover__field__order_8h_source.html">clover_field_order.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a497c61bc7b95f3f677fe1008d950d574"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structquda_1_1clover_1_1_accessor.html#a497c61bc7b95f3f677fe1008d950d574">Accessor</a> (const <a class="el" href="classquda_1_1_clover_field.html">CloverField</a> &amp;A, bool <a class="el" href="namespacequda.html#a599ff2d7aba3544b3e0559cd50861906">inverse</a>=false)</td></tr>
<tr class="separator:a497c61bc7b95f3f677fe1008d950d574"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22bdd0119157278ab658128e1e1e30e3"><td class="memItemLeft" align="right" valign="top">__device__ __host__ <a class="el" href="structquda_1_1complex.html">complex</a>&lt; Float &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structquda_1_1clover_1_1_accessor.html#a22bdd0119157278ab658128e1e1e30e3">operator()</a> (int <a class="el" href="covdev__test_8cpp.html#a5a1bb2e0fac8c62fc2ed33f5d3d3856f">parity</a>, int x, int s_row, int s_col, int c_row, int c_col) const</td></tr>
<tr class="separator:a22bdd0119157278ab658128e1e1e30e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5e6123fc8e867e8558eb916a8cc67c0"><td class="memTemplParams" colspan="2">template&lt;typename helper , typename reducer &gt; </td></tr>
<tr class="memitem:ad5e6123fc8e867e8558eb916a8cc67c0"><td class="memTemplItemLeft" align="right" valign="top">__host__ double&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="structquda_1_1clover_1_1_accessor.html#ad5e6123fc8e867e8558eb916a8cc67c0">transform_reduce</a> (<a class="el" href="enum__quda_8h.html#a8c1d7b33d5e75edf090fd5d370e88ace">QudaFieldLocation</a> location, helper h, double i, reducer r) const</td></tr>
<tr class="separator:ad5e6123fc8e867e8558eb916a8cc67c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:adc2697616f10f4f591508e3c2c7437a2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structquda_1_1complex.html">complex</a>&lt; Float &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structquda_1_1clover_1_1_accessor.html#adc2697616f10f4f591508e3c2c7437a2">dummy</a></td></tr>
<tr class="separator:adc2697616f10f4f591508e3c2c7437a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h3>template&lt;typename Float, int nColor, int nSpin, QudaCloverFieldOrder order&gt;<br />
struct quda::clover::Accessor&lt; Float, nColor, nSpin, order &gt;</h3>

<pre class="fragment">   The internal ordering for each clover matrix has chirality as the
   slowest running dimension, with the internal 36 degrees of
   freedom stored as follows (s=spin, c = color)

   i |  row  |  col  |
       s   c   s   c   z
   0   0   0   0   0   0
   1   0   1   0   1   0
   2   0   2   0   2   0
   3   1   0   1   0   0
   4   1   1   1   1   0
   5   1   2   1   2   0
   6   0   1   0   0   0
   7   0   1   0   0   1
   8   0   2   0   0   0
   9   0   2   0   0   1
   10  1   0   0   0   0
   11  1   0   0   0   1
   12  1   1   0   0   0
   13  1   1   0   0   1
   14  1   2   0   0   0
   15  1   2   0   0   1
   16  0   2   0   1   0
   17  0   2   0   1   1
   18  1   0   0   1   0
   19  1   0   0   1   1
   20  1   1   0   1   0
   21  1   1   0   1   1
   22  1   2   0   1   0
   23  1   2   0   1   1
   24  1   0   0   2   0
   25  1   0   0   2   1
   26  1   1   0   2   0
   27  1   1   0   2   1
   28  1   2   0   2   0
   29  1   2   0   2   1
   30  1   1   1   0   0
   31  1   1   1   0   1
   32  1   2   1   0   0
   33  1   2   1   0   1
   34  1   2   1   1   0
   35  1   2   1   1   1

   For each chirality the first 6 entires are the pure real
   diagonal entries.  The following 30 entries correspond to the
   15 complex numbers on the strictly lower triangular.

   E.g., N = 6 (2 spins x 3 colors) and 
   # entries = 1/2 * N * (N-1)

   The storage order on the strictly lower triangular is column
   major, which complicates the indexing, since we have to count
   backwards from the end of the array.
</pre><p> psuedo code in lieu of implementation int row = s_row*3 + c_row; int col = s_col*3 + c_col; if (row == col) { return complex(a[row]) } else if (col &lt; row) {</p>
<p>below we find the offset into each chiral half. First compute the offset into the strictly lower triangular part, counting from the lower right. This requires we change to prime coordinates. int row' = N - row; int col' = N - col;</p>
<p>The linear offset (in bottom-right coordinates) to the required element is simply 1/2*col'*(col'-1) + col - row. Subtract this offset from the number of elements: N=6, means 15 elements (14 with C-style indexing)), multiply by two to account for complexity and then add on number of real diagonals at the end </p><pre class="fragment">     int k = 2 * ( (1/2 N*(N-1) -1) - (1/2 * col' * (col'-1) + col - row) + N;
     return complex(a[2*k], a[2*k+1]);
   } else {
     conj(swap(col,row));
   }
</pre> 
<p class="definition">Definition at line <a class="el" href="clover__field__order_8h_source.html#l00168">168</a> of file <a class="el" href="clover__field__order_8h_source.html">clover_field_order.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a497c61bc7b95f3f677fe1008d950d574"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a497c61bc7b95f3f677fe1008d950d574">&#9670;&nbsp;</a></span>Accessor()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Float , int nColor, int nSpin, QudaCloverFieldOrder order&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structquda_1_1clover_1_1_accessor.html">quda::clover::Accessor</a>&lt; Float, <a class="el" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a>, nSpin, order &gt;::<a class="el" href="structquda_1_1clover_1_1_accessor.html">Accessor</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classquda_1_1_clover_field.html">CloverField</a> &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>inverse</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="clover__field__order_8h_source.html#l00170">170</a> of file <a class="el" href="clover__field__order_8h_source.html">clover_field_order.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a22bdd0119157278ab658128e1e1e30e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a22bdd0119157278ab658128e1e1e30e3">&#9670;&nbsp;</a></span>operator()()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Float , int nColor, int nSpin, QudaCloverFieldOrder order&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">__device__ __host__ <a class="el" href="structquda_1_1complex.html">complex</a>&lt;Float&gt;&amp; <a class="el" href="structquda_1_1clover_1_1_accessor.html">quda::clover::Accessor</a>&lt; Float, <a class="el" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a>, nSpin, order &gt;::operator() </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>parity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>s_row</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>s_col</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>c_row</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>c_col</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="clover__field__order_8h_source.html#l00174">174</a> of file <a class="el" href="clover__field__order_8h_source.html">clover_field_order.h</a>.</p>

</div>
</div>
<a id="ad5e6123fc8e867e8558eb916a8cc67c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5e6123fc8e867e8558eb916a8cc67c0">&#9670;&nbsp;</a></span>transform_reduce()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Float , int nColor, int nSpin, QudaCloverFieldOrder order&gt; </div>
<div class="memtemplate">
template&lt;typename helper , typename reducer &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">__host__ double <a class="el" href="structquda_1_1clover_1_1_accessor.html">quda::clover::Accessor</a>&lt; Float, <a class="el" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a>, nSpin, order &gt;::transform_reduce </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="enum__quda_8h.html#a8c1d7b33d5e75edf090fd5d370e88ace">QudaFieldLocation</a>&#160;</td>
          <td class="paramname"><em>location</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">helper&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">reducer&#160;</td>
          <td class="paramname"><em>r</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="clover__field__order_8h_source.html#l00180">180</a> of file <a class="el" href="clover__field__order_8h_source.html">clover_field_order.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="adc2697616f10f4f591508e3c2c7437a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc2697616f10f4f591508e3c2c7437a2">&#9670;&nbsp;</a></span>dummy</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Float , int nColor, int nSpin, QudaCloverFieldOrder order&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structquda_1_1complex.html">complex</a>&lt;Float&gt; <a class="el" href="structquda_1_1clover_1_1_accessor.html">quda::clover::Accessor</a>&lt; Float, <a class="el" href="covdev__test_8cpp.html#a8534bf561fd4d68d79107757d9cbac65">nColor</a>, nSpin, order &gt;::dummy</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">mutable</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="clover__field__order_8h_source.html#l00169">169</a> of file <a class="el" href="clover__field__order_8h_source.html">clover_field_order.h</a>.</p>

</div>
</div>
<hr/>The documentation for this struct was generated from the following file:<ul>
<li>quda/include/<a class="el" href="clover__field__order_8h_source.html">clover_field_order.h</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Oct 28 2021 16:10:29 for QUDA by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
