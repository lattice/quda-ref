<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>QUDA: quda/lib/blas_quda.cu Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.4 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<script type="text/javascript">
function hasClass(ele,cls) {
  return ele.className.match(new RegExp('(\\s|^)'+cls+'(\\s|$)'));
}

function addClass(ele,cls) {
  if (!this.hasClass(ele,cls)) ele.className += " "+cls;
}

function removeClass(ele,cls) {
  if (hasClass(ele,cls)) {
    var reg = new RegExp('(\\s|^)'+cls+'(\\s|$)');
    ele.className=ele.className.replace(reg,' ');
  }
}

function toggleVisibility(linkObj) {
 var base = linkObj.getAttribute('id');
 var summary = document.getElementById(base + '-summary');
 var content = document.getElementById(base + '-content');
 var trigger = document.getElementById(base + '-trigger');
 if ( hasClass(linkObj,'closed') ) {
   summary.style.display = 'none';
   content.style.display = 'block';
   trigger.src = 'open.png';
   removeClass(linkObj,'closed');
   addClass(linkObj,'opened');
 } else if ( hasClass(linkObj,'opened') ) {
   summary.style.display = 'block';
   content.style.display = 'none';
   trigger.src = 'closed.png';
   removeClass(linkObj,'opened');
   addClass(linkObj,'closed');
 }
 return false;
}
</script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">QUDA&#160;<span id="projectnumber">v0.4.0</span></div>
   <div id="projectbrief">A library for QCD on GPUs</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">quda/lib/blas_quda.cu</div>  </div>
</div>
<div class="contents">
<a href="blas__quda_8cu.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
<a name="l00002"></a>00002 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
<a name="l00003"></a>00003 
<a name="l00004"></a>00004 <span class="preprocessor">#include &lt;<a class="code" href="quda__internal_8h.html">quda_internal.h</a>&gt;</span>
<a name="l00005"></a>00005 <span class="preprocessor">#include &lt;<a class="code" href="blas__quda_8h.html">blas_quda.h</a>&gt;</span>
<a name="l00006"></a>00006 <span class="preprocessor">#include &lt;<a class="code" href="color__spinor__field_8h.html">color_spinor_field.h</a>&gt;</span>
<a name="l00007"></a>00007 <span class="preprocessor">#include &lt;<a class="code" href="face__quda_8h.html">face_quda.h</a>&gt;</span> <span class="comment">// this is where the MPI / QMP depdendent code is</span>
<a name="l00008"></a>00008 
<a name="l00009"></a><a class="code" href="blas__quda_8cu.html#a5b3deb2017936fc0e42564e146d08a8d">00009</a> <span class="preprocessor">#define REDUCE_MAX_BLOCKS 65536</span>
<a name="l00010"></a>00010 <span class="preprocessor"></span>
<a name="l00011"></a>00011 <span class="preprocessor">#if (__COMPUTE_CAPABILITY__ &gt;= 130)</span>
<a name="l00012"></a>00012 <span class="preprocessor"></span><span class="preprocessor">#define QudaSumFloat double</span>
<a name="l00013"></a>00013 <span class="preprocessor"></span><span class="preprocessor">#define QudaSumFloat2 double2</span>
<a name="l00014"></a>00014 <span class="preprocessor"></span><span class="preprocessor">#define QudaSumFloat3 double3</span>
<a name="l00015"></a>00015 <span class="preprocessor"></span><span class="preprocessor">#else</span>
<a name="l00016"></a><a class="code" href="blas__quda_8cu.html#a9f355a73ef38f9719bcc254c8454342e">00016</a> <span class="preprocessor"></span><span class="preprocessor">#define QudaSumFloat doublesingle</span>
<a name="l00017"></a><a class="code" href="blas__quda_8cu.html#ae90dc53b7a2a28c799aa31ddcca2ac9d">00017</a> <span class="preprocessor"></span><span class="preprocessor">#define QudaSumFloat2 doublesingle2</span>
<a name="l00018"></a><a class="code" href="blas__quda_8cu.html#a03ab09c152271b9c593c8b51b2c62e57">00018</a> <span class="preprocessor"></span><span class="preprocessor">#define QudaSumFloat3 doublesingle3</span>
<a name="l00019"></a>00019 <span class="preprocessor"></span><span class="preprocessor">#include &lt;<a class="code" href="double__single_8h.html">double_single.h</a>&gt;</span>
<a name="l00020"></a>00020 <span class="preprocessor">#endif</span>
<a name="l00021"></a>00021 <span class="preprocessor"></span>
<a name="l00022"></a>00022 <span class="comment">// These are used for reduction kernels</span>
<a name="l00023"></a>00023 <span class="keyword">static</span> <a class="code" href="blas__quda_8cu.html#a9f355a73ef38f9719bcc254c8454342e">QudaSumFloat</a> *d_reduce=0;
<a name="l00024"></a>00024 <span class="keyword">static</span> <a class="code" href="blas__quda_8cu.html#a9f355a73ef38f9719bcc254c8454342e">QudaSumFloat</a> *h_reduce=0;
<a name="l00025"></a>00025 <span class="keyword">static</span> <a class="code" href="blas__quda_8cu.html#a9f355a73ef38f9719bcc254c8454342e">QudaSumFloat</a> *hd_reduce=0;
<a name="l00026"></a>00026 <span class="keyword">static</span> cudaEvent_t reduceEnd;
<a name="l00027"></a>00027 
<a name="l00028"></a>00028 <span class="keyword">namespace </span>quda {
<a name="l00029"></a><a class="code" href="namespacequda.html#abe0bc62507a413541146ddf10fe00b2f">00029</a>   <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <a class="code" href="namespacequda.html#abe0bc62507a413541146ddf10fe00b2f">blas_flops</a>;
<a name="l00030"></a><a class="code" href="namespacequda.html#a9bbafb88e524c86ba71c0e549ded05f2">00030</a>   <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <a class="code" href="namespacequda.html#a9bbafb88e524c86ba71c0e549ded05f2">blas_bytes</a>;
<a name="l00031"></a>00031 }
<a name="l00032"></a>00032 
<a name="l00033"></a>00033 <span class="preprocessor">#include &lt;<a class="code" href="float__vector_8h.html">float_vector.h</a>&gt;</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &lt;<a class="code" href="texture_8h.html">texture.h</a>&gt;</span>
<a name="l00035"></a>00035 
<a name="l00036"></a>00036 <span class="preprocessor">#include &lt;<a class="code" href="tune__quda_8h.html">tune_quda.h</a>&gt;</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include &lt;typeinfo&gt;</span>
<a name="l00038"></a>00038 
<a name="l00039"></a><a class="code" href="blas__quda_8cu.html#ad9bb2a4ae86205d128c2a238b486e755">00039</a> <span class="keywordtype">void</span> <a class="code" href="blas__quda_8h.html#ad9bb2a4ae86205d128c2a238b486e755">zeroCuda</a>(<a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a> &amp;a) { a.<a class="code" href="classcuda_color_spinor_field.html#a37c66bbef37d1ab3543ce315cc4a3a07">zero</a>(); }
<a name="l00040"></a>00040 
<a name="l00041"></a><a class="code" href="blas__quda_8cu.html#ae3e92b9a11a1f48cf1a48118e927a215">00041</a> <span class="preprocessor">#define checkSpinor(a, b)                                               \</span>
<a name="l00042"></a>00042 <span class="preprocessor">  {                                                                     \</span>
<a name="l00043"></a>00043 <span class="preprocessor">    if (a.Precision() != b.Precision())                                 \</span>
<a name="l00044"></a>00044 <span class="preprocessor">      errorQuda(&quot;precisions do not match: %d %d&quot;, a.Precision(), b.Precision()); \</span>
<a name="l00045"></a>00045 <span class="preprocessor">    if (a.Length() != b.Length())                                       \</span>
<a name="l00046"></a>00046 <span class="preprocessor">      errorQuda(&quot;lengths do not match: %d %d&quot;, a.Length(), b.Length()); \</span>
<a name="l00047"></a>00047 <span class="preprocessor">    if (a.Stride() != b.Stride())                                       \</span>
<a name="l00048"></a>00048 <span class="preprocessor">      errorQuda(&quot;strides do not match: %d %d&quot;, a.Stride(), b.Stride()); \</span>
<a name="l00049"></a>00049 <span class="preprocessor">  }</span>
<a name="l00050"></a>00050 <span class="preprocessor"></span>
<a name="l00051"></a>00051 <span class="comment">// For kernels with precision conversion built in</span>
<a name="l00052"></a><a class="code" href="blas__quda_8cu.html#a0cda1598e8589e2d66cf24e566e74fa8">00052</a> <span class="preprocessor">#define checkSpinorLength(a, b)                                         \</span>
<a name="l00053"></a>00053 <span class="preprocessor">  {                                                                     \</span>
<a name="l00054"></a>00054 <span class="preprocessor">    if (a.Length() != b.Length())                                       \</span>
<a name="l00055"></a>00055 <span class="preprocessor">      errorQuda(&quot;lengths do not match: %d %d&quot;, a.Length(), b.Length()); \</span>
<a name="l00056"></a>00056 <span class="preprocessor">    if (a.Stride() != b.Stride())                                       \</span>
<a name="l00057"></a>00057 <span class="preprocessor">      errorQuda(&quot;strides do not match: %d %d&quot;, a.Stride(), b.Stride()); \</span>
<a name="l00058"></a>00058 <span class="preprocessor">  }</span>
<a name="l00059"></a>00059 <span class="preprocessor"></span>
<a name="l00060"></a>00060 <span class="comment">// blasTuning = 1 turns off error checking</span>
<a name="l00061"></a>00061 <span class="keyword">static</span> <a class="code" href="enum__quda_8h.html#ae1992c8a469e4979a23f6177d8058a21">QudaTune</a> blasTuning = <a class="code" href="enum__quda_8h.html#ab692679068e8ef209853c1ee7e9f1f89a84cd8a855debe802a41b6782d056cc51">QUDA_TUNE_NO</a>;
<a name="l00062"></a>00062 <span class="keyword">static</span> <a class="code" href="enum__quda_8h.html#a548da41d47a2128b7462a3595297ac76">QudaVerbosity</a> verbosity = <a class="code" href="enum__quda_8h.html#a49355eae66447edf8f077f2dc5e214c6a04424f5d2f1159bf7192a800039dc031">QUDA_SILENT</a>;
<a name="l00063"></a>00063 
<a name="l00064"></a>00064 <span class="keyword">static</span> cudaStream_t *blasStream;
<a name="l00065"></a>00065 
<a name="l00066"></a>00066 <span class="keyword">static</span> <span class="keyword">struct </span>{
<a name="l00067"></a><a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">00067</a>   <span class="keywordtype">int</span> <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>[<a class="code" href="color__spinor__field_8h.html#aa69925e50554e0ea81dd89fdcb572bbc">QUDA_MAX_DIM</a>];
<a name="l00068"></a><a class="code" href="blas__quda_8cu.html#a08f66a6870d87afcd5dc1b60d1019692">00068</a>   <span class="keywordtype">int</span> <a class="code" href="blas__quda_8cu.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>;
<a name="l00069"></a>00069 } blasConstants;
<a name="l00070"></a>00070 
<a name="l00071"></a>00071 <span class="keyword">namespace </span>quda {
<a name="l00072"></a>00072 
<a name="l00073"></a><a class="code" href="namespacequda.html#a5750bde990ed86c682761df118bd63c4">00073</a> <span class="keywordtype">void</span> <a class="code" href="namespacequda.html#a5750bde990ed86c682761df118bd63c4">initBlas</a>()
<a name="l00074"></a>00074 { 
<a name="l00075"></a>00075   <span class="comment">// reduction buffer size</span>
<a name="l00076"></a>00076   <span class="keywordtype">size_t</span> bytes = 3*<a class="code" href="blas__quda_8cu.html#a5b3deb2017936fc0e42564e146d08a8d">REDUCE_MAX_BLOCKS</a>*<span class="keyword">sizeof</span>(<a class="code" href="blas__quda_8cu.html#a9f355a73ef38f9719bcc254c8454342e">QudaSumFloat</a>);
<a name="l00077"></a>00077 
<a name="l00078"></a>00078   <span class="keywordflow">if</span> (!d_reduce) {
<a name="l00079"></a>00079     <span class="keywordflow">if</span> (cudaMalloc((<span class="keywordtype">void</span>**) &amp;d_reduce, bytes) == cudaErrorMemoryAllocation) {
<a name="l00080"></a>00080       <a class="code" href="util__quda_8h.html#af3bddfd9d113d50e8e0bbf58a35c5aac">errorQuda</a>(<span class="stringliteral">&quot;Error allocating device reduction array&quot;</span>);
<a name="l00081"></a>00081     }
<a name="l00082"></a>00082   }
<a name="l00083"></a>00083 
<a name="l00084"></a>00084   <span class="comment">// these arrays are acutally oversized currently (only needs to be QudaSumFloat3)</span>
<a name="l00085"></a>00085 
<a name="l00086"></a>00086   <span class="comment">// if the device supports host-mapped memory then use a host-mapped array for the reduction</span>
<a name="l00087"></a>00087   <span class="keywordflow">if</span>(<a class="code" href="quda__internal_8h.html#abc437f342049ab295e33fd1f4b74c46d">deviceProp</a>.canMapHostMemory) {
<a name="l00088"></a>00088     <span class="keywordflow">if</span> (!h_reduce) {
<a name="l00089"></a>00089       <span class="keywordflow">if</span> (cudaHostAlloc((<span class="keywordtype">void</span>**) &amp;h_reduce, bytes, cudaHostAllocMapped) == cudaErrorMemoryAllocation) {
<a name="l00090"></a>00090         <a class="code" href="util__quda_8h.html#af3bddfd9d113d50e8e0bbf58a35c5aac">errorQuda</a>(<span class="stringliteral">&quot;Error allocating host reduction array&quot;</span>);
<a name="l00091"></a>00091       }
<a name="l00092"></a>00092       
<a name="l00093"></a>00093       <span class="comment">// set the matching device pointer</span>
<a name="l00094"></a>00094       cudaHostGetDevicePointer(&amp;hd_reduce, h_reduce, 0);
<a name="l00095"></a>00095     }
<a name="l00096"></a>00096 
<a name="l00097"></a>00097   } <span class="keywordflow">else</span> {
<a name="l00098"></a>00098 
<a name="l00099"></a>00099     <span class="keywordflow">if</span> (!h_reduce) {
<a name="l00100"></a>00100       <span class="keywordflow">if</span> (cudaMallocHost((<span class="keywordtype">void</span>**) &amp;h_reduce, bytes) == cudaErrorMemoryAllocation) {
<a name="l00101"></a>00101         <a class="code" href="util__quda_8h.html#af3bddfd9d113d50e8e0bbf58a35c5aac">errorQuda</a>(<span class="stringliteral">&quot;Error allocating host reduction array&quot;</span>);
<a name="l00102"></a>00102       }
<a name="l00103"></a>00103     }
<a name="l00104"></a>00104 
<a name="l00105"></a>00105     hd_reduce = d_reduce;
<a name="l00106"></a>00106   }
<a name="l00107"></a>00107 
<a name="l00108"></a>00108   blasStream = &amp;<a class="code" href="quda__internal_8h.html#a0bf27533c025df9eb1aa7deb98a6fd02">streams</a>[<a class="code" href="quda__internal_8h.html#a61088cc1c59425148ebcc48075ff6b60">Nstream</a>-1];
<a name="l00109"></a>00109   cudaEventCreateWithFlags(&amp;reduceEnd, cudaEventDisableTiming);
<a name="l00110"></a>00110 
<a name="l00111"></a>00111   <a class="code" href="util__quda_8h.html#a7668e6580e0f57b0db3112fae4959e34">checkCudaError</a>();
<a name="l00112"></a>00112 }
<a name="l00113"></a>00113 
<a name="l00114"></a>00114 
<a name="l00115"></a><a class="code" href="namespacequda.html#acdf87b5163c14cda9f75c0989028b271">00115</a> <span class="keywordtype">void</span> <a class="code" href="namespacequda.html#acdf87b5163c14cda9f75c0989028b271">endBlas</a>(<span class="keywordtype">void</span>)
<a name="l00116"></a>00116 {
<a name="l00117"></a>00117   <span class="keywordflow">if</span> (d_reduce) {
<a name="l00118"></a>00118     cudaFree(d_reduce);
<a name="l00119"></a>00119     d_reduce = 0;
<a name="l00120"></a>00120   }
<a name="l00121"></a>00121 
<a name="l00122"></a>00122   <span class="keywordflow">if</span> (h_reduce) {
<a name="l00123"></a>00123     cudaFreeHost(h_reduce);
<a name="l00124"></a>00124     h_reduce = 0;
<a name="l00125"></a>00125   }
<a name="l00126"></a>00126 
<a name="l00127"></a>00127   hd_reduce = 0;
<a name="l00128"></a>00128 
<a name="l00129"></a>00129   cudaEventDestroy(reduceEnd);
<a name="l00130"></a>00130 }
<a name="l00131"></a>00131 
<a name="l00132"></a><a class="code" href="namespacequda.html#a8e1707aa6ebdccc97b153e4c129725a3">00132</a> <span class="keywordtype">void</span> <a class="code" href="namespacequda.html#a8e1707aa6ebdccc97b153e4c129725a3">setBlasTuning</a>(<a class="code" href="enum__quda_8h.html#ae1992c8a469e4979a23f6177d8058a21">QudaTune</a> <a class="code" href="staggered__dslash__test_8cpp.html#a10c8ecd1e18b84f28bcd500d0476995d">tune</a>, <a class="code" href="enum__quda_8h.html#a548da41d47a2128b7462a3595297ac76">QudaVerbosity</a> verbose)
<a name="l00133"></a>00133 {
<a name="l00134"></a>00134   blasTuning = <a class="code" href="staggered__dslash__test_8cpp.html#a10c8ecd1e18b84f28bcd500d0476995d">tune</a>;
<a name="l00135"></a>00135   verbosity = verbose;
<a name="l00136"></a>00136 }
<a name="l00137"></a>00137 
<a name="l00138"></a>00138 } <span class="comment">// namespace quda</span>
<a name="l00139"></a>00139 
<a name="l00140"></a>00140 <span class="comment">// FIXME: this should be queried from the device</span>
<a name="l00141"></a>00141 <span class="preprocessor">#if (__COMPUTE_CAPACITY__ &lt; 200)</span>
<a name="l00142"></a><a class="code" href="blas__quda_8cu.html#a937069a03b0b7d8a6dd102c5e20a3e64">00142</a> <span class="preprocessor"></span><span class="preprocessor">#define MAX_BLOCK 512</span>
<a name="l00143"></a>00143 <span class="preprocessor"></span><span class="preprocessor">#else</span>
<a name="l00144"></a>00144 <span class="preprocessor"></span><span class="preprocessor">#define MAX_BLOCK 1024</span>
<a name="l00145"></a>00145 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00146"></a>00146 <span class="preprocessor"></span>
<a name="l00147"></a>00147 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> FloatN, <span class="keywordtype">int</span> N, <span class="keyword">typename</span> Output, <span class="keyword">typename</span> Input&gt;
<a name="l00148"></a><a class="code" href="blas__quda_8cu.html#a5f695104a31e663c6def7ad4d3fa78cc">00148</a> __global__ <span class="keywordtype">void</span> <a class="code" href="blas__quda_8cu.html#a5f695104a31e663c6def7ad4d3fa78cc">copyKernel</a>(Output Y, Input <a class="code" href="dw__dslash__core_8h.html#a80c0944640e62d3ed6c5419c1bcc0c88">X</a>, <span class="keywordtype">int</span> <a class="code" href="gauge__force__test_8cpp.html#a2bcd2adde36b870d02897e694ecc39cb">length</a>) {
<a name="l00149"></a>00149   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = blockIdx.x*(blockDim.x) + threadIdx.x;
<a name="l00150"></a>00150   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> gridSize = gridDim.x*blockDim.x;
<a name="l00151"></a>00151 
<a name="l00152"></a>00152   while (i &lt; length) {
<a name="l00153"></a>00153     <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>[N];
<a name="l00154"></a>00154     X.load(x, i);
<a name="l00155"></a>00155     Y.save(x, i);
<a name="l00156"></a>00156     i += gridSize;
<a name="l00157"></a>00157   }
<a name="l00158"></a>00158 }
<a name="l00159"></a>00159 
<a name="l00160"></a>00160 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> FloatN, <span class="keywordtype">int</span> N, <span class="keyword">typename</span> Output, <span class="keyword">typename</span> Input&gt;
<a name="l00161"></a><a class="code" href="class_copy_cuda.html">00161</a> <span class="keyword">class </span><a class="code" href="class_copy_cuda.html">CopyCuda</a> : <span class="keyword">public</span> <a class="code" href="class_tunable.html">Tunable</a> {
<a name="l00162"></a>00162 
<a name="l00163"></a>00163 <span class="keyword">private</span>:
<a name="l00164"></a>00164   Input &amp;X;
<a name="l00165"></a>00165   Output &amp;Y;
<a name="l00166"></a>00166   <span class="keyword">const</span> <span class="keywordtype">int</span> length;
<a name="l00167"></a>00167 
<a name="l00168"></a>00168   <span class="keywordtype">int</span> sharedBytesPerThread()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> 0; }
<a name="l00169"></a>00169   <span class="keywordtype">int</span> sharedBytesPerBlock()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> 0; }
<a name="l00170"></a>00170 
<a name="l00171"></a>00171   <span class="keyword">virtual</span> <span class="keywordtype">bool</span> advanceSharedBytes(<a class="code" href="class_tune_param.html">TuneParam</a> &amp;<a class="code" href="pack__test_8cpp.html#aba126262dff054e28bac5c0d901769c8">param</a>)<span class="keyword"> const</span>
<a name="l00172"></a>00172 <span class="keyword">  </span>{
<a name="l00173"></a>00173     <a class="code" href="class_tune_param.html">TuneParam</a> next(param);
<a name="l00174"></a>00174     <a class="code" href="class_tunable.html#a17057def4d9c3439829d6e79d9507aed">advanceBlockDim</a>(next); <span class="comment">// to get next blockDim</span>
<a name="l00175"></a>00175     <span class="keywordtype">int</span> nthreads = next.<a class="code" href="class_tune_param.html#a6c11885d3e6304bf22e9c9108006fd78">block</a>.x * next.<a class="code" href="class_tune_param.html#a6c11885d3e6304bf22e9c9108006fd78">block</a>.y * next.<a class="code" href="class_tune_param.html#a6c11885d3e6304bf22e9c9108006fd78">block</a>.z;
<a name="l00176"></a>00176     param.<a class="code" href="class_tune_param.html#abfe0c4e731cdfe25ccaf4370087a4ef5">shared_bytes</a> = sharedBytesPerThread()*nthreads &gt; sharedBytesPerBlock() ?
<a name="l00177"></a>00177       sharedBytesPerThread()*nthreads : sharedBytesPerBlock();
<a name="l00178"></a>00178     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00179"></a>00179   }
<a name="l00180"></a>00180 
<a name="l00181"></a>00181 <span class="keyword">public</span>:
<a name="l00182"></a><a class="code" href="class_copy_cuda.html#a1219c569e3e91b56ba0aaf85a5e0034a">00182</a>   <a class="code" href="class_copy_cuda.html#a1219c569e3e91b56ba0aaf85a5e0034a">CopyCuda</a>(Output &amp;Y, Input &amp;X, <span class="keywordtype">int</span> length) : X(X), Y(Y), length(length) { ; }
<a name="l00183"></a><a class="code" href="class_copy_cuda.html#aea1583aec9998ebb32f142b8cdbc6ca7">00183</a>   <span class="keyword">virtual</span> <a class="code" href="class_copy_cuda.html#aea1583aec9998ebb32f142b8cdbc6ca7">~CopyCuda</a>() { ; }
<a name="l00184"></a>00184 
<a name="l00185"></a><a class="code" href="class_copy_cuda.html#a28cbdc6c51e1eb626497fefd2205867d">00185</a>   <a class="code" href="class_tune_key.html">TuneKey</a> <a class="code" href="class_copy_cuda.html#a28cbdc6c51e1eb626497fefd2205867d">tuneKey</a>()<span class="keyword"> const </span>{
<a name="l00186"></a>00186     std::stringstream vol, <a class="code" href="tm__dslash__dagger__fermi__core_8h.html#a13307a0c81bbf19030ea4732534efbec">aux</a>;
<a name="l00187"></a>00187     vol &lt;&lt; blasConstants.x[0] &lt;&lt; <span class="stringliteral">&quot;x&quot;</span>;
<a name="l00188"></a>00188     vol &lt;&lt; blasConstants.x[1] &lt;&lt; <span class="stringliteral">&quot;x&quot;</span>;
<a name="l00189"></a>00189     vol &lt;&lt; blasConstants.x[2] &lt;&lt; <span class="stringliteral">&quot;x&quot;</span>;
<a name="l00190"></a>00190     vol &lt;&lt; blasConstants.x[3];
<a name="l00191"></a>00191     aux &lt;&lt; <span class="stringliteral">&quot;stride=&quot;</span> &lt;&lt; blasConstants.stride &lt;&lt; <span class="stringliteral">&quot;,out_prec=&quot;</span> &lt;&lt; Y.Precision() &lt;&lt; <span class="stringliteral">&quot;,in_prec=&quot;</span> &lt;&lt; X.Precision();
<a name="l00192"></a>00192     <span class="keywordflow">return</span> <a class="code" href="class_tune_key.html">TuneKey</a>(vol.str(), <span class="stringliteral">&quot;copyKernel&quot;</span>, aux.str());
<a name="l00193"></a>00193   }  
<a name="l00194"></a>00194 
<a name="l00195"></a><a class="code" href="class_copy_cuda.html#a46761e36263360f392657e9fe112686a">00195</a>   <span class="keywordtype">void</span> <a class="code" href="class_copy_cuda.html#a46761e36263360f392657e9fe112686a">apply</a>(<span class="keyword">const</span> cudaStream_t &amp;<a class="code" href="face__mpi_8cpp.html#a9f4fd0b5397f65cf8963d5001f0001f3">stream</a>) {
<a name="l00196"></a>00196     <a class="code" href="class_tune_param.html">TuneParam</a> tp = <a class="code" href="tune__quda_8h.html#aa41892b4ef1d7ebd4a833d14115dd88a">tuneLaunch</a>(*<span class="keyword">this</span>, blasTuning, verbosity);
<a name="l00197"></a>00197     copyKernel&lt;FloatN, N&gt;&lt;&lt;&lt;tp.<a class="code" href="class_tune_param.html#a8cff46997e2a12c47f25a5f617559376">grid</a>, tp.<a class="code" href="class_tune_param.html#a6c11885d3e6304bf22e9c9108006fd78">block</a>, tp.<a class="code" href="class_tune_param.html#abfe0c4e731cdfe25ccaf4370087a4ef5">shared_bytes</a>, stream&gt;&gt;&gt;(Y, X, length);
<a name="l00198"></a>00198   }
<a name="l00199"></a>00199 
<a name="l00200"></a><a class="code" href="class_copy_cuda.html#a81ac2f87dca72afab19037c3094d601f">00200</a>   <span class="keywordtype">void</span> <a class="code" href="class_copy_cuda.html#a81ac2f87dca72afab19037c3094d601f">preTune</a>() { ; } <span class="comment">// no need to save state for copy kernels</span>
<a name="l00201"></a><a class="code" href="class_copy_cuda.html#ab156db232eca52316f42100a2792d176">00201</a>   <span class="keywordtype">void</span> <a class="code" href="class_copy_cuda.html#ab156db232eca52316f42100a2792d176">postTune</a>() { ; } <span class="comment">// no need to restore state for copy kernels</span>
<a name="l00202"></a>00202 
<a name="l00203"></a><a class="code" href="class_copy_cuda.html#ada94df064c75954ef809fe34c4ede7f9">00203</a>   <span class="keywordtype">long</span> <span class="keywordtype">long</span> <a class="code" href="class_copy_cuda.html#ada94df064c75954ef809fe34c4ede7f9">flops</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> 0; }
<a name="l00204"></a><a class="code" href="class_copy_cuda.html#adf37e18e3cf259969e3bf5b8c79da404">00204</a>   <span class="keywordtype">long</span> <span class="keywordtype">long</span> <a class="code" href="class_copy_cuda.html#adf37e18e3cf259969e3bf5b8c79da404">bytes</a>()<span class="keyword"> const </span>{ 
<a name="l00205"></a>00205     <span class="keyword">const</span> <span class="keywordtype">int</span> Ninternal = (<span class="keyword">sizeof</span>(<a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a>)/<span class="keyword">sizeof</span>(((<a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a>*)0)-&gt;x))*N;
<a name="l00206"></a>00206     <span class="keywordtype">size_t</span> <a class="code" href="class_copy_cuda.html#adf37e18e3cf259969e3bf5b8c79da404">bytes</a> = (X.Precision() + Y.Precision())*Ninternal;
<a name="l00207"></a>00207     <span class="keywordflow">if</span> (X.Precision() == <a class="code" href="enum__quda_8h.html#ac166c47d6ef16f830c164fefe6c8ab90afb568427ae928d5a1330ee47ef03c0b6">QUDA_HALF_PRECISION</a>) bytes += <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>);
<a name="l00208"></a>00208     <span class="keywordflow">if</span> (Y.Precision() == <a class="code" href="enum__quda_8h.html#ac166c47d6ef16f830c164fefe6c8ab90afb568427ae928d5a1330ee47ef03c0b6">QUDA_HALF_PRECISION</a>) bytes += <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>);
<a name="l00209"></a>00209     <span class="keywordflow">return</span> bytes*length; 
<a name="l00210"></a>00210   }
<a name="l00211"></a>00211 };
<a name="l00212"></a>00212 
<a name="l00213"></a>00213 
<a name="l00214"></a><a class="code" href="blas__quda_8cu.html#aeb1c1a9ddc56be6afcca252fcaec019d">00214</a> <span class="keywordtype">void</span> <a class="code" href="blas__quda_8h.html#aeb1c1a9ddc56be6afcca252fcaec019d">copyCuda</a>(<a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a> &amp;dst, <span class="keyword">const</span> <a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a> &amp;src) {
<a name="l00215"></a>00215   <span class="keywordflow">if</span> (&amp;src == &amp;dst) <span class="keywordflow">return</span>; <span class="comment">// aliasing fields</span>
<a name="l00216"></a>00216   <span class="keywordflow">if</span> (src.<a class="code" href="class_color_spinor_field.html#abdd88a39f9f275bf5459ba34f4f3f0ae">Nspin</a>() != 1 &amp;&amp; src.<a class="code" href="class_color_spinor_field.html#abdd88a39f9f275bf5459ba34f4f3f0ae">Nspin</a>() != 4) <a class="code" href="util__quda_8h.html#af3bddfd9d113d50e8e0bbf58a35c5aac">errorQuda</a>(<span class="stringliteral">&quot;nSpin(%d) not supported\n&quot;</span>, src.<a class="code" href="class_color_spinor_field.html#abdd88a39f9f275bf5459ba34f4f3f0ae">Nspin</a>());
<a name="l00217"></a>00217 
<a name="l00218"></a>00218   <span class="keywordflow">if</span> (dst.<a class="code" href="class_color_spinor_field.html#a4b9679eaf4561f53eef15e02f6631c44">SiteSubset</a>() == <a class="code" href="enum__quda_8h.html#a4a68299802e87f91497af7e70585d4daa68af501cdf082bcfa0b242115cdfb581">QUDA_FULL_SITE_SUBSET</a> || src.<a class="code" href="class_color_spinor_field.html#a4b9679eaf4561f53eef15e02f6631c44">SiteSubset</a>() == <a class="code" href="enum__quda_8h.html#a4a68299802e87f91497af7e70585d4daa68af501cdf082bcfa0b242115cdfb581">QUDA_FULL_SITE_SUBSET</a>) {
<a name="l00219"></a>00219     <a class="code" href="blas__quda_8h.html#aeb1c1a9ddc56be6afcca252fcaec019d">copyCuda</a>(dst.<a class="code" href="classcuda_color_spinor_field.html#a57eb1e0a776ddaa75c31688abe2d81f9">Even</a>(), src.<a class="code" href="classcuda_color_spinor_field.html#a57eb1e0a776ddaa75c31688abe2d81f9">Even</a>());
<a name="l00220"></a>00220     <a class="code" href="blas__quda_8h.html#aeb1c1a9ddc56be6afcca252fcaec019d">copyCuda</a>(dst.<a class="code" href="classcuda_color_spinor_field.html#a1e4a9d8468cf19e2b6ea20cd97d10572">Odd</a>(), src.<a class="code" href="classcuda_color_spinor_field.html#a1e4a9d8468cf19e2b6ea20cd97d10572">Odd</a>());
<a name="l00221"></a>00221     <span class="keywordflow">return</span>;
<a name="l00222"></a>00222   }
<a name="l00223"></a>00223 
<a name="l00224"></a>00224   <a class="code" href="blas__quda_8cu.html#a0cda1598e8589e2d66cf24e566e74fa8">checkSpinorLength</a>(dst, src);
<a name="l00225"></a>00225 
<a name="l00226"></a>00226   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d=0; d&lt;<a class="code" href="color__spinor__field_8h.html#aa69925e50554e0ea81dd89fdcb572bbc">QUDA_MAX_DIM</a>; d++) blasConstants.x[d] = src.<a class="code" href="class_color_spinor_field.html#aaf5ee486fa12de120bfa9367056b96d5">X</a>()[d];
<a name="l00227"></a>00227   blasConstants.stride = src.<a class="code" href="class_color_spinor_field.html#aa0100678a81f4c208f3138ae19366890">Stride</a>();
<a name="l00228"></a>00228 
<a name="l00229"></a>00229   <span class="comment">// For a given dst precision, there are two non-trivial possibilities for the</span>
<a name="l00230"></a>00230   <span class="comment">// src precision.</span>
<a name="l00231"></a>00231 
<a name="l00232"></a>00232   <a class="code" href="namespacequda.html#a9bbafb88e524c86ba71c0e549ded05f2">quda::blas_bytes</a> += src.<a class="code" href="class_color_spinor_field.html#ae4e0bcc581e2d259499aff1a0f658294">RealLength</a>()*((int)src.<a class="code" href="class_color_spinor_field.html#a2bbecf6511b79c04c24431e28d45acfc">Precision</a>() + (int)dst.<a class="code" href="class_color_spinor_field.html#a2bbecf6511b79c04c24431e28d45acfc">Precision</a>());
<a name="l00233"></a>00233 
<a name="l00234"></a>00234   <a class="code" href="class_tunable.html">Tunable</a> *copy = 0;
<a name="l00235"></a>00235 
<a name="l00236"></a>00236   <span class="keywordflow">if</span> (dst.<a class="code" href="class_color_spinor_field.html#a2bbecf6511b79c04c24431e28d45acfc">Precision</a>() == <a class="code" href="enum__quda_8h.html#ac166c47d6ef16f830c164fefe6c8ab90a6288ca4c9d3166592676284c7d886972">QUDA_DOUBLE_PRECISION</a> &amp;&amp; src.<a class="code" href="class_color_spinor_field.html#a2bbecf6511b79c04c24431e28d45acfc">Precision</a>() == <a class="code" href="enum__quda_8h.html#ac166c47d6ef16f830c164fefe6c8ab90a8edc95cbc07156d848030900d84a09e0">QUDA_SINGLE_PRECISION</a>) {
<a name="l00237"></a>00237     <span class="keywordflow">if</span> (src.<a class="code" href="class_color_spinor_field.html#abdd88a39f9f275bf5459ba34f4f3f0ae">Nspin</a>() == 4){
<a name="l00238"></a>00238       <a class="code" href="class_spinor_texture.html">SpinorTexture&lt;float4, float4, float4, 6, 0&gt;</a> src_tex(src);
<a name="l00239"></a>00239       <a class="code" href="class_spinor.html">Spinor&lt;float4, float2, double2, 6&gt;</a> dst_spinor(dst);
<a name="l00240"></a>00240       copy = <span class="keyword">new</span> <a class="code" href="class_copy_cuda.html">CopyCuda&lt;float4, 6, Spinor&lt;float4, float2, double2, 6&gt;</a>, 
<a name="l00241"></a>00241                           <a class="code" href="class_spinor_texture.html">SpinorTexture&lt;float4, float4, float4, 6, 0&gt;</a> &gt;
<a name="l00242"></a>00242         (dst_spinor, src_tex, src.<a class="code" href="class_color_spinor_field.html#aa0100678a81f4c208f3138ae19366890">Stride</a>());
<a name="l00243"></a>00243     } <span class="keywordflow">else</span> { <span class="comment">//src.Nspin() == 1</span>
<a name="l00244"></a>00244       <a class="code" href="class_spinor_texture.html">SpinorTexture&lt;float2, float2, float2, 3, 0&gt;</a> src_tex(src);
<a name="l00245"></a>00245       <a class="code" href="class_spinor.html">Spinor&lt;float2, float2, double2, 3&gt;</a> dst_spinor(dst);
<a name="l00246"></a>00246       copy = <span class="keyword">new</span> <a class="code" href="class_copy_cuda.html">CopyCuda&lt;float2, 3, Spinor&lt;float2, float2, double2, 3&gt;</a>,
<a name="l00247"></a>00247                           <a class="code" href="class_spinor_texture.html">SpinorTexture&lt;float2, float2, float2, 3, 0&gt;</a> &gt;
<a name="l00248"></a>00248         (dst_spinor, src_tex, src.<a class="code" href="class_color_spinor_field.html#aa0100678a81f4c208f3138ae19366890">Stride</a>());
<a name="l00249"></a>00249     }
<a name="l00250"></a>00250 
<a name="l00251"></a>00251   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dst.<a class="code" href="class_color_spinor_field.html#a2bbecf6511b79c04c24431e28d45acfc">Precision</a>() == <a class="code" href="enum__quda_8h.html#ac166c47d6ef16f830c164fefe6c8ab90a8edc95cbc07156d848030900d84a09e0">QUDA_SINGLE_PRECISION</a> &amp;&amp; src.<a class="code" href="class_color_spinor_field.html#a2bbecf6511b79c04c24431e28d45acfc">Precision</a>() == <a class="code" href="enum__quda_8h.html#ac166c47d6ef16f830c164fefe6c8ab90a6288ca4c9d3166592676284c7d886972">QUDA_DOUBLE_PRECISION</a>) {
<a name="l00252"></a>00252     <span class="keywordflow">if</span> (src.<a class="code" href="class_color_spinor_field.html#abdd88a39f9f275bf5459ba34f4f3f0ae">Nspin</a>() == 4){
<a name="l00253"></a>00253       <a class="code" href="class_spinor_texture.html">SpinorTexture&lt;float4, float2, double2, 6, 0&gt;</a> src_tex(src);
<a name="l00254"></a>00254       <a class="code" href="class_spinor.html">Spinor&lt;float4, float4, float4, 6&gt;</a> dst_spinor(dst);
<a name="l00255"></a>00255       copy = <span class="keyword">new</span> <a class="code" href="class_copy_cuda.html">CopyCuda&lt;float4, 6, Spinor&lt;float4, float4, float4, 6&gt;</a>,
<a name="l00256"></a>00256                           <a class="code" href="class_spinor_texture.html">SpinorTexture&lt;float4, float2, double2, 6, 0&gt;</a> &gt;
<a name="l00257"></a>00257         (dst_spinor, src_tex, src.<a class="code" href="class_color_spinor_field.html#aa0100678a81f4c208f3138ae19366890">Stride</a>());
<a name="l00258"></a>00258     } <span class="keywordflow">else</span> { <span class="comment">//src.Nspin() ==1</span>
<a name="l00259"></a>00259       <a class="code" href="class_spinor_texture.html">SpinorTexture&lt;float2, float2, double2, 3, 0&gt;</a> src_tex(src);
<a name="l00260"></a>00260       <a class="code" href="class_spinor.html">Spinor&lt;float2, float2, float2, 3&gt;</a> dst_spinor(dst);
<a name="l00261"></a>00261       copy = <span class="keyword">new</span> <a class="code" href="class_copy_cuda.html">CopyCuda&lt;float2, 3, Spinor&lt;float2, float2, float2, 3&gt;</a>,
<a name="l00262"></a>00262                           <a class="code" href="class_spinor_texture.html">SpinorTexture&lt;float2, float2, double2, 3, 0&gt;</a> &gt;
<a name="l00263"></a>00263         (dst_spinor, src_tex, src.<a class="code" href="class_color_spinor_field.html#aa0100678a81f4c208f3138ae19366890">Stride</a>());
<a name="l00264"></a>00264     }
<a name="l00265"></a>00265   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dst.<a class="code" href="class_color_spinor_field.html#a2bbecf6511b79c04c24431e28d45acfc">Precision</a>() == <a class="code" href="enum__quda_8h.html#ac166c47d6ef16f830c164fefe6c8ab90a8edc95cbc07156d848030900d84a09e0">QUDA_SINGLE_PRECISION</a> &amp;&amp; src.<a class="code" href="class_color_spinor_field.html#a2bbecf6511b79c04c24431e28d45acfc">Precision</a>() == <a class="code" href="enum__quda_8h.html#ac166c47d6ef16f830c164fefe6c8ab90afb568427ae928d5a1330ee47ef03c0b6">QUDA_HALF_PRECISION</a>) {
<a name="l00266"></a>00266     <a class="code" href="namespacequda.html#a9bbafb88e524c86ba71c0e549ded05f2">quda::blas_bytes</a> += src.<a class="code" href="class_color_spinor_field.html#a2162dfa6150d29e7a1e5d61b4f85ba9b">Volume</a>()*<span class="keyword">sizeof</span>(float);
<a name="l00267"></a>00267     <span class="keywordflow">if</span> (src.<a class="code" href="class_color_spinor_field.html#abdd88a39f9f275bf5459ba34f4f3f0ae">Nspin</a>() == 4){      
<a name="l00268"></a>00268       <a class="code" href="class_spinor_texture.html">SpinorTexture&lt;float4, float4, short4, 6, 0&gt;</a> src_tex(src);
<a name="l00269"></a>00269       <a class="code" href="class_spinor.html">Spinor&lt;float4, float4, float4, 6&gt;</a> dst_spinor(dst);
<a name="l00270"></a>00270       copy = <span class="keyword">new</span> <a class="code" href="class_copy_cuda.html">CopyCuda&lt;float4, 6, Spinor&lt;float4, float4, float4, 6&gt;</a>,
<a name="l00271"></a>00271                           <a class="code" href="class_spinor_texture.html">SpinorTexture&lt;float4, float4, short4, 6, 0&gt;</a> &gt;
<a name="l00272"></a>00272         (dst_spinor, src_tex, src.<a class="code" href="class_color_spinor_field.html#aa0100678a81f4c208f3138ae19366890">Stride</a>());
<a name="l00273"></a>00273     } <span class="keywordflow">else</span> { <span class="comment">//nSpin== 1;</span>
<a name="l00274"></a>00274       <a class="code" href="class_spinor_texture.html">SpinorTexture&lt;float2, float2, short2, 3, 0&gt;</a> src_tex(src);
<a name="l00275"></a>00275       <a class="code" href="class_spinor.html">Spinor&lt;float2, float2, float2, 3&gt;</a> dst_spinor(dst);
<a name="l00276"></a>00276       copy = <span class="keyword">new</span> <a class="code" href="class_copy_cuda.html">CopyCuda&lt;float2, 3, Spinor&lt;float2, float2, float2, 3&gt;</a>,
<a name="l00277"></a>00277                           <a class="code" href="class_spinor_texture.html">SpinorTexture&lt;float2, float2, short2, 3, 0&gt;</a> &gt;
<a name="l00278"></a>00278         (dst_spinor, src_tex, src.<a class="code" href="class_color_spinor_field.html#aa0100678a81f4c208f3138ae19366890">Stride</a>());
<a name="l00279"></a>00279     }
<a name="l00280"></a>00280   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dst.<a class="code" href="class_color_spinor_field.html#a2bbecf6511b79c04c24431e28d45acfc">Precision</a>() == <a class="code" href="enum__quda_8h.html#ac166c47d6ef16f830c164fefe6c8ab90afb568427ae928d5a1330ee47ef03c0b6">QUDA_HALF_PRECISION</a> &amp;&amp; src.<a class="code" href="class_color_spinor_field.html#a2bbecf6511b79c04c24431e28d45acfc">Precision</a>() == <a class="code" href="enum__quda_8h.html#ac166c47d6ef16f830c164fefe6c8ab90a8edc95cbc07156d848030900d84a09e0">QUDA_SINGLE_PRECISION</a>) {
<a name="l00281"></a>00281     <a class="code" href="namespacequda.html#a9bbafb88e524c86ba71c0e549ded05f2">quda::blas_bytes</a> += dst.<a class="code" href="class_color_spinor_field.html#a2162dfa6150d29e7a1e5d61b4f85ba9b">Volume</a>()*<span class="keyword">sizeof</span>(float);
<a name="l00282"></a>00282     <span class="keywordflow">if</span> (src.<a class="code" href="class_color_spinor_field.html#abdd88a39f9f275bf5459ba34f4f3f0ae">Nspin</a>() == 4){
<a name="l00283"></a>00283       <a class="code" href="class_spinor_texture.html">SpinorTexture&lt;float4, float4, float4, 6, 0&gt;</a> src_tex(src);
<a name="l00284"></a>00284       <a class="code" href="class_spinor.html">Spinor&lt;float4, float4, short4, 6&gt;</a> dst_spinor(dst);
<a name="l00285"></a>00285       copy = <span class="keyword">new</span> <a class="code" href="class_copy_cuda.html">CopyCuda&lt;float4, 6, Spinor&lt;float4, float4, short4, 6&gt;</a>,
<a name="l00286"></a>00286                           <a class="code" href="class_spinor_texture.html">SpinorTexture&lt;float4, float4, float4, 6, 0&gt;</a> &gt;
<a name="l00287"></a>00287         (dst_spinor, src_tex, src.<a class="code" href="class_color_spinor_field.html#aa0100678a81f4c208f3138ae19366890">Stride</a>());
<a name="l00288"></a>00288     } <span class="keywordflow">else</span> { <span class="comment">//nSpin == 1</span>
<a name="l00289"></a>00289       <a class="code" href="class_spinor_texture.html">SpinorTexture&lt;float2, float2, float2, 3, 0&gt;</a> src_tex(src);
<a name="l00290"></a>00290       <a class="code" href="class_spinor.html">Spinor&lt;float2, float2, short2, 3&gt;</a> dst_spinor(dst);
<a name="l00291"></a>00291       copy = <span class="keyword">new</span> <a class="code" href="class_copy_cuda.html">CopyCuda&lt;float2, 3, Spinor&lt;float2, float2, short2, 3&gt;</a>,
<a name="l00292"></a>00292                           <a class="code" href="class_spinor_texture.html">SpinorTexture&lt;float2, float2, float2, 3, 0&gt;</a> &gt;
<a name="l00293"></a>00293         (dst_spinor, src_tex, src.<a class="code" href="class_color_spinor_field.html#aa0100678a81f4c208f3138ae19366890">Stride</a>());
<a name="l00294"></a>00294     }
<a name="l00295"></a>00295   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dst.<a class="code" href="class_color_spinor_field.html#a2bbecf6511b79c04c24431e28d45acfc">Precision</a>() == <a class="code" href="enum__quda_8h.html#ac166c47d6ef16f830c164fefe6c8ab90a6288ca4c9d3166592676284c7d886972">QUDA_DOUBLE_PRECISION</a> &amp;&amp; src.<a class="code" href="class_color_spinor_field.html#a2bbecf6511b79c04c24431e28d45acfc">Precision</a>() == <a class="code" href="enum__quda_8h.html#ac166c47d6ef16f830c164fefe6c8ab90afb568427ae928d5a1330ee47ef03c0b6">QUDA_HALF_PRECISION</a>) {
<a name="l00296"></a>00296     <a class="code" href="namespacequda.html#a9bbafb88e524c86ba71c0e549ded05f2">quda::blas_bytes</a> += src.<a class="code" href="class_color_spinor_field.html#a2162dfa6150d29e7a1e5d61b4f85ba9b">Volume</a>()*<span class="keyword">sizeof</span>(float);
<a name="l00297"></a>00297     <span class="keywordflow">if</span> (src.<a class="code" href="class_color_spinor_field.html#abdd88a39f9f275bf5459ba34f4f3f0ae">Nspin</a>() == 4){
<a name="l00298"></a>00298       <a class="code" href="class_spinor_texture.html">SpinorTexture&lt;double2, float4, short4, 12, 0&gt;</a> src_tex(src);
<a name="l00299"></a>00299       <a class="code" href="class_spinor.html">Spinor&lt;double2, double2, double2, 12&gt;</a> dst_spinor(dst);
<a name="l00300"></a>00300       copy = <span class="keyword">new</span> <a class="code" href="class_copy_cuda.html">CopyCuda&lt;double2, 12, Spinor&lt;double2, double2, double2, 12&gt;</a>,
<a name="l00301"></a>00301                           <a class="code" href="class_spinor_texture.html">SpinorTexture&lt;double2, float4, short4, 12, 0&gt;</a> &gt;
<a name="l00302"></a>00302         (dst_spinor, src_tex, src.<a class="code" href="class_color_spinor_field.html#aa0100678a81f4c208f3138ae19366890">Stride</a>());
<a name="l00303"></a>00303     } <span class="keywordflow">else</span> { <span class="comment">//nSpin == 1</span>
<a name="l00304"></a>00304       <a class="code" href="class_spinor_texture.html">SpinorTexture&lt;double2, float2, short2, 3, 0&gt;</a> src_tex(src);
<a name="l00305"></a>00305       <a class="code" href="class_spinor.html">Spinor&lt;double2, double2, double2, 3&gt;</a> dst_spinor(dst);
<a name="l00306"></a>00306       copy = <span class="keyword">new</span> <a class="code" href="class_copy_cuda.html">CopyCuda&lt;double2, 3, Spinor&lt;double2, double2, double2, 3&gt;</a>,
<a name="l00307"></a>00307                           <a class="code" href="class_spinor_texture.html">SpinorTexture&lt;double2, float2, short2, 3, 0&gt;</a> &gt;
<a name="l00308"></a>00308         (dst_spinor, src_tex, src.<a class="code" href="class_color_spinor_field.html#aa0100678a81f4c208f3138ae19366890">Stride</a>());
<a name="l00309"></a>00309     }
<a name="l00310"></a>00310   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dst.<a class="code" href="class_color_spinor_field.html#a2bbecf6511b79c04c24431e28d45acfc">Precision</a>() == <a class="code" href="enum__quda_8h.html#ac166c47d6ef16f830c164fefe6c8ab90afb568427ae928d5a1330ee47ef03c0b6">QUDA_HALF_PRECISION</a> &amp;&amp; src.<a class="code" href="class_color_spinor_field.html#a2bbecf6511b79c04c24431e28d45acfc">Precision</a>() == <a class="code" href="enum__quda_8h.html#ac166c47d6ef16f830c164fefe6c8ab90a6288ca4c9d3166592676284c7d886972">QUDA_DOUBLE_PRECISION</a>) {
<a name="l00311"></a>00311     <a class="code" href="namespacequda.html#a9bbafb88e524c86ba71c0e549ded05f2">quda::blas_bytes</a> += dst.<a class="code" href="class_color_spinor_field.html#a2162dfa6150d29e7a1e5d61b4f85ba9b">Volume</a>()*<span class="keyword">sizeof</span>(float);
<a name="l00312"></a>00312     <span class="keywordflow">if</span> (src.<a class="code" href="class_color_spinor_field.html#abdd88a39f9f275bf5459ba34f4f3f0ae">Nspin</a>() == 4){
<a name="l00313"></a>00313       <a class="code" href="class_spinor_texture.html">SpinorTexture&lt;double2, double2, double2, 12, 0&gt;</a> src_tex(src);
<a name="l00314"></a>00314       <a class="code" href="class_spinor.html">Spinor&lt;double2, double4, short4, 12&gt;</a> dst_spinor(dst);
<a name="l00315"></a>00315       copy = <span class="keyword">new</span> <a class="code" href="class_copy_cuda.html">CopyCuda&lt;double2, 12, Spinor&lt;double2, double4, short4, 12&gt;</a>,
<a name="l00316"></a>00316                           <a class="code" href="class_spinor_texture.html">SpinorTexture&lt;double2, double2, double2, 12, 0&gt;</a> &gt;
<a name="l00317"></a>00317         (dst_spinor, src_tex, src.<a class="code" href="class_color_spinor_field.html#aa0100678a81f4c208f3138ae19366890">Stride</a>());
<a name="l00318"></a>00318     } <span class="keywordflow">else</span> { <span class="comment">//nSpin == 1</span>
<a name="l00319"></a>00319       <a class="code" href="class_spinor_texture.html">SpinorTexture&lt;double2, double2, double2, 3, 0&gt;</a> src_tex(src);
<a name="l00320"></a>00320       <a class="code" href="class_spinor.html">Spinor&lt;double2, double2, short2, 3&gt;</a> dst_spinor(dst);
<a name="l00321"></a>00321       copy = <span class="keyword">new</span> <a class="code" href="class_copy_cuda.html">CopyCuda&lt;double2, 3, Spinor&lt;double2, double2, short2, 3&gt;</a>,
<a name="l00322"></a>00322                           <a class="code" href="class_spinor_texture.html">SpinorTexture&lt;double2, double2, double2, 3, 0&gt;</a> &gt;
<a name="l00323"></a>00323         (dst_spinor, src_tex, src.<a class="code" href="class_color_spinor_field.html#aa0100678a81f4c208f3138ae19366890">Stride</a>());
<a name="l00324"></a>00324     }
<a name="l00325"></a>00325   }
<a name="l00326"></a>00326   
<a name="l00327"></a>00327   <span class="keywordflow">if</span> (dst.<a class="code" href="class_color_spinor_field.html#a2bbecf6511b79c04c24431e28d45acfc">Precision</a>() != src.<a class="code" href="class_color_spinor_field.html#a2bbecf6511b79c04c24431e28d45acfc">Precision</a>()) {
<a name="l00328"></a>00328     copy-&gt;<a class="code" href="class_tunable.html#ad33ab9bec510fdb3bcb90561735a08ed">apply</a>(*blasStream);
<a name="l00329"></a>00329     <span class="keyword">delete</span> copy;
<a name="l00330"></a>00330   } <span class="keywordflow">else</span> {
<a name="l00331"></a>00331     cudaMemcpy(dst.<a class="code" href="classcuda_color_spinor_field.html#aa4337476b6db7ef770197a63dbe48023">V</a>(), src.<a class="code" href="classcuda_color_spinor_field.html#aa4337476b6db7ef770197a63dbe48023">V</a>(), dst.<a class="code" href="class_color_spinor_field.html#a3865236a406c549b8eb5fef0eb8fc9ff">Bytes</a>(), cudaMemcpyDeviceToDevice);
<a name="l00332"></a>00332     <span class="keywordflow">if</span> (dst.<a class="code" href="class_color_spinor_field.html#a2bbecf6511b79c04c24431e28d45acfc">Precision</a>() == <a class="code" href="enum__quda_8h.html#ac166c47d6ef16f830c164fefe6c8ab90afb568427ae928d5a1330ee47ef03c0b6">QUDA_HALF_PRECISION</a>) {
<a name="l00333"></a>00333       cudaMemcpy(dst.<a class="code" href="classcuda_color_spinor_field.html#a4a99f053432850fcccf73d5923d049c0">Norm</a>(), src.<a class="code" href="classcuda_color_spinor_field.html#a4a99f053432850fcccf73d5923d049c0">Norm</a>(), dst.<a class="code" href="class_color_spinor_field.html#a0506685f0dbf08a11a07c8e6a9678552">NormBytes</a>(), cudaMemcpyDeviceToDevice);
<a name="l00334"></a>00334       <a class="code" href="namespacequda.html#a9bbafb88e524c86ba71c0e549ded05f2">quda::blas_bytes</a> += 2*dst.<a class="code" href="class_color_spinor_field.html#ae4e0bcc581e2d259499aff1a0f658294">RealLength</a>()*<span class="keyword">sizeof</span>(float);
<a name="l00335"></a>00335     }
<a name="l00336"></a>00336   }
<a name="l00337"></a>00337 
<a name="l00338"></a>00338   <a class="code" href="util__quda_8h.html#a7668e6580e0f57b0db3112fae4959e34">checkCudaError</a>();
<a name="l00339"></a>00339 }
<a name="l00340"></a>00340 
<a name="l00341"></a>00341 <span class="preprocessor">#include &lt;<a class="code" href="blas__core_8h.html">blas_core.h</a>&gt;</span>
<a name="l00342"></a>00342 
<a name="l00346"></a>00346 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Float2, <span class="keyword">typename</span> FloatN&gt;
<a name="l00347"></a><a class="code" href="structaxpby.html">00347</a> <span class="keyword">struct </span><a class="code" href="structaxpby.html">axpby</a> {
<a name="l00348"></a><a class="code" href="structaxpby.html#ac66a635ca03cabd954dd66f62d87d3bd">00348</a>   <span class="keyword">const</span> Float2 <a class="code" href="structaxpby.html#ac66a635ca03cabd954dd66f62d87d3bd">a</a>;
<a name="l00349"></a><a class="code" href="structaxpby.html#af17a4aee3525d851c89f0f5b55d32101">00349</a>   <span class="keyword">const</span> Float2 <a class="code" href="structaxpby.html#af17a4aee3525d851c89f0f5b55d32101">b</a>;
<a name="l00350"></a><a class="code" href="structaxpby.html#a29aa71044b50ce2763050d34bcc071b1">00350</a>   <a class="code" href="structaxpby.html#a29aa71044b50ce2763050d34bcc071b1">axpby</a>(<span class="keyword">const</span> Float2 &amp;<a class="code" href="structaxpby.html#ac66a635ca03cabd954dd66f62d87d3bd">a</a>, <span class="keyword">const</span> Float2 &amp;<a class="code" href="structaxpby.html#af17a4aee3525d851c89f0f5b55d32101">b</a>, <span class="keyword">const</span> Float2 &amp;c) : a(a), b(b) { ; }
<a name="l00351"></a><a class="code" href="structaxpby.html#a7821bf57d1a421f4cffc05ec71aa0ee5">00351</a>   __device__ <span class="keywordtype">void</span> <a class="code" href="structaxpby.html#a7821bf57d1a421f4cffc05ec71aa0ee5">operator()</a>(<span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;<a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;y, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;z, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;w) { y = <a class="code" href="structaxpby.html#ac66a635ca03cabd954dd66f62d87d3bd">a</a>.x*x + <a class="code" href="structaxpby.html#af17a4aee3525d851c89f0f5b55d32101">b</a>.x*y; }
<a name="l00352"></a><a class="code" href="structaxpby.html#a1c5fb9a90248c8aee994b94778bcfb1a">00352</a>   <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="structaxpby.html#a1c5fb9a90248c8aee994b94778bcfb1a">streams</a>() { <span class="keywordflow">return</span> 3; } 
<a name="l00353"></a><a class="code" href="structaxpby.html#aa9f5d539979c97ff508d7c5e5b899dae">00353</a>   <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="structaxpby.html#aa9f5d539979c97ff508d7c5e5b899dae" title="total number of input and output streams">flops</a>() { <span class="keywordflow">return</span> 3; } 
<a name="l00354"></a>00354 };
<a name="l00355"></a>00355 
<a name="l00356"></a><a class="code" href="blas__quda_8cu.html#a27b3cb4f55d26a4cf62d2e004a08e4fa">00356</a> <span class="keywordtype">void</span> <a class="code" href="blas__quda_8h.html#a27b3cb4f55d26a4cf62d2e004a08e4fa">axpbyCuda</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> &amp;a, <a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a> &amp;<a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;b, <a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a> &amp;y) {
<a name="l00357"></a>00357   <span class="keyword">const</span> <span class="keywordtype">int</span> kernel = 2;
<a name="l00358"></a>00358   blasCuda&lt;axpby,0,1,0,0&gt;(kernel, make_double2(a, 0.0), make_double2(b, 0.0), make_double2(0.0, 0.0),
<a name="l00359"></a>00359                   <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, y, <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>);
<a name="l00360"></a>00360 }
<a name="l00361"></a>00361 
<a name="l00365"></a>00365 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Float2, <span class="keyword">typename</span> FloatN&gt;
<a name="l00366"></a><a class="code" href="structxpy.html">00366</a> <span class="keyword">struct </span><a class="code" href="structxpy.html">xpy</a> {
<a name="l00367"></a><a class="code" href="structxpy.html#aa783a8eef1b7cd5faf007ad8061bb406">00367</a>   <a class="code" href="structxpy.html#aa783a8eef1b7cd5faf007ad8061bb406">xpy</a>(<span class="keyword">const</span> Float2 &amp;a, <span class="keyword">const</span> Float2 &amp;b, <span class="keyword">const</span> Float2 &amp;c) { ; }
<a name="l00368"></a><a class="code" href="structxpy.html#a252a223e29a7632018f26326047d8d82">00368</a>   __device__ <span class="keywordtype">void</span> <a class="code" href="structxpy.html#a252a223e29a7632018f26326047d8d82">operator()</a>(<span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;<a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;y, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;z, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;w) { y += <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a> ; }
<a name="l00369"></a><a class="code" href="structxpy.html#aa1a5d303415dfffbed371f2331881d98">00369</a>   <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="structxpy.html#aa1a5d303415dfffbed371f2331881d98">streams</a>() { <span class="keywordflow">return</span> 3; } 
<a name="l00370"></a><a class="code" href="structxpy.html#a4aabf4d104c8655aa82fdafa236063e0">00370</a>   <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="structxpy.html#a4aabf4d104c8655aa82fdafa236063e0" title="total number of input and output streams">flops</a>() { <span class="keywordflow">return</span> 1; } 
<a name="l00371"></a>00371 };
<a name="l00372"></a>00372 
<a name="l00373"></a><a class="code" href="blas__quda_8cu.html#a30d1b8294129126fe81626e4a3095a25">00373</a> <span class="keywordtype">void</span> <a class="code" href="blas__quda_8h.html#a30d1b8294129126fe81626e4a3095a25">xpyCuda</a>(<a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a> &amp;<a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a> &amp;y) {
<a name="l00374"></a>00374   <span class="keyword">const</span> <span class="keywordtype">int</span> kernel = 3;
<a name="l00375"></a>00375   blasCuda&lt;xpy,0,1,0,0&gt;(kernel, make_double2(1.0, 0.0), make_double2(1.0, 0.0), make_double2(0.0, 0.0), 
<a name="l00376"></a>00376                 <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, y, <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>);
<a name="l00377"></a>00377 }
<a name="l00378"></a>00378 
<a name="l00382"></a>00382 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Float2, <span class="keyword">typename</span> FloatN&gt;
<a name="l00383"></a><a class="code" href="structaxpy.html">00383</a> <span class="keyword">struct </span><a class="code" href="structaxpy.html">axpy</a> {
<a name="l00384"></a><a class="code" href="structaxpy.html#a68f57e2c0480289eaccc99b1e29c3c88">00384</a>   <span class="keyword">const</span> Float2 <a class="code" href="structaxpy.html#a68f57e2c0480289eaccc99b1e29c3c88">a</a>;
<a name="l00385"></a><a class="code" href="structaxpy.html#a7696e1837de6523b5d667d6e84bf551e">00385</a>   <a class="code" href="structaxpy.html#a7696e1837de6523b5d667d6e84bf551e">axpy</a>(<span class="keyword">const</span> Float2 &amp;<a class="code" href="structaxpy.html#a68f57e2c0480289eaccc99b1e29c3c88">a</a>, <span class="keyword">const</span> Float2 &amp;b, <span class="keyword">const</span> Float2 &amp;c) : a(a) { ; }
<a name="l00386"></a><a class="code" href="structaxpy.html#ad624fa3c987c70a391aa28583277a886">00386</a>   __device__ <span class="keywordtype">void</span> <a class="code" href="structaxpy.html#ad624fa3c987c70a391aa28583277a886">operator()</a>(<span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;<a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;y, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;z, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;w) { y = <a class="code" href="structaxpy.html#a68f57e2c0480289eaccc99b1e29c3c88">a</a>.x*x + y; }
<a name="l00387"></a><a class="code" href="structaxpy.html#ae21bef54c3ff550c8bca451fbd3f2af9">00387</a>   <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="structaxpy.html#ae21bef54c3ff550c8bca451fbd3f2af9">streams</a>() { <span class="keywordflow">return</span> 3; } 
<a name="l00388"></a><a class="code" href="structaxpy.html#a4d854b104c3f5b3971dd15369fe05711">00388</a>   <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="structaxpy.html#a4d854b104c3f5b3971dd15369fe05711" title="total number of input and output streams">flops</a>() { <span class="keywordflow">return</span> 2; } 
<a name="l00389"></a>00389 };
<a name="l00390"></a>00390 
<a name="l00391"></a><a class="code" href="blas__quda_8cu.html#a07a8952d4d007db1f557b5db1a5f728e">00391</a> <span class="keywordtype">void</span> <a class="code" href="blas__quda_8h.html#a07a8952d4d007db1f557b5db1a5f728e">axpyCuda</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> &amp;a, <a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a> &amp;<a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a> &amp;y) {
<a name="l00392"></a>00392   <span class="keyword">const</span> <span class="keywordtype">int</span> kernel = 4;
<a name="l00393"></a>00393   blasCuda&lt;axpy,0,1,0,0&gt;(kernel, make_double2(a, 0.0), make_double2(1.0, 0.0), make_double2(0.0, 0.0), 
<a name="l00394"></a>00394                  <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, y, <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>);
<a name="l00395"></a>00395 }
<a name="l00396"></a>00396 
<a name="l00400"></a>00400 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Float2, <span class="keyword">typename</span> FloatN&gt;
<a name="l00401"></a><a class="code" href="structxpay.html">00401</a> <span class="keyword">struct </span><a class="code" href="structxpay.html">xpay</a> {
<a name="l00402"></a><a class="code" href="structxpay.html#adf21ae35f6f7d0fd0e57b8977d79eb75">00402</a>   <span class="keyword">const</span> Float2 <a class="code" href="structxpay.html#adf21ae35f6f7d0fd0e57b8977d79eb75">a</a>;
<a name="l00403"></a><a class="code" href="structxpay.html#a3f22228b63bc0d47755fc2eb7be3c3a5">00403</a>   <a class="code" href="structxpay.html#a3f22228b63bc0d47755fc2eb7be3c3a5">xpay</a>(<span class="keyword">const</span> Float2 &amp;<a class="code" href="structxpay.html#adf21ae35f6f7d0fd0e57b8977d79eb75">a</a>, <span class="keyword">const</span> Float2 &amp;b, <span class="keyword">const</span> Float2 &amp;c) : a(a) { ; }
<a name="l00404"></a><a class="code" href="structxpay.html#a6d415912883af7d8fc6fd60a5d3fda68">00404</a>   __device__ <span class="keywordtype">void</span> <a class="code" href="structxpay.html#a6d415912883af7d8fc6fd60a5d3fda68">operator()</a>(<span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;<a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;y, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;z, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;w) { y = x + <a class="code" href="structxpay.html#adf21ae35f6f7d0fd0e57b8977d79eb75">a</a>.x*y; }
<a name="l00405"></a><a class="code" href="structxpay.html#a57c2b241646b4db82f1d79f5aac12149">00405</a>   <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="structxpay.html#a57c2b241646b4db82f1d79f5aac12149">streams</a>() { <span class="keywordflow">return</span> 3; } 
<a name="l00406"></a><a class="code" href="structxpay.html#a7cc0049f18be3c912b355d61b909bc66">00406</a>   <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="structxpay.html#a7cc0049f18be3c912b355d61b909bc66" title="total number of input and output streams">flops</a>() { <span class="keywordflow">return</span> 2; } 
<a name="l00407"></a>00407 };
<a name="l00408"></a>00408 
<a name="l00409"></a><a class="code" href="blas__quda_8cu.html#a87b6d90b5c3f75d371483a1751ea0cea">00409</a> <span class="keywordtype">void</span> <a class="code" href="blas__quda_8h.html#a87b6d90b5c3f75d371483a1751ea0cea">xpayCuda</a>(<a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a> &amp;<a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;a, <a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a> &amp;y) {
<a name="l00410"></a>00410   <span class="keyword">const</span> <span class="keywordtype">int</span> kernel = 5;
<a name="l00411"></a>00411   blasCuda&lt;xpay,0,1,0,0&gt;(kernel, make_double2(a,0.0), make_double2(0.0, 0.0), make_double2(0.0, 0.0),
<a name="l00412"></a>00412                          <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, y, <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>);
<a name="l00413"></a>00413 }
<a name="l00414"></a>00414 
<a name="l00418"></a>00418 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Float2, <span class="keyword">typename</span> FloatN&gt;
<a name="l00419"></a><a class="code" href="structmxpy.html">00419</a> <span class="keyword">struct </span><a class="code" href="structmxpy.html">mxpy</a> {
<a name="l00420"></a><a class="code" href="structmxpy.html#a98e4df070eadf3259abe97ab94fbfc24">00420</a>   <a class="code" href="structmxpy.html#a98e4df070eadf3259abe97ab94fbfc24">mxpy</a>(<span class="keyword">const</span> Float2 &amp;a, <span class="keyword">const</span> Float2 &amp;b, <span class="keyword">const</span> Float2 &amp;c) { ; }
<a name="l00421"></a><a class="code" href="structmxpy.html#a49aa186f34a64d33e045e67d7f06acb1">00421</a>   __device__ <span class="keywordtype">void</span> <a class="code" href="structmxpy.html#a49aa186f34a64d33e045e67d7f06acb1">operator()</a>(<span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;<a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;y, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;z, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;w) { y -= <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>; }
<a name="l00422"></a><a class="code" href="structmxpy.html#a7c9f1fe7edf9a254b68ef3417550f53a">00422</a>   <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="structmxpy.html#a7c9f1fe7edf9a254b68ef3417550f53a">streams</a>() { <span class="keywordflow">return</span> 3; } 
<a name="l00423"></a><a class="code" href="structmxpy.html#a4a83e150ae1ea2197bc7352fe87c91f1">00423</a>   <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="structmxpy.html#a4a83e150ae1ea2197bc7352fe87c91f1" title="total number of input and output streams">flops</a>() { <span class="keywordflow">return</span> 1; } 
<a name="l00424"></a>00424 };
<a name="l00425"></a>00425 
<a name="l00426"></a><a class="code" href="blas__quda_8cu.html#ade0055f202a2a1a671b6fa74b524bd69">00426</a> <span class="keywordtype">void</span> <a class="code" href="blas__quda_8h.html#ade0055f202a2a1a671b6fa74b524bd69">mxpyCuda</a>(<a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a> &amp;<a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a> &amp;y) {
<a name="l00427"></a>00427   <span class="keyword">const</span> <span class="keywordtype">int</span> kernel = 6;
<a name="l00428"></a>00428   blasCuda&lt;mxpy,0,1,0,0&gt;(kernel, make_double2(1.0, 0.0), make_double2(1.0, 0.0), 
<a name="l00429"></a>00429                          make_double2(0.0, 0.0), <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, y, <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>);
<a name="l00430"></a>00430 }
<a name="l00431"></a>00431 
<a name="l00435"></a>00435 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Float2, <span class="keyword">typename</span> FloatN&gt;
<a name="l00436"></a><a class="code" href="structax.html">00436</a> <span class="keyword">struct </span><a class="code" href="structax.html">ax</a> {
<a name="l00437"></a><a class="code" href="structax.html#a8768c03f9b71654c1b68a989afad78fa">00437</a>   <span class="keyword">const</span> Float2 <a class="code" href="structax.html#a8768c03f9b71654c1b68a989afad78fa">a</a>;
<a name="l00438"></a><a class="code" href="structax.html#a18af1b468a99c3003b7a281d23b4c45e">00438</a>   <a class="code" href="structax.html#a18af1b468a99c3003b7a281d23b4c45e">ax</a>(<span class="keyword">const</span> Float2 &amp;<a class="code" href="structax.html#a8768c03f9b71654c1b68a989afad78fa">a</a>, <span class="keyword">const</span> Float2 &amp;b, <span class="keyword">const</span> Float2 &amp;c) : a(a) { ; }
<a name="l00439"></a><a class="code" href="structax.html#a8cccb3d643c835b37c708d1dfa5441b6">00439</a>   __device__ <span class="keywordtype">void</span> <a class="code" href="structax.html#a8cccb3d643c835b37c708d1dfa5441b6">operator()</a>(<a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;<a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;y, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;z, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;w) { x *= <a class="code" href="structax.html#a8768c03f9b71654c1b68a989afad78fa">a</a>.x; }
<a name="l00440"></a><a class="code" href="structax.html#a54877710cb14a1afac10118929fbb720">00440</a>   <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="structax.html#a54877710cb14a1afac10118929fbb720">streams</a>() { <span class="keywordflow">return</span> 2; } 
<a name="l00441"></a><a class="code" href="structax.html#ae7724997799a80b2beb220a243ab50c1">00441</a>   <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="structax.html#ae7724997799a80b2beb220a243ab50c1" title="total number of input and output streams">flops</a>() { <span class="keywordflow">return</span> 1; } 
<a name="l00442"></a>00442 };
<a name="l00443"></a>00443 
<a name="l00444"></a><a class="code" href="blas__quda_8cu.html#a3ac6ec2df8daf11201407bee0f8d9eab">00444</a> <span class="keywordtype">void</span> <a class="code" href="blas__quda_8h.html#a3ac6ec2df8daf11201407bee0f8d9eab">axCuda</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> &amp;a, <a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a> &amp;<a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>) {
<a name="l00445"></a>00445   <span class="keyword">const</span> <span class="keywordtype">int</span> kernel = 7;
<a name="l00446"></a>00446   blasCuda&lt;ax,1,0,0,0&gt;(kernel, make_double2(a, 0.0), make_double2(0.0, 0.0), 
<a name="l00447"></a>00447                        make_double2(0.0, 0.0), <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>);
<a name="l00448"></a>00448 }
<a name="l00449"></a>00449 
<a name="l00454"></a><a class="code" href="blas__quda_8cu.html#afe4b9416b76c50cbceefc03748f659e1">00454</a> __device__ <span class="keywordtype">void</span> <a class="code" href="blas__quda_8cu.html#afe4b9416b76c50cbceefc03748f659e1">caxpy_</a>(<span class="keyword">const</span> float2 &amp;a, <span class="keyword">const</span> float4 &amp;<a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, float4 &amp;y) {
<a name="l00455"></a>00455   y.x += a.x*x.x; y.x -= a.y*x.y;
<a name="l00456"></a>00456   y.y += a.y*x.x; y.y += a.x*x.y;
<a name="l00457"></a>00457   y.z += a.x*x.z; y.z -= a.y*x.w;
<a name="l00458"></a>00458   y.w += a.y*x.z; y.w += a.x*x.w;
<a name="l00459"></a>00459 }
<a name="l00460"></a>00460 
<a name="l00461"></a><a class="code" href="blas__quda_8cu.html#a3dc9a4e399b0ce50566e2efb22f75c34">00461</a> __device__ <span class="keywordtype">void</span> <a class="code" href="blas__quda_8cu.html#afe4b9416b76c50cbceefc03748f659e1">caxpy_</a>(<span class="keyword">const</span> float2 &amp;a, <span class="keyword">const</span> float2 &amp;<a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, float2 &amp;y) {
<a name="l00462"></a>00462   y.x += a.x*x.x; y.x -= a.y*x.y;
<a name="l00463"></a>00463   y.y += a.y*x.x; y.y += a.x*x.y;
<a name="l00464"></a>00464 }
<a name="l00465"></a>00465 
<a name="l00466"></a><a class="code" href="blas__quda_8cu.html#afc955820d9e762f4e9b315dfc63fa466">00466</a> __device__ <span class="keywordtype">void</span> <a class="code" href="blas__quda_8cu.html#afe4b9416b76c50cbceefc03748f659e1">caxpy_</a>(<span class="keyword">const</span> double2 &amp;a, <span class="keyword">const</span> double2 &amp;<a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, double2 &amp;y) {
<a name="l00467"></a>00467   y.x += a.x*x.x; y.x -= a.y*x.y;
<a name="l00468"></a>00468   y.y += a.y*x.x; y.y += a.x*x.y;
<a name="l00469"></a>00469 }
<a name="l00470"></a>00470 
<a name="l00471"></a>00471 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Float2, <span class="keyword">typename</span> FloatN&gt;
<a name="l00472"></a><a class="code" href="structcaxpy.html">00472</a> <span class="keyword">struct </span><a class="code" href="structcaxpy.html">caxpy</a> {
<a name="l00473"></a><a class="code" href="structcaxpy.html#a35b372a8af2cc785cfab9366bfd9d55c">00473</a>   <span class="keyword">const</span> Float2 <a class="code" href="structcaxpy.html#a35b372a8af2cc785cfab9366bfd9d55c">a</a>;
<a name="l00474"></a><a class="code" href="structcaxpy.html#a7321b88cef506f8f9b1c2d142fd06f3f">00474</a>   <a class="code" href="structcaxpy.html#a7321b88cef506f8f9b1c2d142fd06f3f">caxpy</a>(<span class="keyword">const</span> Float2 &amp;<a class="code" href="structcaxpy.html#a35b372a8af2cc785cfab9366bfd9d55c">a</a>, <span class="keyword">const</span> Float2 &amp;b, <span class="keyword">const</span> Float2 &amp;c) : a(a) { ; }
<a name="l00475"></a><a class="code" href="structcaxpy.html#a71eed17fff4d26eb3cb8abd5f38b8735">00475</a>   __device__ <span class="keywordtype">void</span> <a class="code" href="structcaxpy.html#a71eed17fff4d26eb3cb8abd5f38b8735">operator()</a>(<span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;<a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;y, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;z, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;w) { <a class="code" href="blas__quda_8cu.html#afe4b9416b76c50cbceefc03748f659e1">caxpy_</a>(<a class="code" href="structcaxpy.html#a35b372a8af2cc785cfab9366bfd9d55c">a</a>, x, y); }
<a name="l00476"></a><a class="code" href="structcaxpy.html#a5fc2905bc812d073cbb730ac0a1ed4fe">00476</a>   <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="structcaxpy.html#a5fc2905bc812d073cbb730ac0a1ed4fe">streams</a>() { <span class="keywordflow">return</span> 3; } 
<a name="l00477"></a><a class="code" href="structcaxpy.html#ad41076b9dd4e50a4b88143db0008919f">00477</a>   <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="structcaxpy.html#ad41076b9dd4e50a4b88143db0008919f" title="total number of input and output streams">flops</a>() { <span class="keywordflow">return</span> 4; } 
<a name="l00478"></a>00478 };
<a name="l00479"></a>00479 
<a name="l00480"></a><a class="code" href="blas__quda_8cu.html#ad270c9e61914a8ee080aebef9141ab39">00480</a> <span class="keywordtype">void</span> <a class="code" href="blas__quda_8h.html#ad270c9e61914a8ee080aebef9141ab39">caxpyCuda</a>(<span class="keyword">const</span> <a class="code" href="namespacequda.html#a61eb8e0789e8a2021032ee12761d924e">quda::Complex</a> &amp;a, <a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a> &amp;<a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a> &amp;y) {
<a name="l00481"></a>00481   <span class="keyword">const</span> <span class="keywordtype">int</span> kernel = 8;
<a name="l00482"></a>00482   blasCuda&lt;caxpy,0,1,0,0&gt;(kernel, make_double2(real(a),imag(a)), make_double2(0.0, 0.0), 
<a name="l00483"></a>00483                           make_double2(0.0, 0.0), <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, y, <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>);
<a name="l00484"></a>00484 }
<a name="l00485"></a>00485 
<a name="l00490"></a><a class="code" href="blas__quda_8cu.html#ad3ed0816345d95185fdbd05a9e7b0941">00490</a> __device__ <span class="keywordtype">void</span> <a class="code" href="blas__quda_8cu.html#ad3ed0816345d95185fdbd05a9e7b0941">caxpby_</a>(<span class="keyword">const</span> float2 &amp;a, <span class="keyword">const</span> float4 &amp;<a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <span class="keyword">const</span> float2 &amp;b, float4 &amp;y)                                   
<a name="l00491"></a>00491   { float4 yy;                                                          
<a name="l00492"></a>00492   yy.x = a.x*x.x; yy.x -= a.y*x.y; yy.x += b.x*y.x; yy.x -= b.y*y.y;    
<a name="l00493"></a>00493   yy.y = a.y*x.x; yy.y += a.x*x.y; yy.y += b.y*y.x; yy.y += b.x*y.y;    
<a name="l00494"></a>00494   yy.z = a.x*x.z; yy.z -= a.y*x.w; yy.z += b.x*y.z; yy.z -= b.y*y.w;    
<a name="l00495"></a>00495   yy.w = a.y*x.z; yy.w += a.x*x.w; yy.w += b.y*y.z; yy.w += b.x*y.w;    
<a name="l00496"></a>00496   y = yy; }
<a name="l00497"></a>00497 
<a name="l00498"></a><a class="code" href="blas__quda_8cu.html#a6f559151bbd015b73a56f80f71cae105">00498</a> __device__ <span class="keywordtype">void</span> <a class="code" href="blas__quda_8cu.html#ad3ed0816345d95185fdbd05a9e7b0941">caxpby_</a>(<span class="keyword">const</span> float2 &amp;a, <span class="keyword">const</span> float2 &amp;<a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <span class="keyword">const</span> float2 &amp;b, float2 &amp;y)
<a name="l00499"></a>00499   { float2 yy;                                                          
<a name="l00500"></a>00500   yy.x = a.x*x.x; yy.x -= a.y*x.y; yy.x += b.x*y.x; yy.x -= b.y*y.y;    
<a name="l00501"></a>00501   yy.y = a.y*x.x; yy.y += a.x*x.y; yy.y += b.y*y.x; yy.y += b.x*y.y;    
<a name="l00502"></a>00502   y = yy; }
<a name="l00503"></a>00503 
<a name="l00504"></a><a class="code" href="blas__quda_8cu.html#a512c407ed0847bdcd18440cfca5dd4bb">00504</a> __device__ <span class="keywordtype">void</span> <a class="code" href="blas__quda_8cu.html#ad3ed0816345d95185fdbd05a9e7b0941">caxpby_</a>(<span class="keyword">const</span> double2 &amp;a, <span class="keyword">const</span> double2 &amp;<a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <span class="keyword">const</span> double2 &amp;b, double2 &amp;y)                                
<a name="l00505"></a>00505   { double2 yy;                                                         
<a name="l00506"></a>00506   yy.x = a.x*x.x; yy.x -= a.y*x.y; yy.x += b.x*y.x; yy.x -= b.y*y.y;    
<a name="l00507"></a>00507   yy.y = a.y*x.x; yy.y += a.x*x.y; yy.y += b.y*y.x; yy.y += b.x*y.y;    
<a name="l00508"></a>00508   y = yy; }
<a name="l00509"></a>00509 
<a name="l00510"></a>00510 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Float2, <span class="keyword">typename</span> FloatN&gt;
<a name="l00511"></a><a class="code" href="structcaxpby.html">00511</a> <span class="keyword">struct </span><a class="code" href="structcaxpby.html">caxpby</a> {
<a name="l00512"></a><a class="code" href="structcaxpby.html#aaf0b5febfa72ce21183f243dad8caa6e">00512</a>   <span class="keyword">const</span> Float2 <a class="code" href="structcaxpby.html#aaf0b5febfa72ce21183f243dad8caa6e">a</a>;
<a name="l00513"></a><a class="code" href="structcaxpby.html#a5c18af15a3d4cca2819d2efd43f1f0b7">00513</a>   <span class="keyword">const</span> Float2 <a class="code" href="structcaxpby.html#a5c18af15a3d4cca2819d2efd43f1f0b7">b</a>;
<a name="l00514"></a><a class="code" href="structcaxpby.html#a7f93a5d15587eabefb8bb13594f7478c">00514</a>   <a class="code" href="structcaxpby.html#a7f93a5d15587eabefb8bb13594f7478c">caxpby</a>(<span class="keyword">const</span> Float2 &amp;<a class="code" href="structcaxpby.html#aaf0b5febfa72ce21183f243dad8caa6e">a</a>, <span class="keyword">const</span> Float2 &amp;<a class="code" href="structcaxpby.html#a5c18af15a3d4cca2819d2efd43f1f0b7">b</a>, <span class="keyword">const</span> Float2 &amp;c) : a(a), b(b) { ; }
<a name="l00515"></a><a class="code" href="structcaxpby.html#a3bd47cccfb577e408b4a9ddcd30d60b9">00515</a>   __device__ <span class="keywordtype">void</span> <a class="code" href="structcaxpby.html#a3bd47cccfb577e408b4a9ddcd30d60b9">operator()</a>(<span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;<a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;y, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;z, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;w) { <a class="code" href="blas__quda_8cu.html#ad3ed0816345d95185fdbd05a9e7b0941">caxpby_</a>(<a class="code" href="structcaxpby.html#aaf0b5febfa72ce21183f243dad8caa6e">a</a>, x, <a class="code" href="structcaxpby.html#a5c18af15a3d4cca2819d2efd43f1f0b7">b</a>, y); }
<a name="l00516"></a><a class="code" href="structcaxpby.html#a6dda51b4a35685f06f62fd2924f83e89">00516</a>   <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="structcaxpby.html#a6dda51b4a35685f06f62fd2924f83e89">streams</a>() { <span class="keywordflow">return</span> 3; } 
<a name="l00517"></a><a class="code" href="structcaxpby.html#a8fd145c6a1a966a871af750cad013539">00517</a>   <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="structcaxpby.html#a8fd145c6a1a966a871af750cad013539" title="total number of input and output streams">flops</a>() { <span class="keywordflow">return</span> 7; } 
<a name="l00518"></a>00518 };
<a name="l00519"></a>00519 
<a name="l00520"></a><a class="code" href="blas__quda_8cu.html#acaa1c582620b78a6da42ce159fbdfeab">00520</a> <span class="keywordtype">void</span> <a class="code" href="blas__quda_8h.html#acaa1c582620b78a6da42ce159fbdfeab">caxpbyCuda</a>(<span class="keyword">const</span> <a class="code" href="namespacequda.html#a61eb8e0789e8a2021032ee12761d924e">quda::Complex</a> &amp;a, <a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a> &amp;<a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <span class="keyword">const</span> <a class="code" href="namespacequda.html#a61eb8e0789e8a2021032ee12761d924e">quda::Complex</a> &amp;b, <a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a> &amp;y) {
<a name="l00521"></a>00521   <span class="keyword">const</span> <span class="keywordtype">int</span> kernel = 9;
<a name="l00522"></a>00522   blasCuda&lt;caxpby,0,1,0,0&gt;(kernel, make_double2(a.real(),a.imag()), make_double2(b.real(), b.imag()), 
<a name="l00523"></a>00523                            make_double2(0.0, 0.0), <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, y, <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>);
<a name="l00524"></a>00524 }
<a name="l00525"></a>00525 
<a name="l00530"></a><a class="code" href="blas__quda_8cu.html#ac7a312f77caf60c1583b26fb5c1a6edd">00530</a> __device__ <span class="keywordtype">void</span> <a class="code" href="blas__quda_8cu.html#ac7a312f77caf60c1583b26fb5c1a6edd">cxpaypbz_</a>(<span class="keyword">const</span> float4 &amp;<a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <span class="keyword">const</span> float2 &amp;a, <span class="keyword">const</span> float4 &amp;y, <span class="keyword">const</span> float2 &amp;b, float4 &amp;z) {
<a name="l00531"></a>00531   float4 zz;
<a name="l00532"></a>00532   zz.x = x.x + a.x*y.x; zz.x -= a.y*y.y; zz.x += b.x*z.x; zz.x -= b.y*z.y;
<a name="l00533"></a>00533   zz.y = x.y + a.y*y.x; zz.y += a.x*y.y; zz.y += b.y*z.x; zz.y += b.x*z.y;
<a name="l00534"></a>00534   zz.z = x.z + a.x*y.z; zz.z -= a.y*y.w; zz.z += b.x*z.z; zz.z -= b.y*z.w;
<a name="l00535"></a>00535   zz.w = x.w + a.y*y.z; zz.w += a.x*y.w; zz.w += b.y*z.z; zz.w += b.x*z.w;
<a name="l00536"></a>00536   z = zz;
<a name="l00537"></a>00537 }
<a name="l00538"></a>00538 
<a name="l00539"></a><a class="code" href="blas__quda_8cu.html#ad77e26922ba789bcac7fa7c764f99ce5">00539</a> __device__ <span class="keywordtype">void</span> <a class="code" href="blas__quda_8cu.html#ac7a312f77caf60c1583b26fb5c1a6edd">cxpaypbz_</a>(<span class="keyword">const</span> float2 &amp;<a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <span class="keyword">const</span> float2 &amp;a, <span class="keyword">const</span> float2 &amp;y, <span class="keyword">const</span> float2 &amp;b, float2 &amp;z) {
<a name="l00540"></a>00540   float2 zz;
<a name="l00541"></a>00541   zz.x = x.x + a.x*y.x; zz.x -= a.y*y.y; zz.x += b.x*z.x; zz.x -= b.y*z.y;
<a name="l00542"></a>00542   zz.y = x.y + a.y*y.x; zz.y += a.x*y.y; zz.y += b.y*z.x; zz.y += b.x*z.y;
<a name="l00543"></a>00543   z = zz;
<a name="l00544"></a>00544 }
<a name="l00545"></a>00545 
<a name="l00546"></a><a class="code" href="blas__quda_8cu.html#a7a233d38fedbce1e39ad0a89f22f9a79">00546</a> __device__ <span class="keywordtype">void</span> <a class="code" href="blas__quda_8cu.html#ac7a312f77caf60c1583b26fb5c1a6edd">cxpaypbz_</a>(<span class="keyword">const</span> double2 &amp;<a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <span class="keyword">const</span> double2 &amp;a, <span class="keyword">const</span> double2 &amp;y, <span class="keyword">const</span> double2 &amp;b, double2 &amp;z) {
<a name="l00547"></a>00547   double2 zz;
<a name="l00548"></a>00548   zz.x = x.x + a.x*y.x; zz.x -= a.y*y.y; zz.x += b.x*z.x; zz.x -= b.y*z.y;
<a name="l00549"></a>00549   zz.y = x.y + a.y*y.x; zz.y += a.x*y.y; zz.y += b.y*z.x; zz.y += b.x*z.y;
<a name="l00550"></a>00550   z = zz;
<a name="l00551"></a>00551 }
<a name="l00552"></a>00552 
<a name="l00553"></a>00553 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Float2, <span class="keyword">typename</span> FloatN&gt;
<a name="l00554"></a><a class="code" href="structcxpaypbz.html">00554</a> <span class="keyword">struct </span><a class="code" href="structcxpaypbz.html">cxpaypbz</a> {
<a name="l00555"></a><a class="code" href="structcxpaypbz.html#a49cfc7a69c8cf3aaaf7c8f603ecec5c4">00555</a>   <span class="keyword">const</span> Float2 <a class="code" href="structcxpaypbz.html#a49cfc7a69c8cf3aaaf7c8f603ecec5c4">a</a>;
<a name="l00556"></a><a class="code" href="structcxpaypbz.html#a14ff168678467105d31c692eb82d6982">00556</a>   <span class="keyword">const</span> Float2 <a class="code" href="structcxpaypbz.html#a14ff168678467105d31c692eb82d6982">b</a>;
<a name="l00557"></a><a class="code" href="structcxpaypbz.html#a348669f6a9680c555f8410f6d6bbdf16">00557</a>   <a class="code" href="structcxpaypbz.html#a348669f6a9680c555f8410f6d6bbdf16">cxpaypbz</a>(<span class="keyword">const</span> Float2 &amp;<a class="code" href="structcxpaypbz.html#a49cfc7a69c8cf3aaaf7c8f603ecec5c4">a</a>, <span class="keyword">const</span> Float2 &amp;<a class="code" href="structcxpaypbz.html#a14ff168678467105d31c692eb82d6982">b</a>, <span class="keyword">const</span> Float2 &amp;c) : a(a), b(b) { ; }
<a name="l00558"></a><a class="code" href="structcxpaypbz.html#a2c34018f388f494bb2e994afa98cff29">00558</a>   __device__ <span class="keywordtype">void</span> <a class="code" href="structcxpaypbz.html#a2c34018f388f494bb2e994afa98cff29">operator()</a>(<span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;<a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;y, <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;z, <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;w) 
<a name="l00559"></a>00559   { <a class="code" href="blas__quda_8cu.html#ac7a312f77caf60c1583b26fb5c1a6edd">cxpaypbz_</a>(x, <a class="code" href="structcxpaypbz.html#a49cfc7a69c8cf3aaaf7c8f603ecec5c4">a</a>, y, <a class="code" href="structcxpaypbz.html#a14ff168678467105d31c692eb82d6982">b</a>, z); }
<a name="l00560"></a><a class="code" href="structcxpaypbz.html#a10ad24b5695a2fb583e152a34d231474">00560</a>   <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="structcxpaypbz.html#a10ad24b5695a2fb583e152a34d231474">streams</a>() { <span class="keywordflow">return</span> 4; } 
<a name="l00561"></a><a class="code" href="structcxpaypbz.html#af884e53418ffc8f81332b71af2e0785a">00561</a>   <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="structcxpaypbz.html#af884e53418ffc8f81332b71af2e0785a" title="total number of input and output streams">flops</a>() { <span class="keywordflow">return</span> 8; } 
<a name="l00562"></a>00562 };
<a name="l00563"></a>00563 
<a name="l00564"></a><a class="code" href="blas__quda_8cu.html#a07fa43649604ecdf0a0b64d20b657629">00564</a> <span class="keywordtype">void</span> <a class="code" href="blas__quda_8h.html#af254e56e6104ecb29636975fce3a53cc">cxpaypbzCuda</a>(<a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a> &amp;<a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <span class="keyword">const</span> <a class="code" href="namespacequda.html#a61eb8e0789e8a2021032ee12761d924e">quda::Complex</a> &amp;a, <a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a> &amp;y, 
<a name="l00565"></a>00565                   <span class="keyword">const</span> <a class="code" href="namespacequda.html#a61eb8e0789e8a2021032ee12761d924e">quda::Complex</a> &amp;b, <a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a> &amp;z) {
<a name="l00566"></a>00566   <span class="keyword">const</span> <span class="keywordtype">int</span> kernel = 10;
<a name="l00567"></a>00567   blasCuda&lt;cxpaypbz,0,0,1,0&gt;(kernel, make_double2(a.real(),a.imag()), make_double2(b.real(), b.imag()), 
<a name="l00568"></a>00568                              make_double2(0.0, 0.0), <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, y, z, z);
<a name="l00569"></a>00569 }
<a name="l00570"></a>00570 
<a name="l00574"></a>00574 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Float2, <span class="keyword">typename</span> FloatN&gt;
<a name="l00575"></a><a class="code" href="structaxpy_bzpcx.html">00575</a> <span class="keyword">struct </span><a class="code" href="structaxpy_bzpcx.html">axpyBzpcx</a> {
<a name="l00576"></a><a class="code" href="structaxpy_bzpcx.html#ad8721455fa4c87df705513697b8d6048">00576</a>   <span class="keyword">const</span> Float2 <a class="code" href="structaxpy_bzpcx.html#ad8721455fa4c87df705513697b8d6048">a</a>;
<a name="l00577"></a><a class="code" href="structaxpy_bzpcx.html#a63a5f0a6b733ce6e24b100405c8b9124">00577</a>   <span class="keyword">const</span> Float2 <a class="code" href="structaxpy_bzpcx.html#a63a5f0a6b733ce6e24b100405c8b9124">b</a>;
<a name="l00578"></a><a class="code" href="structaxpy_bzpcx.html#a7cf11326dc97237f9b51b1516622f4e6">00578</a>   <span class="keyword">const</span> Float2 <a class="code" href="structaxpy_bzpcx.html#a7cf11326dc97237f9b51b1516622f4e6">c</a>;
<a name="l00579"></a><a class="code" href="structaxpy_bzpcx.html#a2d9d1959c2512bbaf98b6b44032bcad3">00579</a>   <a class="code" href="structaxpy_bzpcx.html#a2d9d1959c2512bbaf98b6b44032bcad3">axpyBzpcx</a>(<span class="keyword">const</span> Float2 &amp;<a class="code" href="structaxpy_bzpcx.html#ad8721455fa4c87df705513697b8d6048">a</a>, <span class="keyword">const</span> Float2 &amp;<a class="code" href="structaxpy_bzpcx.html#a63a5f0a6b733ce6e24b100405c8b9124">b</a>, <span class="keyword">const</span> Float2 &amp;<a class="code" href="structaxpy_bzpcx.html#a7cf11326dc97237f9b51b1516622f4e6">c</a>) : a(a), b(b), c(c) { ; }
<a name="l00580"></a><a class="code" href="structaxpy_bzpcx.html#a10a7d451f0080292179e291295cf67f7">00580</a>   __device__ <span class="keywordtype">void</span> <a class="code" href="structaxpy_bzpcx.html#a10a7d451f0080292179e291295cf67f7">operator()</a>(<a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;<a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;y, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;z, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;w)
<a name="l00581"></a>00581   { y += <a class="code" href="structaxpy_bzpcx.html#ad8721455fa4c87df705513697b8d6048">a</a>.x*<a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>; x = <a class="code" href="structaxpy_bzpcx.html#a63a5f0a6b733ce6e24b100405c8b9124">b</a>.x*z + <a class="code" href="structaxpy_bzpcx.html#a7cf11326dc97237f9b51b1516622f4e6">c</a>.x*<a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>; }
<a name="l00582"></a><a class="code" href="structaxpy_bzpcx.html#afad4ac93511018334d5c35fabf642cb4">00582</a>   <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="structaxpy_bzpcx.html#afad4ac93511018334d5c35fabf642cb4">streams</a>() { <span class="keywordflow">return</span> 5; } 
<a name="l00583"></a><a class="code" href="structaxpy_bzpcx.html#a6ca42ad71a02145705061bec239dfada">00583</a>   <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="structaxpy_bzpcx.html#a6ca42ad71a02145705061bec239dfada" title="total number of input and output streams">flops</a>() { <span class="keywordflow">return</span> 10; } 
<a name="l00584"></a>00584 };
<a name="l00585"></a>00585 
<a name="l00586"></a><a class="code" href="blas__quda_8cu.html#ac0dc28d10b10936aadca98dff915f035">00586</a> <span class="keywordtype">void</span> <a class="code" href="blas__quda_8h.html#ac0dc28d10b10936aadca98dff915f035">axpyBzpcxCuda</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> &amp;a, <a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a>&amp; <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a>&amp; y, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;b, 
<a name="l00587"></a>00587                    <a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a>&amp; z, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;c) {
<a name="l00588"></a>00588   <span class="keyword">const</span> <span class="keywordtype">int</span> kernel = 11;
<a name="l00589"></a>00589   blasCuda&lt;axpyBzpcx,1,1,0,0&gt;(kernel, make_double2(a,0.0), make_double2(b,0.0), make_double2(c,0.0), 
<a name="l00590"></a>00590                               <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, y, z, <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>);
<a name="l00591"></a>00591 }
<a name="l00592"></a>00592 
<a name="l00596"></a>00596 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Float2, <span class="keyword">typename</span> FloatN&gt;
<a name="l00597"></a><a class="code" href="structaxpy_zpbx.html">00597</a> <span class="keyword">struct </span><a class="code" href="structaxpy_zpbx.html">axpyZpbx</a> {
<a name="l00598"></a><a class="code" href="structaxpy_zpbx.html#a617bf990786a2675ba753bc11dadc112">00598</a>   <span class="keyword">const</span> Float2 <a class="code" href="structaxpy_zpbx.html#a617bf990786a2675ba753bc11dadc112">a</a>;
<a name="l00599"></a><a class="code" href="structaxpy_zpbx.html#a620f0946bb6eed7de6ce34d5f6f22667">00599</a>   <span class="keyword">const</span> Float2 <a class="code" href="structaxpy_zpbx.html#a620f0946bb6eed7de6ce34d5f6f22667">b</a>;
<a name="l00600"></a><a class="code" href="structaxpy_zpbx.html#aba6877bddb19515c0a7e175384a00989">00600</a>   <a class="code" href="structaxpy_zpbx.html#aba6877bddb19515c0a7e175384a00989">axpyZpbx</a>(<span class="keyword">const</span> Float2 &amp;<a class="code" href="structaxpy_zpbx.html#a617bf990786a2675ba753bc11dadc112">a</a>, <span class="keyword">const</span> Float2 &amp;<a class="code" href="structaxpy_zpbx.html#a620f0946bb6eed7de6ce34d5f6f22667">b</a>, <span class="keyword">const</span> Float2 &amp;c) : a(a), b(b) { ; }
<a name="l00601"></a><a class="code" href="structaxpy_zpbx.html#a2f35652fd3d782c2a3de2913ae530fb0">00601</a>   __device__ <span class="keywordtype">void</span> <a class="code" href="structaxpy_zpbx.html#a2f35652fd3d782c2a3de2913ae530fb0">operator()</a>(<a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;<a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;y, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;z, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;w)
<a name="l00602"></a>00602   { y += <a class="code" href="structaxpy_zpbx.html#a617bf990786a2675ba753bc11dadc112">a</a>.x*<a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>; x = z + <a class="code" href="structaxpy_zpbx.html#a620f0946bb6eed7de6ce34d5f6f22667">b</a>.x*<a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>; }
<a name="l00603"></a><a class="code" href="structaxpy_zpbx.html#a6918b9f89a6cb83a527adbeada49c516">00603</a>   <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="structaxpy_zpbx.html#a6918b9f89a6cb83a527adbeada49c516">streams</a>() { <span class="keywordflow">return</span> 5; } 
<a name="l00604"></a><a class="code" href="structaxpy_zpbx.html#a6b955ea9683e88ac2f310df11073c666">00604</a>   <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="structaxpy_zpbx.html#a6b955ea9683e88ac2f310df11073c666" title="total number of input and output streams">flops</a>() { <span class="keywordflow">return</span> 8; } 
<a name="l00605"></a>00605 };
<a name="l00606"></a>00606 
<a name="l00607"></a><a class="code" href="blas__quda_8cu.html#a4fe6a2d24b3e74e6d5b34e4a629c7784">00607</a> <span class="keywordtype">void</span> <a class="code" href="blas__quda_8h.html#a4fe6a2d24b3e74e6d5b34e4a629c7784">axpyZpbxCuda</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> &amp;a, <a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a>&amp; <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a>&amp; y,
<a name="l00608"></a>00608                   <a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a>&amp; z, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;b) {
<a name="l00609"></a>00609   <span class="keyword">const</span> <span class="keywordtype">int</span> kernel = 12;
<a name="l00610"></a>00610   <span class="comment">// swap arguments around </span>
<a name="l00611"></a>00611   blasCuda&lt;axpyZpbx,1,1,0,0&gt;(kernel, make_double2(a,0.0), make_double2(b,0.0), make_double2(0.0,0.0),
<a name="l00612"></a>00612                              <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, y, z, <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>);
<a name="l00613"></a>00613 }
<a name="l00614"></a>00614 
<a name="l00618"></a>00618 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Float2, <span class="keyword">typename</span> FloatN&gt;
<a name="l00619"></a><a class="code" href="structcaxpbypz_ymbw.html">00619</a> <span class="keyword">struct </span><a class="code" href="structcaxpbypz_ymbw.html">caxpbypzYmbw</a> {
<a name="l00620"></a><a class="code" href="structcaxpbypz_ymbw.html#af8196e9f6eb2ed140c17bd5235bcb17d">00620</a>   <span class="keyword">const</span> Float2 <a class="code" href="structcaxpbypz_ymbw.html#af8196e9f6eb2ed140c17bd5235bcb17d">a</a>;
<a name="l00621"></a><a class="code" href="structcaxpbypz_ymbw.html#a87669efe2a458219cf564398bf982797">00621</a>   <span class="keyword">const</span> Float2 <a class="code" href="structcaxpbypz_ymbw.html#a87669efe2a458219cf564398bf982797">b</a>;
<a name="l00622"></a><a class="code" href="structcaxpbypz_ymbw.html#a2a81db5ae39b660604b526a088e3bff2">00622</a>   <a class="code" href="structcaxpbypz_ymbw.html#a2a81db5ae39b660604b526a088e3bff2">caxpbypzYmbw</a>(<span class="keyword">const</span> Float2 &amp;<a class="code" href="structcaxpbypz_ymbw.html#af8196e9f6eb2ed140c17bd5235bcb17d">a</a>, <span class="keyword">const</span> Float2 &amp;<a class="code" href="structcaxpbypz_ymbw.html#a87669efe2a458219cf564398bf982797">b</a>, <span class="keyword">const</span> Float2 &amp;c) : a(a), b(b) { ; }
<a name="l00623"></a><a class="code" href="structcaxpbypz_ymbw.html#a87aee3fd69d1b7fe810c838cd50d7451">00623</a>   __device__ <span class="keywordtype">void</span> <a class="code" href="structcaxpbypz_ymbw.html#a87aee3fd69d1b7fe810c838cd50d7451">operator()</a>(<span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;<a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;y, <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;z, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;w)
<a name="l00624"></a>00624   { <a class="code" href="blas__quda_8cu.html#afe4b9416b76c50cbceefc03748f659e1">caxpy_</a>(<a class="code" href="structcaxpbypz_ymbw.html#af8196e9f6eb2ed140c17bd5235bcb17d">a</a>, x, z); <a class="code" href="blas__quda_8cu.html#afe4b9416b76c50cbceefc03748f659e1">caxpy_</a>(<a class="code" href="structcaxpbypz_ymbw.html#a87669efe2a458219cf564398bf982797">b</a>, y, z); <a class="code" href="blas__quda_8cu.html#afe4b9416b76c50cbceefc03748f659e1">caxpy_</a>(-<a class="code" href="structcaxpbypz_ymbw.html#a87669efe2a458219cf564398bf982797">b</a>, w, y); }
<a name="l00625"></a>00625 
<a name="l00626"></a><a class="code" href="structcaxpbypz_ymbw.html#a5fd3f18105b4bb82b7c0cf425a28e7c8">00626</a>   <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="structcaxpbypz_ymbw.html#a5fd3f18105b4bb82b7c0cf425a28e7c8">streams</a>() { <span class="keywordflow">return</span> 6; } 
<a name="l00627"></a><a class="code" href="structcaxpbypz_ymbw.html#aeba8fbc69ff980400292f5d939342c26">00627</a>   <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="structcaxpbypz_ymbw.html#aeba8fbc69ff980400292f5d939342c26" title="total number of input and output streams">flops</a>() { <span class="keywordflow">return</span> 12; } 
<a name="l00628"></a>00628 };
<a name="l00629"></a>00629 
<a name="l00630"></a><a class="code" href="blas__quda_8cu.html#a46bda145b3898fbe1f65db5ec8e046a9">00630</a> <span class="keywordtype">void</span> <a class="code" href="blas__quda_8h.html#a93ed4325e7173205fa662372ae260b6e">caxpbypzYmbwCuda</a>(<span class="keyword">const</span> <a class="code" href="namespacequda.html#a61eb8e0789e8a2021032ee12761d924e">quda::Complex</a> &amp;a, <a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a> &amp;<a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <span class="keyword">const</span> <a class="code" href="namespacequda.html#a61eb8e0789e8a2021032ee12761d924e">quda::Complex</a> &amp;b, 
<a name="l00631"></a>00631                       <a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a> &amp;y, <a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a> &amp;z, <a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a> &amp;w) {
<a name="l00632"></a>00632   <span class="keyword">const</span> <span class="keywordtype">int</span> kernel = 12;
<a name="l00633"></a>00633   blasCuda&lt;caxpbypzYmbw,0,1,1,0&gt;(kernel, make_double2(a.real(),a.imag()), make_double2(b.real(), b.imag()), 
<a name="l00634"></a>00634                                  make_double2(0.0,0.0), <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, y, z, w);
<a name="l00635"></a>00635 }
<a name="l00636"></a>00636 
<a name="l00640"></a>00640 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Float2, <span class="keyword">typename</span> FloatN&gt;
<a name="l00641"></a><a class="code" href="structcabxpy_ax.html">00641</a> <span class="keyword">struct </span><a class="code" href="structcabxpy_ax.html">cabxpyAx</a> {
<a name="l00642"></a><a class="code" href="structcabxpy_ax.html#a6881f05738f1e803b9194702a8e18043">00642</a>   <span class="keyword">const</span> Float2 <a class="code" href="structcabxpy_ax.html#a6881f05738f1e803b9194702a8e18043">a</a>;
<a name="l00643"></a><a class="code" href="structcabxpy_ax.html#aec82d2b92888a8c52574e2ad54e28377">00643</a>   <span class="keyword">const</span> Float2 <a class="code" href="structcabxpy_ax.html#aec82d2b92888a8c52574e2ad54e28377">b</a>;
<a name="l00644"></a><a class="code" href="structcabxpy_ax.html#ae95e0b06b3dcdb8e71d31b0d15f50f61">00644</a>   <a class="code" href="structcabxpy_ax.html#ae95e0b06b3dcdb8e71d31b0d15f50f61">cabxpyAx</a>(<span class="keyword">const</span> Float2 &amp;<a class="code" href="structcabxpy_ax.html#a6881f05738f1e803b9194702a8e18043">a</a>, <span class="keyword">const</span> Float2 &amp;<a class="code" href="structcabxpy_ax.html#aec82d2b92888a8c52574e2ad54e28377">b</a>, <span class="keyword">const</span> Float2 &amp;c) : a(a), b(b) { ; }
<a name="l00645"></a><a class="code" href="structcabxpy_ax.html#a491f68c06db459accabb2d45cb50fd7a">00645</a>   __device__ <span class="keywordtype">void</span> <a class="code" href="structcabxpy_ax.html#a491f68c06db459accabb2d45cb50fd7a">operator()</a>(<a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;<a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;y, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;z, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;w) 
<a name="l00646"></a>00646   { x *= <a class="code" href="structcabxpy_ax.html#a6881f05738f1e803b9194702a8e18043">a</a>.x; <a class="code" href="blas__quda_8cu.html#afe4b9416b76c50cbceefc03748f659e1">caxpy_</a>(<a class="code" href="structcabxpy_ax.html#aec82d2b92888a8c52574e2ad54e28377">b</a>, x, y); }
<a name="l00647"></a><a class="code" href="structcabxpy_ax.html#afe3f374f750c0456e852ba1add7dbfd3">00647</a>   <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="structcabxpy_ax.html#afe3f374f750c0456e852ba1add7dbfd3">streams</a>() { <span class="keywordflow">return</span> 4; } 
<a name="l00648"></a><a class="code" href="structcabxpy_ax.html#a776e612af05d949c5813875bc126a310">00648</a>   <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="structcabxpy_ax.html#a776e612af05d949c5813875bc126a310" title="total number of input and output streams">flops</a>() { <span class="keywordflow">return</span> 5; } 
<a name="l00649"></a>00649 };
<a name="l00650"></a>00650 
<a name="l00651"></a><a class="code" href="blas__quda_8cu.html#a8424bba6b49412b57c97bd12e165a602">00651</a> <span class="keywordtype">void</span> <a class="code" href="blas__quda_8h.html#a8424bba6b49412b57c97bd12e165a602">cabxpyAxCuda</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> &amp;a, <span class="keyword">const</span> <a class="code" href="namespacequda.html#a61eb8e0789e8a2021032ee12761d924e">quda::Complex</a> &amp;b, 
<a name="l00652"></a>00652                   <a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a> &amp;<a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a> &amp;y) {
<a name="l00653"></a>00653   <span class="keyword">const</span> <span class="keywordtype">int</span> kernel = 14;
<a name="l00654"></a>00654   <span class="comment">// swap arguments around </span>
<a name="l00655"></a>00655   blasCuda&lt;cabxpyAx,1,1,0,0&gt;(kernel, make_double2(a,0.0), make_double2(b.real(),b.imag()), 
<a name="l00656"></a>00656                              make_double2(0.0,0.0), <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, y, <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>);
<a name="l00657"></a>00657 }
<a name="l00658"></a>00658 
<a name="l00662"></a>00662 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Float2, <span class="keyword">typename</span> FloatN&gt;
<a name="l00663"></a><a class="code" href="structcaxpbypz.html">00663</a> <span class="keyword">struct </span><a class="code" href="structcaxpbypz.html">caxpbypz</a> {
<a name="l00664"></a><a class="code" href="structcaxpbypz.html#a84afac01c5b5c85b31bcff356a9451c6">00664</a>   <span class="keyword">const</span> Float2 <a class="code" href="structcaxpbypz.html#a84afac01c5b5c85b31bcff356a9451c6">a</a>;
<a name="l00665"></a><a class="code" href="structcaxpbypz.html#a8b971bfef9fbf92737bc1ea5667cd600">00665</a>   <span class="keyword">const</span> Float2 <a class="code" href="structcaxpbypz.html#a8b971bfef9fbf92737bc1ea5667cd600">b</a>;
<a name="l00666"></a><a class="code" href="structcaxpbypz.html#afda71c2dfff0dc3daa0f1fb3e023ef81">00666</a>   <a class="code" href="structcaxpbypz.html#afda71c2dfff0dc3daa0f1fb3e023ef81">caxpbypz</a>(<span class="keyword">const</span> Float2 &amp;<a class="code" href="structcaxpbypz.html#a84afac01c5b5c85b31bcff356a9451c6">a</a>, <span class="keyword">const</span> Float2 &amp;<a class="code" href="structcaxpbypz.html#a8b971bfef9fbf92737bc1ea5667cd600">b</a>, <span class="keyword">const</span> Float2 &amp;c) : a(a), b(b) { ; }
<a name="l00667"></a><a class="code" href="structcaxpbypz.html#a90a7c3dc777b9c1a8d633703371d9b14">00667</a>   __device__ <span class="keywordtype">void</span> <a class="code" href="structcaxpbypz.html#a90a7c3dc777b9c1a8d633703371d9b14">operator()</a>(<span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;<a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;y, <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;z, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;w) 
<a name="l00668"></a>00668   { <a class="code" href="blas__quda_8cu.html#afe4b9416b76c50cbceefc03748f659e1">caxpy_</a>(<a class="code" href="structcaxpbypz.html#a84afac01c5b5c85b31bcff356a9451c6">a</a>, x, z); <a class="code" href="blas__quda_8cu.html#afe4b9416b76c50cbceefc03748f659e1">caxpy_</a>(<a class="code" href="structcaxpbypz.html#a8b971bfef9fbf92737bc1ea5667cd600">b</a>, y, z); }
<a name="l00669"></a><a class="code" href="structcaxpbypz.html#a2480b1a5b6151a595776b77a60644993">00669</a>   <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="structcaxpbypz.html#a2480b1a5b6151a595776b77a60644993">streams</a>() { <span class="keywordflow">return</span> 4; } 
<a name="l00670"></a><a class="code" href="structcaxpbypz.html#ae5f27eff93e47481c312def58194812f">00670</a>   <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="structcaxpbypz.html#ae5f27eff93e47481c312def58194812f" title="total number of input and output streams">flops</a>() { <span class="keywordflow">return</span> 5; } 
<a name="l00671"></a>00671 };
<a name="l00672"></a>00672 
<a name="l00673"></a><a class="code" href="blas__quda_8cu.html#aed711da35ad832685263b0635247cf50">00673</a> <span class="keywordtype">void</span> <a class="code" href="blas__quda_8h.html#af953c5df13d204a7c460885962771edd">caxpbypzCuda</a>(<span class="keyword">const</span> <a class="code" href="namespacequda.html#a61eb8e0789e8a2021032ee12761d924e">quda::Complex</a> &amp;a, <a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a> &amp;<a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <span class="keyword">const</span> <a class="code" href="namespacequda.html#a61eb8e0789e8a2021032ee12761d924e">quda::Complex</a> &amp;b, 
<a name="l00674"></a>00674                   <a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a> &amp;y, <a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a> &amp;z) {
<a name="l00675"></a>00675   <span class="keyword">const</span> <span class="keywordtype">int</span> kernel = 15;
<a name="l00676"></a>00676   blasCuda&lt;caxpbypz,0,0,1,0&gt;(kernel, make_double2(a.real(),a.imag()), make_double2(b.real(),b.imag()), 
<a name="l00677"></a>00677                              make_double2(0.0,0.0), <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, y, z, z);
<a name="l00678"></a>00678 }
<a name="l00679"></a>00679 
<a name="l00683"></a>00683 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Float2, <span class="keyword">typename</span> FloatN&gt;
<a name="l00684"></a><a class="code" href="structcaxpbypczpw.html">00684</a> <span class="keyword">struct </span><a class="code" href="structcaxpbypczpw.html">caxpbypczpw</a> {
<a name="l00685"></a><a class="code" href="structcaxpbypczpw.html#af936b9b74d0b8f3dfb713984eac8684d">00685</a>   <span class="keyword">const</span> Float2 <a class="code" href="structcaxpbypczpw.html#af936b9b74d0b8f3dfb713984eac8684d">a</a>;
<a name="l00686"></a><a class="code" href="structcaxpbypczpw.html#ab9834d845b3e26c4268b7bc192eccd26">00686</a>   <span class="keyword">const</span> Float2 <a class="code" href="structcaxpbypczpw.html#ab9834d845b3e26c4268b7bc192eccd26">b</a>;
<a name="l00687"></a><a class="code" href="structcaxpbypczpw.html#a78644a642b1c1db59a889a701d31a83c">00687</a>   <span class="keyword">const</span> Float2 <a class="code" href="structcaxpbypczpw.html#a78644a642b1c1db59a889a701d31a83c">c</a>;
<a name="l00688"></a><a class="code" href="structcaxpbypczpw.html#ac6696aaec12f58e899ed783577c11beb">00688</a>   <a class="code" href="structcaxpbypczpw.html#ac6696aaec12f58e899ed783577c11beb">caxpbypczpw</a>(<span class="keyword">const</span> Float2 &amp;<a class="code" href="structcaxpbypczpw.html#af936b9b74d0b8f3dfb713984eac8684d">a</a>, <span class="keyword">const</span> Float2 &amp;<a class="code" href="structcaxpbypczpw.html#ab9834d845b3e26c4268b7bc192eccd26">b</a>, <span class="keyword">const</span> Float2 &amp;<a class="code" href="structcaxpbypczpw.html#a78644a642b1c1db59a889a701d31a83c">c</a>) : a(a), b(b), c(c) { ; }
<a name="l00689"></a><a class="code" href="structcaxpbypczpw.html#a90ccb94515911f6bfc2abaee90b7f9e4">00689</a>   __device__ <span class="keywordtype">void</span> <a class="code" href="structcaxpbypczpw.html#a90ccb94515911f6bfc2abaee90b7f9e4">operator()</a>(<span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;<a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;y, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;z, <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;w) 
<a name="l00690"></a>00690   { <a class="code" href="blas__quda_8cu.html#afe4b9416b76c50cbceefc03748f659e1">caxpy_</a>(<a class="code" href="structcaxpbypczpw.html#af936b9b74d0b8f3dfb713984eac8684d">a</a>, x, w); <a class="code" href="blas__quda_8cu.html#afe4b9416b76c50cbceefc03748f659e1">caxpy_</a>(<a class="code" href="structcaxpbypczpw.html#ab9834d845b3e26c4268b7bc192eccd26">b</a>, y, w); <a class="code" href="blas__quda_8cu.html#afe4b9416b76c50cbceefc03748f659e1">caxpy_</a>(<a class="code" href="structcaxpbypczpw.html#a78644a642b1c1db59a889a701d31a83c">c</a>, z, w); }
<a name="l00691"></a>00691 
<a name="l00692"></a><a class="code" href="structcaxpbypczpw.html#a334582db65a845547f33295d1b345d66">00692</a>   <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="structcaxpbypczpw.html#a334582db65a845547f33295d1b345d66">streams</a>() { <span class="keywordflow">return</span> 4; } 
<a name="l00693"></a><a class="code" href="structcaxpbypczpw.html#a655eb33eba008909656db0dac86ed4a6">00693</a>   <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="structcaxpbypczpw.html#a655eb33eba008909656db0dac86ed4a6" title="total number of input and output streams">flops</a>() { <span class="keywordflow">return</span> 5; } 
<a name="l00694"></a>00694 };
<a name="l00695"></a>00695 
<a name="l00696"></a><a class="code" href="blas__quda_8cu.html#a216369f7e578320b1bcbf4f945e9bee1">00696</a> <span class="keywordtype">void</span> <a class="code" href="blas__quda_8h.html#adb6225693cb48a1e447586d7afc9f37b">caxpbypczpwCuda</a>(<span class="keyword">const</span> <a class="code" href="namespacequda.html#a61eb8e0789e8a2021032ee12761d924e">quda::Complex</a> &amp;a, <a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a> &amp;<a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <span class="keyword">const</span> <a class="code" href="namespacequda.html#a61eb8e0789e8a2021032ee12761d924e">quda::Complex</a> &amp;b, 
<a name="l00697"></a>00697                      <a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a> &amp;y, <span class="keyword">const</span> <a class="code" href="namespacequda.html#a61eb8e0789e8a2021032ee12761d924e">quda::Complex</a> &amp;c, <a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a> &amp;z, 
<a name="l00698"></a>00698                      <a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a> &amp;w) {
<a name="l00699"></a>00699   <span class="keyword">const</span> <span class="keywordtype">int</span> kernel = 16;
<a name="l00700"></a>00700   blasCuda&lt;caxpbypczpw,0,0,0,1&gt;(kernel, make_double2(a.real(),a.imag()), make_double2(b.real(),b.imag()), 
<a name="l00701"></a>00701                                 make_double2(c.real(), c.imag()), x, y, z, w);
<a name="l00702"></a>00702 }
<a name="l00703"></a>00703 
<a name="l00710"></a>00710 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Float2, <span class="keyword">typename</span> FloatN&gt;
<a name="l00711"></a><a class="code" href="structcaxpyxmaz.html">00711</a> <span class="keyword">struct </span><a class="code" href="structcaxpyxmaz.html">caxpyxmaz</a> {
<a name="l00712"></a><a class="code" href="structcaxpyxmaz.html#a5666f126aa6737e12f5614253c235f13">00712</a>   Float2 <a class="code" href="structcaxpyxmaz.html#a5666f126aa6737e12f5614253c235f13">a</a>;
<a name="l00713"></a><a class="code" href="structcaxpyxmaz.html#aeeaee5085f9395f7b8c467631f127304">00713</a>   <a class="code" href="structcaxpyxmaz.html#aeeaee5085f9395f7b8c467631f127304">caxpyxmaz</a>(<span class="keyword">const</span> Float2 &amp;<a class="code" href="structcaxpyxmaz.html#a5666f126aa6737e12f5614253c235f13">a</a>, <span class="keyword">const</span> Float2 &amp;b, <span class="keyword">const</span> Float2 &amp;c) : a(a) { ; }
<a name="l00714"></a><a class="code" href="structcaxpyxmaz.html#a32e7d42d223cc2ea1e515f7a69b7caf5">00714</a>   __device__ <span class="keywordtype">void</span> <a class="code" href="structcaxpyxmaz.html#a32e7d42d223cc2ea1e515f7a69b7caf5">operator()</a>(<a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;<a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;y, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;z, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;w) 
<a name="l00715"></a>00715   { <a class="code" href="blas__quda_8cu.html#afe4b9416b76c50cbceefc03748f659e1">caxpy_</a>(<a class="code" href="structcaxpyxmaz.html#a5666f126aa6737e12f5614253c235f13">a</a>, x, y); x-= <a class="code" href="structcaxpyxmaz.html#a5666f126aa6737e12f5614253c235f13">a</a>.x*z; }
<a name="l00716"></a><a class="code" href="structcaxpyxmaz.html#a8e4a7d3a5d34f94827e9651fbcd258dc">00716</a>   <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="structcaxpyxmaz.html#a8e4a7d3a5d34f94827e9651fbcd258dc">streams</a>() { <span class="keywordflow">return</span> 5; } 
<a name="l00717"></a><a class="code" href="structcaxpyxmaz.html#a1e1f35129edb61c8f99811151546c93d">00717</a>   <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="structcaxpyxmaz.html#a1e1f35129edb61c8f99811151546c93d" title="total number of input and output streams">flops</a>() { <span class="keywordflow">return</span> 8; } 
<a name="l00718"></a>00718 };
<a name="l00719"></a>00719 
<a name="l00720"></a><a class="code" href="blas__quda_8cu.html#a6abfa86435090ead450e9a4044a5d793">00720</a> <span class="keywordtype">void</span> <a class="code" href="blas__quda_8h.html#a6abfa86435090ead450e9a4044a5d793">caxpyXmazCuda</a>(<span class="keyword">const</span> <a class="code" href="namespacequda.html#a61eb8e0789e8a2021032ee12761d924e">quda::Complex</a> &amp;a, <a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a> &amp;<a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, 
<a name="l00721"></a>00721                           <a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a> &amp;y, <a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a> &amp;z) {
<a name="l00722"></a>00722   <span class="keyword">const</span> <span class="keywordtype">int</span> kernel = 17;
<a name="l00723"></a>00723   blasCuda&lt;caxpyxmaz,1,1,0,0&gt;(kernel, make_double2(a.real(), a.imag()), make_double2(0.0, 0.0), 
<a name="l00724"></a>00724                               make_double2(0.0, 0.0), <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, y, z, <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>);
<a name="l00725"></a>00725 }
<a name="l00726"></a>00726 
<a name="l00727"></a>00727 
<a name="l00731"></a><a class="code" href="blas__quda_8cu.html#aded2accddd1180b9817046733ecb2582">00731</a> __device__ <span class="keywordtype">double</span> <a class="code" href="blas__quda_8cu.html#aded2accddd1180b9817046733ecb2582">norm2_</a>(<span class="keyword">const</span> double2 &amp;a) { <span class="keywordflow">return</span> a.x*a.x + a.y*a.y; }
<a name="l00732"></a><a class="code" href="blas__quda_8cu.html#a67805cd40ddf1826a86518af2495dbd3">00732</a> __device__ <span class="keywordtype">float</span> <a class="code" href="blas__quda_8cu.html#aded2accddd1180b9817046733ecb2582">norm2_</a>(<span class="keyword">const</span> float2 &amp;a) { <span class="keywordflow">return</span> a.x*a.x + a.y*a.y; }
<a name="l00733"></a><a class="code" href="blas__quda_8cu.html#ae5e0304f38c6f34c579f438d0f83d759">00733</a> __device__ <span class="keywordtype">float</span> <a class="code" href="blas__quda_8cu.html#aded2accddd1180b9817046733ecb2582">norm2_</a>(<span class="keyword">const</span> float4 &amp;a) { <span class="keywordflow">return</span> a.x*a.x + a.y*a.y + a.z*a.z + a.w*a.w; }
<a name="l00734"></a>00734 
<a name="l00735"></a>00735 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ReduceType, <span class="keyword">typename</span> Float2, <span class="keyword">typename</span> FloatN&gt;
<a name="l00736"></a><a class="code" href="struct_norm2.html">00736</a> <span class="keyword">struct </span><a class="code" href="struct_norm2.html">Norm2</a> {
<a name="l00737"></a><a class="code" href="struct_norm2.html#a276245e24a04c2d8438e402d4300586b">00737</a>   <a class="code" href="struct_norm2.html#a276245e24a04c2d8438e402d4300586b">Norm2</a>(<span class="keyword">const</span> Float2 &amp;a, <span class="keyword">const</span> Float2 &amp;b) { ; }
<a name="l00738"></a><a class="code" href="struct_norm2.html#ab462144190a9f3705ef5f06cc7ef821e">00738</a>   __device__ <span class="keywordtype">void</span> <a class="code" href="struct_norm2.html#ab462144190a9f3705ef5f06cc7ef821e">operator()</a>(ReduceType &amp;<a class="code" href="domain__wall__dslash__reference_8cpp.html#ace02558c5f0825d03996e5faeaa01bfb">sum</a>, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;<a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;y, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;z, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;w, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;v) { sum += <a class="code" href="blas__quda_8cu.html#aded2accddd1180b9817046733ecb2582">norm2_</a>(x); }
<a name="l00739"></a><a class="code" href="struct_norm2.html#a865710e44d40755ee1d8016165e037cd">00739</a>   <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="struct_norm2.html#a865710e44d40755ee1d8016165e037cd">streams</a>() { <span class="keywordflow">return</span> 1; } 
<a name="l00740"></a><a class="code" href="struct_norm2.html#a92e7bd92ee6baddff7eb63ec7f33d3ef">00740</a>   <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="struct_norm2.html#a92e7bd92ee6baddff7eb63ec7f33d3ef" title="total number of input and output streams">flops</a>() { <span class="keywordflow">return</span> 2; } 
<a name="l00741"></a>00741 };
<a name="l00742"></a>00742 
<a name="l00743"></a>00743 <span class="preprocessor">#include &lt;<a class="code" href="reduce__core_8h.html">reduce_core.h</a>&gt;</span>
<a name="l00744"></a>00744 
<a name="l00745"></a><a class="code" href="color__spinor__field_8cpp.html#ae96f56fe31e59ab1dbb90d499bb073ea">00745</a> <span class="keywordtype">double</span> <a class="code" href="blas__quda_8h.html#ae96f56fe31e59ab1dbb90d499bb073ea">normCuda</a>(<span class="keyword">const</span> <a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a> &amp;<a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>) {
<a name="l00746"></a>00746   <span class="keyword">const</span> <span class="keywordtype">int</span> kernel = 18;
<a name="l00747"></a>00747   <a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a> &amp;y = (<a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a>&amp;)x; <span class="comment">// FIXME</span>
<a name="l00748"></a>00748   <span class="keywordflow">return</span> reduceCuda&lt;double,QudaSumFloat,QudaSumFloat,Norm2,0,0,0&gt;
<a name="l00749"></a>00749     (kernel, make_double2(0.0, 0.0), make_double2(0.0, 0.0), y, y, y, y, y);
<a name="l00750"></a>00750 }
<a name="l00751"></a>00751 
<a name="l00755"></a><a class="code" href="blas__quda_8cu.html#a8ba1e0c8e9ffcf9f21c7bec461aa99da">00755</a> __device__ <span class="keywordtype">double</span> <a class="code" href="blas__quda_8cu.html#a8ba1e0c8e9ffcf9f21c7bec461aa99da">dot_</a>(<span class="keyword">const</span> double2 &amp;a, <span class="keyword">const</span> double2 &amp;b) { <span class="keywordflow">return</span> a.x*b.x + a.y*b.y; }
<a name="l00756"></a><a class="code" href="blas__quda_8cu.html#aed58f76dc00a841965068822ea443a16">00756</a> __device__ <span class="keywordtype">float</span> <a class="code" href="blas__quda_8cu.html#a8ba1e0c8e9ffcf9f21c7bec461aa99da">dot_</a>(<span class="keyword">const</span> float2 &amp;a, <span class="keyword">const</span> float2 &amp;b) { <span class="keywordflow">return</span> a.x*b.x + a.y*b.y; }
<a name="l00757"></a><a class="code" href="blas__quda_8cu.html#a4f2242041e403bb4c65394ce80bb4a28">00757</a> __device__ <span class="keywordtype">float</span> <a class="code" href="blas__quda_8cu.html#a8ba1e0c8e9ffcf9f21c7bec461aa99da">dot_</a>(<span class="keyword">const</span> float4 &amp;a, <span class="keyword">const</span> float4 &amp;b) { <span class="keywordflow">return</span> a.x*b.x + a.y*b.y + a.z*b.z + a.w*b.w; }
<a name="l00758"></a>00758 
<a name="l00759"></a>00759 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ReduceType, <span class="keyword">typename</span> Float2, <span class="keyword">typename</span> FloatN&gt;
<a name="l00760"></a><a class="code" href="struct_dot.html">00760</a> <span class="keyword">struct </span><a class="code" href="struct_dot.html">Dot</a> {
<a name="l00761"></a><a class="code" href="struct_dot.html#a86053a8cff82d20721303add18df24d8">00761</a>   <a class="code" href="struct_dot.html#a86053a8cff82d20721303add18df24d8">Dot</a>(<span class="keyword">const</span> Float2 &amp;a, <span class="keyword">const</span> Float2 &amp;b) { ; }
<a name="l00762"></a><a class="code" href="struct_dot.html#a1ad8f882612abd9274c7589adfa11c5d">00762</a>   __device__ <span class="keywordtype">void</span> <a class="code" href="struct_dot.html#a1ad8f882612abd9274c7589adfa11c5d">operator()</a>(ReduceType &amp;<a class="code" href="domain__wall__dslash__reference_8cpp.html#ace02558c5f0825d03996e5faeaa01bfb">sum</a>, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;<a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;y, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;z, 
<a name="l00763"></a>00763                              <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;w, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;v) { sum += <a class="code" href="blas__quda_8cu.html#a8ba1e0c8e9ffcf9f21c7bec461aa99da">dot_</a>(x,y); }
<a name="l00764"></a><a class="code" href="struct_dot.html#a6a2555b8d0a74f3268491c967c048ae7">00764</a>   <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="struct_dot.html#a6a2555b8d0a74f3268491c967c048ae7">streams</a>() { <span class="keywordflow">return</span> 2; } 
<a name="l00765"></a><a class="code" href="struct_dot.html#abe4e4b3f55abbd15015102bfb406f9d8">00765</a>   <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="struct_dot.html#abe4e4b3f55abbd15015102bfb406f9d8" title="total number of input and output streams">flops</a>() { <span class="keywordflow">return</span> 2; } 
<a name="l00766"></a>00766 };
<a name="l00767"></a>00767 
<a name="l00768"></a><a class="code" href="blas__quda_8cu.html#abe6b6d901ef5b4400d2aa5e61b2e5a9b">00768</a> <span class="keywordtype">double</span> <a class="code" href="blas__quda_8h.html#a916405cd9c1c61be7edb8a919f4f72f1">reDotProductCuda</a>(<a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a> &amp;<a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a> &amp;y) {
<a name="l00769"></a>00769   <span class="keyword">const</span> <span class="keywordtype">int</span> kernel = 19;
<a name="l00770"></a>00770   <span class="keywordflow">return</span> reduceCuda&lt;double,QudaSumFloat,QudaSumFloat,Dot,0,0,0&gt;
<a name="l00771"></a>00771     (kernel, make_double2(0.0, 0.0), make_double2(0.0, 0.0), <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, y, <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>);
<a name="l00772"></a>00772 }
<a name="l00773"></a>00773 
<a name="l00778"></a>00778 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ReduceType, <span class="keyword">typename</span> Float2, <span class="keyword">typename</span> FloatN&gt;
<a name="l00779"></a><a class="code" href="structaxpy_norm2.html">00779</a> <span class="keyword">struct </span><a class="code" href="structaxpy_norm2.html">axpyNorm2</a> {
<a name="l00780"></a><a class="code" href="structaxpy_norm2.html#a0c3cbff061f63709906e591d78e2bc68">00780</a>   Float2 <a class="code" href="structaxpy_norm2.html#a0c3cbff061f63709906e591d78e2bc68">a</a>;
<a name="l00781"></a><a class="code" href="structaxpy_norm2.html#ad9ee03a194ca7fff9c9cd682b0004021">00781</a>   <a class="code" href="structaxpy_norm2.html#ad9ee03a194ca7fff9c9cd682b0004021">axpyNorm2</a>(<span class="keyword">const</span> Float2 &amp;<a class="code" href="structaxpy_norm2.html#a0c3cbff061f63709906e591d78e2bc68">a</a>, <span class="keyword">const</span> Float2 &amp;b) : a(a) { ; }
<a name="l00782"></a><a class="code" href="structaxpy_norm2.html#a35e20a21798fd30e28fd2c36cb2a7c7e">00782</a>   __device__ <span class="keywordtype">void</span> <a class="code" href="structaxpy_norm2.html#a35e20a21798fd30e28fd2c36cb2a7c7e">operator()</a>(ReduceType &amp;<a class="code" href="domain__wall__dslash__reference_8cpp.html#ace02558c5f0825d03996e5faeaa01bfb">sum</a>, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;<a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;y, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;z, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;w, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;v) { 
<a name="l00783"></a>00783     y += <a class="code" href="structaxpy_norm2.html#a0c3cbff061f63709906e591d78e2bc68">a</a>.x*<a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>; sum += <a class="code" href="blas__quda_8cu.html#aded2accddd1180b9817046733ecb2582">norm2_</a>(y); }
<a name="l00784"></a><a class="code" href="structaxpy_norm2.html#a60fede2c30a12a406e84f4deafb2678f">00784</a>   <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="structaxpy_norm2.html#a60fede2c30a12a406e84f4deafb2678f">streams</a>() { <span class="keywordflow">return</span> 3; } 
<a name="l00785"></a><a class="code" href="structaxpy_norm2.html#abf644339e6a2a6b55ed5f7ff1e02d2bc">00785</a>   <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="structaxpy_norm2.html#abf644339e6a2a6b55ed5f7ff1e02d2bc" title="total number of input and output streams">flops</a>() { <span class="keywordflow">return</span> 4; } 
<a name="l00786"></a>00786 };
<a name="l00787"></a>00787 
<a name="l00788"></a><a class="code" href="blas__quda_8cu.html#a98049928f1a093f96bb83c2254153158">00788</a> <span class="keywordtype">double</span> <a class="code" href="blas__quda_8h.html#a98049928f1a093f96bb83c2254153158">axpyNormCuda</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> &amp;a, <a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a> &amp;<a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a> &amp;y) {
<a name="l00789"></a>00789   <span class="keyword">const</span> <span class="keywordtype">int</span> kernel = 20;
<a name="l00790"></a>00790   <span class="keywordflow">return</span> reduceCuda&lt;double,QudaSumFloat,QudaSumFloat,axpyNorm2,0,1,0&gt;
<a name="l00791"></a>00791     (kernel, make_double2(a, 0.0), make_double2(0.0, 0.0), <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, y, <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>);
<a name="l00792"></a>00792 }
<a name="l00793"></a>00793 
<a name="l00798"></a>00798 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ReduceType, <span class="keyword">typename</span> Float2, <span class="keyword">typename</span> FloatN&gt;
<a name="l00799"></a><a class="code" href="structxmy_norm2.html">00799</a> <span class="keyword">struct </span><a class="code" href="structxmy_norm2.html">xmyNorm2</a> {
<a name="l00800"></a><a class="code" href="structxmy_norm2.html#ab9f6b03103743103e36d2b9910dc0abf">00800</a>   <a class="code" href="structxmy_norm2.html#ab9f6b03103743103e36d2b9910dc0abf">xmyNorm2</a>(<span class="keyword">const</span> Float2 &amp;a, <span class="keyword">const</span> Float2 &amp;b) { ; }
<a name="l00801"></a><a class="code" href="structxmy_norm2.html#ac1fd7b016c500b81796a7ec80e6d5af5">00801</a>   __device__ <span class="keywordtype">void</span> <a class="code" href="structxmy_norm2.html#ac1fd7b016c500b81796a7ec80e6d5af5">operator()</a>(ReduceType &amp;<a class="code" href="domain__wall__dslash__reference_8cpp.html#ace02558c5f0825d03996e5faeaa01bfb">sum</a>, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;<a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;y, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;z, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;w, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;v) { 
<a name="l00802"></a>00802     y = x - y; sum += <a class="code" href="blas__quda_8cu.html#aded2accddd1180b9817046733ecb2582">norm2_</a>(y); }
<a name="l00803"></a><a class="code" href="structxmy_norm2.html#a714304ed94c1d2037a9ba7e124cf4c2c">00803</a>   <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="structxmy_norm2.html#a714304ed94c1d2037a9ba7e124cf4c2c">streams</a>() { <span class="keywordflow">return</span> 3; } 
<a name="l00804"></a><a class="code" href="structxmy_norm2.html#ac7d3de001c01259418a7cb2996a30fb6">00804</a>   <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="structxmy_norm2.html#ac7d3de001c01259418a7cb2996a30fb6" title="total number of input and output streams">flops</a>() { <span class="keywordflow">return</span> 3; } 
<a name="l00805"></a>00805 };
<a name="l00806"></a>00806 
<a name="l00807"></a><a class="code" href="blas__quda_8cu.html#aec2d4177c40f1198a60f2e37193792c9">00807</a> <span class="keywordtype">double</span> <a class="code" href="blas__quda_8h.html#af21a980836ec5e8ce2485dc9544ec687">xmyNormCuda</a>(<a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a> &amp;<a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a> &amp;y) {
<a name="l00808"></a>00808   <span class="keyword">const</span> <span class="keywordtype">int</span> kernel = 21;
<a name="l00809"></a>00809   <span class="keywordflow">return</span> reduceCuda&lt;double,QudaSumFloat,QudaSumFloat,xmyNorm2,0,1,0&gt;
<a name="l00810"></a>00810     (kernel, make_double2(0.0, 0.0), make_double2(0.0, 0.0), <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, y, <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>);
<a name="l00811"></a>00811 }
<a name="l00812"></a>00812 
<a name="l00817"></a>00817 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ReduceType, <span class="keyword">typename</span> Float2, <span class="keyword">typename</span> FloatN&gt;
<a name="l00818"></a><a class="code" href="structcaxpy_norm2.html">00818</a> <span class="keyword">struct </span><a class="code" href="structcaxpy_norm2.html">caxpyNorm2</a> {
<a name="l00819"></a><a class="code" href="structcaxpy_norm2.html#a477496534b55848b22c6daa8e06d2438">00819</a>   Float2 <a class="code" href="structcaxpy_norm2.html#a477496534b55848b22c6daa8e06d2438">a</a>;
<a name="l00820"></a><a class="code" href="structcaxpy_norm2.html#a29b195f9e59ecd45bbfefc556ff21dc4">00820</a>   <a class="code" href="structcaxpy_norm2.html#a29b195f9e59ecd45bbfefc556ff21dc4">caxpyNorm2</a>(<span class="keyword">const</span> Float2 &amp;<a class="code" href="structcaxpy_norm2.html#a477496534b55848b22c6daa8e06d2438">a</a>, <span class="keyword">const</span> Float2 &amp;b) : a(a) { ; }
<a name="l00821"></a><a class="code" href="structcaxpy_norm2.html#abeac3444da4a4f69b52a3082cc4a435d">00821</a>   __device__ <span class="keywordtype">void</span> <a class="code" href="structcaxpy_norm2.html#abeac3444da4a4f69b52a3082cc4a435d">operator()</a>(ReduceType &amp;<a class="code" href="domain__wall__dslash__reference_8cpp.html#ace02558c5f0825d03996e5faeaa01bfb">sum</a>, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;<a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;y, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;z, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;w, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;v) { 
<a name="l00822"></a>00822     <a class="code" href="blas__quda_8cu.html#afe4b9416b76c50cbceefc03748f659e1">caxpy_</a>(<a class="code" href="structcaxpy_norm2.html#a477496534b55848b22c6daa8e06d2438">a</a>, x, y); sum += <a class="code" href="blas__quda_8cu.html#aded2accddd1180b9817046733ecb2582">norm2_</a>(y); }
<a name="l00823"></a><a class="code" href="structcaxpy_norm2.html#a029004c9e92b23bc2d0216b333d56929">00823</a>   <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="structcaxpy_norm2.html#a029004c9e92b23bc2d0216b333d56929">streams</a>() { <span class="keywordflow">return</span> 3; } 
<a name="l00824"></a><a class="code" href="structcaxpy_norm2.html#ac4afc16e35ad925bbe8a1e01b3d9b98f">00824</a>   <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="structcaxpy_norm2.html#ac4afc16e35ad925bbe8a1e01b3d9b98f" title="total number of input and output streams">flops</a>() { <span class="keywordflow">return</span> 6; } 
<a name="l00825"></a>00825 };
<a name="l00826"></a>00826 
<a name="l00827"></a><a class="code" href="blas__quda_8cu.html#a4f53228a6dccf0ca350db2daf65c0bec">00827</a> <span class="keywordtype">double</span> <a class="code" href="blas__quda_8h.html#a4f53228a6dccf0ca350db2daf65c0bec">caxpyNormCuda</a>(<span class="keyword">const</span> <a class="code" href="namespacequda.html#a61eb8e0789e8a2021032ee12761d924e">quda::Complex</a> &amp;a, <a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a> &amp;<a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a> &amp;y) {
<a name="l00828"></a>00828   <span class="keyword">const</span> <span class="keywordtype">int</span> kernel = 22;
<a name="l00829"></a>00829   <span class="keywordflow">return</span> reduceCuda&lt;double,QudaSumFloat,QudaSumFloat,caxpyNorm2,0,1,0&gt;
<a name="l00830"></a>00830     (kernel, make_double2(a.real(), a.imag()), make_double2(0.0, 0.0), <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, y, <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>);
<a name="l00831"></a>00831 }
<a name="l00832"></a>00832 
<a name="l00840"></a>00840 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ReduceType, <span class="keyword">typename</span> Float2, <span class="keyword">typename</span> FloatN&gt;
<a name="l00841"></a><a class="code" href="structcaxpyxmaznormx.html">00841</a> <span class="keyword">struct </span><a class="code" href="structcaxpyxmaznormx.html">caxpyxmaznormx</a> {
<a name="l00842"></a><a class="code" href="structcaxpyxmaznormx.html#a5e05cf6953347426ee3d1356b5e8f5d4">00842</a>   Float2 <a class="code" href="structcaxpyxmaznormx.html#a5e05cf6953347426ee3d1356b5e8f5d4">a</a>;
<a name="l00843"></a><a class="code" href="structcaxpyxmaznormx.html#a46c8a19f5f3f9a198b23f54cef32518d">00843</a>   <a class="code" href="structcaxpyxmaznormx.html#a46c8a19f5f3f9a198b23f54cef32518d">caxpyxmaznormx</a>(<span class="keyword">const</span> Float2 &amp;<a class="code" href="structcaxpyxmaznormx.html#a5e05cf6953347426ee3d1356b5e8f5d4">a</a>, <span class="keyword">const</span> Float2 &amp;b) : a(a) { ; }
<a name="l00844"></a><a class="code" href="structcaxpyxmaznormx.html#a02af94303444e1dcd5dfed12ac75dd1f">00844</a>   __device__ <span class="keywordtype">void</span> <a class="code" href="structcaxpyxmaznormx.html#a02af94303444e1dcd5dfed12ac75dd1f">operator()</a>(ReduceType &amp;<a class="code" href="domain__wall__dslash__reference_8cpp.html#ace02558c5f0825d03996e5faeaa01bfb">sum</a>, <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;<a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;y, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;z, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;w, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;v) { <a class="code" href="blas__quda_8cu.html#afe4b9416b76c50cbceefc03748f659e1">caxpy_</a>(<a class="code" href="structcaxpyxmaznormx.html#a5e05cf6953347426ee3d1356b5e8f5d4">a</a>, x, y); x-= <a class="code" href="structcaxpyxmaznormx.html#a5e05cf6953347426ee3d1356b5e8f5d4">a</a>.x*z; sum += <a class="code" href="blas__quda_8cu.html#aded2accddd1180b9817046733ecb2582">norm2_</a>(x); }
<a name="l00845"></a><a class="code" href="structcaxpyxmaznormx.html#afa1d712bc3b162b589a7d6eab0d57ef3">00845</a>   <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="structcaxpyxmaznormx.html#afa1d712bc3b162b589a7d6eab0d57ef3">streams</a>() { <span class="keywordflow">return</span> 5; } 
<a name="l00846"></a><a class="code" href="structcaxpyxmaznormx.html#a4518d952c30d54a05d1ea41bda95970d">00846</a>   <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="structcaxpyxmaznormx.html#a4518d952c30d54a05d1ea41bda95970d" title="total number of input and output streams">flops</a>() { <span class="keywordflow">return</span> 10; } 
<a name="l00847"></a>00847 };
<a name="l00848"></a>00848 
<a name="l00849"></a><a class="code" href="blas__quda_8cu.html#ad9600568879ed2de17139d937e375b81">00849</a> <span class="keywordtype">double</span> <a class="code" href="blas__quda_8h.html#ad9600568879ed2de17139d937e375b81">caxpyXmazNormXCuda</a>(<span class="keyword">const</span> <a class="code" href="namespacequda.html#a61eb8e0789e8a2021032ee12761d924e">quda::Complex</a> &amp;a, <a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a> &amp;<a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, 
<a name="l00850"></a>00850                           <a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a> &amp;y, <a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a> &amp;z) {
<a name="l00851"></a>00851   <span class="keyword">const</span> <span class="keywordtype">int</span> kernel = 23;
<a name="l00852"></a>00852   <span class="keywordflow">return</span> reduceCuda&lt;double,QudaSumFloat,QudaSumFloat,caxpyxmaznormx,1,1,0&gt;
<a name="l00853"></a>00853     (kernel, make_double2(a.real(), a.imag()), make_double2(0.0, 0.0), <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, y, z, <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>);
<a name="l00854"></a>00854 }
<a name="l00855"></a>00855 
<a name="l00863"></a>00863 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ReduceType, <span class="keyword">typename</span> Float2, <span class="keyword">typename</span> FloatN&gt;
<a name="l00864"></a><a class="code" href="structcabxpyaxnorm.html">00864</a> <span class="keyword">struct </span><a class="code" href="structcabxpyaxnorm.html">cabxpyaxnorm</a> {
<a name="l00865"></a><a class="code" href="structcabxpyaxnorm.html#a56a20ecf6bb11d538fa45f69f55817e4">00865</a>   Float2 <a class="code" href="structcabxpyaxnorm.html#a56a20ecf6bb11d538fa45f69f55817e4">a</a>;
<a name="l00866"></a><a class="code" href="structcabxpyaxnorm.html#a7559f8890728225888ecc20e07f23f13">00866</a>   Float2 <a class="code" href="structcabxpyaxnorm.html#a7559f8890728225888ecc20e07f23f13">b</a>;
<a name="l00867"></a><a class="code" href="structcabxpyaxnorm.html#a23cc8565134126834c3807865265fab1">00867</a>   <a class="code" href="structcabxpyaxnorm.html#a23cc8565134126834c3807865265fab1">cabxpyaxnorm</a>(<span class="keyword">const</span> Float2 &amp;<a class="code" href="structcabxpyaxnorm.html#a56a20ecf6bb11d538fa45f69f55817e4">a</a>, <span class="keyword">const</span> Float2 &amp;<a class="code" href="structcabxpyaxnorm.html#a7559f8890728225888ecc20e07f23f13">b</a>) : a(a), b(b) { ; }
<a name="l00868"></a><a class="code" href="structcabxpyaxnorm.html#acfb803d2fdb6b8c2c28e627e6592036a">00868</a>   __device__ <span class="keywordtype">void</span> <a class="code" href="structcabxpyaxnorm.html#acfb803d2fdb6b8c2c28e627e6592036a">operator()</a>(ReduceType &amp;<a class="code" href="domain__wall__dslash__reference_8cpp.html#ace02558c5f0825d03996e5faeaa01bfb">sum</a>, <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;<a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;y, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;z, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;w, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;v) { x *= <a class="code" href="structcabxpyaxnorm.html#a56a20ecf6bb11d538fa45f69f55817e4">a</a>.x; <a class="code" href="blas__quda_8cu.html#afe4b9416b76c50cbceefc03748f659e1">caxpy_</a>(<a class="code" href="structcabxpyaxnorm.html#a7559f8890728225888ecc20e07f23f13">b</a>, x, y); sum += <a class="code" href="blas__quda_8cu.html#aded2accddd1180b9817046733ecb2582">norm2_</a>(y); }
<a name="l00869"></a><a class="code" href="structcabxpyaxnorm.html#a56305749c03b4fb52bbcea8c755eea5f">00869</a>   <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="structcabxpyaxnorm.html#a56305749c03b4fb52bbcea8c755eea5f">streams</a>() { <span class="keywordflow">return</span> 4; } 
<a name="l00870"></a><a class="code" href="structcabxpyaxnorm.html#abcb8c09fad2e9498509c0e24bf5ec0cf">00870</a>   <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="structcabxpyaxnorm.html#abcb8c09fad2e9498509c0e24bf5ec0cf" title="total number of input and output streams">flops</a>() { <span class="keywordflow">return</span> 10; } 
<a name="l00871"></a>00871 };
<a name="l00872"></a>00872 
<a name="l00873"></a><a class="code" href="blas__quda_8cu.html#a8bc318f43250f314ce7a3cf3ba57a69e">00873</a> <span class="keywordtype">double</span> <a class="code" href="blas__quda_8h.html#a8bc318f43250f314ce7a3cf3ba57a69e">cabxpyAxNormCuda</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> &amp;a, <span class="keyword">const</span> <a class="code" href="namespacequda.html#a61eb8e0789e8a2021032ee12761d924e">quda::Complex</a> &amp;b, 
<a name="l00874"></a>00874                         <a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a> &amp;<a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a> &amp;y) {
<a name="l00875"></a>00875   <span class="keyword">const</span> <span class="keywordtype">int</span> kernel = 24;
<a name="l00876"></a>00876   <span class="keywordflow">return</span> reduceCuda&lt;double,QudaSumFloat,QudaSumFloat,cabxpyaxnorm,1,1,0&gt;
<a name="l00877"></a>00877     (kernel, make_double2(a, 0.0), make_double2(b.real(), b.imag()), x, y, x, x, x);
<a name="l00878"></a>00878 }
<a name="l00879"></a>00879 
<a name="l00883"></a><a class="code" href="blas__quda_8cu.html#a92ebb034c326c98cfbcbda576c3d3226">00883</a> __device__ double2 <a class="code" href="blas__quda_8cu.html#a92ebb034c326c98cfbcbda576c3d3226">cdot_</a>(<span class="keyword">const</span> double2 &amp;a, <span class="keyword">const</span> double2 &amp;b) 
<a name="l00884"></a>00884 { <span class="keywordflow">return</span> make_double2(a.x*b.x + a.y*b.y, a.x*b.y - a.y*b.x); }
<a name="l00885"></a><a class="code" href="blas__quda_8cu.html#a2ba98913cfa23b5dca0174ed74f1015f">00885</a> __device__ double2 <a class="code" href="blas__quda_8cu.html#a92ebb034c326c98cfbcbda576c3d3226">cdot_</a>(<span class="keyword">const</span> float2 &amp;a, <span class="keyword">const</span> float2 &amp;b) 
<a name="l00886"></a>00886 { <span class="keywordflow">return</span> make_double2(a.x*b.x + a.y*b.y, a.x*b.y - a.y*b.x); }
<a name="l00887"></a><a class="code" href="blas__quda_8cu.html#ae5a2dc6a465013c35fcd33d3ffddf696">00887</a> __device__ double2 <a class="code" href="blas__quda_8cu.html#a92ebb034c326c98cfbcbda576c3d3226">cdot_</a>(<span class="keyword">const</span> float4 &amp;a, <span class="keyword">const</span> float4 &amp;b) 
<a name="l00888"></a>00888 { <span class="keywordflow">return</span> make_double2(a.x*b.x + a.y*b.y + a.z*b.z + a.w*b.w, a.x*b.y - a.y*b.x + a.z*b.w - a.w*b.z); }
<a name="l00889"></a>00889 
<a name="l00890"></a>00890 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ReduceType, <span class="keyword">typename</span> Float2, <span class="keyword">typename</span> FloatN&gt;
<a name="l00891"></a><a class="code" href="struct_cdot.html">00891</a> <span class="keyword">struct </span><a class="code" href="struct_cdot.html">Cdot</a> {
<a name="l00892"></a><a class="code" href="struct_cdot.html#a4797d479ae2dec6062fadce5f5ce1b64">00892</a>   <a class="code" href="struct_cdot.html#a4797d479ae2dec6062fadce5f5ce1b64">Cdot</a>(<span class="keyword">const</span> Float2 &amp;a, <span class="keyword">const</span> Float2 &amp;b) { ; }
<a name="l00893"></a><a class="code" href="struct_cdot.html#a781e883c49bca9fedfde9331f119c85e">00893</a>   __device__ <span class="keywordtype">void</span> <a class="code" href="struct_cdot.html#a781e883c49bca9fedfde9331f119c85e">operator()</a>(ReduceType &amp;<a class="code" href="domain__wall__dslash__reference_8cpp.html#ace02558c5f0825d03996e5faeaa01bfb">sum</a>, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;<a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;y, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;z, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;w, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;v) { sum += <a class="code" href="blas__quda_8cu.html#a92ebb034c326c98cfbcbda576c3d3226">cdot_</a>(x,y); }
<a name="l00894"></a><a class="code" href="struct_cdot.html#a84d9e819e0c0ee183c75bfaa4b838729">00894</a>   <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="struct_cdot.html#a84d9e819e0c0ee183c75bfaa4b838729">streams</a>() { <span class="keywordflow">return</span> 2; } 
<a name="l00895"></a><a class="code" href="struct_cdot.html#a8c1357e4148bc1361182ed092e475f31">00895</a>   <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="struct_cdot.html#a8c1357e4148bc1361182ed092e475f31" title="total number of input and output streams">flops</a>() { <span class="keywordflow">return</span> 4; } 
<a name="l00896"></a>00896 };
<a name="l00897"></a>00897 
<a name="l00898"></a><a class="code" href="blas__quda_8cu.html#a1f61ea957dbb402f1484a8bc79216e99">00898</a> <a class="code" href="namespacequda.html#a61eb8e0789e8a2021032ee12761d924e">quda::Complex</a> <a class="code" href="blas__quda_8h.html#a8402c906e6b606a91459ad1e233d5b94">cDotProductCuda</a>(<a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a> &amp;<a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a> &amp;y) {
<a name="l00899"></a>00899   <span class="keyword">const</span> <span class="keywordtype">int</span> kernel = 25;
<a name="l00900"></a>00900   double2 cdot = reduceCuda&lt;double2,QudaSumFloat2,QudaSumFloat,Cdot,0,0,0&gt;
<a name="l00901"></a>00901     (kernel, make_double2(0.0, 0.0), make_double2(0.0, 0.0), <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, y, <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>);
<a name="l00902"></a>00902   <span class="keywordflow">return</span> <a class="code" href="namespacequda.html#a61eb8e0789e8a2021032ee12761d924e">quda::Complex</a>(cdot.x, cdot.y);
<a name="l00903"></a>00903 }
<a name="l00904"></a>00904 
<a name="l00911"></a>00911 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ReduceType, <span class="keyword">typename</span> Float2, <span class="keyword">typename</span> FloatN&gt;
<a name="l00912"></a><a class="code" href="structxpaycdotzy.html">00912</a> <span class="keyword">struct </span><a class="code" href="structxpaycdotzy.html">xpaycdotzy</a> {
<a name="l00913"></a><a class="code" href="structxpaycdotzy.html#ad15ff838895641a04396c3cb1e47063e">00913</a>   Float2 <a class="code" href="structxpaycdotzy.html#ad15ff838895641a04396c3cb1e47063e">a</a>;
<a name="l00914"></a><a class="code" href="structxpaycdotzy.html#a9bd2438262998586379d22b8ad8b2fe1">00914</a>   <a class="code" href="structxpaycdotzy.html#a9bd2438262998586379d22b8ad8b2fe1">xpaycdotzy</a>(<span class="keyword">const</span> Float2 &amp;<a class="code" href="structxpaycdotzy.html#ad15ff838895641a04396c3cb1e47063e">a</a>, <span class="keyword">const</span> Float2 &amp;b) : a(a) { ; }
<a name="l00915"></a><a class="code" href="structxpaycdotzy.html#aec497da887fba568d972b41730ef0c26">00915</a>   __device__ <span class="keywordtype">void</span> <a class="code" href="structxpaycdotzy.html#aec497da887fba568d972b41730ef0c26">operator()</a>(ReduceType &amp;<a class="code" href="domain__wall__dslash__reference_8cpp.html#ace02558c5f0825d03996e5faeaa01bfb">sum</a>, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;<a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;y, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;z, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;w, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;v) { y = x + <a class="code" href="structxpaycdotzy.html#ad15ff838895641a04396c3cb1e47063e">a</a>.x*y; sum += <a class="code" href="blas__quda_8cu.html#a92ebb034c326c98cfbcbda576c3d3226">cdot_</a>(z,y); }
<a name="l00916"></a><a class="code" href="structxpaycdotzy.html#aab1a18dad4cc1270b34e4bcdffce2358">00916</a>   <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="structxpaycdotzy.html#aab1a18dad4cc1270b34e4bcdffce2358">streams</a>() { <span class="keywordflow">return</span> 4; } 
<a name="l00917"></a><a class="code" href="structxpaycdotzy.html#a4521217c30f940ebbb2c23b6bc556d52">00917</a>   <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="structxpaycdotzy.html#a4521217c30f940ebbb2c23b6bc556d52" title="total number of input and output streams">flops</a>() { <span class="keywordflow">return</span> 6; } 
<a name="l00918"></a>00918 };
<a name="l00919"></a>00919 
<a name="l00920"></a><a class="code" href="blas__quda_8cu.html#a9b841f1b5c255484fcfa37e25aaacd1c">00920</a> <a class="code" href="namespacequda.html#a61eb8e0789e8a2021032ee12761d924e">quda::Complex</a> <a class="code" href="blas__quda_8h.html#a9b841f1b5c255484fcfa37e25aaacd1c">xpaycDotzyCuda</a>(<a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a> &amp;<a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;a, <a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a> &amp;y, <a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a> &amp;z) {
<a name="l00921"></a>00921   <span class="keyword">const</span> <span class="keywordtype">int</span> kernel = 26;
<a name="l00922"></a>00922   double2 cdot = reduceCuda&lt;double2,QudaSumFloat2,QudaSumFloat,xpaycdotzy,0,1,0&gt;
<a name="l00923"></a>00923     (kernel, make_double2(a, 0.0), make_double2(0.0, 0.0), <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, y, z, <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>);
<a name="l00924"></a>00924   <span class="keywordflow">return</span> <a class="code" href="namespacequda.html#a61eb8e0789e8a2021032ee12761d924e">quda::Complex</a>(cdot.x, cdot.y);
<a name="l00925"></a>00925 }
<a name="l00926"></a>00926 
<a name="l00933"></a>00933 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ReduceType, <span class="keyword">typename</span> Float2, <span class="keyword">typename</span> FloatN&gt;
<a name="l00934"></a><a class="code" href="structcaxpydotzy.html">00934</a> <span class="keyword">struct </span><a class="code" href="structcaxpydotzy.html">caxpydotzy</a> {
<a name="l00935"></a><a class="code" href="structcaxpydotzy.html#a988dec0586dc0e01725405db42aef4c5">00935</a>   Float2 <a class="code" href="structcaxpydotzy.html#a988dec0586dc0e01725405db42aef4c5">a</a>;
<a name="l00936"></a><a class="code" href="structcaxpydotzy.html#a00c35a4f6e268092a01558740049d5a5">00936</a>    <a class="code" href="structcaxpydotzy.html#a00c35a4f6e268092a01558740049d5a5">caxpydotzy</a>(<span class="keyword">const</span> Float2 &amp;<a class="code" href="structcaxpydotzy.html#a988dec0586dc0e01725405db42aef4c5">a</a>, <span class="keyword">const</span> Float2 &amp;b) : a(a) { ; }
<a name="l00937"></a><a class="code" href="structcaxpydotzy.html#a5a2b29e01459ec7aab4a991cb60e6984">00937</a>   __device__ <span class="keywordtype">void</span> <a class="code" href="structcaxpydotzy.html#a5a2b29e01459ec7aab4a991cb60e6984">operator()</a>(ReduceType &amp;<a class="code" href="domain__wall__dslash__reference_8cpp.html#ace02558c5f0825d03996e5faeaa01bfb">sum</a>, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;<a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;y, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;z, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;w, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;v) { <a class="code" href="blas__quda_8cu.html#afe4b9416b76c50cbceefc03748f659e1">caxpy_</a>(<a class="code" href="structcaxpydotzy.html#a988dec0586dc0e01725405db42aef4c5">a</a>, x, y); sum += <a class="code" href="blas__quda_8cu.html#a92ebb034c326c98cfbcbda576c3d3226">cdot_</a>(z,y); }
<a name="l00938"></a><a class="code" href="structcaxpydotzy.html#a2865b9bcc61ffb126834acf06bcaf7bd">00938</a>   <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="structcaxpydotzy.html#a2865b9bcc61ffb126834acf06bcaf7bd">streams</a>() { <span class="keywordflow">return</span> 4; } 
<a name="l00939"></a><a class="code" href="structcaxpydotzy.html#aa76af77bb9ba911c073327a2bb931259">00939</a>   <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="structcaxpydotzy.html#aa76af77bb9ba911c073327a2bb931259" title="total number of input and output streams">flops</a>() { <span class="keywordflow">return</span> 8; } 
<a name="l00940"></a>00940 };
<a name="l00941"></a>00941 
<a name="l00942"></a><a class="code" href="blas__quda_8cu.html#aac0c9bb8961ab21aa1123dcb0745aaa4">00942</a> <a class="code" href="namespacequda.html#a61eb8e0789e8a2021032ee12761d924e">quda::Complex</a> <a class="code" href="blas__quda_8h.html#aac0c9bb8961ab21aa1123dcb0745aaa4">caxpyDotzyCuda</a>(<span class="keyword">const</span> <a class="code" href="namespacequda.html#a61eb8e0789e8a2021032ee12761d924e">quda::Complex</a> &amp;a, <a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a> &amp;<a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a> &amp;y,
<a name="l00943"></a>00943                        <a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a> &amp;z) {
<a name="l00944"></a>00944   <span class="keyword">const</span> <span class="keywordtype">int</span> kernel = 27;
<a name="l00945"></a>00945   double2 cdot = reduceCuda&lt;double2,QudaSumFloat2,QudaSumFloat,caxpydotzy,0,1,0&gt;
<a name="l00946"></a>00946     (kernel, make_double2(a.real(), a.imag()), make_double2(0.0, 0.0), <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, y, z, <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>);
<a name="l00947"></a>00947   <span class="keywordflow">return</span> <a class="code" href="namespacequda.html#a61eb8e0789e8a2021032ee12761d924e">quda::Complex</a>(cdot.x, cdot.y);
<a name="l00948"></a>00948 }
<a name="l00949"></a>00949 
<a name="l00954"></a><a class="code" href="blas__quda_8cu.html#aba76825079ad24caef3d51a710a0e685">00954</a> __device__ double3 <a class="code" href="blas__quda_8cu.html#aba76825079ad24caef3d51a710a0e685">cdotNormA_</a>(<span class="keyword">const</span> double2 &amp;a, <span class="keyword">const</span> double2 &amp;b) 
<a name="l00955"></a>00955 { <span class="keywordflow">return</span> make_double3(a.x*b.x + a.y*b.y, a.x*b.y - a.y*b.x, a.x*a.x + a.y*a.y); }
<a name="l00956"></a><a class="code" href="blas__quda_8cu.html#a71bf0550a8a18906aab190224abad450">00956</a> __device__ double3 <a class="code" href="blas__quda_8cu.html#aba76825079ad24caef3d51a710a0e685">cdotNormA_</a>(<span class="keyword">const</span> float2 &amp;a, <span class="keyword">const</span> float2 &amp;b) 
<a name="l00957"></a>00957 { <span class="keywordflow">return</span> make_double3(a.x*b.x + a.y*b.y, a.x*b.y - a.y*b.x, a.x*a.x + a.y*a.y); }
<a name="l00958"></a><a class="code" href="blas__quda_8cu.html#ad65f1797a68ce108a957a6956da0fd3f">00958</a> __device__ double3 <a class="code" href="blas__quda_8cu.html#aba76825079ad24caef3d51a710a0e685">cdotNormA_</a>(<span class="keyword">const</span> float4 &amp;a, <span class="keyword">const</span> float4 &amp;b) 
<a name="l00959"></a>00959 { <span class="keywordflow">return</span> make_double3(a.x*b.x + a.y*b.y + a.z*b.z + a.w*b.w, 
<a name="l00960"></a>00960                       a.x*b.y - a.y*b.x + a.z*b.w - a.w*b.z,
<a name="l00961"></a>00961                       a.x*a.x + a.y*a.y + a.z*a.z + a.w*a.w); }
<a name="l00962"></a>00962 
<a name="l00963"></a>00963 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ReduceType, <span class="keyword">typename</span> Float2, <span class="keyword">typename</span> FloatN&gt;
<a name="l00964"></a><a class="code" href="struct_cdot_norm_a.html">00964</a> <span class="keyword">struct </span><a class="code" href="struct_cdot_norm_a.html">CdotNormA</a> {
<a name="l00965"></a><a class="code" href="struct_cdot_norm_a.html#ad6d239515f31459b2b16f7e834a60b5e">00965</a>   <a class="code" href="struct_cdot_norm_a.html#ad6d239515f31459b2b16f7e834a60b5e">CdotNormA</a>(<span class="keyword">const</span> Float2 &amp;a, <span class="keyword">const</span> Float2 &amp;b) { ; }
<a name="l00966"></a><a class="code" href="struct_cdot_norm_a.html#a49ffde3afdc18bf01ce025f6cf49252c">00966</a>   __device__ <span class="keywordtype">void</span> <a class="code" href="struct_cdot_norm_a.html#a49ffde3afdc18bf01ce025f6cf49252c">operator()</a>(ReduceType &amp;<a class="code" href="domain__wall__dslash__reference_8cpp.html#ace02558c5f0825d03996e5faeaa01bfb">sum</a>, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;<a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;y, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;z, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;w, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;v) { sum += <a class="code" href="blas__quda_8cu.html#aba76825079ad24caef3d51a710a0e685">cdotNormA_</a>(x,y); }
<a name="l00967"></a><a class="code" href="struct_cdot_norm_a.html#a8824cc1160dfe6e82631b524c35934e8">00967</a>   <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="struct_cdot_norm_a.html#a8824cc1160dfe6e82631b524c35934e8">streams</a>() { <span class="keywordflow">return</span> 2; } 
<a name="l00968"></a><a class="code" href="struct_cdot_norm_a.html#aaf3329daf0ae1019a0f714493c865ed9">00968</a>   <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="struct_cdot_norm_a.html#aaf3329daf0ae1019a0f714493c865ed9" title="total number of input and output streams">flops</a>() { <span class="keywordflow">return</span> 6; } 
<a name="l00969"></a>00969 };
<a name="l00970"></a>00970 
<a name="l00971"></a><a class="code" href="blas__quda_8cu.html#ae1d3df6675296169ec3cac3ad2612364">00971</a> double3 <a class="code" href="blas__quda_8h.html#a0a29522c83a03482f46a1db4fe2a6301">cDotProductNormACuda</a>(<a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a> &amp;<a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a> &amp;y) {
<a name="l00972"></a>00972   <span class="keyword">const</span> <span class="keywordtype">int</span> kernel = 28;
<a name="l00973"></a>00973   <span class="keywordflow">return</span> reduceCuda&lt;double3,QudaSumFloat3,QudaSumFloat,CdotNormA,0,0,0&gt;
<a name="l00974"></a>00974     (kernel, make_double2(0.0, 0.0), make_double2(0.0, 0.0), <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, y, <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>);
<a name="l00975"></a>00975 }
<a name="l00976"></a>00976 
<a name="l00981"></a><a class="code" href="blas__quda_8cu.html#a2b9b2610a6163f401219d351395e29a9">00981</a> __device__ double3 <a class="code" href="blas__quda_8cu.html#a2b9b2610a6163f401219d351395e29a9">cdotNormB_</a>(<span class="keyword">const</span> double2 &amp;a, <span class="keyword">const</span> double2 &amp;b) 
<a name="l00982"></a>00982 { <span class="keywordflow">return</span> make_double3(a.x*b.x + a.y*b.y, a.x*b.y - a.y*b.x, b.x*b.x + b.y*b.y); }
<a name="l00983"></a><a class="code" href="blas__quda_8cu.html#a4e5613326658329eb7c04b652a4b6ddf">00983</a> __device__ double3 <a class="code" href="blas__quda_8cu.html#a2b9b2610a6163f401219d351395e29a9">cdotNormB_</a>(<span class="keyword">const</span> float2 &amp;a, <span class="keyword">const</span> float2 &amp;b) 
<a name="l00984"></a>00984 { <span class="keywordflow">return</span> make_double3(a.x*b.x + a.y*b.y, a.x*b.y - a.y*b.x, b.x*b.x + b.y*b.y); }
<a name="l00985"></a><a class="code" href="blas__quda_8cu.html#ad67dd3b54c93c8f5becba3ca3d1e3509">00985</a> __device__ double3 <a class="code" href="blas__quda_8cu.html#a2b9b2610a6163f401219d351395e29a9">cdotNormB_</a>(<span class="keyword">const</span> float4 &amp;a, <span class="keyword">const</span> float4 &amp;b) 
<a name="l00986"></a>00986 { <span class="keywordflow">return</span> make_double3(a.x*b.x + a.y*b.y + a.z*b.z + a.w*b.w, a.x*b.y - a.y*b.x + a.z*b.w - a.w*b.z,
<a name="l00987"></a>00987                       b.x*b.x + b.y*b.y + b.z*b.z + b.w*b.w); }
<a name="l00988"></a>00988 
<a name="l00989"></a>00989 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ReduceType, <span class="keyword">typename</span> Float2, <span class="keyword">typename</span> FloatN&gt;
<a name="l00990"></a><a class="code" href="struct_cdot_norm_b.html">00990</a> <span class="keyword">struct </span><a class="code" href="struct_cdot_norm_b.html">CdotNormB</a> {
<a name="l00991"></a><a class="code" href="struct_cdot_norm_b.html#ad21cf2b86c8d90f08bf1a87328a48c73">00991</a>   <a class="code" href="struct_cdot_norm_b.html#ad21cf2b86c8d90f08bf1a87328a48c73">CdotNormB</a>(<span class="keyword">const</span> Float2 &amp;a, <span class="keyword">const</span> Float2 &amp;b) { ; }
<a name="l00992"></a><a class="code" href="struct_cdot_norm_b.html#a6aad9a5a8fc518e52942b68a7b566e8c">00992</a>   __device__ <span class="keywordtype">void</span> <a class="code" href="struct_cdot_norm_b.html#a6aad9a5a8fc518e52942b68a7b566e8c">operator()</a>(ReduceType &amp;<a class="code" href="domain__wall__dslash__reference_8cpp.html#ace02558c5f0825d03996e5faeaa01bfb">sum</a>, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;<a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;y, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;z, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;w, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;v) { sum += <a class="code" href="blas__quda_8cu.html#a2b9b2610a6163f401219d351395e29a9">cdotNormB_</a>(x,y); }
<a name="l00993"></a><a class="code" href="struct_cdot_norm_b.html#ab06ebc81211148a2a840caeaba6fcae0">00993</a>   <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="struct_cdot_norm_b.html#ab06ebc81211148a2a840caeaba6fcae0">streams</a>() { <span class="keywordflow">return</span> 2; } 
<a name="l00994"></a><a class="code" href="struct_cdot_norm_b.html#aee8b9a16137c88577bb673fda37df107">00994</a>   <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="struct_cdot_norm_b.html#aee8b9a16137c88577bb673fda37df107" title="total number of input and output streams">flops</a>() { <span class="keywordflow">return</span> 6; } 
<a name="l00995"></a>00995 };
<a name="l00996"></a>00996 
<a name="l00997"></a><a class="code" href="blas__quda_8cu.html#a04c721e9a9361aa189e04390bc847cc9">00997</a> double3 <a class="code" href="blas__quda_8h.html#a02b2029a7146a99a1513069f0882eb7c">cDotProductNormBCuda</a>(<a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a> &amp;<a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a> &amp;y) {
<a name="l00998"></a>00998   <span class="keyword">const</span> <span class="keywordtype">int</span> kernel = 29;
<a name="l00999"></a>00999   <span class="keywordflow">return</span> reduceCuda&lt;double3,QudaSumFloat3,QudaSumFloat,CdotNormB,0,0,0&gt;
<a name="l01000"></a>01000     (kernel, make_double2(0.0, 0.0), make_double2(0.0, 0.0), <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, y, <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>);
<a name="l01001"></a>01001 }
<a name="l01002"></a>01002 
<a name="l01007"></a>01007 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ReduceType, <span class="keyword">typename</span> Float2, <span class="keyword">typename</span> FloatN&gt;
<a name="l01008"></a><a class="code" href="structcaxpbypz_ymbwc_dot_product_u_y_norm_y.html">01008</a> <span class="keyword">struct </span><a class="code" href="structcaxpbypz_ymbwc_dot_product_u_y_norm_y.html">caxpbypzYmbwcDotProductUYNormY</a> {
<a name="l01009"></a><a class="code" href="structcaxpbypz_ymbwc_dot_product_u_y_norm_y.html#afc7f301867bc40931f5d06871c5fcc4a">01009</a>   Float2 <a class="code" href="structcaxpbypz_ymbwc_dot_product_u_y_norm_y.html#afc7f301867bc40931f5d06871c5fcc4a">a</a>;
<a name="l01010"></a><a class="code" href="structcaxpbypz_ymbwc_dot_product_u_y_norm_y.html#a10f10b549bdc1a91206f86af86a1483a">01010</a>   Float2 <a class="code" href="structcaxpbypz_ymbwc_dot_product_u_y_norm_y.html#a10f10b549bdc1a91206f86af86a1483a">b</a>;
<a name="l01011"></a><a class="code" href="structcaxpbypz_ymbwc_dot_product_u_y_norm_y.html#aa8a633de97d0a97a118aec7e2e86d752">01011</a>   <a class="code" href="structcaxpbypz_ymbwc_dot_product_u_y_norm_y.html#aa8a633de97d0a97a118aec7e2e86d752">caxpbypzYmbwcDotProductUYNormY</a>(<span class="keyword">const</span> Float2 &amp;<a class="code" href="structcaxpbypz_ymbwc_dot_product_u_y_norm_y.html#afc7f301867bc40931f5d06871c5fcc4a">a</a>, <span class="keyword">const</span> Float2 &amp;<a class="code" href="structcaxpbypz_ymbwc_dot_product_u_y_norm_y.html#a10f10b549bdc1a91206f86af86a1483a">b</a>) : a(a), b(b) { ; }
<a name="l01012"></a><a class="code" href="structcaxpbypz_ymbwc_dot_product_u_y_norm_y.html#ab1479151d19808cac018e72e56f6a944">01012</a>   __device__ <span class="keywordtype">void</span> <a class="code" href="structcaxpbypz_ymbwc_dot_product_u_y_norm_y.html#ab1479151d19808cac018e72e56f6a944">operator()</a>(ReduceType &amp;<a class="code" href="domain__wall__dslash__reference_8cpp.html#ace02558c5f0825d03996e5faeaa01bfb">sum</a>, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;<a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;y, <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;z, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;w, <span class="keyword">const</span> <a class="code" href="llfat__quda_8cu.html#ac48ea7937311ab667390142aabe97433">FloatN</a> &amp;v) { <a class="code" href="blas__quda_8cu.html#afe4b9416b76c50cbceefc03748f659e1">caxpy_</a>(<a class="code" href="structcaxpbypz_ymbwc_dot_product_u_y_norm_y.html#afc7f301867bc40931f5d06871c5fcc4a">a</a>, x, z); <a class="code" href="blas__quda_8cu.html#afe4b9416b76c50cbceefc03748f659e1">caxpy_</a>(<a class="code" href="structcaxpbypz_ymbwc_dot_product_u_y_norm_y.html#a10f10b549bdc1a91206f86af86a1483a">b</a>, y, z); <a class="code" href="blas__quda_8cu.html#afe4b9416b76c50cbceefc03748f659e1">caxpy_</a>(-<a class="code" href="structcaxpbypz_ymbwc_dot_product_u_y_norm_y.html#a10f10b549bdc1a91206f86af86a1483a">b</a>, w, y); sum += <a class="code" href="blas__quda_8cu.html#a2b9b2610a6163f401219d351395e29a9">cdotNormB_</a>(v,y); }
<a name="l01013"></a><a class="code" href="structcaxpbypz_ymbwc_dot_product_u_y_norm_y.html#a615fb94e34c91b707c66e003ecf873b3">01013</a>   <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="structcaxpbypz_ymbwc_dot_product_u_y_norm_y.html#a615fb94e34c91b707c66e003ecf873b3">streams</a>() { <span class="keywordflow">return</span> 7; } 
<a name="l01014"></a><a class="code" href="structcaxpbypz_ymbwc_dot_product_u_y_norm_y.html#ab4a328097f55c2a08a59d145343c3bc1">01014</a>   <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="structcaxpbypz_ymbwc_dot_product_u_y_norm_y.html#ab4a328097f55c2a08a59d145343c3bc1" title="total number of input and output streams">flops</a>() { <span class="keywordflow">return</span> 18; } 
<a name="l01015"></a>01015 };
<a name="l01016"></a>01016 
<a name="l01017"></a><a class="code" href="blas__quda_8cu.html#a546cbd6ddb50cc0f2c18ea6d27e4e76a">01017</a> double3 <a class="code" href="blas__quda_8h.html#a546cbd6ddb50cc0f2c18ea6d27e4e76a">caxpbypzYmbwcDotProductUYNormYCuda</a>(<span class="keyword">const</span> <a class="code" href="namespacequda.html#a61eb8e0789e8a2021032ee12761d924e">quda::Complex</a> &amp;a, <a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a> &amp;<a class="code" href="blas__quda_8cu.html#ab785f167db51e5445112e14e0b8ef6ae">x</a>, 
<a name="l01018"></a>01018                                            <span class="keyword">const</span> <a class="code" href="namespacequda.html#a61eb8e0789e8a2021032ee12761d924e">quda::Complex</a> &amp;b, <a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a> &amp;y,
<a name="l01019"></a>01019                                            <a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a> &amp;z, <a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a> &amp;w,
<a name="l01020"></a>01020                                            <a class="code" href="classcuda_color_spinor_field.html">cudaColorSpinorField</a> &amp;u) {
<a name="l01021"></a>01021   <span class="keyword">const</span> <span class="keywordtype">int</span> kernel = 30;
<a name="l01022"></a>01022   <span class="keywordflow">return</span> reduceCuda&lt;double3,QudaSumFloat3,QudaSumFloat,caxpbypzYmbwcDotProductUYNormY,0,1,1&gt;
<a name="l01023"></a>01023     (kernel, make_double2(a.real(), a.imag()), make_double2(b.real(), b.imag()), x, y, z, w, u);
<a name="l01024"></a>01024 }
</pre></div></div>
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generated on Wed Apr 4 2012 21:08:04 for QUDA by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
